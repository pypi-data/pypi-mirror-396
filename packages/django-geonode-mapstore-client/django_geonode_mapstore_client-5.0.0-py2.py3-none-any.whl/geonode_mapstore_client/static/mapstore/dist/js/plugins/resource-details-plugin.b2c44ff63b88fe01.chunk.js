"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[5187],{669906:(e,t,n)=>{n.d(t,{O8:()=>a,j3:()=>o,pn:()=>r});var r="DETAILS:DETAILS_LOADED",a=function(e,t,n){return{type:r,id:e,detailsUri:t,detailsSettings:n}},o=function(){return{type:"DETAILS:OPEN_DETAILS_PANEL"}}},995134:(e,t,n)=>{n.d(t,{HH:()=>r,g$:()=>a,k5:()=>o});var r="MAP_TYPE_CHANGED",a="MAP_TYPE:VISUALIZATION_MODE_CHANGED";function o(e){return{type:a,visualizationMode:e}}},779376:(e,t,n)=>{n.d(t,{A:()=>b});var r=n(980971),a=n(538704),o=n(669906),i=n(995134),s=n(779893),l=n(905185),c=n(112585),u=n(499084),d=n.n(u),p=n(444003);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t,n){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const b=function(){var e,t,n,u,g,m,v,b,y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,w=arguments.length>1?arguments[1]:void 0;switch(w.type){case r.LK:var I;return"REPLACE"===(null==w||null===(I=w.payload)||void 0===I?void 0:I.action)?y:f(f({},y),{},{mapInitialConfig:{}});case a.mO:var h=y&&y.map&&y.map.present&&y.map.present.size||y&&y.map&&y.map.size,D=y&&y.map&&y.map.present&&y.map.present.bbox||y&&y.map&&y.map.bbox,S=w.config&&w.config.version>=2,x=w.legacy&&!S?s.Ay.convertFromLegacy(w.config):s.Ay.normalizeConfig(w.config.map),O=f(f({},x),{},{layers:x.layers.map(function(e){return"background"!==e.group||"ol"!==e.type&&"OpenLayers.Layer"!==e.type||(e.type="empty"),e}).map(c.jR),mapConfigRawData:f({},w.config)}),R=(null==y||null===(e=y.map)||void 0===e?void 0:e.mapId)||(null==y||null===(t=y.map)||void 0===t||null===(t=t.present)||void 0===t?void 0:t.mapId);return R=null!==(n=w.config)&&void 0!==n&&n.fileName&&R?R:w.mapId,O.map=Object.assign({},O.map,{mapId:R,size:h,bbox:D,version:S?w.config.version:1}),Object.assign({},O,{mapInitialConfig:f(f({},O.map),{},{mapId:w.mapId})});case a.Wy:return{loadingError:f(f({},w.error),{},{mapId:w.mapId})};case a.Il:return(b=y&&y.map&&y.map.present?y.map.present:y&&y.map)&&b.mapId===w.mapId?(b=Object.assign({},b,{loadingInfo:!0}),Object.assign({},y,{map:b})):y;case a.EE:return(b=y&&y.map&&y.map.present?y.map.present:y&&y.map)&&b.mapId===w.mapId?(b=Object.assign({},b,{loadingInfoError:w.error,loadingInfo:!1}),Object.assign({},y,{map:b})):y;case a.Aq:return!(b=y&&y.map&&y.map.present?y.map.present:y&&y.map)||"".concat(b.mapId)!=="".concat(w.mapId)&&(b.mapId||w.mapId)?y:(b=Object.assign({},b,{info:w.merge?f(f({},b.info),w.info):w.info,loadingInfo:!1}),Object.assign({},y,{map:b}));case o.pn:var E,C,A,j=null===(u=y.dashboard)||void 0===u?void 0:u.resource;return(b=y&&y.map&&y.map.present?y.map.present:y&&y.map)&&(null===(g=b.mapId)||void 0===g?void 0:g.toString())===w.id.toString()?(b=f(f({},b),{},{info:f(f({},b.info),{},{attributes:f(f({},null===(E=b.info)||void 0===E?void 0:E.attributes),{},{details:w.detailsUri||(null===(C=b.info)||void 0===C||null===(C=C.attributes)||void 0===C?void 0:C.details),detailsSettings:w.detailsSettings||(null===(A=b.info)||void 0===A||null===(A=A.attributes)||void 0===A?void 0:A.detailsSettings)})})}),Object.assign({},y,{map:b})):j&&(null===(m=j.id)||void 0===m?void 0:m.toString())===w.id.toString()?(j=Object.assign({},j,{attributes:Object.assign({},j.attributes,{details:w.detailsUri,detailsSettings:w.detailsSettings})}),Object.assign({},y,{dashboard:f(f({},y.dashboard),{},{resource:j})})):y;case a.QW:return b=y&&y.map&&y.map.present?y.map.present:y&&y.map,b=(0,l.hZ)("mapSaveErrors",d()(w.error),b),Object.assign({},y,{map:b});case a.xg:return b=y&&y.map&&y.map.present?y.map.present:y&&y.map,b=(0,l.wC)("mapSaveErrors",b),Object.assign({},y,{map:b});case a.u1:return b=(null==y||null===(v=y.map)||void 0===v?void 0:v.present)||(null==y?void 0:y.map),b=(0,l.wC)("mapSaveErrors",b),f(f({},y),{},{map:b});case i.g$:case i.HH:b=y&&y.map&&y.map.present?y.map.present:y&&y.map;var P=void 0!==w.mapType?(0,p.RR)(w.mapType):w.visualizationMode||p.Hd._2D;return b=(0,l.hZ)("visualizationMode",P,b),f(f({},y),{},{map:b});default:return y}}},290895:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(273517),a=n.n(r),o=n(393149),i=n(811668),s=n(801081),l=n(605556),c=n.n(l),u=n(68352),d=n(779376),p=n(891543),g=n(131127),m=n(662387),f=n(935897),v=n(592497),b=n(201384),y=n(82725),w=n(51797),I=n(836970),h=n(8571),D=n(172175),S=n(66178),x=n(930196),O=n(147628),R=n(17793),E=n(982668),C=["defaultOpen"];function A(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){var n,o,i=e.tabs,s=void 0===i?[{type:"tab",id:"info",labelId:"gnviewer.info",items:[{type:"text",labelId:"gnviewer.title",value:"{context.get(state('gnResourceData'), 'title')}"},{type:"link",labelId:"gnviewer.owner",href:"{'/people/profile/' + context.get(state('gnResourceData'), 'owner.username')}",value:"{context.getUserResourceName(context.get(state('gnResourceData'), 'owner'))}",disableIf:"{!context.get(state('gnResourceData'), 'owner.username')}"},{type:"date",format:"YYYY-MM-DD HH:mm",labelId:"{'gnviewer.'+context.get(state('gnResourceData'), 'date_type').toLowerCase()}",value:"{context.get(state('gnResourceData'), 'date')}"},{type:"date",format:"YYYY-MM-DD HH:mm",labelId:"gnviewer.created",value:"{context.get(state('gnResourceData'), 'created')}"},{type:"date",format:"YYYY-MM-DD HH:mm",labelId:"gnviewer.lastModified",value:"{context.get(state('gnResourceData'), 'last_updated')}"},{type:"query",labelId:"gnviewer.resourceType",valueId:"{'gnviewer.' + context.get(state('gnResourceData'), 'resource_type')}",pathname:"/",query:{f:"{context.get(state('gnResourceData'), 'resource_type')}"}},{type:"{context.isDocumentExternalSource(state('gnResourceData')) ? 'link' : 'text'}",labelId:"gnviewer.sourceType",value:"{context.get(state('gnResourceData'), 'sourcetype', '').toLowerCase()}",href:"{context.get(state('gnResourceData'), 'href')}"},{type:"query",labelId:"gnviewer.category",value:"{context.get(state('gnResourceData'), 'category.gn_description')}",pathname:"/",query:{"filter{category.identifier.in}":"{context.get(state('gnResourceData'), 'category.identifier')}"}},{type:"link",labelId:"gnviewer.pointOfContact",value:"{context.getUserResourceNames(context.get(state('gnResourceData'), 'poc'))}",disableIf:"{!context.get(state('gnResourceData'), 'poc')}"},{type:"query",labelId:"gnviewer.keywords",value:"{context.get(state('gnResourceData'), 'keywords')}",valueKey:"name",pathname:"/",queryTemplate:{"filter{keywords.slug.in}":"${slug}"}},{type:"query",labelId:"gnviewer.regions",value:"{context.get(state('gnResourceData'), 'regions')}",valueKey:"name",pathname:"/",queryTemplate:{"filter{regions.code.in}":"${code}"}},{type:"text",labelId:"gnviewer.attribution",value:"{context.get(state('gnResourceData'), 'attribution')}"},{type:"text",labelId:"gnviewer.language",value:"{context.get(state('gnResourceData'), 'language')}"},{type:"html",labelId:"gnviewer.supplementalInformation",value:"{context.get(state('gnResourceData'), 'supplemental_information')}"},{type:"date",format:"YYYY-MM-DD HH:mm",labelId:"gnviewer.temporalExtent",value:{start:"{context.get(state('gnResourceData'), 'temporal_extent_start')}",end:"{context.get(state('gnResourceData'), 'temporal_extent_end')}"}},{type:"link",style:"label",labelId:"gnviewer.viewFullMetadata",href:"{context.getMetadataDetailUrl(state('gnResourceData'))}",disableIf:"{!context.getMetadataDetailUrl(state('gnResourceData'))}"}]},{type:"locations",id:"locations",labelId:"gnviewer.locations",items:"{({extent: context.get(state('gnResourceData'), 'extent')})}"},{type:"relations",id:"related",labelId:"gnviewer.linkedResources.label",items:"{context.get(state('gnResourceData'), 'linkedResources')}"},{type:"assets",id:"assets",labelId:"gnviewer.assets",items:"{context.get(state('gnResourceData'), 'assets')}",disableIf:"{!context.resourceHasPermission(state('gnResourceData'), 'change_resourcebase')}"},{type:"data",id:"data",labelId:"gnviewer.data",disableIf:"{context.get(state('gnResourceData'), 'resource_type') !== 'dataset'}",items:"{context.get(state('gnResourceData'), 'attribute_set')}"},{type:"share",id:"share",labelId:"gnviewer.share",disableIf:"{!context.canAccessPermissions(state('gnResourceData'))}",items:[!0]},{type:"settings",id:"settings",labelId:"gnviewer.settings",disableIf:"{!context.canManageResourceSettings(state('gnResourceData'))}",items:[!0]}]:i,l=e.items,c=e.editable,u=void 0===c||c,d=e.canEdit,g=e.targetSelector,b=e.headerNodeSelector,y=void 0===b?"#gn-brand-navbar":b,I=e.navbarNodeSelector,h=void 0===I?"#ms-action-navbar":I,D=e.footerNodeSelector,S=void 0===D?".gn-footer":D,x=e.width,C=e.height,P=e.show,k=e.onShow,_=e.onClose,M=e.enableFilters,T=e.resource,H=e.resourcesGridId,N=e.loading,Y=e.pendingChanges,L=e.enablePreview,q=e.editingOverlay,G=e.closeOnClickOut,z=e.showViewerButton,U=e.onClearResource,F=(n=(0,r.useState)(!1),o=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(n,o)||A(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),$=F[0],B=F[1],K=d&&u,V=!(null!=T&&T["@ms-detail"]),Z=(0,v.A)({headerNodeSelector:y,navbarNodeSelector:h,footerNodeSelector:S,width:x,height:C,active:!0}),Q=Z.stickyTop,W=Z.stickyBottom;function X(){k(!1),_(null),!V&&U(null)}function J(){Y&&!V?B(!0):X()}(0,r.useEffect)(function(){return function(){J()}},[]);var ee=(0,O.A)({extraNodes:[".ms-popover-overlay"],disabled:!G||!P,onClickOut:function(){J()}}),te=t.loadedPlugins,ne=function(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,p.A)({items:l,loadedPlugins:te},[null==T?void 0:T.pk]).filter(function(e){return"toolbar"===e.target})).sort(function(e,t){return e.position-t.position});return a().createElement(f.A,{targetSelector:g},a().createElement(m.A,{className:"ms-resource-detail shadow-xl",top:Q,bottom:W,show:P,enabled:P,editing:q&&Y,ref:ee},a().createElement(E.A,{resource:T,loading:N,toolbarItems:ne,onClose:J,editing:K,enableFilters:M,enablePreview:L,tabs:s,tabComponents:R.A,resourcesGridId:H,showViewerButton:z})),a().createElement(w.A,{show:!!$,onCancel:function(){return B(!1)},onConfirm:X,pendingState:!!Y,titleId:"resourcesCatalog.detailsPendingChangesTitle",descriptionId:"resourcesCatalog.detailsPendingChangesDescription",cancelId:"resourcesCatalog.detailsPendingChangesCancel",confirmId:"resourcesCatalog.detailsPendingChangesConfirm",variant:"danger"}))}P.contextTypes={loadedPlugins:c().object,plugins:c().object};var k=(0,i.connect)((0,s.j8)({resource:D.xF,show:b.e_,loading:D.tI,canEdit:D.PA,pendingChanges:D.i9}),{onShow:y.GE,onClose:y.cQ,onClearResource:S.Hc})(function(e){var t,n,o=e.defaultOpen,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,C);return(0,r.useEffect)(function(){var e;null!=i&&null!==(e=i.resource)&&void 0!==e&&e.pk&&o&&i.onShow(!0)},[null==i||null===(t=i.resource)||void 0===t?void 0:t.pk,o]),null!=i&&null!==(n=i.resource)&&void 0!==n&&n.pk&&i.show?a().createElement(P,i):null});const _=(0,o.i1)("ResourceDetails",{component:k,containers:{ActionNavbar:[{name:"ResourceDetailsButton",Component:(0,i.connect)(function(e){return{resource:(0,D.xF)(e)}},{onShow:y.GE})(function(e){var t=e.component,n=e.resourcesGridId,r=e.onShow,o=e.resource;if(null==o||!o.pk)return null;var i=t;return i?a().createElement(i,{onClick:function(){r(!0,n)},glyph:"details",square:!0,labelId:"resourcesCatalog.viewResourceProperties"}):null}),priority:1,doNotHide:!0},{name:"ShareActionButton",Component:(0,i.connect)((0,s.Mz)(D.$f,D.mv,g.ii,function(e,t,n){return{enabled:!e&&(t||(null==n?void 0:n.id))}}),{onSelectTab:y.xX,onShowDetails:y.GE})(function(e){var t=e.enabled,n=e.size,r=e.onSelectTab,o=e.onShowDetails;return t?a().createElement(I.A,{size:n,onClick:function(){o(!0),r("share")}},a().createElement(h.A,{msgId:"share.title"})):null}),priority:1,doNotHide:!0}],ResourcesGrid:{priority:2,target:"card-buttons",position:2,Component:(0,i.connect)((0,s.j8)({selectedResource:D.xF}),{onSelect:S.gu,onShow:y.GE})(function(e){var t=e.resourcesGridId,n=e.resource,r=e.onSelect,o=e.component,i=e.selectedResource,s=e.onShow,l=o;return a().createElement(l,{onClick:function(){i["@ms-detail"]&&(null==i?void 0:i.pk)===(null==n?void 0:n.pk)||r(n,t),s(!0,t)},glyph:"details",square:!0,labelId:"resourcesCatalog.viewResourceProperties"})}),doNotHide:!0}},reducers:{gnresource:x.A,controls:u.A,config:d.A}})}}]);