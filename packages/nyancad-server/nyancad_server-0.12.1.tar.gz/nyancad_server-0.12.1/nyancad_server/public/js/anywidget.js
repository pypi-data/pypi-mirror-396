import { $APP, shadow$provide } from "./common.js";
var YI=function(){var a=$APP.Jm(1);$APP.mm(function(){var b=function(){function d(e){var f=e[1];if(f===7){var g=e[7];f=$APP.n(TI);f=!$APP.Gd(f,g);e[8]=f;e[1]=f?10:11;return $APP.Z}if(f===1)return f=$APP.n(UI),f=$APP.yh(f),g=$APP.B(f),e[9]=g,e[2]=null,e[1]=2,$APP.Z;if(f===4){g=e[9];f=$APP.C(g);f=$APP.Bz.g(f);g=$APP.n(VI);g=$APP.M(g,f);var h=$APP.Az.g(g);e[7]=f;e[10]=g;e[11]=h;e[1]=$APP.m(f)?7:8;return $APP.Z}if(f===15)return e[2]=e[2],e[1]=12,$APP.Z;if(f===13)return h=e[11],e[2]=$APP.Ha(h),e[1]=15,
$APP.Z;if(f===6)return e[2]=e[2],e[1]=3,$APP.Z;if(f===17)return g=e[9],g=$APP.D(g),e[9]=g,e[2]=null,e[1]=2,$APP.Z;if(f===3)return $APP.Hm(e,e[2]);if(f===12)return e[2]=e[2],e[1]=9,$APP.Z;if(f===2)return g=e[9],f=$APP.B(g),e[1]=f?4:5,$APP.Z;if(f===19)return g=e[9],h=e[12],f=e[2],g=$APP.D(g),h=$APP.n(h),h=$APP.yh(h),h=$APP.B(h),g=$APP.rf.h(g,h),e[13]=f,e[9]=g,e[2]=null,e[1]=2,$APP.Z;if(f===11)return f=e[8],e[2]=f,e[1]=12,$APP.Z;if(f===9)return e[1]=$APP.m(e[2])?16:17,$APP.Z;if(f===5)return e[2]=null,
e[1]=6,$APP.Z;if(f===14)return e[2]=e[14],e[1]=15,$APP.Z;if(f===16){g=e[7];f=$APP.Ri.s(WI,$APP.W,g,$APP.Cg);g=$APP.an(XI,g,$APP.Jl(WI,new $APP.T(null,1,5,$APP.U,[g],null)));h=$APP.Ri.s(TI,$APP.W,g.group,g.cache);var l=g.ec;e[15]=f;e[12]=g;e[16]=h;return $APP.Em(e,19,l)}return f===10?(f=e[10],f=$APP.B(f),e[14]=f,e[1]=f?13:14,$APP.Z):f===18?(e[2]=e[2],e[1]=6,$APP.Z):f===8?(g=e[7],e[2]=g,e[1]=9,$APP.Z):null}return function(){function e(h){for(;;){a:{try{for(;;){var l=d(h);if(!$APP.P(l,$APP.Z)){var p=
l;break a}}}catch(q){p=q;h[2]=p;if($APP.B(h[4]))h[1]=$APP.C(h[4]);else throw p;p=$APP.Z;break a}p=void 0}if(!$APP.P(p,$APP.Z))return p}}function f(){var h=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[0]=g;h[1]=1;return h}var g=null;g=function(h){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,h)}throw Error("Invalid arity: "+arguments.length);};g.m=f;g.g=e;return g}()}(),c=function(){var d=b();d[6]=a;return d}();return $APP.Dm(c)})},
ZI=new $APP.O("nyancad.mosaic.anywidget","anywidget-sync","nyancad.mosaic.anywidget/anywidget-sync",-1693447253);var $I=new URLSearchParams(window.location.search),aJ,bJ=$I.get("schem");aJ=$APP.m(bJ)?bJ:"myschem";var cJ=$I.get("db"),XI=$APP.Nm($APP.m(cJ)?cJ:"schematics"),WI=$APP.Hl($APP.Ne([aJ,$APP.Q,"models",$APP.Q])),UI=$APP.an(XI,aJ,$APP.Jl(WI,new $APP.T(null,1,5,$APP.U,[aJ],null))),VI=$APP.an(XI,"models",$APP.Jl(WI,new $APP.T(null,1,5,$APP.U,["models"],null))),dJ=$APP.an(XI,""+$APP.X.g(aJ)+"$result",$APP.Hl($APP.uh())),TI=$APP.Zm(XI,$APP.J([UI,VI,dJ]));export const render=function(a){var b=a.model;a.el.innerHTML="Connected to editor.";b.set("schematic_data",$APP.ol($APP.n(WI)));b.set("name",aJ);b.save_changes();$APP.Di(WI,ZI,function(c,d,e,f){$APP.yi($APP.J(["Schematic updated, syncing to anywidget model"]));YI();b.set("schematic_data",$APP.ol(f));return b.save_changes()});b.on("change:simulation_data",function(){var c=$APP.Rm(b.get("simulation_data")),d=(new Date).toISOString();d=""+$APP.X.g(aJ)+"$result:"+$APP.X.g(d);$APP.yi($APP.J(["Received simulation data from Python, storing with key:",
d]));return $APP.Ri.s(dJ,$APP.W,d,c)});return null};