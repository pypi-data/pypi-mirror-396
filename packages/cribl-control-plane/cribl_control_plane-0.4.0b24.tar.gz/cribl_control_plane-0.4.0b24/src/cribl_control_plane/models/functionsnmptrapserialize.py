"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from cribl_control_plane import models, utils
from cribl_control_plane.types import BaseModel
from cribl_control_plane.utils import validate_open_enum
from enum import Enum
import pydantic
from pydantic import field_serializer
from pydantic.functional_validators import PlainValidator
from typing import Any, Dict, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


class FunctionSnmpTrapSerializeID(str, Enum):
    SNMP_TRAP_SERIALIZE = "snmp_trap_serialize"


class FunctionSnmpTrapSerializeAuthenticationProtocol(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    # None
    NONE = "none"
    # MD5
    MD5 = "md5"
    # SHA1
    SHA = "sha"
    # SHA224
    SHA224 = "sha224"
    # SHA256
    SHA256 = "sha256"
    # SHA384
    SHA384 = "sha384"
    # SHA512
    SHA512 = "sha512"


class FunctionSnmpTrapSerializeV3UserTypedDict(TypedDict):
    name: NotRequired[str]
    auth_protocol: NotRequired[FunctionSnmpTrapSerializeAuthenticationProtocol]
    auth_key: NotRequired[Any]
    priv_protocol: NotRequired[str]


class FunctionSnmpTrapSerializeV3User(BaseModel):
    name: Optional[str] = None

    auth_protocol: Annotated[
        Annotated[
            Optional[FunctionSnmpTrapSerializeAuthenticationProtocol],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="authProtocol"),
    ] = FunctionSnmpTrapSerializeAuthenticationProtocol.NONE

    auth_key: Annotated[Optional[Any], pydantic.Field(alias="authKey")] = None

    priv_protocol: Annotated[Optional[str], pydantic.Field(alias="privProtocol")] = (
        "none"
    )

    @field_serializer("auth_protocol")
    def serialize_auth_protocol(self, value):
        if isinstance(value, str):
            try:
                return models.FunctionSnmpTrapSerializeAuthenticationProtocol(value)
            except ValueError:
                return value
        return value


class FunctionSnmpTrapSerializeSchemaTypedDict(TypedDict):
    strict: NotRequired[bool]
    r"""Prevent event serialization if any required fields are missing. When disabled, @{product} will attempt to serialize the event even if required fields are missing, which could cause unexpected behavior at the downstream receiver."""
    drop_failed_events: NotRequired[bool]
    r"""When disabled, `snmpSerializeErrors` will be set on the event, and the `__snmpRaw` field will be removed to prevent @{product} from sending the event from the SNMP Trap Destination"""
    v3_user: NotRequired[FunctionSnmpTrapSerializeV3UserTypedDict]


class FunctionSnmpTrapSerializeSchema(BaseModel):
    strict: Optional[bool] = True
    r"""Prevent event serialization if any required fields are missing. When disabled, @{product} will attempt to serialize the event even if required fields are missing, which could cause unexpected behavior at the downstream receiver."""

    drop_failed_events: Annotated[
        Optional[bool], pydantic.Field(alias="dropFailedEvents")
    ] = True
    r"""When disabled, `snmpSerializeErrors` will be set on the event, and the `__snmpRaw` field will be removed to prevent @{product} from sending the event from the SNMP Trap Destination"""

    v3_user: Annotated[
        Optional[FunctionSnmpTrapSerializeV3User], pydantic.Field(alias="v3User")
    ] = None


class FunctionSnmpTrapSerializeTypedDict(TypedDict):
    filename: str
    group: str
    id: FunctionSnmpTrapSerializeID
    load_time: float
    mod_time: float
    name: str
    uischema: Dict[str, Any]
    version: str
    async_timeout: NotRequired[float]
    cribl_version: NotRequired[str]
    disabled: NotRequired[bool]
    handle_signals: NotRequired[bool]
    sync: NotRequired[bool]
    schema_: NotRequired[FunctionSnmpTrapSerializeSchemaTypedDict]


class FunctionSnmpTrapSerialize(BaseModel):
    filename: Annotated[str, pydantic.Field(alias="__filename")]

    group: str

    id: FunctionSnmpTrapSerializeID

    load_time: Annotated[float, pydantic.Field(alias="loadTime")]

    mod_time: Annotated[float, pydantic.Field(alias="modTime")]

    name: str

    uischema: Dict[str, Any]

    version: str

    async_timeout: Annotated[Optional[float], pydantic.Field(alias="asyncTimeout")] = (
        None
    )

    cribl_version: Optional[str] = None

    disabled: Optional[bool] = None

    handle_signals: Annotated[Optional[bool], pydantic.Field(alias="handleSignals")] = (
        None
    )

    sync: Optional[bool] = None

    schema_: Annotated[
        Optional[FunctionSnmpTrapSerializeSchema], pydantic.Field(alias="schema")
    ] = None
