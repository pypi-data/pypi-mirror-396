import{_ as le}from"./PPVm8Dsz.js";import{y as se,p as ie,C as j,o as oe,v as V,g as t,m as f,l as L,G as m,d as Z,e as c,b as ne,i as de,f as R,n as h,k as u,P as B,z as ce,r as g,w as W,Q as pe,I as G,R as fe,S as ve,t as y,c as me,s as ue,U as _e,V as he,X as ge,D as ye,h as be,M as we}from"./BA6D4iam.js";import{d as xe,z as ze}from"./NApQS6X6.js";import{D as Se}from"./C4A3Hpap.js";var Re=R('<label class="text-sm">Interval (ms): <input type="number" class="input w-24 ml-2"/></label>'),Pe=R('<div class="text-sm">Loading well logâ€¦</div>'),Oe=R('<div class="text-sm text-red-500"> </div>'),Fe=R('<div class="ws-well-plot"><!> <div class="mb-2 flex items-center gap-2"><button class="btn px-3 py-1 text-sm bg-gray-800 text-white rounded" aria-label="Refresh plot">Refresh</button> <label class="text-sm flex items-center gap-1"><input type="checkbox"/> Auto-refresh</label> <!></div> <!> <div></div></div>');function Ae(Q,b){ie(b,!1);const i=()=>Z(xe,"$depthFilter",$),p=()=>Z(ze,"$zoneFilter",$),[$,X]=ue();let o=j(b,"projectId",8),n=j(b,"wellName",8),w=null,a=f(null),H=j(b,"minWidth",8,"480px"),P=f(!1),x=f(null),O=f(!1),J=f(5e3),F=null,D=f(null),I=f(null);const K="http://localhost:6312";async function Y(){if(w)return w;const e=await le(()=>import("./BJMC0GYJ.js").then(r=>r.p),[],import.meta.url);return w=e.default||e,w}async function _(){if(!(!o()||!n())){c(P,!0),c(x,null);try{let e=`${K}/quick_pp/plotter/projects/${o()}/wells/${encodeURIComponent(String(n()))}/log`;const r=new URLSearchParams;if(i()?.enabled&&(i().minDepth!==null&&r.append("min_depth",String(i().minDepth)),i().maxDepth!==null&&r.append("max_depth",String(i().maxDepth))),p()?.enabled&&Array.isArray(p().zones)&&p().zones.length>0){const S=p().zones.map(N=>String(N)).join(",");r.append("zones",S)}r.toString()&&(e+="?"+r.toString());const l=await fetch(e);if(!l.ok)throw new Error(await l.text());const d=await l.json();if(!t(a))throw new Error("Missing plot container");const s=await Y();if(!s)throw new Error("Failed to load Plotly library");const v={...d.config||{},responsive:!0,scrollZoom:!0},z={...d.layout||{},dragmode:d.layout?.dragmode??"zoom"};if(s.react?s.react(t(a),d.data,z,v):s.newPlot(t(a),d.data,z,v),_e&&typeof ResizeObserver<"u"){if(t(a)?._plotlyResizeObserver)try{t(a)._plotlyResizeObserver.disconnect()}catch{}const S=new ResizeObserver(()=>{try{s.Plots&&s.Plots.resize&&s.Plots.resize(t(a))}catch{}});S.observe(t(a)),he(a,t(a)._plotlyResizeObserver=S)}}catch(e){console.error("Failed to render well plot",e),c(x,String(e?.message??e))}finally{c(P,!1)}}}oe(()=>{}),V(()=>{try{t(a)&&t(a)._plotlyResizeObserver&&(t(a)._plotlyResizeObserver.disconnect(),delete t(a)._plotlyResizeObserver),F&&(clearInterval(F),F=null)}catch{}});{const e=r=>{try{const l=r.detail;if(!l)return;String(l.projectId)===String(o())&&String(l.wellName)===String(n())&&_()}catch{}};window.addEventListener("qpp:data-updated",e),V(()=>window.removeEventListener("qpp:data-updated",e))}L(()=>(m(o()),m(n())),()=>{o()&&n()&&_()}),L(()=>(i(),t(D),m(o()),m(n())),()=>{i()&&JSON.stringify(i())!==JSON.stringify(t(D))&&(c(D,{...i()}),o()&&n()&&_())}),L(()=>(p(),t(I),m(o()),m(n())),()=>{p()&&JSON.stringify(p())!==JSON.stringify(t(I))&&(c(I,{...p()}),o()&&n()&&_())}),ne(),de();var E=Fe(),q=h(E);Se(q,{});var k=u(q,2),M=h(k);M.__click=_;var A=u(M,2),U=h(A);B(U),ce(),g(A);var ee=u(A,2);{var te=e=>{var r=Re(),l=u(h(r));B(l),g(r),ge(l,()=>t(J),d=>c(J,d)),y(e,r)};W(ee,e=>{t(O)&&e(te)})}g(k);var C=u(k,2);{var re=e=>{var r=Pe();y(e,r)},ae=e=>{var r=ye(),l=be(r);{var d=s=>{var v=Oe(),z=h(v);g(v),G(()=>we(z,`Error: ${t(x)??""}`)),y(s,v)};W(l,s=>{t(x)&&s(d)},!0)}y(e,r)};W(C,e=>{t(P)?e(re):e(ae,!1)})}var T=u(C,2);pe(T,e=>c(a,e),()=>t(a)),g(E),G(()=>fe(T,`width:100%; min-width: ${H()??""}; height:900px;`)),ve(U,()=>t(O),e=>c(O,e)),y(Q,E),me(),X()}se(["click"]);export{Ae as W};
