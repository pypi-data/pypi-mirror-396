import{af as Fa,p as $e,D as St,h as tt,w as q,g as t,_ as Re,t as l,c as Ce,ag as Ea,ah as Da,Z as vt,I as z,M as g,ai as Ma,C as we,f as _,a0 as Ta,a1 as za,n as r,k as s,a2 as qa,a3 as Ra,r as a,Q as na,y as ia,o as Oa,l as re,e,m as y,d as ra,G as Q,b as Ia,i as da,z as ct,F as Y,H as v,J as sa,K as Et,N as Dt,O as la,P as oa,X as Va,S as Ua,s as Ha,V as se,a8 as La,v as Wa,x as Ba}from"../chunks/BA6D4iam.js";import{_ as Ka}from"../chunks/PPVm8Dsz.js";import{C as Ja,a as Ya,b as Za,c as Ga,d as Qa}from"../chunks/CGJgvb-R.js";import{c as Xa,B as Mt}from"../chunks/DwWu_tO9.js";import"../chunks/BJMC0GYJ.js";import{f as tr,e as er,d as ar,z as rr,w as sr}from"../chunks/NApQS6X6.js";import{D as lr}from"../chunks/C4A3Hpap.js";const or=()=>({title:"Data Overview",subtitle:"Overview of all data available for the selected well"}),rs=Object.freeze(Object.defineProperty({__proto__:null,load:or},Symbol.toStringTag,{value:"Module"})),nr={light:"",dark:".dark"},ir=Symbol("chart-context");function dr(U){return Fa(ir,U)}function cr(U,h){$e(h,!0);const j=Re(()=>h.config?Object.entries(h.config).filter(([,w])=>w.theme||w.color):null),N=Re(()=>{if(!t(j)||!t(j).length)return;const w=[];for(let[M,T]of Object.entries(nr)){let u=`${T} [data-chart=${h.id}] {
`;const K=t(j).map(([A,at])=>{const lt=M,L=at.theme?.[lt]||at.color;return L?`	--color-${A}: ${L};`:null});u+=K.join(`
`)+`
}`,w.push(u)}return w.join(`
`)});var H=St(),X=tt(H);{var et=w=>{var M=St(),T=tt(M);Ea(T,()=>h.id,u=>{var K=St(),A=tt(K);Da(A,()=>"style",!1,(at,lt)=>{var L=vt();z(()=>g(L,t(N))),l(lt,L)}),l(u,K)}),l(w,M)};q(X,w=>{t(N)&&w(et)})}l(U,H),Ce()}var vr=_("<div><!> <!></div>");function ur(U,h){const j=Ma();$e(h,!0);let N=we(h,"ref",15,null),H=we(h,"id",3,j),X=za(h,["$$slots","$$events","$$legacy","ref","id","class","children","config"]);const et=Re(()=>`chart-${H()||j.replace(/:/g,"")}`);dr({get config(){return h.config}});var w=vr();Ta(w,u=>({"data-chart":t(et),"data-slot":"chart",class:u,...X}),[()=>Xa("flex aspect-video justify-center overflow-visible text-xs","[&_.stroke-white]:stroke-transparent","[&_.lc-line]:stroke-border/50","[&_.lc-highlight-line]:stroke-0","[&_.lc-area-path]:opacity-100 [&_.lc-highlight-line]:opacity-100 [&_.lc-highlight-point]:opacity-100 [&_.lc-spline-path]:opacity-100 [&_.lc-text-svg]:overflow-visible [&_.lc-text]:text-xs","[&_.lc-axis-tick]:stroke-0","[&_.lc-rule-x-line:not(.lc-grid-x-rule)]:stroke-0 [&_.lc-rule-y-line:not(.lc-grid-y-rule)]:stroke-0","[&_.lc-grid-x-radial-line]:stroke-border [&_.lc-grid-x-radial-circle]:stroke-border","[&_.lc-grid-y-radial-line]:stroke-border [&_.lc-grid-y-radial-circle]:stroke-border","[&_.lc-legend-swatch-button]:items-center [&_.lc-legend-swatch-button]:gap-1.5","[&_.lc-legend-swatch-group]:items-center [&_.lc-legend-swatch-group]:gap-4","[&_.lc-legend-swatch]:size-2.5 [&_.lc-legend-swatch]:rounded-[2px]","[&_.lc-labels-text:not([fill])]:fill-foreground [&_text]:stroke-transparent","[&_.lc-axis-tick-label]:fill-muted-foreground [&_.lc-axis-tick-label]:font-normal","[&_.lc-tooltip-rects-g]:fill-transparent","[&_.lc-layout-svg-g]:fill-transparent","[&_.lc-root-container]:w-full",h.class)]);var M=r(w);cr(M,{get id(){return t(et)},get config(){return h.config}});var T=s(M,2);qa(T,()=>h.children??Ra),a(w),na(w,u=>N(u),()=>N()),l(U,w),Ce()}function fr(U,h,j){return!h||!j||h===j?U:U.map(N=>{const H={};for(const X of Object.keys(N))X===h?H[j]=N[X]:H[X]=N[X];return H})}function pr(U,h){return h?U.map(j=>{const N=j[h],H=typeof N=="number"?N:N==null||N===""?NaN:Number(String(N).replace("%",""));if(isNaN(H))return{...j};const X=H>1?H/100:H;return{...j,[h]:X}}):U}function _r(U,h,j){return!h||!j||h===j?U:U.map(N=>N===h?j:N)}var mr=_('<span class="unsaved-dot" aria-hidden="true" style="background:#ef4444; margin-left:.5rem;"></span>'),gr=_("Save Edits <!>",1),hr=_('<!> <!> <div class="ml-auto flex items-center gap-2"><!> <!></div>',1),xr=_('<div class="text-sm">Loading…</div>'),br=_('<div class="text-sm text-red-500"> </div>'),yr=_('<div class="text-xs"><span class="text-muted-foreground">min:</span> <span class="text-muted-foreground">max:</span> <span class="text-muted-foreground">mean:</span> </div>'),wr=_('<div class="text-xs truncate max-w-xs"> <!></div>'),$r=_('<div class="text-xs text-muted-foreground"> </div>'),Cr=_('<tr class="border-b hover:bg-panel/50"><td class="p-2 font-medium"> </td><td class="p-2 text-muted-foreground"> </td><td class="p-2 text-right"> </td><td class="p-2 text-right"> </td><td class="p-2 text-right"> </td><td class="p-2 text-right"> </td><td class="p-2"><!></td></tr>'),Sr=_('<div class="bg-surface rounded p-3 space-y-3"><div class="font-medium">Data Profile</div> <div class="grid grid-cols-2 gap-2 text-sm"><div class="p-2 bg-panel rounded"><div class="text-muted-foreground">Total Columns</div> <div class="font-semibold"> </div></div> <div class="p-2 bg-panel rounded"><div class="text-muted-foreground">Total Rows</div> <div class="font-semibold"> </div></div></div> <div class="overflow-auto max-h-96"><table class="w-full text-xs"><thead class="sticky top-0 bg-surface"><tr class="border-b"><th class="p-2 text-left">Column</th><th class="p-2 text-left">Type</th><th class="p-2 text-right">Non-Null</th><th class="p-2 text-right">Missing</th><th class="p-2 text-right">Missing %</th><th class="p-2 text-right">Unique</th><th class="p-2 text-left">Stats / Values</th></tr></thead><tbody></tbody></table></div></div>'),Pr=_("<option> </option>"),kr=_("<li> </li>"),Nr=_('<div class="mt-2"><div class="text-sm font-medium">Formation Tops</div> <ul class="text-sm"></ul></div>'),jr=_("<li> </li>"),Ar=_('<div class="mt-2"><div class="text-sm font-medium">Fluid Contacts</div> <ul class="text-sm"></ul></div>'),Fr=_('<div class="text-sm text-muted-foreground-foreground mb-2"> </div>'),Er=_("<option> </option>"),Dr=_("<option>(no columns)</option>"),Mr=_('<tr><td class="p-1"> </td><td class="p-1"> </td><td class="p-1"> </td></tr>'),Tr=_('<div class="mt-2 bg-panel rounded p-2 max-h-40 overflow-auto"><div class="text-xs text-muted-foreground mb-1"> </div> <table class="w-full text-xs"><thead><tr><th class="p-1 text-left">Depth</th><th class="p-1 text-left">Old</th><th class="p-1 text-left">New</th></tr></thead><tbody></tbody></table></div>'),zr=_('<div class="fixed inset-0 z-50 flex items-start justify-center p-6"><button type="button" class="absolute inset-0 bg-black/40" aria-label="Close modal"></button> <div class="relative bg-white dark:bg-surface rounded shadow-lg w-full max-w-md p-4 z-10"><div class="flex items-center justify-between mb-2"><div class="font-medium">Edit Columns</div> <div class="flex gap-2"><!> <!></div></div> <!> <div class="space-y-2"><div><label for="editColumn" class="text-xs text-muted-foreground">Column</label> <select id="editColumn" class="input w-full"><!></select></div> <div><label for="editNewName" class="text-xs text-muted-foreground">Rename to (optional)</label> <input id="editNewName" class="input w-full" placeholder="e.g. NPHI"/></div> <div class="flex items-center gap-2"><input id="conv" type="checkbox"/> <label for="conv" class="text-sm">Convert % → fraction</label></div> <div class="flex gap-2"><!> <!> <!></div> <!></div></div></div>'),qr=_('<div class="w-full h-[240px]"></div>'),Rr=_('<th class="p-1 text-left"> </th>'),Or=_('<td class="p-1"> </td>'),Ir=_("<tr></tr>"),Vr=_('<div class="text-xs text-muted-foreground mt-2"> </div>'),Ur=_('<div class="mt-2 space-y-2"><!> <div class="flex items-center gap-2"><div class="text-sm text-muted-foreground">Plot log:</div> <select class="input"><!></select></div> <!> <!> <!> <div class="bg-surface rounded p-2"><!></div> <div class="overflow-auto max-h-48 mt-2 bg-panel rounded p-2"><table class="w-full text-sm"><thead><tr></tr></thead><tbody></tbody></table> <!></div></div>'),Hr=_('<!> <div class="grid grid-cols-2 gap-2"><div class="p-3 bg-surface rounded"><div class="text-sm text-muted-foreground">Formation Tops</div> <div class="font-semibold"> </div></div> <div class="p-3 bg-surface rounded"><div class="text-sm text-muted-foreground">Fluid Contacts</div> <div class="font-semibold"> </div></div> <div class="p-3 bg-surface rounded"><div class="text-sm text-muted-foreground">Pressure Tests</div> <div class="font-semibold"> </div></div> <div class="p-3 bg-surface rounded"><div class="text-sm text-muted-foreground">Core Samples</div> <div class="font-semibold"> </div></div></div> <div class="mt-4"><div class="flex items-center justify-between"><div class="font-medium">Property vs Depth Data</div> <div class="flex gap-2"><!> <!></div></div> <!></div>',1),Lr=_("<!> <!>",1),Wr=_("<!> <!>",1);function Br(U,h){$e(h,!1);const j=()=>ra(ar,"$depthFilter",H),N=()=>ra(rr,"$zoneFilter",H),[H,X]=Ha(),et=y();let w=we(h,"projectId",8),M=we(h,"wellName",8);const T="http://localhost:6312";let u=y(!1),K=y(null),A=y({formation_tops:0,fluid_contacts:0,pressure_tests:0,core_samples:0}),at=y([]),lt=[],L=y(null),Vt=y([]),le=null,gt=y(null),Ut=y(!1),S=y([]),Oe=y([]),P=y([]),Z=y(null),Yt=y([]),Zt=y([]),Ie=y([]),Ve=y([]),oe=y({}),Pt=y([]),Ht=y(!1),Se=y(!1),W=y(null),Lt=y(""),ne=y(!1),ut=y([]),Pe=[],ie=y(new Set),Gt=y({}),ft=y(!1),G=y(null);function ca(){const o={};for(const d of t(P)){const f=t(Pt).map(O=>O[d]),c=f.filter(O=>O!=null&&O!==""),$=f.length-c.length,n=c.find(O=>O!=null);let i=typeof n;i==="string"&&!isNaN(Number(n))&&(i="numeric (string)");const m=new Set(c),F=m.size;let kt=null;if(i==="number"||i==="numeric (string)"){const O=c.map(rt=>Number(rt)).filter(rt=>!isNaN(rt));if(O.length>0){const rt=O.slice().sort((Tt,At)=>Tt-At),st=O.reduce((Tt,At)=>Tt+At,0)/O.length,ht=rt[0],xt=rt[rt.length-1],jt=rt[Math.floor(rt.length/2)];kt={min:ht,max:xt,mean:st,median:jt,count:O.length}}}o[d]={dataType:i,totalCount:f.length,nonNullCount:c.length,nullCount:$,missingPercent:($/f.length*100).toFixed(2),uniqueCount:F,uniqueValues:F<=20?Array.from(m).slice(0,20):null,stats:kt}}e(oe,o)}async function Ue(){if(!(!w()||!M())){e(u,!0),e(K,null);try{const o={formation_tops:`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/formation_tops`,fluid_contacts:`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/fluid_contacts`,pressure_tests:`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/pressure_tests`,core_samples:`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/core_samples`},[d,f,c,$]=await Promise.all([fetch(o.formation_tops),fetch(o.fluid_contacts),fetch(o.pressure_tests),fetch(o.core_samples)]);if(d.ok){const n=await d.json();se(A,t(A).formation_tops=Array.isArray(n)?n.length:n?.formation_tops?.length??0)}if(f.ok){const n=await f.json();se(A,t(A).fluid_contacts=Array.isArray(n)?n.length:n?.fluid_contacts?.length??0)}if(c.ok){const n=await c.json();se(A,t(A).pressure_tests=Array.isArray(n)?n.length:n?.pressure_tests?.length??0)}if($.ok){const n=await $.json();e(at,Array.isArray(n)?n:n?.core_samples??[]),se(A,t(A).core_samples=t(at).length);const i=new Set;for(const m of t(at))if(m.measurements&&Array.isArray(m.measurements))for(const F of m.measurements)F.property_name&&i.add(String(F.property_name));lt=Array.from(i).sort(),e(L,lt[0]??null)}try{const n=await fetch(`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/data?include_ancillary=true`);if(n.ok){const i=await n.json();console.log("Full well data response:",i);let m=[];Array.isArray(i)?m=i:i&&Array.isArray(i.data)&&(m=i.data,i.formation_tops&&e(Yt,i.formation_tops),i.fluid_contacts&&e(Zt,i.fluid_contacts),i.pressure_tests&&e(Ie,i.pressure_tests),i.core_samples&&e(Ve,i.core_samples)),m.length>0?(e(S,m),e(P,Object.keys(m[0]??{})),e(Z,t(Z)??t(P).find(F=>F!=="depth")??null),console.log(`Loaded ${t(S).length} rows with ${t(P).length} columns`)):console.warn("No well data found in response")}else console.error("Failed to fetch well data:",n.status,n.statusText)}catch(n){console.error("Error fetching well data:",n)}}catch(o){console.warn("WsWellStats fetch error",o),e(K,String(o?.message??o))}finally{e(u,!1)}}}function ke(o,d,f,c){if(d&&d.length&&o){const n=o,i=d.map(m=>({depth:Number(m.depth??m.depth_m??NaN),value:Number(m[n]??NaN)})).filter(m=>!isNaN(m.depth)&&!isNaN(m.value));if(i.sort((m,F)=>m.depth-F.depth),i.length)return i}if(!f||!c||c.length===0)return Array.from({length:40},(n,i)=>({depth:1e3+i*5,value:Math.random()*100}));const $=[];for(const n of c){const i=Number(n.depth??NaN);if(isNaN(i))continue;const m=(n.measurements||[]).find(kt=>String(kt.property_name)===String(f)),F=m?Number(m.value):NaN;isNaN(F)||$.push({depth:i,value:F})}return $.sort((n,i)=>n.depth-i.depth),$.length===0?Array.from({length:30},(n,i)=>({depth:1e3+i*5,value:Math.random()*50})):$}async function va(){if(!le){const o=await Ka(()=>import("../chunks/BJMC0GYJ.js").then(d=>d.p),[],import.meta.url);le=o?.default??o}return le}async function ua(){if(!t(gt))return;const o=await va();if(!t(et)||t(et).length===0){console.debug("renderChartPlot: no chartPoints to plot",{selectedLog:t(Z),chartPointsLength:t(et)?.length});try{o.purge(t(gt))}catch{}return}const d=t(et).map(F=>F.x),f=t(et).map(F=>F.y);let c=Math.min(...f),$=Math.max(...f);(!isFinite(c)||!isFinite($))&&(c=0,$=1);const n=($-c)*.05||Math.abs($)*.05||1,i={height:240,margin:{l:60,r:20,t:20,b:40},dragmode:"zoom",xaxis:{title:"Depth",fixedrange:!1},yaxis:{title:t(Z)??"value",range:[c-n,$+n],fixedrange:!0},showlegend:!1},m=[{x:d,y:f,type:"scatter",mode:"lines",fill:"tozeroy",fillcolor:"rgba(37,99,235,0.2)",line:{color:"#2563eb"}}];console.debug("renderChartPlot: plotting",{selectedLog:t(Z),points:t(et).length,xSample:d.slice(0,3),ySample:f.slice(0,3)});try{o.react(t(gt),m,i,{responsive:!0})}catch{o.newPlot(t(gt),m,i,{responsive:!0})}}async function He(){if(!w()||!M()){e(G,"Missing project/well context");return}if(!t(ft)){e(G,"No changes to save");return}e(G,"Saving...");const o=d=>d?d.depth??d.DEPTH??d.depth_m??d.DEPTH_M??d.Depth??d.depth_m??null:null;try{const f={data:t(S).map($=>{const n={};return n.DEPTH=o($),n.WELL_NAME=String(M()),t(W)&&(n[t(W)]=$[t(W)]),n})},c=await fetch(`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/data`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!c.ok)throw new Error(await c.text());e(Oe,t(S).map($=>({...$}))),e(ie,new Set),e(Gt,{}),e(ft,!1),Pe=[],e(G,"Saved edits to server")}catch(d){e(G,`Save failed: ${String(d?.message??d)}`)}}function fa(){e(W,t(P)[0]??null),e(Lt,""),e(ne,!1),e(ut,[]),e(G,null),e(Se,!0)}function Le(){e(Se,!1),e(ut,[]),e(G,null)}function pa(){if(!t(W)){e(G,"Choose column to preview");return}const o=(f,c)=>{if(f==null)return;if(c in f)return f[c];const $=String(c).toUpperCase();if($ in f)return f[$];const n=String(c).toLowerCase();if(n in f)return f[n]},d=t(S).filter(f=>{const c=o(f,t(W));return!(c==null||c===""||typeof c=="number"&&isNaN(c))}).slice(0,12);e(ut,d.map(f=>{const c=o(f,t(W));let $=c;if(t(ne)){const i=typeof c=="number"?c:c==null||c===""?NaN:Number(String(c).replace("%",""));isNaN(i)?$=c:$=i>1?i/100:i}return{depth:o(f,"depth")??o(f,"DEPTH")??o(f,"depth_m")??"",oldValue:c,newValue:$}})),t(ut).length===0?e(G,"No data available in that column for preview"):e(G,`Previewing first ${t(ut).length} rows with data`)}function _a(){if(!t(W)){e(G,"Choose column to apply");return}Pe.push({rows:t(S).slice(0,50).map(d=>({...d})),columns:t(P).slice(),editedColumns:Array.from(t(ie)),renameMap:{...t(Gt)}});const o=t(W);if(t(Lt)&&t(Lt).trim()){const d=t(Lt).trim();e(S,fr(t(S),t(W),d)),e(P,_r(t(P),t(W),d)),t(Z)===t(W)&&e(Z,d),se(Gt,t(Gt)[o]=d),e(W,d),e(Lt,"")}t(ne)&&e(S,pr(t(S),t(W))),t(ie).add(t(W)),e(ft,!0),e(G,"Applied edits in-memory"),e(ut,[])}function ma(){const o=Pe.pop();if(!o){e(G,"Nothing to undo");return}if(o.rows.length===t(S).length)e(S,o.rows.map(d=>({...d})));else for(let d=0;d<o.rows.length;d++)se(S,t(S)[d]={...o.rows[d]});e(P,o.columns.slice()),o.editedColumns&&e(ie,new Set(o.editedColumns)),o.renameMap&&e(Gt,{...o.renameMap}),e(ft,!0),e(G,"Undid last action (partial restore)")}Oa(()=>{w()&&M()&&Ue()}),re(()=>(t(S),j(),N()),()=>{e(Pt,(()=>{let o=t(S)||[];return o=tr(o,j()),o=er(o,N()),o})())}),re(()=>(t(Z),t(Pt),t(L),t(at)),()=>{e(Vt,ke(t(Z),t(Pt),t(L),t(at)))}),re(()=>(t(Pt),t(P)),()=>{t(Pt).length>0&&t(P).length>0&&ca()}),re(()=>t(Vt),()=>{e(et,t(Vt).map(o=>({x:o.depth,y:o.value})))}),re(()=>(t(gt),t(Vt)),()=>{t(gt)&&t(Vt)&&ua()}),re(()=>(Q(w()),Q(M())),()=>{w()&&M()&&Ue()}),Ia(),da(),Ja(U,{children:(o,d)=>{var f=Wr(),c=tt(f);Ya(c,{children:(n,i)=>{var m=hr(),F=tt(m);Za(F,{children:(st,ht)=>{ct();var xt=vt("Well Statistics");l(st,xt)},$$slots:{default:!0}});var kt=s(F,2);Ga(kt,{children:(st,ht)=>{ct();var xt=vt("Summary for the selected well");l(st,xt)},$$slots:{default:!0}});var O=s(kt,2),rt=r(O);{let st=Y(()=>t(u)?"opacity:0.5; pointer-events:none;":"");Mt(rt,{variant:"ghost",size:"sm",onclick:fa,title:"Open edits modal","aria-label":"Open edits modal",get disabled(){return t(u)},get style(){return t(st)},children:(ht,xt)=>{ct();var jt=vt("✏️ Edits");l(ht,jt)},$$slots:{default:!0}})}var Nt=s(rt,2);{let st=Y(()=>t(ft)?"default":"ghost"),ht=Y(()=>t(u)||!t(ft)),xt=Y(()=>t(u)||!t(ft)?"opacity:0.5; pointer-events:none;":"");Mt(Nt,{get variant(){return t(st)},size:"sm",onclick:He,get disabled(){return t(ht)},title:"Save edits to server","aria-label":"Save edits to server",get style(){return t(xt)},children:(jt,Tt)=>{ct();var At=gr(),Ne=s(tt(At));{var de=Qt=>{var je=mr();l(Qt,je)};q(Ne,Qt=>{t(ft)&&Qt(de)})}l(jt,At)},$$slots:{default:!0}})}a(O),l(n,m)},$$slots:{default:!0}});var $=s(c,2);Qa($,{class:"p-3",children:(n,i)=>{var m=Lr(),F=tt(m);lr(F,{});var kt=s(F,2);{var O=Nt=>{var st=xr();l(Nt,st)},rt=Nt=>{var st=Hr(),ht=tt(st);{var xt=pt=>{var _t=br(),zt=r(_t);a(_t),z(()=>g(zt,`Error: ${t(K)??""}`)),l(pt,_t)};q(ht,pt=>{t(K)&&pt(xt)})}var jt=s(ht,2),Tt=r(jt),At=s(r(Tt),2),Ne=r(At,!0);a(At),a(Tt);var de=s(Tt,2),Qt=s(r(de),2),je=r(Qt,!0);a(Qt),a(de);var Ae=s(de,2),We=s(r(Ae),2),ga=r(We,!0);a(We),a(Ae);var Be=s(Ae,2),Ke=s(r(Be),2),ha=r(Ke,!0);a(Ke),a(Be),a(jt);var Je=s(jt,2),Fe=r(Je),Ye=s(r(Fe),2),Ze=r(Ye);{let pt=Y(()=>t(Ht)?"Hide Profile":"Show Profile"),_t=Y(()=>t(Ht)?"Hide Profile":"Show Profile"),zt=Y(()=>t(u)?"opacity:0.5; pointer-events:none;":"");Mt(Ze,{variant:"ghost",size:"sm",onclick:()=>{e(Ht,!t(Ht))},get title(){return t(pt)},get"aria-label"(){return t(_t)},get disabled(){return t(u)},get style(){return t(zt)},children:(nt,R)=>{ct();var J=vt();z(()=>g(J,`${t(Ht)?"Hide":"Show"} Profile`)),l(nt,J)},$$slots:{default:!0}})}var xa=s(Ze,2);{let pt=Y(()=>t(Ut)?"Hide full well data":"Show full well data"),_t=Y(()=>t(Ut)?"Hide full well data":"Show full well data"),zt=Y(()=>t(u)?"opacity:0.5; pointer-events:none;":"");Mt(xa,{variant:"ghost",size:"sm",get title(){return t(pt)},get"aria-label"(){return t(_t)},get disabled(){return t(u)},get style(){return t(zt)},onclick:async()=>{if(e(Ut,!t(Ut)),t(Ut)&&t(S).length===0){e(u,!0);try{const nt=await fetch(`${T}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(M()))}/data?include_ancillary=true`);if(nt.ok){const R=await nt.json();console.log("Well data fetched on demand:",R);let J=[];Array.isArray(R)?J=R:R&&Array.isArray(R.data)&&(J=R.data,R.formation_tops&&e(Yt,R.formation_tops),R.fluid_contacts&&e(Zt,R.fluid_contacts),R.pressure_tests&&e(Ie,R.pressure_tests),R.core_samples&&e(Ve,R.core_samples)),J.length>0?(e(S,J),e(Oe,J.map(ce=>({...ce}))),e(P,Object.keys(J[0]??{})),e(Z,t(Z)??t(P).find(ce=>ce!=="depth")??null),e(ie,new Set),e(Gt,{}),e(ft,!1),ke(t(Z),t(Pt),t(L),t(at)),console.log(`Loaded ${t(S).length} rows with ${t(P).length} columns`)):e(K,"No well data available")}else e(K,`Failed to load well data: ${nt.status}`)}catch(nt){console.error("Error loading well data:",nt),e(K,`Error: ${nt.message}`)}finally{e(u,!1)}}},children:(nt,R)=>{ct();var J=vt();z(()=>g(J,t(Ut)?"Hide":"Show")),l(nt,J)},$$slots:{default:!0}})}a(Ye),a(Fe);var ba=s(Fe,2);{var ya=pt=>{var _t=Ur(),zt=r(_t);{var nt=x=>{var C=Sr(),k=s(r(C),2),B=r(k),E=s(r(B),2),I=r(E,!0);a(E),a(B);var ot=s(B,2),qt=s(r(ot),2),Rt=r(qt,!0);a(qt),a(ot),a(k);var bt=s(k,2),Wt=r(bt),Ft=s(r(Wt));Et(Ft,5,()=>t(P),Dt,(ve,ue)=>{const b=Y(()=>(t(oe),t(ue),v(()=>t(oe)[t(ue)])));var xe=St(),fe=tt(xe);{var be=Bt=>{var Xt=Cr(),Kt=r(Xt),ye=r(Kt,!0);a(Kt);var te=s(Kt),Te=r(te,!0);a(te);var pe=s(te),ze=r(pe,!0);a(pe);var p=s(pe),D=r(p,!0);a(p);var V=s(p),yt=r(V);a(V);var it=s(V),wt=r(it,!0);a(it);var ee=s(it),mt=r(ee);{var _e=Ot=>{var $t=yr(),ae=s(r($t)),Jt=s(ae,2),ge=s(Jt,2);a($t),z((Ct,dt,It)=>{g(ae,` ${Ct??""}, `),g(Jt,` ${dt??""}, `),g(ge,` ${It??""}`)},[()=>(Q(t(b)),v(()=>t(b).stats.min.toFixed(2))),()=>(Q(t(b)),v(()=>t(b).stats.max.toFixed(2))),()=>(Q(t(b)),v(()=>t(b).stats.mean.toFixed(2)))]),l(Ot,$t)},me=Ot=>{var $t=St(),ae=tt($t);{var Jt=Ct=>{var dt=wr(),It=r(dt),ja=s(It);{var Aa=he=>{var qe=vt("...");l(he,qe)};q(ja,he=>{Q(t(b)),v(()=>t(b).uniqueValues.length>5)&&he(Aa)})}a(dt),z((he,qe)=>{La(dt,"title",he),g(It,`${qe??""} `)},[()=>(Q(t(b)),v(()=>t(b).uniqueValues.join(", "))),()=>(Q(t(b)),v(()=>t(b).uniqueValues.slice(0,5).join(", ")))]),l(Ct,dt)},ge=Ct=>{var dt=$r(),It=r(dt);a(dt),z(()=>g(It,`${Q(t(b)),v(()=>t(b).uniqueCount)??""} unique values`)),l(Ct,dt)};q(ae,Ct=>{Q(t(b)),v(()=>t(b).uniqueValues)?Ct(Jt):Ct(ge,!1)},!0)}l(Ot,$t)};q(mt,Ot=>{Q(t(b)),v(()=>t(b).stats)?Ot(_e):Ot(me,!1)})}a(ee),a(Xt),z(()=>{g(ye,t(ue)),g(Te,(Q(t(b)),v(()=>t(b).dataType))),g(ze,(Q(t(b)),v(()=>t(b).nonNullCount))),g(D,(Q(t(b)),v(()=>t(b).nullCount))),g(yt,`${Q(t(b)),v(()=>t(b).missingPercent)??""}%`),g(wt,(Q(t(b)),v(()=>t(b).uniqueCount)))}),l(Bt,Xt)};q(fe,Bt=>{t(b)&&Bt(be)})}l(ve,xe)}),a(Ft),a(Wt),a(bt),a(C),z(()=>{g(I,(t(P),v(()=>t(P).length))),g(Rt,(t(S),v(()=>t(S).length)))}),l(x,C)};q(zt,x=>{t(Ht),t(oe),v(()=>t(Ht)&&Object.keys(t(oe)).length>0)&&x(nt)})}var R=s(zt,2),J=s(r(R),2);z(()=>{t(Z),sa(()=>{t(Pt),t(L),t(at),t(P)})}),J.__change=()=>ke(t(Z),t(Pt),t(L),t(at));var ce=r(J);{var wa=x=>{var C=St(),k=tt(C);Et(k,1,()=>t(P),Dt,(B,E)=>{var I=St(),ot=tt(I);{var qt=Rt=>{var bt=Pr(),Wt=r(bt,!0);a(bt);var Ft={};z(()=>{g(Wt,t(E)),Ft!==(Ft=t(E))&&(bt.value=(bt.__value=t(E))??"")}),l(Rt,bt)};q(ot,Rt=>{t(E)!=="depth"&&Rt(qt)})}l(B,I)}),l(x,C)};q(ce,x=>{t(P),v(()=>t(P).length)&&x(wa)})}a(J),a(R);var Ge=s(R,2);{var $a=x=>{var C=Nr(),k=s(r(C),2);Et(k,5,()=>t(Yt),Dt,(B,E)=>{var I=kr(),ot=r(I);a(I),z(()=>g(ot,`${t(E),v(()=>t(E).name)??""} — ${t(E),v(()=>t(E).depth)??""}`)),l(B,I)}),a(k),a(C),l(x,C)};q(Ge,x=>{t(Yt),v(()=>t(Yt)&&t(Yt).length)&&x($a)})}var Qe=s(Ge,2);{var Ca=x=>{var C=Ar(),k=s(r(C),2);Et(k,5,()=>t(Zt),Dt,(B,E)=>{var I=jr(),ot=r(I);a(I),z(()=>g(ot,`${t(E),v(()=>t(E).name)??""} — ${t(E),v(()=>t(E).depth)??""}`)),l(B,I)}),a(k),a(C),l(x,C)};q(Qe,x=>{t(Zt),v(()=>t(Zt)&&t(Zt).length)&&x(Ca)})}var Xe=s(Qe,2);{var Sa=x=>{var C=zr(),k=r(C);k.__click=Le;var B=s(k,2),E=r(B),I=s(r(E),2),ot=r(I);Mt(ot,{variant:"ghost",size:"sm",onclick:ma,title:"Undo last","aria-label":"Undo last",children:(p,D)=>{ct();var V=vt("Undo");l(p,V)},$$slots:{default:!0}});var qt=s(ot,2);Mt(qt,{variant:"ghost",size:"sm",onclick:Le,title:"Close modal","aria-label":"Close modal",children:(p,D)=>{ct();var V=vt("Close");l(p,V)},$$slots:{default:!0}}),a(I),a(E);var Rt=s(E,2);{var bt=p=>{var D=Fr(),V=r(D,!0);a(D),z(()=>g(V,t(G))),l(p,D)};q(Rt,p=>{t(G)&&p(bt)})}var Wt=s(Rt,2),Ft=r(Wt),ve=s(r(Ft),2);z(()=>{t(W),sa(()=>{t(P)})});var ue=r(ve);{var b=p=>{var D=St(),V=tt(D);Et(V,1,()=>t(P),Dt,(yt,it)=>{var wt=Er(),ee=r(wt,!0);a(wt);var mt={};z(()=>{g(ee,t(it)),mt!==(mt=t(it))&&(wt.value=(wt.__value=t(it))??"")}),l(yt,wt)}),l(p,D)},xe=p=>{var D=Dr();D.value=D.__value="",l(p,D)};q(ue,p=>{t(P),v(()=>t(P).length)?p(b):p(xe,!1)})}a(ve),a(Ft);var fe=s(Ft,2),be=s(r(fe),2);oa(be),a(fe);var Bt=s(fe,2),Xt=r(Bt);oa(Xt),ct(2),a(Bt);var Kt=s(Bt,2),ye=r(Kt);{let p=Y(()=>t(u)?"opacity:0.5; pointer-events:none;":"");Mt(ye,{variant:"ghost",size:"sm",onclick:pa,title:"Preview changes",get disabled(){return t(u)},get style(){return t(p)},children:(D,V)=>{ct();var yt=vt("Preview");l(D,yt)},$$slots:{default:!0}})}var te=s(ye,2);{let p=Y(()=>t(u)?"opacity:0.5; pointer-events:none;":"");Mt(te,{variant:"default",onclick:_a,title:"Apply edits in-memory",get disabled(){return t(u)},get style(){return t(p)},children:(D,V)=>{ct();var yt=vt("Apply");l(D,yt)},$$slots:{default:!0}})}var Te=s(te,2);{let p=Y(()=>t(u)||!t(ft)),D=Y(()=>t(u)||!t(ft)?"opacity:0.5; pointer-events:none;":"");Mt(Te,{variant:"default",size:"sm",onclick:He,get disabled(){return t(p)},title:"Save edits to server",get style(){return t(D)},children:(V,yt)=>{ct();var it=vt("Save");l(V,it)},$$slots:{default:!0}})}a(Kt);var pe=s(Kt,2);{var ze=p=>{var D=Tr(),V=r(D),yt=r(V);a(V);var it=s(V,2),wt=s(r(it));Et(wt,5,()=>t(ut),Dt,(ee,mt)=>{var _e=Mr(),me=r(_e),Ot=r(me,!0);a(me);var $t=s(me),ae=r($t,!0);a($t);var Jt=s($t),ge=r(Jt,!0);a(Jt),a(_e),z((Ct,dt,It)=>{g(Ot,Ct),g(ae,dt),g(ge,It)},[()=>(t(mt),v(()=>String(t(mt).depth))),()=>(t(mt),v(()=>String(t(mt).oldValue))),()=>(t(mt),v(()=>String(t(mt).newValue)))]),l(ee,_e)}),a(wt),a(it),a(D),z(()=>g(yt,`Preview (first ${t(ut),v(()=>t(ut).length)??""} rows)`)),l(p,D)};q(pe,p=>{t(ut),v(()=>t(ut).length)&&p(ze)})}a(Wt),a(B),a(C),la(ve,()=>t(W),p=>e(W,p)),Va(be,()=>t(Lt),p=>e(Lt,p)),Ua(Xt,()=>t(ne),p=>e(ne,p)),l(x,C)};q(Xe,x=>{t(Se)&&x(Sa)})}var Ee=s(Xe,2),Pa=r(Ee);ur(Pa,{class:"h-[240px] w-full",config:{},children:(x,C)=>{var k=qr();na(k,B=>e(gt,B),()=>t(gt)),l(x,k)},$$slots:{default:!0}}),a(Ee);var ta=s(Ee,2),De=r(ta),Me=r(De),ea=r(Me);Et(ea,5,()=>t(P),Dt,(x,C)=>{var k=Rr(),B=r(k,!0);a(k),z(()=>g(B,t(C))),l(x,k)}),a(ea),a(Me);var aa=s(Me);Et(aa,5,()=>(t(S),v(()=>t(S).slice(0,200))),Dt,(x,C)=>{var k=Ir();Et(k,5,()=>t(P),Dt,(B,E)=>{var I=Or(),ot=r(I,!0);a(I),z(qt=>g(ot,qt),[()=>(t(C),t(E),v(()=>String(t(C)[t(E)]??"")))]),l(B,I)}),a(k),l(x,k)}),a(aa),a(De);var ka=s(De,2);{var Na=x=>{var C=Vr(),k=r(C);a(C),z(()=>g(k,`Showing first 200 rows of ${t(S),v(()=>t(S).length)??""}.`)),l(x,C)};q(ka,x=>{t(S),v(()=>t(S).length>200)&&x(Na)})}a(ta),a(_t),la(J,()=>t(Z),x=>e(Z,x)),l(pt,_t)};q(ba,pt=>{t(Ut)&&pt(ya)})}a(Je),z(()=>{g(Ne,(t(A),v(()=>t(A).formation_tops))),g(je,(t(A),v(()=>t(A).fluid_contacts))),g(ga,(t(A),v(()=>t(A).pressure_tests))),g(ha,(t(A),v(()=>t(A).core_samples)))}),l(Nt,st)};q(kt,Nt=>{t(u)?Nt(O):Nt(rt,!1)})}l(n,m)},$$slots:{default:!0}}),l(o,f)},$$slots:{default:!0}}),Ce(),X()}ia(["change","click"]);var Kr=_('<div class="bg-panel rounded p-4 min-h-[300px]"><!></div>'),Jr=_('<div class="bg-panel rounded p-4 min-h-[300px]"><div class="text-center py-12"><div class="font-semibold">No well selected</div> <div class="text-sm text-muted mt-2">Select a well to view its data.</div></div></div>'),Yr=_('<div class="bg-panel rounded p-6 text-center"><div class="font-semibold">No project selected</div> <div class="text-sm text-muted mt-2">Select a project in the Projects workspace to begin.</div> <div class="mt-4"><button class="btn btn-primary">Open Projects</button></div></div>');function ss(U,h){$e(h,!1);let j=y(null),N=y(null);const H=sr.subscribe(T=>{e(j,T?.project??null),e(N,T?.selectedWell??null)});Wa(()=>H()),da();var X=St(),et=tt(X);{var w=T=>{var u=St(),K=tt(u);{var A=lt=>{var L=Kr(),Vt=r(L);{let le=Y(()=>t(j)?.project_id??""),gt=Y(()=>t(N)?.name??"");Br(Vt,{get projectId(){return t(le)},get wellName(){return t(gt)}})}a(L),l(lt,L)},at=lt=>{var L=Jr();l(lt,L)};q(K,lt=>{t(N)?lt(A):lt(at,!1)})}l(T,u)},M=T=>{var u=Yr(),K=s(r(u),4),A=r(K);A.__click=()=>Ba("/projects"),a(K),a(u),l(T,u)};q(et,T=>{t(j)?T(w):T(M,!1)})}l(U,X),Ce()}ia(["click"]);export{ss as component,rs as universal};
