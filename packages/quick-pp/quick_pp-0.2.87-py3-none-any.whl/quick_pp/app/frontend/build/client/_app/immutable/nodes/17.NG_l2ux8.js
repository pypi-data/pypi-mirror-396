const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BA6D4iam.js","../chunks/BNO5OzLn.js","../chunks/BJMC0GYJ.js","../assets/vendor.S5W4ZllZ.css","../chunks/BIFDz2_Q.js","../assets/tables.D_GW5H37.css"])))=>i.map(i=>d[i]);
import{p as ce,C as ne,o as Pe,v as ve,l as Y,g as e,G as de,b as ke,i as me,f as b,w as J,t as _,c as pe,m as h,k as f,n as d,e as r,r as o,P as K,z as Ee,Z as Re,F as se,H as F,X,I as ee,M as te,K as ae,a8 as ue,N as re,Q as je}from"../chunks/BA6D4iam.js";import{_ as z}from"../chunks/PPVm8Dsz.js";import{B as Ie}from"../chunks/DwWu_tO9.js";import"../chunks/BIFDz2_Q.js";import{P as Te}from"../chunks/CerN-z7d.js";import{w as Ae}from"../chunks/NApQS6X6.js";const $e=()=>({title:"Reservoir Summary",subtitle:"Reservoir summary and exports for the selected well"}),Je=Object.freeze(Object.defineProperty({__proto__:null,load:$e},Symbol.toStringTag,{value:"Module"}));var Oe=b('<div class="text-sm text-red-600 mb-2"> </div>'),Ce=b('<th class="px-2 py-1 text-xs font-medium"><div class="whitespace-nowrap font-medium"> </div> <div class="mt-1"><input class="dt-filter-input input w-full" type="text"/></div></th>'),Ve=b('<td class="px-2 py-1 text-sm"> </td>'),De=b('<tr class="border-t odd:bg-white even:bg-surface"></tr>'),Le=b('<table class="min-w-full table-auto border-collapse"><thead><tr class="bg-muted text-left"></tr></thead><tbody></tbody></table>'),We=b('<div class="text-sm text-muted-foreground">No results. Click "Generate Report" to compute reservoir summary for the selected well.</div>'),ze=b('<div class="bg-panel rounded p-3"><div class="grid grid-cols-2 gap-3 mb-3"><div><label class="text-sm" for="minPhitInput">Min PHIT (cutoff)</label> <input id="minPhitInput" type="number" class="input w-full" placeholder="min phit"/></div> <div><label class="text-sm" for="maxSwtInput">Max SWT (cutoff)</label> <input id="maxSwtInput" type="number" class="input w-full" placeholder="max swt"/></div> <div><label class="text-sm" for="maxVclayInput">Max VCLAY (cutoff)</label> <input id="maxVclayInput" type="number" class="input w-full" placeholder="max vclay"/></div> <div class="flex items-end gap-2"><!></div></div> <!> <div class="overflow-x-auto"><!></div></div>'),Me=b('<div class="text-sm text-muted-foreground">Select a well to view reservoir summary.</div>'),He=b('<div class="ws-reservoir-summary"><div class="mb-2"><div class="font-semibold">Reservoir Summary</div> <div class="text-sm text-muted-foreground">High-level reservoir summary and exportable reports.</div></div> <!></div>');function Ze(G,V){ce(V,!1);const i=h();let y=ne(V,"projectId",8),g=ne(V,"wellName",8);const N="http://localhost:6312";let S=h(!1),u=h(null),P=[],R=h([]),j=h(.01),M=h(.99),H=h(.4),w=h(null),k=null,v=h(null);function le(){if(e(w))try{if(k){try{k.destroy()}catch{}for(;e(w).tBodies.length;)e(w).removeChild(e(w).tBodies[0])}const s=(e(i).length?Object.keys(e(i)[0]):[]).map(t=>({title:t,data:t}));k=e(v)(e(w)).DataTable({data:e(i),columns:s,destroy:!0,paging:!0,searching:!0,dom:"Blfrtip",buttons:[{extend:"csv",text:"Export CSV"},{extend:"colvis",text:"Columns"}],lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],pageLength:10,info:!0,autoWidth:!1,stripeClasses:["odd","even"],rowCallback(t,c,l){return l%2===0?e(v)(t).addClass("even-row"):e(v)(t).addClass("odd-row"),e(v)(t).addClass("hoverable-row"),t}});try{e(v)(e(w)).find("thead").off("input.dt-filter"),e(v)(e(w)).find("thead .dt-filter-input").each(function(t,c){const l=e(v)(c);l.off("keyup.dt-filter change.dt-filter"),l.on("keyup.dt-filter change.dt-filter",function(){const m=this.value||"";k.column(t).search(m).draw()})})}catch{}}catch(a){console.warn("DataTables init error",a)}}Pe(async()=>{r(v,(await z(async()=>{const{default:a}=await import("../chunks/BA6D4iam.js").then(s=>s.j);return{default:a}},__vite__mapDeps([0,1,2,3]),import.meta.url)).default),await z(()=>import("../chunks/BIFDz2_Q.js").then(a=>a.d),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),await z(()=>import("../chunks/BIFDz2_Q.js").then(a=>a.b),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),await z(()=>import("../chunks/BIFDz2_Q.js").then(a=>a.a),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),await z(()=>import("../chunks/BIFDz2_Q.js").then(a=>a.c),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),window.jQuery=e(v),window.$=e(v),le()}),ve(()=>{try{k&&k.destroy()}catch{}k=null});async function fe(){if(!(!y()||!g())){r(S,!0),r(u,null);try{const a=await fetch(`${N}/quick_pp/database/projects/${y()}/wells/${encodeURIComponent(String(g()))}/merged`);if(!a.ok)throw new Error(await a.text());const s=await a.json(),t=s&&s.data?s.data:s;if(!Array.isArray(t))throw new Error("Unexpected data format from backend");P=t}catch(a){console.warn("Failed to load well data",a),r(u,String(a?.message??a))}finally{r(S,!1)}}}function _e(){const a=Array.isArray(P)?P:[],s=[];for(const t of a){const c=Number(t.depth??t.tvdss??t.TVD??t.TVDSS??t.DEPTH??NaN),l=Number(t.vcld??t.VCLD??t.vclay??t.VCLAY??NaN),m=Number(t.phit??t.PHIT??NaN),x=Number(t.swt??t.SWT??NaN),I=Number(t.perm??t.PERM??t.permeability??NaN);let T=t.zones??t.ZONES??t.zone??t.ZONE??null;T==null&&(P.some(A=>{const D=A.zones??A.ZONES??A.zone??A.ZONE;return D!=null&&String(D).trim()!==""})||(T="ALL")),!(isNaN(c)||isNaN(l)||isNaN(m)||isNaN(x)||isNaN(I))&&s.push({depth:c,vcld:l,phit:m,swt:x,perm:I,zones:T})}return s}async function he(){if(r(u,null),!y()||!g()){r(u,"Select a project and well before generating a report");return}const a=_e(),s=P.length,t=a.length,c=s-t;if(!a.length){r(u,"No valid well rows available to compute reservoir summary (missing required numeric fields)");return}r(S,!0);try{const l={data:a,cut_offs:{}};e(j)!=null&&(l.cut_offs.PHIT=Number(e(j))),e(M)!=null&&(l.cut_offs.SWT=Number(e(M))),e(H)!=null&&(l.cut_offs.VSHALE=Number(e(H)));const m=await fetch(`${N}/quick_pp/ressum`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!m.ok)throw new Error(await m.text());const x=await m.json();r(R,Array.isArray(x)?x:[]),c>0&&(console.warn(`Skipped ${c} / ${s} rows because they lacked required numeric values (depth, vcld, phit, swt, perm).`),r(u,`Report generated. Note: skipped ${c} row(s) with missing numeric values.`))}catch(l){console.warn("Ressum error",l),r(u,String(l?.message??l)),r(R,[])}finally{r(S,!1)}}Y(()=>e(R),()=>{r(i,e(R)??[])}),Y(()=>(e(i),e(v)),()=>{e(i)&&e(v)&&setTimeout(()=>le(),0)}),Y(()=>(de(y()),de(g())),()=>{y()&&g()&&fe()}),ke(),me();var Q=He(),be=f(d(Q),2);{var ye=a=>{var s=ze(),t=d(s),c=d(t),l=f(d(c),2);K(l),o(c);var m=f(c,2),x=f(d(m),2);K(x),o(m);var I=f(m,2),T=f(d(I),2);K(T),o(I);var U=f(I,2),A=d(U);{let n=se(()=>e(S)?"opacity:0.6; pointer-events:none;":"");Ie(A,{class:"btn btn-primary",onclick:he,get disabled(){return e(S)},get style(){return e(n)},children:(p,$)=>{Ee();var Z=Re("Generate Report");_(p,Z)},$$slots:{default:!0}})}o(U),o(t);var D=f(t,2);{var ge=n=>{var p=Oe(),$=d(p);o(p),ee(()=>te($,`Error: ${e(u)??""}`)),_(n,p)};J(D,n=>{e(u)&&n(ge)})}var oe=f(D,2),xe=d(oe);{var Ne=n=>{var p=Le(),$=d(p),Z=d($);ae(Z,5,()=>(e(i),F(()=>Object.keys(e(i)[0]))),re,(L,O)=>{var E=Ce(),W=d(E),B=d(W,!0);o(W);var C=f(W,2),q=d(C);o(C),o(E),ee(()=>{te(B,e(O)),ue(q,"placeholder",`Filter ${e(O)??""}`),ue(q,"data-col",e(O))}),_(L,E)}),o(Z),o($);var ie=f($);ae(ie,5,()=>e(i),re,(L,O)=>{var E=De();ae(E,5,()=>(e(i),F(()=>Object.keys(e(i)[0]))),re,(W,B)=>{var C=Ve(),q=d(C,!0);o(C),ee(()=>te(q,(e(O),e(B),F(()=>e(O)[e(B)])))),_(W,C)}),o(E),_(L,E)}),o(ie),o(p),je(p,L=>r(w,L),()=>e(w)),_(n,p)},Se=n=>{var p=We();_(n,p)};J(xe,n=>{e(i),F(()=>e(i)&&e(i).length)?n(Ne):n(Se,!1)})}o(oe),o(s),X(l,()=>e(j),n=>r(j,n)),X(x,()=>e(M),n=>r(M,n)),X(T,()=>e(H),n=>r(H,n)),_(a,s)},we=a=>{var s=Me();_(a,s)};J(be,a=>{g()?a(ye):a(we,!1)})}o(Q),_(G,Q),pe()}var Be=b('<div slot="left"><!></div>');function Ke(G,V){ce(V,!1);let i=h(null),y=h(null);const g=Ae.subscribe(N=>{r(i,N?.project??null),r(y,N?.selectedWell??null)});ve(()=>g()),me(),Te(G,{get selectedWell(){return e(y)},get project(){return e(i)},$$slots:{left:(N,S)=>{var u=Be(),P=d(u);{let R=se(()=>e(i)?.project_id??""),j=se(()=>e(y)?.name??"");Ze(P,{get projectId(){return e(R)},get wellName(){return e(j)}})}o(u),_(N,u)}}}),pe()}export{Ke as component,Je as universal};
