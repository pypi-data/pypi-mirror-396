import{p as Dt,C as te,v as Ht,l as nt,g as t,G as ee,b as ae,i as Jt,f as E,k as o,Z as dt,t as b,n,w as Z,Q as It,X as I,c as Ot,m as p,e as r,F as U,P as C,r as i,z as ct,I as ut,H as M,Y as se,M as D,h as Ct,K as re,_ as le,N as oe,D as ie,$ as ne}from"../chunks/BA6D4iam.js";import{_ as de}from"../chunks/PPVm8Dsz.js";import{B as pt}from"../chunks/DwWu_tO9.js";import{D as ce}from"../chunks/C4A3Hpap.js";import{w as Nt,e as ue}from"../chunks/NApQS6X6.js";import{P as pe}from"../chunks/CerN-z7d.js";var ve=E("<div> </div>"),fe=E("<tr><td> </td><td> </td><td> </td><td> </td></tr>"),me=E('<div class="font-semibold mb-2">Fitted Parameters</div> <div class="text-sm text-muted-foreground mb-3">J curve parameters a and b per rock flag.</div> <div class="bg-surface rounded p-3"><table class="w-full text-sm"><thead><tr><th>Rock Flag</th><th>a</th><th>b</th><th>RMSE</th></tr></thead><tbody></tbody></table></div>',1),he=E('<div class="text-sm text-blue-600 mb-3">Loading data...</div>'),_e=E('<div class="text-sm text-red-600 mb-3"> </div>'),be=E('<div class="ws-shf"><div class="mb-2"><div class="font-semibold">Saturation Height Function (Multi-Well)</div> <div class="text-sm text-muted-foreground">Estimate SHF parameters across multiple wells for the project.</div></div> <!> <div class="bg-panel rounded p-3"><div><label for="cutoffs" class="text-sm">FZI Cutoffs</label> <input id="cutoffs" type="text" class="input mt-1" placeholder="0.1, 1.0, 3.0, 6.0"/></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-3"><div><label for="fwl" class="text-sm">FWL (ft)</label> <input id="fwl" type="number" step="0.1" class="input mt-1"/></div> <div><label for="ift" class="text-sm">IFT (dynes/cm)</label> <input id="ift" type="number" step="0.1" class="input mt-1"/></div> <div><label for="theta" class="text-sm">Theta (deg)</label> <input id="theta" type="number" step="0.1" class="input mt-1"/></div> <div><label for="gw" class="text-sm">GW (g/cc)</label> <input id="gw" type="number" step="0.01" class="input mt-1"/></div> <div><label for="ghc" class="text-sm">GHC (g/cc)</label> <input id="ghc" type="number" step="0.01" class="input mt-1"/></div> <div class="col-span-2 flex items-end"><!> <!> <!></div></div> <!> <!> <div class="grid grid-cols-1 gap-3"><div class="bg-surface rounded p-3 min-h-[220px]"><div class="font-medium mb-2">J Plot</div> <div class="text-sm text-muted-foreground">J vs SW with fitted curves per rock flag.</div> <!> <div class="mt-4 h-[300px] bg-white/5 rounded border border-border/30"></div></div> <div class="bg-surface rounded p-3 min-h-[220px]"><div class="font-medium mb-2">SHF Plot</div> <div class="text-sm text-muted-foreground">SHF vs depth.</div> <div class="mt-4 h-[300px] bg-white/5 rounded border border-border/30"></div></div></div></div></div>');function ge(V,R){Dt(R,!1);let v=te(R,"projectId",8,null),_=p(!1),u=p(null),q=p(!1),F=p(null),g=null,m=p(null),h=p(null),j=p(null),K=p(1e4),H=p(30),J=p(30),Q=p(1.05),X=p(.8),O=p("0.1, 1.0, 3.0, 6.0, 8.0"),A={enabled:!1,zones:[]};const Tt=Nt.subscribe(e=>{e?.zoneFilter&&(A.enabled!==e.zoneFilter.enabled||JSON.stringify(A.zones)!==JSON.stringify(e.zoneFilter.zones))&&(A={...e.zoneFilter})});Ht(()=>Tt());let G=null,L=p(null),B=p(null);const N="http://localhost:6312";async function vt(){if(G)return G;const e=await de(()=>import("../chunks/BJMC0GYJ.js").then(a=>a.p),[],import.meta.url);return G=e.default||e,G}function Wt(){if(!g)return null;const e=g.phit.map((s,l)=>({phit:s,perm:g.perm[l],zone:g.zones[l],rock_flag:g.rock_flags[l],well_name:g.well_names[l],depth:g.depths[l]})),a=ue(e,A);return{phit:a.map(s=>s.phit),perm:a.map(s=>s.perm),zones:a.map(s=>s.zone),rock_flags:a.map(s=>s.rock_flag),well_names:a.map(s=>s.well_name),depths:a.map(s=>s.depth)}}async function Mt(){if(v()){r(q,!0),r(F,null);try{const e=`${N}/quick_pp/database/projects/${v()}/fzi_data`,a=await fetch(e);if(!a.ok)throw new Error(await a.text());g=await a.json();const s=`${N}/quick_pp/database/projects/${v()}/j_data?cutoffs=${encodeURIComponent(t(O))}`,l=await fetch(s);if(!l.ok)throw new Error(await l.text());r(m,await l.json())}catch(e){r(F,e.message||"Failed to load data"),r(m,null),r(h,null)}finally{r(q,!1)}}}function Rt(){if(!t(m)||!t(L))return;const{sw:e,pc:a,perm:s,phit:l,rock_flags:d}=t(m),x=a.map((c,f)=>{const y=s[f],S=l[f];return .21665*c/(t(H)*Math.abs(Math.cos(t(J)*Math.PI/180)))*Math.sqrt(y/S)}),w=new Array,$={};d.forEach((c,f)=>{if(c===null)return;const y=c.toString();$[y]||($[y]={sw:[],j:[]}),$[y].sw.push(e[f]),$[y].j.push(x[f])});const z=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd"];Object.keys($).sort((c,f)=>parseFloat(c)-parseFloat(f)).forEach(c=>{const f=$[Number(c)];if(w.push({x:f.sw,y:f.j,mode:"markers",type:"scatter",name:`Rock Flag ${c}`,marker:{color:z[(parseInt(c)-1)%z.length],size:4}}),t(h)&&t(h)[Number(c)]){const{a:y,b:S}=t(h)[Number(c)],T=[];for(let P=.01;P<=1;P+=.01)T.push(P);const W=T.map(P=>y*Math.pow(P,-S));w.push({x:T,y:W,mode:"lines",type:"scatter",name:`Fit RF ${c}`,line:{color:z[(parseInt(c)-1)%z.length]}})}});const k={title:"J vs SW with Fitted Curves",xaxis:{title:"SW (fraction)"},yaxis:{title:"J",range:[0,20]},height:450,showlegend:!0,margin:{l:60,r:60,t:60,b:60}};vt().then(c=>{c.newPlot(t(L),w,k,{responsive:!0})})}function qt(){if(!t(j)||!t(B))return;const e=new Array,a={};t(j).forEach(d=>{a[d.well]||(a[d.well]={depth:[],shf:[]}),a[d.well].depth.push(d.depth),a[d.well].shf.push(d.shf)});const s=["#1f77b4","#ff7f0e","#2ca02c"];Object.keys(a).forEach((d,x)=>{const w=a[d];e.push({x:w.depth,y:w.shf,mode:"lines",type:"scatter",name:d,line:{color:s[x%s.length]}})});const l={title:"SHF vs Depth",xaxis:{title:"Depth (ft)"},yaxis:{title:"SHF (fraction)",range:[0,1.1]},height:200,showlegend:!0,margin:{l:60,r:60,t:60,b:60}};vt().then(d=>{d.newPlot(t(B),e,l,{responsive:!0})})}async function At(){if(!(!t(m)||!v())){r(_,!0),r(u,null);try{if(!t(m))return;const e=`${N}/quick_pp/database/projects/${v()}/compute_j_fits`,a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:t(m),ift:t(H),theta:t(J)})});if(!a.ok)throw new Error(await a.text());r(h,await a.json()),r(u,"J fits computed")}catch(e){r(u,`Error: ${e.message}`)}finally{r(_,!1)}}}async function Gt(){if(!(!t(m)||!t(h)||!v())){r(_,!0),r(u,null);try{const e=Wt();if(!e)return;const a=`${N}/quick_pp/database/projects/${v()}/compute_shf`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e,fits:t(h),fwl:t(K),ift:t(H),theta:t(J),gw:t(Q),ghc:t(X)})});if(!s.ok)throw new Error(await s.text());const l=await s.json();r(j,l.shf_data),r(u,"SHF computed")}catch(e){r(u,`Error: ${e.message}`)}finally{r(_,!1)}}}async function Lt(){if(!(!t(j)||!v())){r(_,!0),r(u,null);try{const e=`${N}/quick_pp/database/projects/${v()}/save_shf`,a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shf_data:t(j)})});if(!a.ok)throw new Error(await a.text());r(u,"SHF saved")}catch(e){r(u,`Error: ${e.message}`)}finally{r(_,!1)}}}nt(()=>(ee(v()),t(O)),()=>{v()&&t(O)&&Mt()}),nt(()=>(t(m),t(h)),()=>{(t(m)||t(h))&&Rt()}),nt(()=>t(j),()=>{t(j)&&qt()}),ae(),Jt();var Y=be(),ft=o(n(Y),2);ce(ft,{});var mt=o(ft,2),tt=n(mt),ht=o(n(tt),2);C(ht),i(tt);var et=o(tt,2),at=n(et),_t=o(n(at),2);C(_t),i(at);var st=o(at,2),bt=o(n(st),2);C(bt),i(st);var rt=o(st,2),gt=o(n(rt),2);C(gt),i(rt);var lt=o(rt,2),wt=o(n(lt),2);C(wt),i(lt);var ot=o(lt,2),yt=o(n(ot),2);C(yt),i(ot);var xt=o(ot,2),$t=n(xt);{let e=U(()=>t(_)||!t(m));pt($t,{class:"btn btn-primary",onclick:At,get disabled(){return t(e)},children:(a,s)=>{ct();var l=dt("Compute Fits");b(a,l)},$$slots:{default:!0}})}var Ft=o($t,2);{let e=U(()=>t(_)||!t(h));pt(Ft,{class:"btn ml-2",onclick:Gt,get disabled(){return t(e)},children:(a,s)=>{ct();var l=dt("Compute SHF");b(a,l)},$$slots:{default:!0}})}var Bt=o(Ft,2);{let e=U(()=>t(_)||!t(j));pt(Bt,{class:"btn ml-2",onclick:Lt,get disabled(){return t(e)},children:(a,s)=>{ct();var l=dt("Save SHF");b(a,l)},$$slots:{default:!0}})}i(xt),i(et);var jt=o(et,2);{var Zt=e=>{var a=ve(),s=n(a,!0);i(a),ut(l=>{se(a,1,`text-sm ${l??""} mb-3`),D(s,t(u))},[()=>(t(u),M(()=>t(u).startsWith("Error")?"text-red-600":"text-green-600"))]),b(e,a)};Z(jt,e=>{t(u)&&e(Zt)})}var kt=o(jt,2);{var Ut=e=>{var a=me(),s=o(Ct(a),4),l=n(s),d=o(n(l));re(d,5,()=>(t(h),M(()=>Object.entries(t(h)))),oe,(x,w)=>{var $=le(()=>ne(t(w),2));let z=()=>t($)[0],k=()=>t($)[1];var c=fe(),f=n(c),y=n(f,!0);i(f);var S=o(f),T=n(S,!0);i(S);var W=o(S),P=n(W,!0);i(W);var zt=o(W),Yt=n(zt,!0);i(zt),i(c),ut(()=>{D(y,z()),D(T,(k(),M(()=>k().a))),D(P,(k(),M(()=>k().b))),D(Yt,(k(),M(()=>k().rmse)))}),b(x,c)}),i(d),i(l),i(s),b(e,a)};Z(kt,e=>{t(h)&&e(Ut)})}var St=o(kt,2),it=n(St),Pt=o(n(it),4);{var Vt=e=>{var a=he();b(e,a)},Kt=e=>{var a=ie(),s=Ct(a);{var l=d=>{var x=_e(),w=n(x,!0);i(x),ut(()=>D(w,t(F))),b(d,x)};Z(s,d=>{t(F)&&d(l)},!0)}b(e,a)};Z(Pt,e=>{t(q)?e(Vt):e(Kt,!1)})}var Qt=o(Pt,2);It(Qt,e=>r(L,e),()=>t(L)),i(it);var Et=o(it,2),Xt=o(n(Et),4);It(Xt,e=>r(B,e),()=>t(B)),i(Et),i(St),i(mt),i(Y),I(ht,()=>t(O),e=>r(O,e)),I(_t,()=>t(K),e=>r(K,e)),I(bt,()=>t(H),e=>r(H,e)),I(gt,()=>t(J),e=>r(J,e)),I(wt,()=>t(Q),e=>r(Q,e)),I(yt,()=>t(X),e=>r(X,e)),b(V,Y),Ot()}var we=E('<div slot="left"><!></div>');function Se(V,R){Dt(R,!1);let v=p(null);const _=Nt.subscribe(u=>{r(v,u?.project??null)});Ht(()=>_()),Jt(),pe(V,{get project(){return t(v)},$$slots:{left:(u,q)=>{var F=we(),g=n(F);{let m=U(()=>t(v)?.project_id??null);ge(g,{get projectId(){return t(m)}})}i(F),b(u,F)}}}),Ot()}export{Se as component};
