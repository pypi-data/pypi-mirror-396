<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serial Cables HYDRA Controller - User's Manual</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #ffffff;
            color: #333;
        }
        
        .container {
            max-width: 8.5in;
            margin: 0 auto;
            background: white;
            padding: 40px;
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #0066cc;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #0066cc;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 18px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .version {
            font-size: 14px;
            color: #888;
        }
        
        h1 {
            color: #0066cc;
            font-size: 24px;
            margin-top: 30px;
            margin-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 8px;
            page-break-after: avoid;
        }
        
        h2 {
            color: #004499;
            font-size: 20px;
            margin-top: 25px;
            margin-bottom: 12px;
            page-break-after: avoid;
        }
        
        h3 {
            color: #333;
            font-size: 16px;
            margin-top: 20px;
            margin-bottom: 10px;
            page-break-after: avoid;
        }
        
        h4 {
            color: #555;
            font-size: 14px;
            margin-top: 15px;
            margin-bottom: 8px;
            page-break-after: avoid;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', Consolas, Monaco, monospace;
            font-size: 12px;
            line-height: 1.4;
            overflow-x: auto;
            page-break-inside: avoid;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .inline-code {
            background-color: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', Consolas, Monaco, monospace;
            font-size: 90%;
        }
        
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        .info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 5px 0;
            padding-left: 20px;
        }
        
        .toc a {
            text-decoration: none;
            color: #0066cc;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #666;
            font-size: 12px;
        }
        
        @media print {
            body {
                margin: 0;
                padding: 0;
            }
            
            .container {
                max-width: none;
                margin: 0;
                padding: 20px;
            }
            
            .page-break {
                page-break-before: always;
            }
            
            h1, h2, h3, h4 {
                page-break-after: avoid;
            }
            
            .code-block, .warning, .info, .success, table {
                page-break-inside: avoid;
            }
        }
        
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        
        li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Serial Cables HYDRA Controller</div>
            <div class="subtitle">User's Manual</div>
            <div class="subtitle">Python Library for PCIe Gen6 HYDRA JBOF Systems</div>
            <div class="version">Version 1.0.0 | November 2025</div>
        </div>

        <div class="toc">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#introduction">1. Introduction</a></li>
                <li><a href="#installation">2. Installation</a></li>
                <li><a href="#quick-start">3. Quick Start Guide</a></li>
                <li><a href="#hardware-setup">4. Hardware Setup</a></li>
                <li><a href="#api-reference">5. API Reference</a></li>
                <li><a href="#monitoring">6. Monitoring and Alerting</a></li>
                <li><a href="#troubleshooting">7. Troubleshooting</a></li>
                <li><a href="#examples">8. Examples</a></li>
                <li><a href="#command-line">9. Command Line Tools</a></li>
                <li><a href="#support">10. Support</a></li>
            </ul>
        </div>

        <div class="page-break"></div>

        <h1 id="introduction">1. Introduction</h1>
        
        <p>The Serial Cables HYDRA Controller is a comprehensive Python library designed for controlling and monitoring Serial Cables PCIe Gen6 HYDRA 8-Bay Passive JBOF (Just a Bunch of Flash) enclosures. This library provides complete hardware control, environmental monitoring, and alerting capabilities through a serial CLI interface.</p>

        <h2>Key Features</h2>
        <ul>
            <li><strong>Complete Hardware Control</strong>: Full implementation of all documented MCU commands</li>
            <li><strong>Environmental Monitoring</strong>: Real-time temperature, voltage, current, and power monitoring</li>
            <li><strong>SSD Slot Management</strong>: Individual and bulk control of all 8 SSD slots</li>
            <li><strong>LED Control</strong>: Host and fault LED management for visual status indication</li>
            <li><strong>Fan Control</strong>: PWM speed control and monitoring of cooling fans</li>
            <li><strong>I2C/SMBus Communication</strong>: Direct device access for advanced diagnostics</li>
            <li><strong>Comprehensive Logging</strong>: CSV data logging for long-term analysis</li>
            <li><strong>Alert System</strong>: Configurable thresholds for proactive monitoring</li>
        </ul>

        <h2>Hardware Compatibility</h2>
        <table>
            <tr><th>Parameter</th><th>Specification</th></tr>
            <tr><td>Model</td><td>Serial Cables PCIe Gen6 8-Bay Passive JBOF</td></tr>
            <tr><td>Firmware Version</td><td>0.0.2 and above</td></tr>
            <tr><td>Connection Interface</td><td>USB Type-C serial interface</td></tr>
            <tr><td>Serial Configuration</td><td>115200 baud, 8N1</td></tr>
            <tr><td>Operating Systems</td><td>Windows, Linux, macOS</td></tr>
            <tr><td>Python Version</td><td>3.7 and above</td></tr>
        </table>

        <div class="page-break"></div>

        <h1 id="installation">2. Installation</h1>

        <h2>System Requirements</h2>
        <ul>
            <li>Python 3.7 or higher</li>
            <li>pyserial >= 3.5</li>
            <li>USB Type-C cable for JBOF connection</li>
            <li>Appropriate serial port drivers (usually automatic)</li>
        </ul>

        <h2>Installation Methods</h2>

        <h3>From PyPI (Recommended)</h3>
        <p>Install the latest stable version from the Python Package Index:</p>
        <div class="code-block">
pip install serialcables-hydra
        </div>

        <h3>Verification</h3>
        <p>Verify your installation by importing the library:</p>
        <div class="code-block">
python -c "from serialcables_hydra import JBOFController; print('Installation successful')"
        </div>

        <div class="success">
            <strong>Success:</strong> If the import completes without errors, your installation is ready to use.
        </div>

        <div class="page-break"></div>

        <h1 id="quick-start">3. Quick Start Guide</h1>

        <h2>Basic Connection and Monitoring</h2>
        <p>This example demonstrates the essential operations for connecting to and monitoring your HYDRA JBOF:</p>

        <div class="code-block">
from serialcables_hydra import JBOFController, PowerState

# Initialize controller (adjust port for your system)
controller = JBOFController(port='COM3')  # Windows
# controller = JBOFController(port='/dev/ttyUSB0')  # Linux

# Connect to HYDRA system
if controller.connect():
    print("Connected to HYDRA JBOF successfully!")
    
    # Get system information
    sys_info = controller.get_system_info()
    print(f"Model: {sys_info.model}")
    print(f"Firmware: {sys_info.firmware_version}")
    print(f"Serial Number: {sys_info.serial_number}")
    
    # Check slot status
    slots = controller.show_slot_info()
    print("\nSlot Status:")
    for slot in slots:
        status = "SSD Present" if slot.present else "Empty"
        print(f"Slot {slot.slot_number}: {status}")
    
    # Get environmental data
    env_data = controller.get_environmental_data()
    print(f"\nEnvironmental Status:")
    print(f"PSU Voltage: {env_data['voltages']['psu_12v']:.2f}V")
    print(f"MCU Temperature: {env_data['temperatures']['mcu']:.1f}°C")
    print(f"Fan 1 Speed: {env_data['fan_speeds']['fan_1']} RPM")
    
    # Disconnect when done
    controller.disconnect()
else:
    print("Failed to connect to HYDRA JBOF")
        </div>

        <h2>Essential SSD Management</h2>
        <p>Control power and monitor individual SSD slots:</p>

        <div class="code-block">
from serialcables_hydra import JBOFController, PowerState
import time

controller = JBOFController(port='COM3')
controller.connect()

# Check current power status
power_status = controller.get_slot_power_status()
print("Current slot power status:")
for slot_num, status in power_status.items():
    print(f"Slot {slot_num}: {status}")

# Power cycle slot 1 (if SSD is present)
print("\nPower cycling slot 1...")
controller.slot_power(1, PowerState.OFF)
time.sleep(2)  # Wait for clean shutdown
controller.slot_power(1, PowerState.ON)

# Control LED for visual indication
controller.control_host_led(1, PowerState.ON)  # Turn on LED
time.sleep(3)
controller.control_host_led(1, PowerState.OFF)  # Turn off LED

controller.disconnect()
        </div>

        <div class="warning">
            <strong>Important:</strong> Always ensure SSDs are properly shut down before powering off slots to prevent data corruption. The library provides safe power cycling with appropriate delays.
        </div>

        <div class="page-break"></div>

        <h1 id="hardware-setup">4. Hardware Setup</h1>

        <h2>Physical Connection</h2>
        <ol>
            <li><strong>Power Connection</strong>: Ensure the HYDRA JBOF is properly connected to power and powered on</li>
            <li><strong>USB Connection</strong>: Connect the USB Type-C cable between your computer and the JBOF's management port</li>
            <li><strong>SSD Installation</strong>: Install NVMe SSDs in the desired slots (1-8)</li>
            <li><strong>PCIe Connection</strong>: Connect PCIe cables from the host system to the JBOF</li>
        </ol>

        <h2>Serial Port Identification</h2>

        <h3>Windows</h3>
        <ul>
            <li>Open Device Manager</li>
            <li>Expand "Ports (COM & LPT)"</li>
            <li>Look for "USB Serial Port" or similar device</li>
            <li>Note the COM port number (e.g., COM3, COM4)</li>
        </ul>

        <h3>Linux</h3>
        <div class="code-block">
# List available serial ports
ls /dev/tty*

# Check for USB serial devices
ls /dev/ttyUSB* /dev/ttyACM*

# View detailed information
dmesg | grep tty
        </div>

        <h3>macOS</h3>
        <div class="code-block">
# List serial ports
ls /dev/tty.*

# Look for USB serial devices
ls /dev/tty.usbserial-* /dev/tty.usbmodem-*
        </div>

        <h2>Permissions Setup (Linux/macOS)</h2>
        <p>Grant access to serial ports:</p>
        <div class="code-block">
# Temporary permission
sudo chmod 666 /dev/ttyUSB0

# Permanent solution - add user to dialout group
sudo usermod -a -G dialout $USER
# Log out and back in for changes to take effect
        </div>

        <div class="info">
            <strong>Note:</strong> The exact port name may vary depending on your system configuration and connected devices. Always verify the correct port before connecting.
        </div>

        <div class="page-break"></div>

        <h1 id="api-reference">5. API Reference</h1>

        <h2>Core Classes</h2>

        <h3>JBOFController / HydraController</h3>
        <p>Main controller class for HYDRA JBOF interaction. Both class names are equivalent and can be used interchangeably.</p>

        <h4>Constructor</h4>
        <div class="code-block">
JBOFController(port: str, baudrate: int = 115200, timeout: float = 1.0)
        </div>

        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr>
            <tr><td>port</td><td>str</td><td>Required</td><td>Serial port path (e.g., 'COM3', '/dev/ttyUSB0')</td></tr>
            <tr><td>baudrate</td><td>int</td><td>115200</td><td>Serial communication baud rate</td></tr>
            <tr><td>timeout</td><td>float</td><td>1.0</td><td>Command timeout in seconds</td></tr>
        </table>

        <h2>System Control Methods</h2>

        <h3>connect() → bool</h3>
        <p>Establish serial connection to the JBOF system.</p>
        <div class="code-block">
controller = JBOFController('COM3')
if controller.connect():
    print("Connection successful")
        </div>

        <h3>disconnect()</h3>
        <p>Close the serial connection and clean up resources.</p>
        <div class="code-block">
controller.disconnect()
        </div>

        <h3>system_power(state: PowerState) → bool</h3>
        <p>Control main system power state.</p>
        <div class="code-block">
# Power on the system
controller.system_power(PowerState.ON)

# Power off the system
controller.system_power(PowerState.OFF)
        </div>

        <h3>reset() → bool</h3>
        <p>Perform a soft reset of the MCU.</p>
        <div class="code-block">
controller.reset()
        </div>

        <h2>Slot Management Methods</h2>

        <h3>slot_power(slot: Union[int, str], state: PowerState) → bool</h3>
        <p>Control power for specific slot(s).</p>
        <div class="code-block">
# Power on slot 1
controller.slot_power(1, PowerState.ON)

# Power off slot 3
controller.slot_power(3, PowerState.OFF)

# Power on all slots
controller.slot_power('all', PowerState.ON)
        </div>

        <h3>get_slot_power_status() → Dict[int, str]</h3>
        <p>Retrieve current power status for all slots.</p>
        <div class="code-block">
status = controller.get_slot_power_status()
for slot_num, power_state in status.items():
    print(f"Slot {slot_num}: {power_state}")
        </div>

        <h3>show_slot_info() → List[SlotInfo]</h3>
        <p>Get detailed information about all slots.</p>
        <div class="code-block">
slots = controller.show_slot_info()
for slot in slots:
    print(f"Slot {slot.slot_number}:")
    print(f"  Present: {slot.present}")
    print(f"  Paddle Card: {slot.paddle_card}")
    print(f"  Temperature: {slot.temperature}°C")
        </div>

        <h2>Environmental Monitoring Methods</h2>

        <h3>get_environmental_data() → Dict</h3>
        <p>Retrieve comprehensive environmental data.</p>
        <div class="code-block">
env_data = controller.get_environmental_data()

# Access temperatures
for location, temp in env_data['temperatures'].items():
    print(f"{location}: {temp:.1f}°C")

# Access voltages
for rail, voltage in env_data['voltages'].items():
    print(f"{rail}: {voltage:.2f}V")

# Access fan speeds
for fan, rpm in env_data['fan_speeds'].items():
    print(f"{fan}: {rpm} RPM")
        </div>

        <h3>get_system_info() → SystemInfo</h3>
        <p>Get complete system information.</p>
        <div class="code-block">
sys_info = controller.get_system_info()
print(f"Company: {sys_info.company}")
print(f"Model: {sys_info.model}")
print(f"Serial Number: {sys_info.serial_number}")
print(f"Firmware: {sys_info.firmware_version}")
        </div>

        <h2>LED Control Methods</h2>

        <h3>control_host_led(slot: Union[int, str], state: PowerState) → bool</h3>
        <p>Control host LED on EDSFF drives.</p>
        <div class="code-block">
# Turn on host LED for slot 1
controller.control_host_led(1, PowerState.ON)

# Turn off host LED for all slots
controller.control_host_led('all', PowerState.OFF)
        </div>

        <h3>control_fault_led(slot: Union[int, str], state: PowerState) → bool</h3>
        <p>Control fault LED indicators.</p>
        <div class="code-block">
# Signal fault condition on slot 2
controller.control_fault_led(2, PowerState.ON)
        </div>

        <h2>Fan Control Methods</h2>

        <h3>set_fan_speed(fan_id: int, duty_cycle: int) → bool</h3>
        <p>Set fan PWM duty cycle for speed control.</p>
        <div class="code-block">
# Set fan 1 to 75% speed
controller.set_fan_speed(1, 75)

# Set fan 2 to maximum speed
controller.set_fan_speed(2, 100)

# Set fan 1 to minimum speed
controller.set_fan_speed(1, 30)
        </div>

        <div class="warning">
            <strong>Caution:</strong> Setting fan speed too low may result in overheating. Monitor temperatures when adjusting fan speeds.
        </div>

        <h2>Advanced Features</h2>

        <h3>I2C/SMBus Communication</h3>

        <h4>i2c_read(address: int, slot: int, register: int, length: int) → List[int]</h4>
        <p>Read data from I2C/SMBus devices connected to SSD slots.</p>
        <div class="code-block">
# Read 8 bytes from device 0x50, register 0x00 on slot 1
data = controller.i2c_read(0x50, 1, 0x00, 8)
if data:
    hex_data = ' '.join(f'{b:02X}' for b in data)
    print(f"Data read: {hex_data}")
        </div>

        <h4>i2c_write(address: int, slot: int, data: List[int]) → bool</h4>
        <p>Write data to I2C/SMBus devices.</p>
        <div class="code-block">
# Write data to device 0x50 on slot 1
data = [0x00, 0x01, 0x02, 0x03]
success = controller.i2c_write(0x50, 1, data)
        </div>

        <h3>Control Buzzer</h3>
        <div class="code-block">
from serialcables_hydra import BuzzerState

# Turn buzzer on
controller.control_buzzer(BuzzerState.ON)

# Turn buzzer off
controller.control_buzzer(BuzzerState.OFF)

# Enable buzzer for alerts
controller.control_buzzer(BuzzerState.ENABLE)
        </div>

        <h3>Additional Reset Functions</h3>

        <h4>smbus_reset(slot: Union[int, str]) → bool</h4>
        <p>Send SMBus reset signal to selected slot(s).</p>
        <div class="code-block">
controller.smbus_reset(1)  # Reset SMBus for slot 1
controller.smbus_reset('all')  # Reset SMBus for all slots
        </div>

        <h4>ssd_reset(slot: Union[int, str], channel: Optional[str] = None) → bool</h4>
        <p>Send PERST# reset signal to selected slot(s).</p>
        <div class="code-block">
controller.ssd_reset(1)  # Reset both channels for slot 1
controller.ssd_reset(2, 'a')  # Reset only channel A for slot 2
controller.ssd_reset(3, 'b')  # Reset only channel B for slot 3
        </div>

        <div class="page-break"></div>

        <h1 id="monitoring">6. Monitoring and Alerting</h1>

        <h2>Real-time Monitoring</h2>
        <p>The HYDRA controller provides comprehensive monitoring capabilities for proactive system management.</p>

        <h3>Continuous Monitoring Loop</h3>
        <div class="code-block">
from serialcables_hydra import JBOFController, BuzzerState
import time

def continuous_monitor(port, duration=300):
    controller = JBOFController(port)
    controller.connect()
    
    start_time = time.time()
    alert_count = 0
    
    print("Starting continuous monitoring...")
    print("Press Ctrl+C to stop")
    
    try:
        while time.time() - start_time < duration:
            env_data = controller.get_environmental_data()
            
            # Monitor temperatures
            for location, temp in env_data['temperatures'].items():
                if temp > 55:  # Critical temperature
                    print(f"CRITICAL: High temperature {location}: {temp:.1f}°C")
                    controller.control_buzzer(BuzzerState.ON)
                    alert_count += 1
                elif temp > 45:  # Warning temperature
                    print(f"WARNING: Elevated temperature {location}: {temp:.1f}°C")
            
            # Monitor voltages
            psu_voltage = env_data['voltages']['psu_12v']
            if psu_voltage < 11.5 or psu_voltage > 12.5:
                print(f"WARNING: PSU voltage out of range: {psu_voltage:.2f}V")
                alert_count += 1
            
            # Monitor fan speeds
            for fan, rpm in env_data['fan_speeds'].items():
                if rpm < 3000:
                    print(f"ALERT: Low fan speed {fan}: {rpm} RPM")
                    controller.control_buzzer(BuzzerState.ON)
                    alert_count += 1
            
            # Display current status every 30 seconds
            if int(time.time() - start_time) % 30 == 0:
                print(f"Status: {alert_count} alerts, PSU: {psu_voltage:.2f}V")
            
            time.sleep(5)  # Check every 5 seconds
            
    except KeyboardInterrupt:
        print("\nMonitoring stopped by user")
    finally:
        controller.control_buzzer(BuzzerState.OFF)
        controller.disconnect()
        print(f"Monitoring complete. Total alerts: {alert_count}")

# Run monitoring for 5 minutes
continuous_monitor('COM3', duration=300)
        </div>

        <h3>Alert Thresholds</h3>
        <table>
            <tr><th>Parameter</th><th>Warning Level</th><th>Critical Level</th></tr>
            <tr><td>Temperature</td><td>45°C</td><td>55°C</td></tr>
            <tr><td>PSU Voltage</td><td>&lt; 11.5V or &gt; 12.5V</td><td>&lt; 11.0V or &gt; 13.0V</td></tr>
            <tr><td>Fan Speed</td><td>&lt; 3000 RPM</td><td>&lt; 1000 RPM</td></tr>
            <tr><td>Current</td><td>&gt; 80% rated</td><td>&gt; 95% rated</td></tr>
        </table>

        <h2>Data Logging</h2>
        <p>Implement data logging for historical analysis and trending:</p>

        <div class="code-block">
import csv
import datetime
from serialcables_hydra import JBOFController

def log_environmental_data(port, log_file, interval=60, duration=3600):
    controller = JBOFController(port)
    controller.connect()
    
    # Create CSV file with headers
    with open(log_file, 'w', newline='') as csvfile:
        fieldnames = ['timestamp', 'mcu_temp', 'psu_voltage', 
                     'fan1_rpm', 'fan2_rpm', 'slot1_temp', 'slot1_power']
        writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
        writer.writeheader()
        
        start_time = time.time()
        while time.time() - start_time < duration:
            env_data = controller.get_environmental_data()
            slots = controller.show_slot_info()
            
            # Log current data
            log_entry = {
                'timestamp': datetime.datetime.now().isoformat(),
                'mcu_temp': env_data['temperatures']['mcu'],
                'psu_voltage': env_data['voltages']['psu_12v'],
                'fan1_rpm': env_data['fan_speeds']['fan_1'],
                'fan2_rpm': env_data['fan_speeds']['fan_2'],
                'slot1_temp': slots[0].temperature if slots else 0,
                'slot1_power': slots[0].power if slots else 0
            }
            writer.writerow(log_entry)
            csvfile.flush()  # Ensure data is written
            
            print(f"Logged data at {log_entry['timestamp']}")
            time.sleep(interval)
    
    controller.disconnect()
    print(f"Data logging complete. File saved: {log_file}")

# Log data every minute for 1 hour
log_environmental_data('COM3', 'hydra_log.csv', interval=60, duration=3600)
        </div>

        <div class="page-break"></div>

        <h1 id="troubleshooting">7. Troubleshooting</h1>

        <h2>Connection Issues</h2>

        <h3>Problem: Cannot Connect to Serial Port</h3>
        <div class="code-block">
# Test port availability
import serial

try:
    ser = serial.Serial('COM3', 115200, timeout=1)
    print("Port is available")
    ser.close()
except serial.SerialException as e:
    print(f"Port error: {e}")
        </div>

        <h4>Solutions:</h4>
        <ul>
            <li><strong>Verify Port Name</strong>: Double-check the correct port identifier for your system</li>
            <li><strong>Check Cable Connection</strong>: Ensure USB Type-C cable is securely connected</li>
            <li><strong>Driver Installation</strong>: Install or update USB-to-serial drivers if needed</li>
            <li><strong>Permission Issues</strong>: On Linux/macOS, ensure user has permission to access serial ports</li>
            <li><strong>Port in Use</strong>: Close any other applications that might be using the port</li>
        </ul>

        <h3>Problem: Commands Timeout</h3>
        <h4>Solutions:</h4>
        <ul>
            <li>Increase timeout value in constructor: <span class="inline-code">JBOFController('COM3', timeout=5.0)</span></li>
            <li>Check baud rate matches device configuration (115200)</li>
            <li>Verify firmware compatibility (version 0.0.2+)</li>
        </ul>

        <h3>Problem: Inconsistent Responses</h3>
        <h4>Solutions:</h4>
        <ul>
            <li>Add delays between commands for busy systems</li>
            <li>Implement retry logic for critical operations</li>
            <li>Check for electrical interference near USB cable</li>
        </ul>

        <h2>Hardware Issues</h2>

        <h3>Problem: SSD Not Detected</h3>
        <h4>Diagnostic Steps:</h4>
        <div class="code-block">
# Check slot status
slots = controller.show_slot_info()
for slot in slots:
    print(f"Slot {slot.slot_number}: Present={slot.present}, Power={slot.power_status}")

# Verify power status
power_status = controller.get_slot_power_status()
print("Power status:", power_status)

# Check clock signals
clock_status = controller.check_clock_input()
print("Clock status:", clock_status)
        </div>

        <h4>Solutions:</h4>
        <ul>
            <li>Verify SSD is properly seated in slot</li>
            <li>Check power connections to JBOF</li>
            <li>Ensure PCIe cables are connected</li>
            <li>Power cycle the affected slot</li>
        </ul>

        <h3>Problem: High Temperature Alerts</h3>
        <h4>Diagnostic Steps:</h4>
        <div class="code-block">
# Check all temperature sensors
env_data = controller.get_environmental_data()
for location, temp in env_data['temperatures'].items():
    status = "CRITICAL" if temp > 55 else "WARNING" if temp > 45 else "OK"
    print(f"{location}: {temp:.1f}°C [{status}]")

# Check fan operation
for fan, rpm in env_data['fan_speeds'].items():
    status = "LOW" if rpm < 3000 else "OK"
    print(f"{fan}: {rpm} RPM [{status}]")
        </div>

        <h4>Solutions:</h4>
        <ul>
            <li>Verify fans are operating at appropriate speeds</li>
            <li>Check for obstructed airflow</li>
            <li>Reduce ambient temperature if possible</li>
            <li>Consider reducing SSD workload temporarily</li>
        </ul>

        <h2>Software Issues</h2>

        <h3>Problem: Import Errors</h3>
        <div class="code-block">
# Verify installation
pip show serialcables-hydra

# Check Python path
import sys
print("Python path:", sys.path)

# Test basic import
try:
    from serialcables_hydra import JBOFController
    print("Import successful")
except ImportError as e:
    print(f"Import failed: {e}")
        </div>

        <h3>Problem: Permission Denied (Linux/macOS)</h3>
        <div class="code-block">
# Check current user groups
groups

# Add user to dialout group
sudo usermod -a -G dialout $USER

# Alternative: temporary permission
sudo chmod 666 /dev/ttyUSB0
        </div>

        <h2>Diagnostic Tools</h2>

        <h3>System Health Check</h3>
        <div class="code-block">
def system_health_check(port):
    """Comprehensive system health check"""
    try:
        controller = JBOFController(port)
        if not controller.connect():
            print("[FAILED] Connection failed")
            return False
        
        print("[SUCCESS] Connection successful")
        
        # Run built-in diagnostics
        diag_results = controller.run_diagnostics()
        print("\nDiagnostic Results:")
        for device, status in diag_results.items():
            symbol = "[OK]" if status == "OK" else "[FAIL]"
            print(f"{symbol} {device}: {status}")
        
        # Check environmental status
        env_data = controller.get_environmental_data()
        print("\nEnvironmental Status:")
        
        # Temperature check
        temps_ok = all(temp < 50 for temp in env_data['temperatures'].values())
        print(f"[{'OK' if temps_ok else 'WARN'}] Temperatures: {'OK' if temps_ok else 'Elevated'}")
        
        # Fan check
        fans_ok = all(rpm > 3000 for rpm in env_data['fan_speeds'].values())
        print(f"[{'OK' if fans_ok else 'FAIL'}] Fans: {'OK' if fans_ok else 'Low Speed'}")
        
        # Voltage check
        voltage = env_data['voltages']['psu_12v']
        voltage_ok = 11.5 <= voltage <= 12.5
        print(f"[{'OK' if voltage_ok else 'WARN'}] PSU Voltage: {voltage:.2f}V {'OK' if voltage_ok else 'Out of Range'}")
        
        controller.disconnect()
        return True
        
    except Exception as e:
        print(f"[FAILED] Health check failed: {e}")
        return False

# Run health check
system_health_check('COM3')
        </div>

        <div class="page-break"></div>

        <h1 id="examples">8. Examples</h1>

        <h2>Complete System Management</h2>
        <p>This example demonstrates comprehensive system management including monitoring, alerts, and automated responses:</p>

        <div class="code-block">
from serialcables_hydra import JBOFController, PowerState, BuzzerState
import time
import logging

# Configure logging
logging.basicConfig(level=logging.INFO, 
                   format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

class HydraSystemManager:
    def __init__(self, port, temp_warning=45, temp_critical=55):
        self.controller = JBOFController(port)
        self.temp_warning = temp_warning
        self.temp_critical = temp_critical
        self.alert_count = 0
        
    def connect(self):
        """Establish connection and perform initial checks"""
        if not self.controller.connect():
            logger.error("Failed to connect to JBOF")
            return False
            
        logger.info("Connected to JBOF successfully")
        
        # Initial system check
        sys_info = self.controller.get_system_info()
        logger.info(f"System: {sys_info.model} (FW: {sys_info.firmware_version})")
        
        return True
        
    def monitor_system(self, duration=3600):
        """Monitor system for specified duration"""
        start_time = time.time()
        last_alert_time = 0
        
        logger.info(f"Starting system monitoring for {duration} seconds")
        
        try:
            while time.time() - start_time < duration:
                env_data = self.controller.get_environmental_data()
                current_time = time.time()
                
                # Temperature monitoring
                max_temp = max(env_data['temperatures'].values())
                if max_temp > self.temp_critical:
                    self.handle_critical_temperature(max_temp)
                elif max_temp > self.temp_warning:
                    self.handle_temperature_warning(max_temp)
                
                # Fan monitoring
                min_fan_speed = min(env_data['fan_speeds'].values())
                if min_fan_speed < 1000:
                    self.handle_fan_failure(min_fan_speed)
                elif min_fan_speed < 3000:
                    self.handle_fan_warning(min_fan_speed)
                
                # Voltage monitoring
                voltage = env_data['voltages']['psu_12v']
                if not (11.5 <= voltage <= 12.5):
                    self.handle_voltage_warning(voltage)
                
                # Log status every 5 minutes
                if current_time - last_alert_time > 300:
                    logger.info(f"Status: Temp={max_temp:.1f}°C, Voltage={voltage:.2f}V, "
                              f"Fans={min_fan_speed}RPM, Alerts={self.alert_count}")
                    last_alert_time = current_time
                
                time.sleep(30)  # Check every 30 seconds
                
        except KeyboardInterrupt:
            logger.info("Monitoring stopped by user")
        finally:
            self.controller.control_buzzer(BuzzerState.OFF)
            logger.info(f"Monitoring complete. Total alerts: {self.alert_count}")
    
    def handle_critical_temperature(self, temp):
        """Handle critical temperature condition"""
        logger.critical(f"CRITICAL TEMPERATURE: {temp:.1f}°C")
        self.controller.control_buzzer(BuzzerState.ON)
        self.alert_count += 1
        
        # Increase fan speeds to maximum
        self.controller.set_fan_speed(1, 100)
        self.controller.set_fan_speed(2, 100)
        logger.info("Fan speeds increased to maximum")
        
    def handle_temperature_warning(self, temp):
        """Handle temperature warning"""
        logger.warning(f"Temperature warning: {temp:.1f}°C")
        self.alert_count += 1
        
    def handle_fan_failure(self, rpm):
        """Handle fan failure"""
        logger.critical(f"FAN FAILURE: {rpm} RPM")
        self.controller.control_buzzer(BuzzerState.ON)
        self.alert_count += 1
        
    def handle_fan_warning(self, rpm):
        """Handle fan speed warning"""
        logger.warning(f"Low fan speed: {rpm} RPM")
        self.alert_count += 1
        
    def handle_voltage_warning(self, voltage):
        """Handle voltage out of range"""
        logger.warning(f"Voltage out of range: {voltage:.2f}V")
        self.alert_count += 1
    
    def power_cycle_slot(self, slot_number):
        """Safely power cycle a specific slot"""
        logger.info(f"Power cycling slot {slot_number}")
        
        # Turn on indicator LED
        self.controller.control_host_led(slot_number, PowerState.ON)
        
        # Power off
        self.controller.slot_power(slot_number, PowerState.OFF)
        logger.info(f"Slot {slot_number} powered off")
        time.sleep(5)  # Wait for clean shutdown
        
        # Power on
        self.controller.slot_power(slot_number, PowerState.ON)
        logger.info(f"Slot {slot_number} powered on")
        time.sleep(3)
        
        # Turn off indicator LED
        self.controller.control_host_led(slot_number, PowerState.OFF)
        
    def disconnect(self):
        """Clean disconnection"""
        if self.controller:
            self.controller.disconnect()
            logger.info("Disconnected from JBOF")

# Usage example
if __name__ == "__main__":
    manager = HydraSystemManager('COM3', temp_warning=45, temp_critical=55)
    
    if manager.connect():
        try:
            # Monitor system for 1 hour
            manager.monitor_system(duration=3600)
        finally:
            manager.disconnect()
        </div>

        <h2>Automated Slot Testing</h2>
        <p>Automated testing routine for all populated slots:</p>

        <div class="code-block">
def automated_slot_test(port):
    """Comprehensive automated slot testing"""
    controller = JBOFController(port)
    
    if not controller.connect():
        print("Connection failed")
        return
    
    print("Starting automated slot testing...")
    
    # Get initial slot status
    slots = controller.show_slot_info()
    populated_slots = [slot for slot in slots if slot.present]
    
    if not populated_slots:
        print("No SSDs detected for testing")
        controller.disconnect()
        return
    
    print(f"Testing {len(populated_slots)} populated slots")
    
    test_results = []
    
    for slot in populated_slots:
        slot_num = slot.slot_number
        print(f"\nTesting Slot {slot_num}...")
        
        test_result = {
            'slot': slot_num,
            'initial_temp': slot.temperature,
            'power_cycle_success': False,
            'led_test_success': False,
            'final_temp': None
        }
        
        try:
            # Test LED control
            print("  Testing LED control...")
            controller.control_host_led(slot_num, PowerState.ON)
            time.sleep(2)
            controller.control_host_led(slot_num, PowerState.OFF)
            test_result['led_test_success'] = True
            print("  [SUCCESS] LED test passed")
            
            # Test power cycling
            print("  Testing power cycle...")
            initial_power = controller.get_slot_power_status()[slot_num]
            
            # Power off
            controller.slot_power(slot_num, PowerState.OFF)
            time.sleep(3)
            off_power = controller.get_slot_power_status()[slot_num]
            
            # Power on
            controller.slot_power(slot_num, PowerState.ON)
            time.sleep(5)
            final_power = controller.get_slot_power_status()[slot_num]
            
            if initial_power == 'on' and off_power == 'off' and final_power == 'on':
                test_result['power_cycle_success'] = True
                print("  [SUCCESS] Power cycle test passed")
            else:
                print(f"  [FAILED] Power cycle test failed: {initial_power}→{off_power}→{final_power}")
            
            # Get final temperature
            updated_slots = controller.show_slot_info()
            final_slot = next(s for s in updated_slots if s.slot_number == slot_num)
            test_result['final_temp'] = final_slot.temperature
            
        except Exception as e:
            print(f"  ❌ Test failed: {e}")
        
        test_results.append(test_result)
        time.sleep(2)  # Brief pause between slot tests
    
    # Print summary
    print("\n" + "="*50)
    print("TEST SUMMARY")
    print("="*50)
    
    for result in test_results:
        slot_num = result['slot']
        led_status = "PASS" if result['led_test_success'] else "FAIL"
        power_status = "PASS" if result['power_cycle_success'] else "FAIL"
        temp_change = result['final_temp'] - result['initial_temp'] if result['final_temp'] else 0
        
        print(f"Slot {slot_num}:")
        print(f"  LED Test: {led_status}")
        print(f"  Power Test: {power_status}")
        print(f"  Temperature: {result['initial_temp']:.1f}°C → {result['final_temp']:.1f}°C ({temp_change:+.1f}°C)")
        print()
    
    # Overall results
    total_tests = len(test_results)
    led_passes = sum(1 for r in test_results if r['led_test_success'])
    power_passes = sum(1 for r in test_results if r['power_cycle_success'])
    
    print(f"Overall Results:")
    print(f"  LED Tests: {led_passes}/{total_tests} passed")
    print(f"  Power Tests: {power_passes}/{total_tests} passed")
    
    controller.disconnect()
    return test_results

# Run automated testing
results = automated_slot_test('COM3')
        </div>

        <div class="page-break"></div>

        <h1 id="command-line">9. Command Line Tools</h1>

        <p>The HYDRA Controller package includes command-line tools for system monitoring and control.</p>

        <h2>hydra-monitor</h2>
        <p>Continuous monitoring tool with real-time display and alerting.</p>

        <h3>Basic Usage</h3>
        <div class="code-block">
# Basic monitoring
hydra-monitor --port COM3

# Monitor with custom settings
hydra-monitor --port /dev/ttyUSB0 --interval 30 --duration 3600

# Monitor with logging
hydra-monitor --port COM3 --log hydra_data.csv --interval 60

# Monitor with custom alert thresholds
hydra-monitor --port COM3 --temp-warning 50 --temp-critical 60 --fan-min 4000
        </div>

        <h3>Command Options</h3>
        <table>
            <tr><th>Option</th><th>Description</th><th>Default</th></tr>
            <tr><td>--port</td><td>Serial port path</td><td>Required</td></tr>
            <tr><td>--interval</td><td>Monitoring interval (seconds)</td><td>30</td></tr>
            <tr><td>--duration</td><td>Total duration (seconds, 0=infinite)</td><td>0</td></tr>
            <tr><td>--log</td><td>CSV log file path</td><td>None</td></tr>
            <tr><td>--temp-warning</td><td>Temperature warning threshold (°C)</td><td>45</td></tr>
            <tr><td>--temp-critical</td><td>Temperature critical threshold (°C)</td><td>55</td></tr>
            <tr><td>--fan-min</td><td>Minimum fan speed (RPM)</td><td>3000</td></tr>
            <tr><td>--voltage-min</td><td>Minimum voltage (V)</td><td>11.5</td></tr>
            <tr><td>--voltage-max</td><td>Maximum voltage (V)</td><td>12.5</td></tr>
        </table>

        <h2>hydra-cli</h2>
        <p>Command-line interface for direct system control and status queries.</p>

        <h3>Available Commands</h3>
        <div class="code-block">
# System status
hydra-cli --port COM3 status

# Power control
hydra-cli --port COM3 power-on --slot 1
hydra-cli --port COM3 power-off --slot 2
hydra-cli --port COM3 power-cycle --slot 3

# Environmental data
hydra-cli --port COM3 environment
hydra-cli --port COM3 temperatures
hydra-cli --port COM3 fans

# LED control
hydra-cli --port COM3 led-on --slot 1
hydra-cli --port COM3 led-off --slot all

# Diagnostics
hydra-cli --port COM3 diagnostics
hydra-cli --port COM3 version
        </div>

        <h3>Output Formats</h3>
        <div class="code-block">
# Default human-readable output
hydra-cli --port COM3 status

# JSON output for scripting
hydra-cli --port COM3 status --format json

# CSV output for data analysis
hydra-cli --port COM3 environment --format csv
        </div>

        <h2>Integration with Scripts</h2>
        <p>Example shell script for automated monitoring:</p>

        <div class="code-block">
#!/bin/bash
# HYDRA monitoring script

PORT="/dev/ttyUSB0"
LOG_DIR="/var/log/hydra"
DATE=$(date +%Y%m%d_%H%M%S)

# Create log directory
mkdir -p $LOG_DIR

# Start background monitoring
hydra-monitor --port $PORT --log "$LOG_DIR/hydra_$DATE.csv" --duration 86400 &
MONITOR_PID=$!

echo "HYDRA monitoring started (PID: $MONITOR_PID)"
echo "Log file: $LOG_DIR/hydra_$DATE.csv"

# Function to check system status
check_status() {
    hydra-cli --port $PORT status --format json > "$LOG_DIR/status_$DATE.json"
    
    # Check for critical conditions
    CRITICAL=$(hydra-cli --port $PORT temperatures | grep -c "CRITICAL")
    if [ $CRITICAL -gt 0 ]; then
        echo "CRITICAL: High temperature detected!"
        # Send alert (email, SMS, etc.)
        # mail -s "HYDRA Critical Alert" admin@company.com < "$LOG_DIR/status_$DATE.json"
    fi
}

# Check status every 5 minutes
while kill -0 $MONITOR_PID 2>/dev/null; do
    check_status
    sleep 300
done

echo "Monitoring completed"
        </div>

        <div class="page-break"></div>

        <h1 id="support">10. Support</h1>

        <h2>Getting Help</h2>
        <p>For technical support and assistance with the Serial Cables HYDRA Controller:</p>

        <h3>Contact Information</h3>
        <ul>
            <li><strong>HYDRA Specific Support:</strong> hydra@serialcables.com</li>
            <li><strong>General Technical Support:</strong> support@serialcables.com</li>
            <li><strong>Documentation:</strong> GitHub repository and PyPI package page</li>
            <li><strong>Bug Reports:</strong> GitHub Issues tracker</li>
        </ul>

        <h2>Before Contacting Support</h2>
        <p>Please gather the following information to help expedite support:</p>

        <h3>System Information</h3>
        <div class="code-block">
from serialcables_hydra import JBOFController

# Collect system information for support
def collect_support_info(port):
    info = {
        'library_version': '1.0.0',
        'python_version': None,
        'platform': None,
        'jbof_info': None,
        'connection_status': False
    }
    
    # Python and platform info
    import sys, platform
    info['python_version'] = sys.version
    info['platform'] = platform.platform()
    
    try:
        controller = JBOFController(port)
        if controller.connect():
            info['connection_status'] = True
            sys_info = controller.get_system_info()
            info['jbof_info'] = {
                'model': sys_info.model,
                'firmware': sys_info.firmware_version,
                'serial': sys_info.serial_number
            }
            controller.disconnect()
    except Exception as e:
        info['connection_error'] = str(e)
    
    return info

# Generate support information
support_data = collect_support_info('COM3')
print("Support Information:")
for key, value in support_data.items():
    print(f"{key}: {value}")
        </div>

        <h3>Information to Include</h3>
        <ul>
            <li>Library version and Python version</li>
            <li>Operating system and platform details</li>
            <li>HYDRA JBOF model and firmware version</li>
            <li>Complete error messages and stack traces</li>
            <li>Steps to reproduce the issue</li>
            <li>Expected vs. actual behavior</li>
            <li>Serial port configuration and connection details</li>
        </ul>

        <h2>Common Support Scenarios</h2>

        <h3>Hardware Compatibility</h3>
        <p>Verify your hardware is compatible:</p>
        <ul>
            <li>Confirm JBOF model is supported</li>
            <li>Check firmware version (0.0.2 or higher required)</li>
            <li>Verify USB Type-C cable functionality</li>
        </ul>

        <h3>Performance Issues</h3>
        <p>For performance-related concerns:</p>
        <ul>
            <li>Monitor system resources during operation</li>
            <li>Check for thermal throttling or overheating</li>
            <li>Verify adequate power supply capacity</li>
            <li>Analyze environmental data trends</li>
        </ul>

        <h3>Integration Support</h3>
        <p>For help integrating with your systems:</p>
        <ul>
            <li>Provide details about your application architecture</li>
            <li>Share relevant code snippets</li>
            <li>Describe integration requirements and constraints</li>
        </ul>

        <h2>Community Resources</h2>
        <ul>
            <li><strong>GitHub Repository:</strong> Source code, examples, and issues</li>
            <li><strong>PyPI Package Page:</strong> Installation and version information</li>
            <li><strong>Documentation:</strong> Online documentation and API reference</li>
            <li><strong>Release Notes:</strong> Change log and version history</li>
        </ul>

        <h2>Feedback and Contributions</h2>
        <p>We welcome feedback and contributions to improve the HYDRA Controller library:</p>
        <ul>
            <li>Report bugs and suggest features via GitHub Issues</li>
            <li>Contribute code improvements through pull requests</li>
            <li>Share usage examples and best practices</li>
            <li>Help improve documentation and examples</li>
        </ul>

        <div class="footer">
            <p>Serial Cables HYDRA Controller User's Manual</p>
            <p>Version 1.0.0 | November 2025</p>
            <p>© 2025 Serial Cables. All rights reserved.</p>
        </div>
    </div>
</body>
</html>