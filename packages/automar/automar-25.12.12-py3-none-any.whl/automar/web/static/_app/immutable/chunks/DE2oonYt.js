import{x as ye,w as Re,ap as Te,K as V,q as T,aq as ke,v as Ae,g as ue,a0 as Ue,H as Me,I as He,J as fe,L as Y,B as H,ar as ze,as as Fe,y as ae,A as xe,at as $,au as B,z as k,av as de,P as je,aw as _e,ax as we,ai as Ge,M as Ce,C as $e,ay as Be,az as K,G,aA as Oe,aB as Ze,aC as qe,aD as Ve,aE as Ye,aF as Ke,_ as We,aG as Xe,aH as Qe,aI as et,aJ as tt,aK as at,aL as oe,ae as nt,b as Le,F as ie,aM as rt,aN as st,N as ot,aO as it,aP as b,R as lt}from"./WOjXuHiA.js";function Dt(e,a){return a}function ct(e,a,t){for(var n=e.items,r=[],s=a.length,o=0;o<s;o++)Ve(a[o].e,r,!0);var d=s>0&&r.length===0&&t!==null;if(d){var p=t.parentNode;Ye(p),p.append(t),n.clear(),I(e,a[0].prev,a[s-1].next)}Ke(r,()=>{for(var l=0;l<s;l++){var m=a[l];d||(n.delete(m.k),I(e,m.prev,m.next)),Oe(m.e,!d)}})}function Rt(e,a,t,n,r,s=null){var o=e,d={flags:a,items:new Map,first:null},p=(a&Te)!==0;if(p){var l=e;o=T?V(ke(l)):l.appendChild(ye())}T&&Ae();var m=null,A=!1,g=new Map,w=Ue(()=>{var _=t();return Ge(_)?_:_==null?[]:we(_)}),u,i;function c(){ut(i,u,d,g,o,r,a,n,t),s!==null&&(u.length===0?m?Ce(m):m=ae(()=>s(o)):m!==null&&$e(m,()=>{m=null}))}Re(()=>{i??=We,u=ue(w);var _=u.length;if(A&&_===0)return;A=_===0;let v=!1;if(T){var E=Me(o)===He;E!==(_===0)&&(o=fe(),V(o),Y(!1),v=!0)}if(T){for(var C=null,S,f=0;f<_;f++){if(H.nodeType===ze&&H.data===Fe){o=H,v=!0,Y(!1);break}var h=u[f],y=n(h,f);S=ne(H,d,C,null,h,y,f,r,a,t),d.items.set(y,S),C=S}_>0&&V(fe())}if(T)_===0&&s&&(m=ae(()=>s(o)));else if(xe()){var U=new Set,F=k;for(f=0;f<_;f+=1){h=u[f],y=n(h,f);var P=d.items.get(y)??g.get(y);P?(a&($|B))!==0&&Ie(P,h,f,a):(S=ne(null,d,null,null,h,y,f,r,a,t,!0),g.set(y,S)),U.add(y)}for(const[L,x]of d.items)U.has(L)||F.skipped_effects.add(x.e);F.add_callback(c)}else c();v&&Y(!0),ue(w)}),T&&(o=H)}function ut(e,a,t,n,r,s,o,d,p){var l=(o&Ze)!==0,m=(o&($|B))!==0,A=a.length,g=t.items,w=t.first,u=w,i,c=null,_,v=[],E=[],C,S,f,h;if(l)for(h=0;h<A;h+=1)C=a[h],S=d(C,h),f=g.get(S),f!==void 0&&(f.a?.measure(),(_??=new Set).add(f));for(h=0;h<A;h+=1){if(C=a[h],S=d(C,h),f=g.get(S),f===void 0){var y=n.get(S);if(y!==void 0){n.delete(S),g.set(S,y);var U=c?c.next:u;I(t,c,y),I(t,y,U),W(y,U,r),c=y}else{var F=u?u.e.nodes_start:r;c=ne(F,t,c,c===null?t.first:c.next,C,S,h,s,o,p)}g.set(S,c),v=[],E=[],u=c.next;continue}if(m&&Ie(f,C,h,o),(f.e.f&K)!==0&&(Ce(f.e),l&&(f.a?.unfix(),(_??=new Set).delete(f))),f!==u){if(i!==void 0&&i.has(f)){if(v.length<E.length){var P=E[0],L;c=P.prev;var x=v[0],Z=v[v.length-1];for(L=0;L<v.length;L+=1)W(v[L],P,r);for(L=0;L<E.length;L+=1)i.delete(E[L]);I(t,x.prev,Z.next),I(t,c,x),I(t,Z,P),u=P,c=Z,h-=1,v=[],E=[]}else i.delete(f),W(f,u,r),I(t,f.prev,f.next),I(t,f,c===null?t.first:c.next),I(t,c,f),c=f;continue}for(v=[],E=[];u!==null&&u.k!==S;)(u.e.f&K)===0&&(i??=new Set).add(u),E.push(u),u=u.next;if(u===null)continue;f=u}v.push(f),c=f,u=f.next}if(u!==null||i!==void 0){for(var M=i===void 0?[]:we(i);u!==null;)(u.e.f&K)===0&&M.push(u),u=u.next;var q=M.length;if(q>0){var Je=(o&Te)!==0&&A===0?r:null;if(l){for(h=0;h<q;h+=1)M[h].a?.measure();for(h=0;h<q;h+=1)M[h].a?.fix()}ct(t,M,Je)}}l&&G(()=>{if(_!==void 0)for(f of _)f.a?.apply()}),e.first=t.first&&t.first.e,e.last=c&&c.e;for(var De of n.values())Oe(De.e);n.clear()}function Ie(e,a,t,n){(n&$)!==0&&de(e.v,a),(n&B)!==0?de(e.i,t):e.i=t}function ne(e,a,t,n,r,s,o,d,p,l,m){var A=(p&$)!==0,g=(p&Be)===0,w=A?g?je(r,!1,!1):_e(r):r,u=(p&B)===0?o:_e(o),i={i:u,v:w,k:s,a:null,e:null,prev:t,next:n};try{if(e===null){var c=document.createDocumentFragment();c.append(e=ye())}return i.e=ae(()=>d(e,w,u,l),T),i.e.prev=t&&t.e,i.e.next=n&&n.e,t===null?m||(a.first=i):(t.next=i,t.e.next=i.e),n!==null&&(n.prev=i,n.e.prev=i.e),i}finally{}}function W(e,a,t){for(var n=e.next?e.next.e.nodes_start:t,r=a?a.e.nodes_start:t,s=e.e.nodes_start;s!==null&&s!==n;){var o=qe(s);r.before(s),s=o}}function I(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}function kt(e,a,t,n,r){T&&Ae();var s=a.$$slots?.[t],o=!1;s===!0&&(s=a.children,o=!0),s===void 0||s(e,o?()=>n:n)}const ve=[...` 	
\r\fÂ \v\uFEFF`];function ft(e,a,t){var n=e==null?"":""+e;if(a&&(n=n?n+" "+a:a),t){for(var r in t)if(t[r])n=n?n+" "+r:r;else if(n.length)for(var s=r.length,o=0;(o=n.indexOf(r,o))>=0;){var d=o+s;(o===0||ve.includes(n[o-1]))&&(d===n.length||ve.includes(n[d]))?n=(o===0?"":n.substring(0,o))+n.substring(d+1):o=d}}return n===""?null:n}function Ut(e,a){return e==null?null:String(e)}function Mt(e,a,t,n,r,s){var o=e.__className;if(T||o!==t||o===void 0){var d=ft(t,n,s);(!T||d!==e.getAttribute("class"))&&(d==null?e.removeAttribute("class"):e.className=d),e.__className=t}else if(s&&r!==s)for(var p in s){var l=!!s[p];(r==null||l!==!!r[p])&&e.classList.toggle(p,l)}return s}const dt=Symbol("is custom element"),_t=Symbol("is html");function Ht(e){if(T){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;he(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var r=e.checked;he(e,"checked",null),e.checked=r}}};e.__on_r=t,G(t),Xe()}}function zt(e,a){var t=le(e);t.value===(t.value=a??void 0)||e.value===a&&(a!==0||e.nodeName!=="PROGRESS")||(e.value=a??"")}function Ft(e,a){var t=le(e);t.checked!==(t.checked=a??void 0)&&(e.checked=a)}function he(e,a,t,n){var r=le(e);T&&(r[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||r[a]!==(r[a]=t)&&(a==="loading"&&(e[Qe]=t),t==null?e.removeAttribute(a):typeof t!="string"&&vt(e).includes(a)?e[a]=t:e.setAttribute(a,t))}function le(e){return e.__attributes??={[dt]:e.nodeName.includes("-"),[_t]:e.namespaceURI===et}}var pe=new Map;function vt(e){var a=e.getAttribute("is")||e.nodeName,t=pe.get(a);if(t)return t;pe.set(a,t=[]);for(var n,r=e,s=Element.prototype;s!==r;){n=at(r);for(var o in n)n[o].set&&t.push(o);r=tt(r)}return t}function xt(e,a,t=a){var n=new WeakSet;oe(e,"input",async r=>{var s=r?e.defaultValue:e.value;if(s=Q(e)?ee(s):s,t(s),k!==null&&n.add(k),await nt(),s!==(s=a())){var o=e.selectionStart,d=e.selectionEnd,p=e.value.length;if(e.value=s??"",d!==null){var l=e.value.length;o===d&&d===p&&l>p?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=o,e.selectionEnd=Math.min(d,l))}}}),(T&&e.defaultValue!==e.value||Le(a)==null&&e.value)&&(t(Q(e)?ee(e.value):e.value),k!==null&&n.add(k)),ie(()=>{var r=a();if(e===document.activeElement){var s=rt??k;if(n.has(s))return}Q(e)&&r===ee(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}const X=new Set;function jt(e,a,t,n,r=n){var s=t.getAttribute("type")==="checkbox",o=e;let d=!1;if(a!==null)for(var p of a)o=o[p]??=[];o.push(t),oe(t,"change",()=>{var l=t.__value;s&&(l=me(o,l,t.checked)),r(l)},()=>r(s?[]:null)),ie(()=>{var l=n();if(T&&t.defaultChecked!==t.checked){d=!0;return}s?(l=l||[],t.checked=l.includes(t.__value)):t.checked=st(t.__value,l)}),ot(()=>{var l=o.indexOf(t);l!==-1&&o.splice(l,1)}),X.has(o)||(X.add(o),G(()=>{o.sort((l,m)=>l.compareDocumentPosition(m)===4?-1:1),X.delete(o)})),G(()=>{if(d){var l;if(s)l=me(o,l,t.checked);else{var m=o.find(A=>A.checked);l=m?.__value}r(l)}})}function Gt(e,a,t=a){oe(e,"change",n=>{var r=n?e.defaultChecked:e.checked;t(r)}),(T&&e.defaultChecked!==e.checked||Le(a)==null)&&t(e.checked),ie(()=>{var n=a();e.checked=!!n})}function me(e,a,t){for(var n=new Set,r=0;r<e.length;r+=1)e[r].checked&&n.add(e[r].__value);return t||n.delete(a),Array.from(n)}function Q(e){var a=e.type;return a==="number"||a==="range"}function ee(e){return e===""?null:+e}function $t(e){return function(...a){var t=a[0];return t.stopPropagation(),e?.apply(this,a)}}function Bt(e){return function(...a){var t=a[0];return t.preventDefault(),e?.apply(this,a)}}class re extends Error{status;payload;constructor(a,t,n){super(t),this.status=a,this.payload=n}}const ht="http://127.0.0.1:8000";function ce(e){return typeof e=="object"&&e!==null}function be(e){return ce(e)&&("loc"in e?Array.isArray(e.loc):!0)&&("msg"in e?typeof e.msg=="string":!0)}function pt(e){return Array.isArray(e)&&e.every(be)?e:ce(e)&&Array.isArray(e.detail)&&e.detail.every(be)?e.detail:null}function mt(e){if(typeof e=="string")return e;const a=pt(e);if(a)return a.map(t=>`${Array.isArray(t.loc)?t.loc.join("."):""} ${t.msg??""}`.trim()).filter(Boolean).join(", ");if(ce(e)&&typeof e.detail=="string")return e.detail;try{return JSON.stringify(e)}catch{return"Unknown error"}}function bt(e={}){const{headers:a,...t}=e,n={...a??{}},r=t.body;return r!=null&&!(r instanceof FormData)&&!("Content-Type"in n)&&(n["Content-Type"]="application/json"),{...t,headers:n}}async function gt(e){const a=e.headers.get("content-type")||"";let t;a.includes("application/json")?t=await e.json().catch(()=>{}):t=await e.text().catch(()=>{});let n=`HTTP error! status: ${e.status}`;return t&&(n=mt(t)),new re(e.status,n,t)}async function O(e,a={}){const t=`${ht}${e}`,n=bt(a);try{const r=await fetch(t,n);if(!r.ok)throw await gt(r);const s=r.headers.get("content-type")||"";return s.includes("application/json")?await r.json():s.includes("application/octet-stream")?r:await r.text()}catch(r){if(r instanceof re)throw r;const s=r instanceof Error?r.message:"Unexpected network error";throw new re(0,s)}}const z={getJobStatus(e){return O(`/jobs/${e}`)},getAllJobs(){return O("/jobs/all")},cancelJob(e){return O(`/jobs/${e}`,{method:"DELETE"})},deleteJobPermanently(e){return O(`/jobs/${e}/permanent`,{method:"DELETE"})},toggleJobLock(e){return O(`/jobs/${e}/lock`,{method:"POST"})},getProgress(e){return O(`/progress/${e}`)},downloadTuningResults(e){return O(`/download/tuning/${e}`)}},Zt={triggerTorchPreload(){return O("/preload-torch",{method:"POST"})},openOutputFolder(){return O("/settings/open-output-folder",{method:"POST"})},checkHealth(){return O("/health")},getDefaults(){return O("/settings/defaults")}},Et={extract:null,pca:null,tuning:null,training:null,crossvalidation:null,predict:null,jobs:null},St=b("extract"),yt=b(!1),Ne=b(Et),R=b({}),ge=b(!0);function Tt(e){return Array.isArray(e)?e.reduce((a,t)=>(t?.job_id&&(a[t.job_id]=t),a),{}):e}function At(e){R.set(Tt(e))}function wt(e){if(!e?.job_id)throw new Error("Job object must include job_id");R.update(a=>({...a,[e.job_id]:e}))}function Ct(e){e&&R.update(a=>{if(!(e in a))return a;const t={...a};return delete t[e],t})}function qt(e,a){if(!a?.job_id)throw new Error("Job object must include job_id");R.update(t=>{const n={...t};return delete n[e],n[a.job_id]=a,n})}it(R,e=>Object.values(e).filter(a=>a.status==="running"||a.status==="pending"));const Vt=b([]),Yt=b([]),Kt=b([]),Wt=b([]),Xt=b([]),Qt=b([]),ea=b([]),ta=b([]),aa=b([]),na=b([]),ra=b([]);function sa(e,a){const t={...a,job_id:a.job_id??e};wt(t)}function te(e,a){R.update(t=>{const n=t[e];return n?{...t,[e]:{...n,...a}}:t})}function oa(e,a){Ne.update(t=>({...t,[e]:a})),a&&typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"})}function ia(e){Ne.update(a=>({...a,[e]:null}))}function la(e){yt.set(e)}function Ot(){const e=new Date;return e.setDate(e.getDate()-1),e.toISOString().split("T")[0]}const ca=b({ticker:"",industry:"",history:"",force:!1,dir_path:null,extract_file:null,format:"feather",datest:"",datend:Ot(),ensure_combined_dataset:!0}),se={n_components:0,alpha:.05,drop:!0,data_file:null,pca_file:null,pca_force:!1,notdf:!1,pca_df_file:null,dataset_path:""},ua=b(se),fa={N_COMPONENTS:se.n_components,ALPHA:se.alpha},J={tsize:20,batch_size:50,dopca:!0,val_size:.15,test_size:.15,device:"cpu",cores:4,gpu_fraction:.25,scaler:"standard"},da=b(J),_a={TSIZE:J.tsize,BATCH_SIZE:J.batch_size,VAL_SIZE:J.val_size,TEST_SIZE:J.test_size,CORES:J.cores,GPU_FRACTION:J.gpu_fraction},j={tuning_path:null,param_path:"test_hyper",num_samples:50,epochs:50,gpu_per_trial:1,model:"GRU",search_space_path:null},va=b(j),ha={NUM_SAMPLES:j.num_samples,EPOCHS:j.epochs,GPU_PER_TRIAL:j.gpu_per_trial},D={cfg_path:null,pca_path:null,mdl_path:null,id:1,model_type:"GRU",epochs:50,tsize:20,batch_size:50,alpha:.05,device:"cpu",cores:4,gpu_fraction:.25,manual_hyperparams_toml:null},pa=b(D),ma={EPOCHS:D.epochs,TSIZE:D.tsize,BATCH_SIZE:D.batch_size,ALPHA:D.alpha,CORES:D.cores,GPU_FRACTION:D.gpu_fraction},N={out_path:null,n_split:5,model:"GRU",epochs:50,tsize:20,batch_size:50,alpha:.05,device:"cpu",cores:4,gpu_fraction:.25,manual_hyperparams_toml:null},ba=b(N),ga={N_SPLIT:N.n_split,EPOCHS:N.epochs,TSIZE:N.tsize,BATCH_SIZE:N.batch_size,ALPHA:N.alpha,CORES:N.cores,GPU_FRACTION:N.gpu_fraction},Pe={model:"GRU",model_path:null,pca_path:null,save_dir:null,mode:"eval",model_type:null,forecast_days:1},Ea=b(Pe),Sa={FORECAST_DAYS:Pe.forecast_days},Lt=new Set(["completed","failed"]),Ee=new Set(["running","pending"]);function It({getJobsSnapshot:e,fetchStatus:a,updateJob:t,onJobCompletion:n,intervalMs:r=2e3}){let s=null,o=!1;async function d(){if(!o){o=!0;try{const m=e(),A=Object.entries(m);for(const[g,w]of A)if(!(!w||g.startsWith("temp-"))&&Ee.has(w.status))try{const u=await a(g),i=Lt.has(u.status);t(g,u),i&&Ee.has(w.status)&&n&&await n(u)}catch(u){console.warn(`Failed to get status for job ${g}:`,u)}}finally{o=!1}}}function p(){s||(s=setInterval(d,r))}function l(){s&&(clearInterval(s),s=null)}return{start:p,stop:l}}const ya=Symbol("jobsLifecycle");function Nt(e={}){const a=["tuning","training","crossvalidation","predict","jobs"];let t=new Set(e.enabledTabs??a),n=e.onJobCompletion,r=null;const s=St.subscribe(i=>{t.has(i)?r?.start():r?.stop()});function o(){r||(r=It({getJobsSnapshot:()=>lt(R),fetchStatus:i=>z.getJobStatus(i),updateJob:te,onJobCompletion:d,intervalMs:e.intervalMs}))}async function d(i){n&&await n(i)}async function p(i){const c=await z.getJobStatus(i);return te(i,c),c}async function l(){ge.set(!0);try{const i=await z.getAllJobs(),c=u(i);At(c)}finally{ge.set(!1)}}async function m(i){const c=i.map(async v=>(await z.deleteJobPermanently(v),Ct(v),v)),_=await Promise.allSettled(c);return g(i,_)}async function A(i,c){const _=i.map(async E=>{const C=await z.toggleJobLock(E);if(te(E,{locked:C.locked}),C.locked!==c)throw new Error("Lock state mismatch after toggle");return E}),v=await Promise.allSettled(_);return g(i,v)}function g(i,c){const _={success:[],failures:[]};return c.forEach((v,E)=>{const C=i[E];v.status==="fulfilled"?_.success.push(v.value):_.failures.push({jobId:C,error:v.reason instanceof Error?v.reason.message:String(v.reason)})}),_}function w(i){return typeof i=="object"&&i!==null&&"job_id"in i}function u(i){return i?Array.isArray(i)?i.reduce((c,_)=>(w(_)&&typeof _.job_id=="string"&&(c[_.job_id]=_),c),{}):typeof i=="object"&&i!==null?Object.entries(i).reduce((c,[_,v])=>(w(v)&&(c[_]=v),c),{}):{}:{}}return{start(){o(),r?.start()},stop(){r?.stop()},destroy(){r?.stop(),s()},refreshJob:p,setEnabledTabs(i){t=new Set(i)},setOnJobCompletion(i){n=i},fetchAllJobs:l,deleteJobs:m,toggleJobLocks:A}}const Se=4e3;function Pt(){const a=b([]);function t(r){const s=crypto.randomUUID(),o={id:s,duration:Se,...r};a.update(p=>[...p,o]);const d=o.duration??Se;setTimeout(()=>n(s),d)}function n(r){a.update(s=>s.filter(o=>o.id!==r))}return{subscribe:a.subscribe,success:(r,s)=>t({message:r,duration:s,variant:"success"}),error:(r,s)=>t({message:r,duration:s,variant:"error"}),info:(r,s)=>t({message:r,duration:s,variant:"info"}),dismiss:n}}const Ta=Pt(),Aa=Nt();export{Ct as $,Kt as A,Wt as B,Xt as C,ra as D,ca as E,ua as F,pa as G,da as H,va as I,ya as J,ba as K,Ea as L,_a as M,ga as N,At as O,Sa as P,Gt as Q,sa as R,Bt as S,ha as T,yt as U,la as V,oa as W,fa as X,jt as Y,ma as Z,qt as _,R as a,Ne as a0,St as a1,ia as a2,ge as b,xt as c,he as d,Mt as e,Rt as f,kt as g,O as h,Dt as i,Aa as j,Zt as k,z as l,zt as m,Ft as n,Ut as o,Vt as p,na as q,Ht as r,$t as s,Ta as t,te as u,ta as v,aa as w,ea as x,Qt as y,Yt as z};
