(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4202],{58095:function(e,t,n){var r=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},95372:function(e){e.exports=function(e,t,n,r){for(var i=e.length,l=n+(r?1:-1);r?l--:++l<i;)if(t(e[l],l,e))return l;return -1}},8817:function(e,t,n){var r=n(95372),i=n(1129),l=n(58263);e.exports=function(e,t,n){return t==t?l(e,t,n):r(e,i,n)}},1129:function(e){e.exports=function(e){return e!=e}},75733:function(e){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var l=Array(i);++r<i;)l[r]=e[r+t];return l}},92198:function(e,t,n){var r=n(52485),i=n(58095),l=n(21796),a=n(65581),s=n(47111),o=n(43735);e.exports=function(e,t,n){var d=-1,u=i,c=e.length,f=!0,m=[],h=m;if(n)f=!1,u=l;else if(c>=200){var p=t?null:s(e);if(p)return o(p);f=!1,u=a,h=new r}else h=t?[]:m;e:for(;++d<c;){var x=e[d],v=t?t(x):x;if(x=n||0!==x?x:0,f&&v==v){for(var y=h.length;y--;)if(h[y]===v)continue e;t&&h.push(v),m.push(x)}else u(h,v,n)||(h!==m&&h.push(v),m.push(x))}return m}},70830:function(e,t,n){var r=n(76747),i=n(31159),l=n(64373),a=n(37948);e.exports=function(e,t){return t=r(t,e),null==(e=l(e,t))||delete e[a(i(t))]}},47111:function(e,t,n){var r=n(46151),i=n(50344),l=n(43735),a=r&&1/l(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},64373:function(e,t,n){var r=n(79867),i=n(75733);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},58263:function(e){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,n){var r=n(92198);e.exports=function(e){return e&&e.length?r(e):[]}},43551:function(e,t,n){var r=n(70830);e.exports=function(e,t){return null==e||r(e,t)}},71180:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/taxonomy",function(){return n(46638)}])},79806:function(e,t,n){"use strict";n.d(t,{Gn:function(){return s},zR:function(){return a}});var r=n(24246),i=n(39158),l=n(56358);let a=e=>{let{title:t}=e;return(0,r.jsx)(i.OXI,{py:0,display:"flex",alignItems:"flex-start",children:(0,r.jsx)(i.xvT,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},s=e=>{let{onDelete:t,onEditYaml:n,formId:a,isSaving:s}=e;return(0,r.jsxs)(i.zeN,{justifyContent:"space-between",children:[t?(0,r.jsx)(i.wpx,{"aria-label":"delete",icon:(0,r.jsx)(l.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,r.jsxs)("div",{className:"flex gap-2",children:[n&&(0,r.jsx)(i.wpx,{onClick:n,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,r.jsx)(i.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:a,loading:s,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:n,isOpen:l,onClose:a,children:s,footer:o}=e;return(0,r.jsxs)(i.dys,{placement:"right",isOpen:l,onClose:a,size:"md",children:[(0,r.jsx)(i.P1B,{}),(0,r.jsxs)(i.scA,{"data-testid":"edit-drawer-content",py:2,children:[(0,r.jsxs)(i.xuv,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,r.jsx)(i.xuv,{flex:1,minH:8,children:t}),(0,r.jsx)(i.xuv,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,r.jsx)(i.wpx,{"aria-label":"Close editor",onClick:a,"data-testid":"close-drawer-btn",icon:(0,r.jsx)(i.Two,{fontSize:"smaller"})})})]}),(0,r.jsxs)(i.Ng0,{pt:1,children:[n?(0,r.jsx)(i.xvT,{fontSize:"sm",mb:4,color:"gray.600",children:n}):null,s]}),o]})]})}},18225:function(e,t,n){"use strict";var r=n(24246),i=n(39158);t.Z=e=>{let{alignment:t="center",...n}=e;return(0,r.jsx)(i.kCb,{boxSize:"full",align:"center",justify:t,children:(0,r.jsx)(i.$jN,{color:"primary",...n})})}},56358:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var r=n(24246);let i=(0,n(39158).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,r.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},94799:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var r=n(76649);let i=e=>(0,r.Ln)({id:"string"},e),l=e=>(null!=e?e:[]).filter(i)},30320:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(27378),i=n(25980),l=n(17245),a=n(32885),s=n(94799);let o=e=>{let{resourceFidesKey:t,resourceType:n}=e,{errorAlert:o}=(0,l.VY)(),{plus:d}=(0,i.hz)(),u=(0,r.useMemo)(()=>null!=t?t:"",[]),c=(0,a.YU)(!0,{skip:!d}),f=(0,a.VN)(n,{skip:!d}),{data:m,isLoading:h,error:p,isError:x}=(0,a.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[v]=(0,a._D)(),y=c.isLoading||f.isLoading||h,g=(0,r.useMemo)(()=>new Map((0,s.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),j=(0,r.useMemo)(()=>{var e;return null===(e=f.data)||void 0===e?void 0:e.filter(e=>e.active)},[f.data]),_=(0,r.useMemo)(()=>new Map((0,s.k)(j).map(e=>[e.id,e])),[j]),T=(0,r.useMemo)(()=>x&&p&&"status"in p&&404===p.status?new Map:new Map((0,s.k)(m).map(e=>[e.custom_field_definition_id,e])),[m,x,p]),b=(0,r.useMemo)(()=>{let e=[..._.keys()];return e.sort(),e},[_]),E=(0,r.useMemo)(()=>{let e={};return j&&T&&j.forEach(t=>{let n=T.get(t.id||"");n&&(t.allow_list_id&&"string[]"===t.field_type?e[n.custom_field_definition_id]=n.value:e[n.custom_field_definition_id]=n.value.toString())}),e},[j,T]),C=(0,r.useCallback)(async e=>{if(!d)return;let r="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!r)return;let{customFieldValues:i}=e;if(!i||0===Object.keys(i).length)return;let l=[],a=[];b.forEach(e=>{let t=T.get(e),n=i[e];void 0===n||""===n||Array.isArray(n)&&0===n.length?(null==t?void 0:t.id)&&a.push(t.id):l.push({custom_field_definition_id:e,resource_id:r,id:null==t?void 0:t.id,value:n})});try{await v({resource_type:n,resource_id:r,upsert:l,delete:a})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,b,v,n]);return{customFieldValues:E,definitionIdToCustomField:T,idToAllowListWithOptions:g,idToCustomFieldDefinition:_,isEnabled:d,isLoading:y,sortedCustomFieldDefinitionIds:b,upsertCustomFields:C}}},33162:function(e,t,n){"use strict";n.d(t,{uc:function(){return c},mZ:function(){return u.m}});var r=n(24246),i=n(39158),l=n(34090),a=n(20987),s=n(30234),o=n(97181),d=n(40324),u=n(30320);let c=e=>{let{resourceFidesKey:t,resourceType:n}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:f,isEnabled:m,isLoading:h,sortedCustomFieldDefinitionIds:p}=(0,u.m)({resourceFidesKey:t,resourceType:n});return m&&0!==p.length?(0,r.jsx)(s.Z,{heading:"Custom fields",children:(0,r.jsx)(i.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,r.jsx)(i.kCb,{flexDir:"column",gap:"24px",children:h?(0,r.jsx)(i.M5Y,{children:(0,r.jsx)(i.$jN,{})}):p.length>0&&(0,r.jsx)(i.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:p.map(e=>{let t=f.get(e);if(!t)return null;let n="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===a.H.STRING)return(0,r.jsx)(l.gN,{name:n,children:e=>{let{field:n}=e;return(0,r.jsx)(d.j0,{...n,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let i=c.get(t.allow_list_id);if(!i)return null;let{options:s}=i;return(0,r.jsx)(o.d,{name:n,allowClear:!0,mode:t.field_type!==a.H.STRING?"multiple":void 0,label:t.name,options:s,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};n(94799)},97181:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var r=n(24246),i=n(39158),l=n(34090),a=n(27378),s=n(46238),o=n(40324);let d=e=>{let{name:t,label:n,labelProps:d,tooltip:u,isRequired:c,layout:f="inline",helperText:m,...h}=e,[p,x,{setValue:v}]=(0,l.U$)(t),y=!!(x.touched&&x.error),[g,j]=(0,a.useState)("");p.value||"tags"!==h.mode&&"multiple"!==h.mode||(p.value=[]),"tags"===h.mode&&"string"==typeof p.value&&(p.value=[p.value]);let _="tags"===h.mode?(e,t)=>e?e.value!==g||p.value.includes(g)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(g,'"'):void 0:h.optionRender||void 0,T=e=>{j(e),h.onSearch&&h.onSearch(e)},b=(e,t)=>{v(e),h.onChange&&h.onChange(e,t)};return"inline"===f?(0,r.jsx)(i.NIc,{isInvalid:y,isRequired:c,children:(0,r.jsxs)(i.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,r.jsx)(o.__,{htmlFor:h.id||t,...d,children:n}):null,(0,r.jsxs)(i.jqI,{align:"center",children:[(0,r.jsxs)(i.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,r.jsx)(i.WPr,{...p,id:h.id||t,"data-testid":"controlled-select-".concat(p.name),...h,optionRender:_,onSearch:"tags"===h.mode?T:void 0,onChange:b,value:p.value||void 0,status:y?"error":void 0}),m&&(0,r.jsx)(i.Q6r,{children:m}),(0,r.jsx)(o.Bc,{isInvalid:y,message:x.error,fieldName:p.name})]}),(0,r.jsx)(s.b,{label:u,className:y?"mt-2 self-start":void 0})]})]})}):(0,r.jsx)(i.NIc,{isInvalid:y,isRequired:c,children:(0,r.jsxs)(i.gCW,{alignItems:"start",children:[(0,r.jsxs)(i.jqI,{align:"center",children:[n?(0,r.jsx)(o.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:n}):null,(0,r.jsx)(s.b,{label:u})]}),(0,r.jsx)(i.WPr,{...p,id:h.id||t,"data-testid":"controlled-select-".concat(p.name),...h,optionRender:_,onSearch:"tags"===h.mode?T:void 0,onChange:b,value:p.value||void 0,status:y?"error":void 0}),m&&(0,r.jsx)(i.Q6r,{style:{marginTop:0},children:m}),(0,r.jsx)(o.Bc,{isInvalid:y,message:x.error,fieldName:p.name})]})})}},84418:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var r=n(24246),i=n(39158),l=n(98784),a=n.n(l);let s=e=>{let{itemKey:t,actions:n}=e;return a().isEmpty(n)?null:(0,r.jsx)(i.jqI,{gap:"small",justify:"flex-end",children:n.map((e,l)=>{let{callback:a,label:s,disabled:o}=e;return(0,r.jsx)(i.wpx,{onClick:()=>a(t),type:l===n.length-1?"primary":"default",disabled:o,children:s},s)})})},o=e=>{let{title:t,titleIcon:n,titleTag:l}=e;return(0,r.jsxs)(i.jqI,{align:"center",gap:"small",children:[n,(0,r.jsx)("span",{children:t}),l&&(0,r.jsx)(i.j8w,{...l})]})},d=e=>{let{title:t,titleIcon:n,titleTag:l,actions:a,width:d=480,...u}=e;return(0,r.jsx)(i.To0,{title:(0,r.jsx)(o,{title:t,titleIcon:n,titleTag:l}),footer:u.footer||!a?u.footer:(0,r.jsx)(s,{itemKey:u.itemKey,actions:a}),width:d,...u})}},33335:function(e,t,n){"use strict";n.d(t,{E:function(){return r}});let r=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},30234:function(e,t,n){"use strict";var r=n(24246),i=n(39158);t.Z=e=>{let{heading:t,HeadingButton:n,children:l}=e;return(0,r.jsx)(i.Kqy,{spacing:4,children:(0,r.jsxs)(i.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,r.jsxs)(i.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,r.jsx)(i.X6q,{as:"h3",size:"xs",children:t}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.LZC,{}),n]})]}),(0,r.jsx)(i.Kqy,{spacing:4,px:6,py:6,children:l})]})})}},22583:function(e,t,n){"use strict";n.d(t,{j:function(){return l}});var r=n(39158),i=n(60240);let l={[i.Ej.TAXONOMY_WHITE]:r.tAb.DEFAULT,[i.Ej.TAXONOMY_RED]:r.tAb.ERROR,[i.Ej.TAXONOMY_ORANGE]:r.tAb.WARNING,[i.Ej.TAXONOMY_YELLOW]:r.tAb.CAUTION,[i.Ej.TAXONOMY_GREEN]:r.tAb.SUCCESS,[i.Ej.TAXONOMY_BLUE]:r.tAb.INFO,[i.Ej.TAXONOMY_PURPLE]:r.tAb.ALERT,[i.Ej.SANDSTONE]:r.tAb.SANDSTONE,[i.Ej.MINOS]:r.tAb.MINOS}},92818:function(e,t,n){"use strict";n.d(t,{r:function(){return o}});var r=n(24246),i=n(27378),l=n(97181),a=n(22583),s=n(60240);let o={[s.Ej.TAXONOMY_WHITE]:"White",[s.Ej.TAXONOMY_RED]:"Red",[s.Ej.TAXONOMY_ORANGE]:"Orange",[s.Ej.TAXONOMY_YELLOW]:"Yellow",[s.Ej.TAXONOMY_GREEN]:"Green",[s.Ej.TAXONOMY_BLUE]:"Blue",[s.Ej.TAXONOMY_PURPLE]:"Purple",[s.Ej.SANDSTONE]:"Sandstone",[s.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...n}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(a.j[t],")"),border:t===s.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})},u=e=>{let t=null==e?void 0:e.value,n=null==e?void 0:e.label;return(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(d,{color:t}),(0,r.jsx)("span",{children:n})]})};t.Z=e=>{let t=Object.values(s.Ej).map(e=>({value:e,label:o[e]})),[n,a]=(0,i.useState)(void 0);return(0,r.jsx)(l.d,{...e,options:t,optionRender:u,layout:"stacked",value:n,onChange:e=>{a(e)},prefix:(0,r.jsx)(d,{color:null!=n?n:s.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},90673:function(e,t,n){"use strict";n.d(t,{Cd:function(){return l},Xl:function(){return a}});var r=n(20987),i=n(59001);let l=(e,t)=>{let n;if(null==t&&e.every(e=>void 0===e.parent_key))n=e;else{let r=null!=t?t:null;n=e.filter(e=>e.parent_key===r)}return n.map(t=>{var n,r;let i=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:l(e,i),is_default:null!==(n=t.is_default)&&void 0!==n&&n,active:null!==(r=t.active)&&void 0!==r&&r}})},a=e=>{switch(e){case i.ac.DATA_CATEGORY:return r.J.DATA_CATEGORY;case i.ac.DATA_SUBJECT:return r.J.DATA_SUBJECT;case i.ac.DATA_USE:return r.J.DATA_USE;default:return e}}},46638:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eq}});var r,i,l=n(24246),a=n(39158),s=n(69238),o=n.n(s),d=n(63662),u=n(27378),c=n(25980),f=n(812),m=n(77213),h=n(58754),p=n(19904),x=n(33335),v=n(39864),y=e=>{let{onClose:t}=e,[n,{isLoading:r}]=(0,v.Hb)(),i=(0,a.UD8)(),s=async e=>{var r;let l={...e,taxonomy_type:(0,x.E)(null!==(r=e.name)&&void 0!==r?r:"")},a=await n(l);if((0,f.D4)(a)){i.error((0,f.e$)(a.error));return}i.success("Taxonomy created successfully"),t()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.AntTypography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,l.jsxs)(a.PPS,{layout:"vertical",onFinish:s,validateTrigger:["onBlur","onChange"],children:[(0,l.jsx)(a.PPS.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,l.jsx)(a.uFc,{"data-testid":"input-name"})}),(0,l.jsx)(a.PPS.Item,{label:"Description",name:"description",children:(0,l.jsx)(a.uFc.TextArea,{rows:2,"data-testid":"input-description"})}),(0,l.jsxs)(a.jqI,{gap:"small",justify:"space-between",children:[(0,l.jsx)(a.wpx,{onClick:t,disabled:r,children:"Cancel"}),(0,l.jsx)(a.wpx,{type:"primary",htmlType:"submit",loading:r,disabled:r,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},g=n(33162),j=n(84418),_=n(67522),T=n(66006),b=n(32885),E=n(60240),C=n(31883),A=e=>{let{taxonomy:t,onSubmit:n,formId:r,customFields:i}=e,{fides_key:s,...o}=null!=t?t:{},[d,c]=(0,u.useState)(!1),{valueTypeOptions:m}=(0,T.Z)(),h=(0,p.Tg)([E.Sh.CUSTOM_FIELD_DELETE]),[x,v]=a.$zI.useModal(),y=(0,a.UD8)(),[g]=(0,b.UF)(),{createOrUpdate:j}=(0,_.Z)(),A=async e=>{let t=await g({id:e});if((0,C.D4)(t)){y.error((0,f.e$)(t.error));return}y.success("Attribute removed successfully")},I=e=>{x.confirm({title:"Remove attribute",content:"Are you sure you want to remove this attribute?",onOk:()=>A(e),okText:"Remove",centered:!0})},S=async e=>{var t;let n=null==m?void 0:m.find(t=>t.value===e);if(!n||!s){y.error("Taxonomy type not found");return}let r=await j({name:null!==(t=n.label)&&void 0!==t?t:n.value,value_type:n.value,resource_type:s},void 0,void 0);if((0,C.D4)(r)){y.error((0,f.e$)(r.error));return}y.success("Attribute added successfully"),c(!1)};return(0,l.jsxs)(a.jqI,{vertical:!0,gap:"large",children:[v,(0,l.jsx)(a.Yfl,{children:(0,l.jsx)(a.Yfl.Item,{label:"Fides key",children:s})}),(0,l.jsxs)(a.PPS,{id:r,layout:"vertical",initialValues:o,onFinish:n,children:[(0,l.jsx)(a.PPS.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,l.jsx)(a.uFc,{})}),(0,l.jsx)(a.PPS.Item,{label:"Description",name:"description",children:(0,l.jsx)(a.uFc.TextArea,{})})]}),d&&(0,l.jsx)(a.WPr,{options:m,defaultOpen:!0,"aria-label":"Attribute type",onSelect:S}),!d&&(0,l.jsx)(a.wpx,{onClick:()=>c(!0),icon:(0,l.jsx)(a.PJP.mm_,{}),children:"Add attribute"}),(0,l.jsx)(a.krs,{children:i.map(e=>(0,l.jsx)(a.krs.Item,{actions:h?[(0,l.jsx)(a.wpx,{type:"link",onClick:()=>I(e.id),children:"Remove"},"remove")]:void 0,children:(0,l.jsx)(a.krs.Item.Meta,{title:e.name,description:e.description})},e.id))})]})};let I="custom-taxonomy-form";var S=e=>{let{taxonomy:t,onClose:n,onDelete:r,...i}=e,[s,{isLoading:o}]=(0,v.Km)(),d=(0,a.UD8)(),{sortedCustomFieldDefinitionIds:u,idToCustomFieldDefinition:c}=(0,g.mZ)({resourceType:t.fides_key}),m=u.map(e=>c.get(e)).sort((e,t)=>{var n,r;return(null!==(n=e.created_at)&&void 0!==n?n:"").localeCompare(null!==(r=t.created_at)&&void 0!==r?r:"")}),h=async e=>{if(!t.fides_key){d.error("Taxonomy not found");return}let n=await s({fides_key:t.fides_key,...e});if((0,f.D4)(n)){d.error((0,f.e$)(n.error));return}d.success("Taxonomy updated successfully")};return(0,l.jsx)(j.d,{title:"Edit ".concat(null==t?void 0:t.name),...i,itemKey:"",open:!!t,onClose:n,destroyOnHidden:!0,footer:(0,l.jsxs)(a.jqI,{justify:"space-between",className:"w-full",children:[(0,l.jsx)(a.wpx,{onClick:r,children:"Delete"}),(0,l.jsx)(a.wpx,{type:"primary",htmlType:"submit",form:I,loading:o,children:"Save"})]}),children:(0,l.jsx)(A,{taxonomy:t,onSubmit:h,formId:I,customFields:m})})},N=n(79806),k=n(56358),O=n(46628),w=n(59001),P=n(90673),R=n(30002),L=n(28079),D=n(69353),M=n(5785),F=e=>{let{taxonomyType:t}=e,[n,r]=(0,M.Vj)(),[i,l]=(0,R.nC)(),[a,s]=(0,L.dk)(),[o,d]=(0,D.cw)(),[c,f]=(0,M.Ti)(),[m,h]=(0,L.Ql)(),[p,x]=(0,R.wG)(),[y,g]=(0,D.Nr)(),[j]=(0,M.jU)(),[_]=(0,L.LG)(),[T]=(0,R.h8)(),[b]=(0,D.Xz)(),[E]=(0,M.K9)(),[C]=(0,L.gu)(),[A]=(0,R.Kv)(),[I]=(0,D.Uv)(),[S,N]=(0,v.ci)(),[k,O]=(0,v.J1)(),[P]=(0,v.Cy)(),[F]=(0,v.d9)(),V=(0,u.useCallback)(()=>t?S(t):Promise.resolve(void 0),[t,S]),H=(0,u.useCallback)(e=>t?k({taxonomyType:t,...e}):Promise.resolve(void 0),[t,k]),z=(0,u.useCallback)(e=>t?P({taxonomyType:t,...e}):Promise.resolve(void 0),[t,P]),U=(0,u.useCallback)(e=>t?F({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,F]);return t===w.ac.DATA_CATEGORY?{getAllTrigger:n,taxonomyItems:r.data||[],updateTrigger:j,deleteTrigger:E,createTrigger:c,isLoading:r.isLoading,isError:r.isError,isCreating:f.isLoading}:t===w.ac.DATA_USE?{getAllTrigger:a,taxonomyItems:s.data||[],updateTrigger:_,deleteTrigger:C,createTrigger:m,isLoading:s.isLoading,isError:s.isError,isCreating:h.isLoading}:t===w.ac.DATA_SUBJECT?{getAllTrigger:i,taxonomyItems:l.data||[],updateTrigger:T,deleteTrigger:A,createTrigger:p,isLoading:l.isLoading,isError:l.isError,isCreating:x.isLoading}:t===w.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:b,deleteTrigger:I,createTrigger:y,isLoading:d.isLoading,isError:d.isError,isCreating:g.isLoading}:{getAllTrigger:V,taxonomyItems:(null==N?void 0:N.data)||[],updateTrigger:z,deleteTrigger:U,createTrigger:H,isLoading:(null==N?void 0:N.isLoading)||!1,isError:(null==N?void 0:N.isError)||!1,isCreating:O.isLoading}},V=n(90104),H=n.n(V),z=n(20987),U=n(18225),Y=e=>{let{taxonomyKey:t,...n}=e,{data:r,isLoading:i}=(0,v.Jy)(t);return r?(0,l.jsx)(a.WPr,{options:r.map(e=>{var t;return{value:e.fides_key,label:null!==(t=e.name)&&void 0!==t?t:e.fides_key}}),loading:i,...n}):null},B=e=>{let{customFields:t,formId:n,form:r}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:s,isEnabled:o,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return o&&0!==u.length?(0,l.jsx)(a.PPS,{form:r,name:n,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:d?(0,l.jsx)(U.Z,{}):(0,l.jsx)("div",{children:!H()(u)&&(0,l.jsx)("div",{children:u.map(e=>{let n=s.get(e);if(!n)return null;let{id:r,name:o,description:d,allow_list_id:u,field_type:c}=n;if(!u)return(0,l.jsx)(a.PPS.Item,{name:r,label:o,tooltip:d,children:c===z.H.STRING?(0,l.jsx)(a.uFc,{}):(0,l.jsx)(Y,{taxonomyKey:c,defaultValue:t.customFieldValues[r]})},e);let f=i.get(n.allow_list_id);if(!f)return null;let{options:m}=f;return(0,l.jsx)(a.PPS.Item,{name:r,label:o,tooltip:d,children:(0,l.jsx)(a.WPr,{mode:c!==z.H.STRING?"multiple":void 0,allowClear:!0,options:m})},e)})})})}):null},q=n(43551),G=n.n(q),W=()=>{let e=a.PPS.useFormInstance(),t=a.PPS.useWatch(["rights","values"],e);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.PPS.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,l.jsx)(a.E_O,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,l.jsx)(a.PPS.Item,{name:["rights","values"],label:"Rights",children:(0,l.jsx)(a.WPr,{mode:"multiple",options:(0,f.MM)(E.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!H()(t)&&(0,l.jsx)(a.PPS.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,l.jsx)(a.WPr,{options:(0,f.MM)(E.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},Z=n(83766),X=n.n(Z),K=n(1315),J=n(22583),$=n(92818);let Q=e=>{let{color:t,...n}=e;return(0,l.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(J.j[t],")"),border:t===E.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})};var ee=e=>{let t=Object.values(E.Ej).map(e=>({value:e,label:(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(Q,{color:e}),(0,l.jsx)("span",{children:$.r[e]})]})}));return(0,l.jsx)(a.WPr,{...e,options:t,placeholder:"Select color"})};let et="all-suggested";var en=e=>{let{initialValues:t,onSubmit:n,form:r,formId:i,isDisabled:s}=e,{data:o=[],isLoading:d}=(0,L.fd)(),{data:c,isLoading:f}=(0,K.K3)(),m=(0,u.useMemo)(()=>o.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[o]),h=a.PPS.useWatch("systems",r),p=(0,u.useMemo)(()=>{var e;let t=h||[];if(!c||0===t.length)return[];let n=null!==(e=null==c?void 0:c.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return X()(null==n?void 0:n.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[c,h]),x=(0,u.useMemo)(()=>{var e;return null!==(e=null==c?void 0:c.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[c]),v=(0,u.useMemo)(()=>{let e=[],t=[];return(m.forEach(n=>{p.includes(n.value)?e.push(n):t.push(n)}),0===e.length)?t:[{label:"Select all suggested",value:et},{label:(0,l.jsxs)(a.vyj,{children:[(0,l.jsx)(a.QMR,{size:14}),(0,l.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,l.jsxs)(a.vyj,{children:[(0,l.jsx)(a.PJP.BBB,{}),(0,l.jsx)("span",{children:"All data uses"})]}),options:t}]},[m,p]);return(0,l.jsxs)(a.PPS,{name:i,initialValues:t,onFinish:e=>{var r,i;let l={...t,...e};(!(null==l?void 0:null===(r=l.rights)||void 0===r?void 0:r.values)||H()(null==l?void 0:null===(i=l.rights)||void 0===i?void 0:i.values))&&G()(l,"rights"),n(l)},layout:"vertical",form:r,children:[(0,l.jsx)(a.PPS.Item,{label:"Name",name:"name",children:(0,l.jsx)(a.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:s})}),(0,l.jsx)(a.PPS.Item,{label:"Description",name:"description",children:(0,l.jsx)(a.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:s})}),(0,l.jsx)(a.PPS.Item,{label:"Systems",name:"systems",children:(0,l.jsx)(a.WPr,{mode:"multiple",placeholder:"Select systems",options:x,allowClear:!0,loading:f,disabled:s,"data-testid":"edit-taxonomy-form_systems"})}),(0,l.jsx)(a.PPS.Item,{label:"Color",name:"label_color",children:(0,l.jsx)(ee,{disabled:s,"data-testid":"edit-taxonomy-form_color"})}),(0,l.jsx)(a.PPS.Item,{label:"Data uses",name:"data_uses",children:(0,l.jsx)(a.WPr,{mode:"multiple",placeholder:"Select data uses",options:v,allowClear:!0,loading:d,disabled:s,onChange:e=>{if(e.includes(et)){let t=X()([...p,...e.filter(e=>e!==et)]);r.setFieldsValue({data_uses:t})}else r.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},er=e=>{let{initialValues:t,onSubmit:n,form:r,formId:i,taxonomyType:s,isDisabled:o}=e,d=s===w.ac.DATA_SUBJECT;return s===w.ac.SYSTEM_GROUP?(0,l.jsx)(en,{initialValues:t,onSubmit:n,form:r,formId:i,isDisabled:o}):(0,l.jsxs)(a.PPS,{name:i,initialValues:t,onFinish:e=>{var r,i;let l={...t,...e};(!(null==l?void 0:null===(r=l.rights)||void 0===r?void 0:r.values)||H()(null==l?void 0:null===(i=l.rights)||void 0===i?void 0:i.values))&&G()(l,"rights"),n(l)},layout:"vertical",form:r,children:[(0,l.jsx)(a.PPS.Item,{label:"Name",name:"name",children:(0,l.jsx)(a.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:o})}),(0,l.jsx)(a.PPS.Item,{label:"Description",name:"description",children:(0,l.jsx)(a.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:o})}),d&&(0,l.jsx)(W,{})]})},ei=e=>{let{taxonomyItem:t,taxonomyType:n,onClose:r}=e,i="edit-taxonomy-form",[s]=a.PPS.useForm(),[o]=a.PPS.useForm(),d=(0,a.pmc)(),{isOpen:u,onOpen:c,onClose:m}=(0,a.qY0)(),{updateTrigger:h}=F({taxonomyType:n}),x=(0,P.Xl)(n),v=(0,g.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:x}),y=(0,p.Tg)([(0,w.aq)(n).UPDATE]),j=(0,p.Tg)([(0,w.aq)(n).DELETE]),_=async e=>{let n=await h(e);if((0,C.D4)(n)){d((0,O.Vo)((0,f.e$)(n.error)));return}if(v.isEnabled){let e=o.getFieldsValue();await v.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,O.t5)("Taxonomy successfully updated")),r()},T=async()=>{await h({...t,active:!1}),m(),r()},b=async()=>{await h({...t,active:!0}),m(),r()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(N.ZP,{isOpen:!!t,onClose:r,header:(0,l.jsx)(N.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,l.jsxs)(a.zeN,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&j&&(0,l.jsx)(a.esZ,{title:"Delete label",children:(0,l.jsx)(a.wpx,{"aria-label":"delete",icon:(0,l.jsx)(k.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&y&&(0,l.jsx)(a.esZ,{title:"Enable label",children:(0,l.jsx)(a.wpx,{"aria-label":"enable",onClick:b,"data-testid":"enable-btn",icon:(0,l.jsx)(a.tEF,{fontSize:"small"})})}),(0,l.jsx)("div",{className:"flex gap-2",children:y&&(0,l.jsx)(a.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:i,children:"Save"})})]}),children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsx)(a.AntTypography.Title,{level:3,children:"Details"})}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,l.jsx)(a.esZ,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,l.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,l.jsx)(er,{initialValues:t,onSubmit:_,form:s,formId:i,taxonomyType:n,isDisabled:!y}),v.isEnabled&&!v.isLoading&&(0,l.jsx)(B,{form:o,formId:"custom-fields-form",customFields:v})]}),(0,l.jsx)(a.cVQ,{isOpen:u,onClose:m,onConfirm:T,title:"Delete ".concat(n),message:(0,l.jsx)(a.Kqy,{children:(0,l.jsxs)(a.xvT,{children:["You are about to permanently delete the ",n," ",(0,l.jsx)(a.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};n(51901);var el=n(86298),ea=n(3124),es=n.n(ea);(r=i||(i={})).DEFAULT="DEFAULT",r.ACTIVE_HOVER="ACTIVE_HOVER",r.PARENT_OF_HOVER="PARENT_OF_HOVER",r.CHILD_OF_HOVER="CHILD_OF_HOVER",r.SIBLING_OF_HOVER="SIBLING_OF_HOVER",r.INACTIVE="INACTIVE";let eo=(0,u.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),ed=e=>{let{children:t}=e,[n,r]=(0,u.useState)(null),i=(0,u.useCallback)(e=>{e!==n&&r(e)},[n]),a=(0,u.useCallback)(()=>{r(null)},[]),s=(0,u.useCallback)(e=>n?e===n?"ACTIVE_HOVER":n.startsWith("".concat(e,"."))||e===w.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(n,"."))||n===w.Ch?"CHILD_OF_HOVER":n.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[n]),o=(0,u.useMemo)(()=>({activeNodeKey:n,setActiveNodeKey:r,onMouseEnter:i,onMouseLeave:a,getNodeHoverStatus:s}),[n,r,i,a,s]);return(0,l.jsx)(eo.Provider,{value:o,children:t})};function eu(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function ec(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=em)):void 0===t&&(t=ef);for(var n,r,i,l,a,s=new ex(e),o=[s];n=o.pop();)if((i=t(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,l=a-1;l>=0;--l)o.push(r=i[l]=new ex(i[l])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ep)}function ef(e){return e.children}function em(e){return Array.isArray(e)?e[1]:null}function eh(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function ep(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ex(e){this.data=e,this.depth=this.height=0,this.parent=null}function ev(e,t){return e.parent===t.parent?1:2}function ey(e){var t=e.children;return t?t[0]:e.t}function eg(e){var t=e.children;return t?t[t.length-1]:e.t}function ej(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function e_(e){return null==e?null:function(e){if("function"!=typeof e)throw Error();return e}(e)}ex.prototype=ec.prototype={constructor:ex,count:function(){return this.eachAfter(eu)},each:function(e,t){let n=-1;for(let r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,l=this,a=[l],s=[],o=-1;l=a.pop();)if(s.push(l),n=l.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;l=s.pop();)e.call(t,l,++o,this);return this},eachBefore:function(e,t){for(var n,r,i=this,l=[i],a=-1;i=l.pop();)if(e.call(t,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)l.push(n[r]);return this},find:function(e,t){let n=-1;for(let r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)r.push(t=t.parent);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return ec(this).eachBefore(eh)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,l=[i];do for(e=l.reverse(),l=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)l.push(t[n]);while(l.length)}},ej.prototype=Object.create(ex.prototype);var eT={depth:-1},eb={},eE={};function eC(e){return e.id}function eA(e){return e.parentId}function eI(e){let t=e.length;if(t<2)return"";for(;--t>1&&!eS(e,t););return e.slice(0,t)}function eS(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if((1&n)==0)return!0}return!1}let eN=function(){var e=ev,t=1,n=1,r=null;function i(i){var o=function(e){for(var t,n,r,i,l,a=new ej(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=Array(l=r.length),i=l-1;i>=0;--i)s.push(n=t.children[i]=new ej(r[i],i)),n.parent=t;return(a.parent=new ej(null,0)).children=[a],a}(i);if(o.eachAfter(l),o.parent.m=-o.z,o.eachBefore(a),r)i.eachBefore(s);else{var d=i,u=i,c=i;i.eachBefore(function(e){e.x<d.x&&(d=e),e.x>u.x&&(u=e),e.depth>c.depth&&(c=e)});var f=d===u?1:e(d,u)/2,m=f-d.x,h=t/(u.x+f+m),p=n/(c.depth||1);i.eachBefore(function(e){e.x=(e.x+m)*h,e.y=e.depth*p})}return i}function l(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,l=i.length;--l>=0;)t=i[l],t.z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var l=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-l):t.z=l}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,l,a,s=t,o=t,d=n,u=s.parent.children[0],c=s.m,f=o.m,m=d.m,h=u.m;d=eg(d),s=ey(s),d&&s;)u=ey(u),(o=eg(o)).a=t,(a=d.z+m-s.z-c+e(d._,s._))>0&&(function(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}((i=d,l=r,i.a.parent===t.parent?i.a:l),t,a),c+=a,f+=a),m+=d.m,c+=s.m,h+=u.m,f+=o.m;d&&!eg(o)&&(o.t=d,o.m+=m-f),s&&!ey(u)&&(u.t=s,u.m+=c-h,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}();var ek=e=>{let{nodes:t,edges:n,options:r}=e;return(0,u.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:n};let e=(function(){var e,t=eC,n=eA;function r(r){var i,l,a,s,o,d,u,c,f=Array.from(r),m=t,h=n,p=new Map;if(null!=e){let t=f.map((t,n)=>{var i;let l;return i=e(t,n,r),l=(i=`${i}`).length,eS(i,l-1)&&!eS(i,l-2)&&(i=i.slice(0,-1)),"/"===i[0]?i:`/${i}`}),n=t.map(eI),i=new Set(t).add("");for(let e of n)i.has(e)||(i.add(e),t.push(e),n.push(eI(e)),f.push(eE));m=(e,n)=>t[n],h=(e,t)=>n[t]}for(a=0,i=f.length;a<i;++a)l=f[a],d=f[a]=new ex(l),null!=(u=m(l,a,r))&&(u+="")&&(c=d.id=u,p.set(c,p.has(c)?eb:d)),null!=(u=h(l,a,r))&&(u+="")&&(d.parent=u);for(a=0;a<i;++a)if(u=(d=f[a]).parent){if(!(o=p.get(u)))throw Error("missing: "+u);if(o===eb)throw Error("ambiguous: "+u);o.children?o.children.push(d):o.children=[d],d.parent=o}else{if(s)throw Error("multiple roots");s=d}if(!s)throw Error("no root");if(null!=e){for(;s.data===eE&&1===s.children.length;)s=s.children[0],--i;for(let e=f.length-1;e>=0&&(d=f[e]).data===eE;--e)d.data=null}if(s.parent=eT,s.eachBefore(function(e){e.depth=e.parent.depth+1,--i}).eachBefore(ep),s.parent=null,i>0)throw Error("cycle");return s}return r.id=function(e){return arguments.length?(t=e_(e),r):t},r.parentId=function(e){return arguments.length?(n=e_(e),r):n},r.path=function(t){return arguments.length?(e=e_(t),r):e},r})().id(e=>e.id).parentId(e=>{var t;return null===(t=n.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),i="LR"===r.direction?[35,320]:[320,35];return{nodes:eN.nodeSize(i).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===r.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:n}},[t,n,r])},eO=e=>{let{positionAbsoluteX:t,positionAbsoluteY:n,nodeWidth:r}=e,{setCenter:i,getZoom:l}=(0,el._K)();return{centerScreenOnNode:(0,u.useCallback)(()=>i(t+r/2,n,{duration:500,zoom:l()}),[l,t,n,r,i])}},ew=n(1945),eP=n.n(ew),eR=n(8335),eL=e=>{let{type:t,inactive:n=!1}=e;return(0,l.jsx)(el.HH,{type:t,position:"source"===t?eR.Ly.Right:eR.Ly.Left,style:{width:8,height:8,backgroundColor:n?es().FIDESUI_NEUTRAL_400:es().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},eD=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:r}=e,{onCancel:i,onSubmit:s,parentKey:o,isLoading:d=!1}=t,c=(0,u.useRef)(null),[f,m]=(0,u.useState)(""),{centerScreenOnNode:h}=eO({positionAbsoluteX:n,positionAbsoluteY:r,nodeWidth:200});(0,u.useEffect)(()=>{m("");let e=()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await h(),e()})()},[o,h,n,r]);let p=()=>{!d&&f.trim()&&s(f)},x=()=>{d||i()};return(0,l.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,l.jsx)(a.uFc,{placeholder:"Type label name...",ref:c,onBlur:x,onSubmit:p,value:f,onChange:e=>m(e.target.value),onKeyUp:e=>{"Escape"===e.key&&x()},onPressEnter:p,className:eP().input,suffix:d&&(0,l.jsx)(a.ZJQ,{size:"small"})}),(0,l.jsx)(eL,{type:"target"})]})},eM=e=>{let{getNodeHoverStatus:t}=(0,u.useContext)(eo),{target:n}=e,r=t(n),a=(0,u.useCallback)(()=>{switch(r){case i.ACTIVE_HOVER:case i.PARENT_OF_HOVER:return es().FIDESUI_MINOS;case i.INACTIVE:return es().NEUTRAL_400;default:return es().FIDESUI_SANDSTONE}},[r]),s=(0,u.useCallback)(()=>{switch(r){case i.ACTIVE_HOVER:case i.PARENT_OF_HOVER:return 2;default:return 1}},[r]);return(0,l.jsx)(el.Jd,{...e,style:{stroke:a(),strokeWidth:s(),transition:"stroke 0.3s ease 0s"}})},eF=n(34770),eV=n.n(eF),eH=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:r}=e,{onMouseEnter:s,onMouseLeave:o,getNodeHoverStatus:d}=(0,u.useContext)(eo),{taxonomyType:c,taxonomyItem:f,onAddButtonClick:m,onTaxonomyItemClick:h,label:p,hasChildren:x,isLastCreatedItem:v,resetLastCreatedItemKey:y,userCanAddLabels:g}=t,{centerScreenOnNode:j}=eO({positionAbsoluteX:n,positionAbsoluteY:r,nodeWidth:200});(0,u.useEffect)(()=>{let e=async()=>{await j(),s(null==f?void 0:f.fides_key)};v&&(e(),y())},[v,s,null==f?void 0:f.fides_key,y,j]);let _=d(null==f?void 0:f.fides_key),T=(0,u.useCallback)(()=>{switch(_){case i.ACTIVE_HOVER:return eV()["button--hover"];case i.PARENT_OF_HOVER:return eV()["button--parent-hover"];case i.INACTIVE:return eV()["button--inactive"];case i.DEFAULT:case i.CHILD_OF_HOVER:case i.SIBLING_OF_HOVER:default:return""}},[_]),b=(null==f?void 0:f.fides_key)===w.Ch,E=c===w.ac.DATA_SUBJECT;return(0,l.jsxs)("div",{className:eV().container,onMouseEnter:()=>s(null==f?void 0:f.fides_key),onMouseLeave:()=>o(null==f?void 0:f.fides_key),"data-testid":"taxonomy-node-".concat(null==f?void 0:f.fides_key),children:[(0,l.jsx)(a.wpx,{className:"".concat(eV().button," ").concat(T()),onClick:()=>null==h?void 0:h(f),disabled:!h,type:"text",children:(0,l.jsxs)(a.AntTypography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==f?void 0:f.active)===!1?"(disabled) ":"",p]})}),!b&&(0,l.jsx)(eL,{type:"target",inactive:_===i.INACTIVE}),x&&(0,l.jsx)(eL,{type:"source",inactive:_===i.INACTIVE}),g&&(!E||b)&&(0,l.jsx)("div",{className:eV()["add-button-container"],children:(0,l.jsx)(a.wpx,{type:"default",className:"".concat(eV()["add-button"]," ").concat(_===i.ACTIVE_HOVER?eV()["add-button--visible"]:""),icon:(0,l.jsx)(a.PJP.mm_,{size:20}),onClick:()=>null==m?void 0:m(f),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(p)})})]})};let ez=e=>{let{taxonomyType:t,taxonomyItems:n,draftNewItem:r,lastCreatedItemKey:i,resetLastCreatedItemKey:a,onRootItemClick:s,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:c,onSubmitDraftItem:f,userCanAddLabels:m,isCreating:h=!1,rootNodeLabel:p}=e,{fitView:x}=(0,el._K)();(0,u.useEffect)(()=>{setTimeout(()=>x(),150)},[x,t,n.length]);let v=[(0,u.useMemo)(()=>({id:w.Ch,position:{x:0,y:0},data:{label:p||t,taxonomyItem:{fides_key:w.Ch},taxonomyType:t,onTaxonomyItemClick:s,onAddButtonClick:d,hasChildren:0!==n.length,userCanAddLabels:m},type:"taxonomyTreeNode"}),[p,t,s,d,n.length,m])],y=[];if(n.forEach(e=>{let n=e.name||e.fides_key.split(".").pop()||"",r={id:e.fides_key,position:{x:0,y:0},data:{label:n,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:i===e.fides_key,resetLastCreatedItemKey:a,userCanAddLabels:m},type:"taxonomyTreeNode"};v.push(r);let l=e.parent_key?v.find(t=>t.id===e.parent_key):null,s=l?l.id:w.Ch,u=e.fides_key,c={id:"".concat(s,"-").concat(u),source:s,target:u,type:"taxonomyTreeEdge"};y.push(c),l&&(l.data.hasChildren=!0)}),r){let e=r.parent_key||w.Ch;v.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:c,onSubmit:f,isLoading:h},hidden:!r}),y.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=v.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:g,edges:j}=ek({nodes:v,edges:y,options:{direction:"LR"}}),_=(0,u.useMemo)(()=>({taxonomyTreeNode:eH,textInputNode:eD}),[]),T=(0,u.useMemo)(()=>({taxonomyTreeEdge:eM}),[]);return(0,l.jsx)("div",{className:"size-full",style:{backgroundColor:es().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,l.jsx)(ed,{children:(0,l.jsxs)(el.x$,{nodes:g,edges:j,nodeTypes:_,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,l.jsx)(el.Aq,{color:es().FIDESUI_NEUTRAL_100,variant:el.T7.Dots,size:3}),(0,l.jsx)(el.a9,{nodeStrokeWidth:3,pannable:!0}),(0,l.jsx)(el.ZX,{showInteractive:!1})]})})})};var eU=e=>(0,l.jsx)(el.tV,{children:(0,l.jsx)(ez,{...e})});let eY="add new item",eB=w.ac.DATA_CATEGORY;var eq=()=>{let[e,t]=(0,u.useState)(eB),n=!Object.values(w.ac).includes(e),r=(0,c.hz)().plus,{data:i}=(0,v.MU)(void 0,{skip:!r}),{createTrigger:s,getAllTrigger:x,taxonomyItems:g=[],isCreating:j}=F({taxonomyType:e}),_=(0,d.useSearchParams)(),T=(null==_?void 0:_.get("showDisabledItems"))==="true",b=(0,a.UD8)();(0,u.useEffect)(()=>{x()},[x,e]);let[E,C]=(0,u.useState)(null),[A,I]=(0,u.useState)(null),[N,k]=(0,u.useState)(null),[O,P]=(0,u.useState)(null),[R,L]=a.$zI.useModal(),[D]=(0,v.EO)(),M=async()=>{if(!(null==A?void 0:A.fides_key)){b.error("Taxonomy not found");return}let e=await D(A.fides_key);if((0,f.D4)(e)){b.error((0,f.e$)(e.error));return}b.success("Taxonomy deleted successfully"),I(null),t(eB)},V=(0,u.useMemo)(()=>{var t;if(!i)return null;let n=i.find(t=>t.fides_key===e);return null!==(t=null==n?void 0:n.name)&&void 0!==t?t:null==n?void 0:n.fides_key},[i,e]),[H,z]=(0,u.useState)(!1);(0,u.useEffect)(()=>{k(null),P(null),C(null)},[e]),(0,u.useEffect)(()=>{e!==w.ac.SYSTEM_GROUP||r||t(w.ac.DATA_CATEGORY)},[e,r]);let U=(0,u.useCallback)(async e=>{if(!N)return;let t=(null==N?void 0:N.parent_key)===w.Ch,n={...N,name:e,parent_key:t?null:N.parent_key},r=await s(n);if((0,f.D4)(r)){b.error((0,f.e$)(r.error));return}P(r.data.fides_key),b.success("New label successfully created"),k(null)},[s,N,b]),Y=o()(g,"active"),B=(0,p.Tg)([(0,w.aq)(e).CREATE]);return(0,l.jsxs)(m.Z,{title:"Taxonomy",children:[L,(0,l.jsxs)(a.jqI,{vertical:!0,className:"h-full",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(h.Z,{heading:"Taxonomy"}),(0,l.jsx)("div",{className:"hidden",children:(0,l.jsx)("div",{className:"mb-5 flex justify-between",children:(0,l.jsxs)(a.vyj.Compact,{children:[(0,l.jsx)(a.uFc,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,l.jsx)(a.wpx,{type:"default",children:"Clear"})]})})})]}),(0,l.jsxs)("div",{className:"relative grow",children:[(0,l.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,l.jsx)(a.AHg,{selectedKeys:[e],onSelect:e=>{let{key:n}=e;if(n===eY){z(!0);return}t(n)},items:(()=>{let e={[w.Lo.DATA_CATEGORIES]:w.ac.DATA_CATEGORY,[w.Lo.DATA_USES]:w.ac.DATA_USE,[w.Lo.DATA_SUBJECTS]:w.ac.DATA_SUBJECT,[w.Lo.SYSTEM_GROUPS]:w.ac.SYSTEM_GROUP},t=(0,f.MM)(w.Lo).filter(e=>r||e.value!==w.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==i?void 0:i.length)&&i.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),r&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:eY})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,l.jsx)(a.$zI,{open:H,destroyOnHidden:!0,onCancel:()=>z(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,l.jsx)(y,{onClose:()=>z(!1)})}),(0,l.jsx)(eU,{userCanAddLabels:B,taxonomyItems:T?g:Y,draftNewItem:N,lastCreatedItemKey:O,resetLastCreatedItemKey:()=>P(null),onTaxonomyItemClick:e=>{C(e)},onRootItemClick:n?()=>{let t=null==i?void 0:i.find(t=>t.fides_key===e);t&&I(t)}:null,onAddButtonClick:e=>{var t;k({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:e,onCancelDraftItem:()=>k(null),onSubmitDraftItem:U,isCreating:j,rootNodeLabel:null!=V?V:(0,w._g)(e)})]})]}),E&&(0,l.jsx)(ei,{taxonomyItem:E,taxonomyType:e,onClose:()=>C(null)}),r&&A&&(0,l.jsx)(S,{title:V?"Edit ".concat(V):"Edit taxonomy",onClose:()=>I(null),onDelete:()=>{R.confirm({title:"Delete ".concat(null==A?void 0:A.name,"?"),icon:null,content:(0,l.jsx)(a.AntTypography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:M,centered:!0})},taxonomy:A})]})}},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}},function(e){e.O(0,[1096,431,3662,1533,7245,590,2888,9774,179],function(){return e(e.s=71180)}),_N_E=e.O()}]);