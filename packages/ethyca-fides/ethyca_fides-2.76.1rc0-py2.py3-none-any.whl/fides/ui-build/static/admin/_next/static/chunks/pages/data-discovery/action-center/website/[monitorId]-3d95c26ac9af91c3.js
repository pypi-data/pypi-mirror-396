(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1206],{55515:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/website/[monitorId]",function(){return s(56497)}])},56497:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var n=s(24246),a=s(39158),i=s(86677),l=s(25980),o=s(35287),r=s(77830),c=s(58754),u=s(25415),d=s(60240),m=s(30952),v=s(27378),y=s(812),f=s(8125),b=s(46628),h=s(37059),_=s(98145),p=s(9320),g=s(71985),w=s(88708),k=s(66213);let j=e=>{let{monitorId:t,readonly:s,allowIgnore:n,onTabChange:a,consentStatus:i,rowClickUrl:l,resourceType:o}=e,[r,c]=(0,v.useState)(!1),[u,d]=(0,v.useState)(!1),[m,y]=(0,v.useState)(!1),[f,b]=(0,v.useState)(0),[h,_]=(0,v.useState)(0),[p,g]=(0,v.useState)(0);return{columns:(0,v.useMemo)(()=>{if((0,k.yu)(o))return(0,k.b$)({rowClickUrl:l});let e={monitorId:t,readonly:s,allowIgnore:n,onTabChange:a,consentStatus:i,rowClickUrl:l,isDataUsesExpanded:m,isLocationsExpanded:r,isDomainsExpanded:u,dataUsesVersion:p,locationsVersion:f,domainsVersion:h,setIsDataUsesExpanded:y,setIsLocationsExpanded:c,setIsDomainsExpanded:d,setDataUsesVersion:g,setLocationsVersion:b,setDomainsVersion:_};return s?(0,k.Ah)(e):(0,k.xg)(e)},[s,i,l,m,r,u,p,f,h,t,n,a,o])}},x=e=>{let{monitorId:t}=e,s=(0,i.useRouter)(),l=(0,a.pmc)(),[o,c]=(0,v.useState)(),u=(0,f.o)({sorting:{validColumns:Object.values(_.vQ)}}),{pageIndex:m,pageSize:k,searchQuery:x,updateSearch:S,resetState:E}=u,{filterTabs:C,activeTab:A,onTabChange:I,activeParams:P,actionsDisabled:N}=(0,w.Z)(),{data:R,isLoading:T,isFetching:L}=(0,h.wi)({key:t,page:m,size:k,search:x,...P}),[M,{isLoading:D}]=(0,h.rs)(),[z,{isLoading:K}]=(0,h.nP)(),O=(0,v.useCallback)(e=>{var t,s,n;return null!==(n=null!==(s=null!==(t=e.id)&&void 0!==t?t:e.vendor_id)&&void 0!==s?s:e.name)&&void 0!==n?n:r.Kl},[]),U=(0,v.useCallback)(e=>{var s;let n=null!==(s=e.id)&&void 0!==s?s:r.Kl,a=A?"#".concat(A):"";return"".concat(r.vi,"/").concat(g.w.WEBSITE,"/").concat(t,"/").concat(n).concat(a)},[t,A]),V=(0,v.useMemo)(()=>({enableSelection:!0,getRowKey:O,isLoading:T,isFetching:L,dataSource:(null==R?void 0:R.items)||[],totalRows:(null==R?void 0:R.total)||0,customTableProps:{locale:{emptyText:(0,n.jsx)(a.oj8,{image:a.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})},sticky:{offsetHeader:40}}}),[O,T,L,null==R?void 0:R.items,null==R?void 0:R.total]),Z=(0,f.V)(u,V),{selectedRows:q,resetSelections:F}=Z,$=(0,v.useCallback)(async e=>{c(void 0),await I(e),E(),F()},[I,E,F]),{columns:B}=j({monitorId:t,onTabChange:$,readonly:N,allowIgnore:!("diff_status"in P)||!P.diff_status.includes(d.LL.MUTED),consentStatus:o,rowClickUrl:U});(0,v.useEffect)(()=>{if((null==R?void 0:R.items)&&!o){var e;let t=null===(e=R.items.find(e=>{var t;return(null===(t=e.consent_status)||void 0===t?void 0:t.status)===d.pF.ALERT}))||void 0===e?void 0:e.consent_status;c(null!=t?t:void 0)}},[R,o]);let G=(0,v.useCallback)(async()=>{let e=q.reduce((e,t)=>e+t.total_updates,0),n=await M({monitor_config_key:t,resolved_system_ids:q.map(e=>e.id)});(0,y.D4)(n)?l((0,b.Vo)((0,y.e$)(n.error))):(l((0,b.t5)((0,p._)("".concat(e," assets have been added to the system inventory."),()=>s.push(r.So)))),F())},[q,M,t,l,s,F]),H=(0,v.useCallback)(async()=>{let e=q.reduce((e,t)=>e+t.total_updates,0),s=await z({monitor_config_key:t,resolved_system_ids:q.map(e=>{var t;return null!==(t=e.id)&&void 0!==t?t:r.Kl})});(0,y.D4)(s)?l((0,b.Vo)((0,y.e$)(s.error))):(l((0,b.t5)((0,p._)("".concat(e," assets have been ignored and will not appear in future scans."),async()=>{await I(w.A.IGNORED)}))),F())},[q,z,t,l,I,F]),X=q.some(e=>null===e.id);return{columns:B,data:R,isLoading:T,isFetching:L,searchQuery:x,updateSearch:S,resetState:E,tableProps:Z.tableProps,selectionProps:Z.selectionProps,filterTabs:C,activeTab:A,handleTabChange:$,activeParams:P,actionsDisabled:N,selectedRows:q,hasSelectedRows:Z.hasSelectedRows,resetSelections:F,uncategorizedIsSelected:X,handleBulkAdd:G,handleBulkIgnore:H,anyBulkActionIsLoading:D||K,isAddingResults:D,isIgnoringResults:K}},S=e=>{let{monitorId:t}=e,{columns:s,searchQuery:i,updateSearch:l,tableProps:o,selectionProps:r,filterTabs:c,activeTab:v,handleTabChange:y,activeParams:f,selectedRows:b,hasSelectedRows:h,uncategorizedIsSelected:_,handleBulkAdd:p,handleBulkIgnore:g,anyBulkActionIsLoading:w}=x({monitorId:t});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Niu,{"aria-label":"Asset state filter",mode:"horizontal",items:c.map(e=>({key:e.hash,label:e.label})),selectedKeys:[v],onClick:async e=>{await y(e.key)},className:"mb-4","data-testid":"asset-state-filter"}),(0,n.jsxs)(a.jqI,{justify:"space-between",align:"center",className:"sticky -top-6 z-10 bg-white py-4",children:[(0,n.jsx)(m.f,{value:i,onChange:l}),(0,n.jsxs)(a.vyj,{size:"large",children:[h&&(0,n.jsx)(u.a,{count:b.length}),(0,n.jsx)(a.S0p,{menu:{items:[{key:"add",label:(0,n.jsx)(a.esZ,{title:_?"Uncategorized assets can't be added to the inventory":null,placement:"left",children:"Add"}),onClick:p,disabled:_},"diff_status"in f&&!f.diff_status.includes(d.LL.MUTED)?{key:"ignore",label:"Ignore",onClick:g}:null]},trigger:["click"],children:(0,n.jsx)(a.wpx,{type:"primary",icon:(0,n.jsx)(a.PJP._ME,{}),iconPosition:"end",loading:w,disabled:!h,"data-testid":"bulk-actions-menu",children:"Actions"})})]})]}),(0,n.jsx)(a.V5H,{...o,columns:s,rowSelection:r})]})},E=()=>(0,n.jsx)(n.Fragment,{children:"Attempting to access monitor results without the required feature flag enabled"});var C=()=>{let{flags:e}=(0,l.hz)(),t=decodeURIComponent((0,i.useRouter)().query.monitorId);return e.webMonitor?(0,n.jsxs)(o.Z,{title:"Action center - Discovered assets by system",children:[(0,n.jsx)(c.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:r.vi},{title:t}],isSticky:!1}),(0,n.jsx)(S,{monitorId:t})]}):(0,n.jsx)(a.ux6,{status:"error",title:(0,n.jsx)(E,{})})}}},function(e){e.O(0,[431,7245,3931,4589,4809,2888,9774,179],function(){return e(e.s=55515)}),_N_E=e.O()}]);