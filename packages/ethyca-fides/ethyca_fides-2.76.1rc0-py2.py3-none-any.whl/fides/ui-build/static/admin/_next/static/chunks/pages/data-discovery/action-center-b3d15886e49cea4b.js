(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8443],{40741:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center",function(){return t(4582)}])},77213:function(e,n,t){"use strict";t.d(n,{Z:function(){return m}});var i=t(24246),s=t(39158),a=t(88038),r=t.n(a),l=t(86677);t(27378);var o=t(25980),c=t(90867),d=t(42478),u=t(77830),g=()=>{let e=(0,l.useRouter)();return(0,i.jsx)(s.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(s.xuv,{children:[(0,i.jsxs)(s.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(s.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(s.wpx,{onClick:()=>{e.push(u.AD)},children:"Configure"})]}),(0,i.jsxs)(s.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},m=e=>{let{children:n,title:t,padded:a=!0,mainProps:u}=e,m=(0,o.hz)(),p=(0,l.useRouter)(),f="/privacy-requests"===p.pathname||"/datastore-connection"===p.pathname,h=!(m.flags.messagingConfiguration&&f),{data:y}=(0,d.JE)(void 0,{skip:h}),{data:x}=(0,c.PW)(void 0,{skip:h}),v=m.flags.messagingConfiguration&&(!y||!x)&&f;return(0,i.jsxs)(s.kCb,{"data-testid":t,direction:"column",h:"100vh",children:[(0,i.jsxs)(r(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",t]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(s.kCb,{as:"main",direction:"column",py:a?6:0,px:a?10:0,h:a?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[v?(0,i.jsx)(g,{}):null,n]})]})}},14908:function(e,n,t){"use strict";var i=t(86677),s=t(27378);let a=e=>e.startsWith("#")?e.slice(1):e;n.Z=e=>{let{tabKeys:n,initialTab:t}=e,r=(0,i.useRouter)(),l=r.asPath.split("#")[1]||n[0],[o,c]=(0,s.useState)(l);return(0,s.useEffect)(()=>{t&&n.includes(t)&&c(t)},[t,n,r.isReady]),{activeTab:o,onTabChange:(0,s.useCallback)(async e=>{if(!n.includes(e)){await r.replace({pathname:r.pathname,query:r.query,hash:void 0}),c(n[0]);return}r.isReady&&(await r.replace({pathname:r.pathname,query:r.query,hash:a(e)},void 0,{shallow:!0}),c(e))},[r,n]),setActiveTab:c}}},54762:function(e,n,t){"use strict";t.d(n,{l:function(){return l}});var i=t(24246),s=t(39158),a=t(62165),r=t(60240);let l=e=>{let{consentStatus:n}=e,{flags:t}=(0,a.hz)(),{assetConsentStatusLabels:l}=t;return l&&(null==n?void 0:n.status)===r.pF.ALERT?(0,i.jsx)(s.esZ,{title:null==n?void 0:n.message,"data-testid":"discovery-status-icon-alert-tooltip",children:(0,i.jsx)("div",{className:"mb-px","data-testid":"discovery-status-icon-alert",children:(0,i.jsx)(s.PJP.OdJ,{style:{color:"var(--fidesui-error)"}})})}):null}},42478:function(e,n,t){"use strict";t.d(n,{FU:function(){return c},JE:function(){return s},Ki:function(){return u},SU:function(){return g},W:function(){return m},h9:function(){return a},jc:function(){return i},qt:function(){return o},sn:function(){return d}});let{useGetEmailInviteStatusQuery:i,useGetActiveMessagingProviderQuery:s,useCreateMessagingConfigurationMutation:a,useCreateMessagingConfigurationSecretsMutation:r,useGetMessagingConfigurationDetailsQuery:l,useGetMessagingConfigurationsQuery:o,useGetMessagingConfigurationByKeyQuery:c,useUpdateMessagingConfigurationByKeyMutation:d,useUpdateMessagingConfigurationSecretsByKeyMutation:u,useCreateTestConnectionMessageMutation:g,useDeleteMessagingConfigurationByKeyMutation:m}=t(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,n,t,i)=>{let s=await i({url:"messaging/default/active"});return s.error&&404===s.error.status?{data:null}:s},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},4582:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return em}});var i,s,a=t(24246),r=t(39158),l=t(27378),o=t(30952),c=t(25980),d=t(35287),u=t(77830),g=t(58754),m=t(9270),p=t(37059),f=t(16394),h=t(17245),y=t(67359);let x=()=>{let{resetPagination:e,pageIndex:n,pageSize:t,paginationProps:i}=(0,m.S)(),{searchQuery:s,updateSearch:o}=(0,h.Rx)(),c=(0,l.useMemo)(()=>[y.n.PENDING,y.n.IN_PROCESSING,y.n.PAUSED,y.n.RETRYING,y.n.ERROR],[]),[d,u]=(0,l.useState)(c),[g,f]=(0,l.useState)(!1),[x,v]=(0,l.useState)(c),[j,_]=(0,l.useState)(!1),C=(0,l.useCallback)(n=>{o(n),e()},[o,e]),w=(0,l.useCallback)(e=>{v(e)},[]),b=(0,l.useCallback)(e=>{_(e)},[]),k=(0,l.useCallback)(()=>{u(x),f(j),e()},[x,j,e]),E=(0,l.useCallback)(()=>{v(c),_(!1),u(c),f(!1),e()},[c,e]),S=[y.n.PENDING,y.n.IN_PROCESSING,y.n.COMPLETE,y.n.ERROR,y.n.PAUSED,y.n.RETRYING,y.n.SKIPPED],{data:N,isLoading:I,isFetching:T}=(0,p.$h)({page:n,size:t,search:s,statuses:d.length>0?d:void 0,return_dismissed:g},{pollingInterval:3e3,refetchOnFocus:!0,refetchOnReconnect:!0});return{searchQuery:s,updateSearch:C,statusFilters:x,updateStatusFilters:w,showDismissed:j,updateShowDismissed:b,applyFilters:k,resetAndApplyFilters:E,availableStatuses:S,listProps:(0,l.useMemo)(()=>({dataSource:(null==N?void 0:N.items)||[],loading:I,locale:{emptyText:(0,a.jsx)(r.oj8,{image:r.oj8.PRESENTED_IMAGE_SIMPLE,description:"No tasks in progress"})}}),[null==N?void 0:N.items,I]),paginationProps:{...i,total:null==N?void 0:N.total},isLoading:I,isFetching:T}};var v=t(10969),j=t(60145),_=t(11558),C=t(70641),w=t(7317),b=t(85302),k=t(64892);function E(e,n,t){let i;let s=(0,j.j)(),a=t?.locale??s.locale??v._,r=(0,b.U)(e,n);if(isNaN(r))throw RangeError("Invalid time value");let l=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:r}),[o,c]=(0,w.d)(t?.in,...r>0?[n,e]:[e,n]),d=(0,_.u)(t?.roundingMethod??"round"),u=c.getTime()-o.getTime(),g=u/k.yJ,m=(u-((0,C.D)(c)-(0,C.D)(o)))/k.yJ,p=t?.unit;if("second"===(i=p||(g<1?"second":g<60?"minute":g<k.H_?"hour":m<k.fH?"day":m<k.UU?"month":"year"))){let e=d(u/1e3);return a.formatDistance("xSeconds",e,l)}if("minute"===i){let e=d(g);return a.formatDistance("xMinutes",e,l)}if("hour"===i){let e=d(g/60);return a.formatDistance("xHours",e,l)}if("day"===i){let e=d(m/k.H_);return a.formatDistance("xDays",e,l)}if("month"===i){let e=d(m/k.fH);return 12===e&&"month"!==p?a.formatDistance("xYears",1,l):a.formatDistance("xMonths",e,l)}{let e=d(m/k.UU);return a.formatDistance("xYears",e,l)}}var S=t(88340),N=t(41337),I=t(60240);let{Paragraph:T,Text:M,Title:P}=r.AntTypography,A=e=>"paused"===e?"Awaiting Processing":e.split("_").map(f.kC).join(" "),R=e=>{var n,t,i,s,l,o,c,d,u,g;let{task:m,...h}=e,y=(0,r.pmc)(),[x,{isLoading:v}]=(0,p.mL)(),[j,{isLoading:_}]=(0,p.QC)(),C=!!m.dismissed,w="error"===m.status&&m.action_type!==I.K8.DETECTION,{data:b}=(0,p.Ud)({page:1,size:1e3}),k=m.monitor_config_id?null==b?void 0:null===(n=b.items)||void 0===n?void 0:n.find(e=>e.key===m.monitor_config_id):void 0,R=k?(0,N.AZ)({connection_type:k.connection_type,name:null!==(s=k.name)&&void 0!==s?s:null,key:null!==(l=k.key)&&void 0!==l?l:null,saas_config:k.saas_config?{type:null!==(o=k.saas_config.type)&&void 0!==o?o:null,name:null!==(c=k.saas_config.name)&&void 0!==c?c:null,fides_key:null!==(d=k.saas_config.fides_key)&&void 0!==d?d:null}:null,secrets:(null===(i=k.secrets)||void 0===i?void 0:i.url)?{url:k.secrets.url}:null}):m.connection_type?(0,N.AZ)({connection_type:m.connection_type,name:null!==(u=m.connection_name)&&void 0!==u?u:m.connection_type?m.connection_type.toString():null,key:null,saas_config:null,secrets:null}):void 0,O=(null===(t=m.staged_resource_urns)||void 0===t?void 0:t.length)||0,D=["pending","in_processing","paused","retrying"].includes((m.status||"").toLowerCase()),q=m.field_count||O,z=(()=>{if(m.action_type===I.K8.CLASSIFICATION||m.action_type===I.K8.LLM_CLASSIFICATION){let e="complete"===m.status?"Classified":"Classifying";return"".concat(e," ").concat(q," ").concat((0,f._6)(q,"field","fields"))}if(m.action_type===I.K8.DETECTION)return"complete"===m.status?"Monitor scanned":"Monitor scanning";if(m.action_type===I.K8.PROMOTION){let e="complete"===m.status?"Confirmed":"Confirming";return"".concat(e," ").concat(q," ").concat((0,f._6)(q,"field","fields"))}return m.action_type?m.action_type.replace(/_/g," "):"Task"})(),U=m.monitor_name||"Unknown monitor",F=async()=>{try{await x({taskId:m.id}).unwrap(),y({status:"success",description:"Task retry initiated successfully"})}catch(t){var e;let n=(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||(null==t?void 0:t.message)||"Unknown error occurred";y({status:"error",description:"Failed to retry task: ".concat(n)})}},H=async()=>{try{await j({taskId:m.id}).unwrap(),y({status:"success",description:"Task dismissed successfully"})}catch(t){var e;let n=(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||(null==t?void 0:t.message)||"Unknown error occurred";y({status:"error",description:"Failed to dismiss task: ".concat(n)})}};return(0,a.jsx)("div",{...h,className:"w-full",children:(0,a.jsxs)(r.bue,{gutter:12,className:"w-full",children:[(0,a.jsx)(r.JGx,{span:14,className:"align-middle",children:(0,a.jsxs)(r.vyj,{direction:"vertical",size:4,children:[(0,a.jsxs)(r.vyj,{align:"center",size:8,wrap:!0,children:[R&&(0,a.jsx)(N.ZP,{data:R,size:24}),(0,a.jsx)(P,{level:5,className:"m-0",children:z}),!D&&(0,a.jsx)(r.j8w,{color:(e=>{switch(e){case"pending":case"retrying":case"skipped":default:return r.tAb.DEFAULT;case"in_processing":return r.tAb.INFO;case"complete":return r.tAb.SUCCESS;case"error":return r.tAb.ERROR;case"paused":return r.tAb.MARBLE}})(m.status),children:(g=m.status)?A(g):"Unknown"})]}),"error"===m.status&&(0,a.jsxs)(r.vyj,{children:[(0,a.jsx)(T,{type:"secondary",size:"sm",ellipsis:{rows:1,expandable:!0,symbol:"more",tooltip:!0},children:m.message||"Unknown error"}),m.message&&(0,a.jsx)(S.Z,{copyText:m.message,size:"small",className:"ml-1"})]})]})}),(0,a.jsx)(r.JGx,{span:4,className:"flex items-center justify-end",children:(0,a.jsx)(M,{type:"secondary",size:"sm",children:U})}),(0,a.jsx)(r.JGx,{span:3,className:"flex items-center justify-end",children:D?(0,a.jsx)(r.ZJQ,{size:"small"}):(0,a.jsx)(M,{type:"secondary",size:"sm",children:E(new Date(m.updated_at),new Date,{addSuffix:!0})})}),(0,a.jsx)(r.JGx,{span:3,className:"flex items-center justify-end",children:"error"===m.status&&(0,a.jsxs)(r.vyj,{size:0,split:(0,a.jsx)(r.htM,{type:"vertical"}),children:[w&&(0,a.jsx)(r.wpx,{type:"link",size:"small",loading:v,onClick:F,className:"p-0",children:"Retry"}),!C&&(0,a.jsx)(r.wpx,{type:"link",size:"small",loading:_,onClick:H,className:"p-0",children:"Dismiss"})]})})]})})},O=e=>"paused"===e?"Awaiting Processing":e.split("_").map(f.kC).join(" "),D=()=>{var e,n;let[t,i]=(0,l.useState)(!1),{searchQuery:s,updateSearch:c,statusFilters:d,updateStatusFilters:u,showDismissed:g,updateShowDismissed:m,applyFilters:p,resetAndApplyFilters:f,availableStatuses:h,listProps:y,paginationProps:v}=x(),j=(0,l.useCallback)(e=>{u(e)},[u]),_=(0,l.useCallback)(()=>{p(),i(!1)},[p]),C=(0,l.useCallback)(()=>{f(),i(!1)},[f]),w=(0,a.jsxs)(r.jqI,{vertical:!0,className:"min-w-[220px]",children:[(0,a.jsxs)(r.jqI,{vertical:!0,className:"gap-1.5 px-4 py-2",children:[(0,a.jsx)(r.E_O.Group,{value:d,onChange:j,className:"flex flex-col gap-1.5",children:h.map(e=>(0,a.jsx)(r.E_O,{value:e,children:O(e)},e))}),(0,a.jsx)(r.E_O,{checked:g,onChange:e=>m(e.target.checked),children:"Dismissed"})]}),(0,a.jsx)(r.htM,{className:"m-0"}),(0,a.jsxs)(r.jqI,{justify:"space-between",className:"px-4 py-2",children:[(0,a.jsx)(r.wpx,{size:"small",type:"text",onClick:C,className:"-ml-2",children:"Reset"}),(0,a.jsx)(r.wpx,{size:"small",type:"primary",onClick:_,children:"Apply"})]})]});return(0,a.jsxs)(r.jqI,{className:"h-[calc(100%-48px)] overflow-hidden",gap:"middle",vertical:!0,children:[(0,a.jsxs)(r.jqI,{justify:"space-between",align:"center",children:[(0,a.jsx)("div",{className:"min-w-[300px]",children:(0,a.jsx)(o.f,{value:null!=s?s:"",onChange:c,placeholder:"Search by monitor name..."})}),(0,a.jsx)(r.bPF,{content:w,trigger:"click",placement:"bottomRight",open:t,onOpenChange:i,children:(0,a.jsx)(r.wpx,{icon:(0,a.jsx)(r.PJP._ME,{}),iconPosition:"end",children:"Filter"})})]}),(0,a.jsx)(r.krs,{...y,className:"h-full overflow-scroll",renderItem:e=>(0,a.jsx)(r.krs.Item,{children:(0,a.jsx)(R,{task:e})})}),(0,a.jsx)(r.B7X,{...v,showSizeChanger:{suffixIcon:(0,a.jsx)(r.PJP._ME,{})},hideOnSinglePage:(null===(e=v.pageSize)||void 0===e?void 0:e.toString())===(null===(n=v.pageSizeOptions)||void 0===n?void 0:n[0])})]})};var q=t(77213);let z=()=>(0,a.jsx)(q.Z,{title:"Action center",mainProps:{className:"h-full"},children:(0,a.jsx)(r.jqI,{justify:"center",align:"center",className:"h-full",children:(0,a.jsx)(r.DUx,{message:"Coming soon...",description:"Action center is currently disabled.",type:"info",showIcon:!0})})});var U=t(79894),F=t.n(U);let H=()=>(0,a.jsx)(r.oj8,{image:r.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up! Set up an integration monitor to track your infrastructure in greater detail.",children:(0,a.jsx)(F(),{href:u.KH,passHref:!0,legacyBehavior:!0,children:(0,a.jsx)(r.wpx,{type:"primary",children:"Visit integrations"})})});var L=t(14908);(i=s||(s={})).ATTENTION_REQUIRED="attention-required",i.IN_PROGRESS="in-progress";var G=()=>{let{flags:e}=(0,c.hz)(),n=!!e.heliosV2,t=(0,l.useMemo)(()=>n?Object.values(s):["attention-required"],[n]),{activeTab:i,onTabChange:a}=(0,L.Z)({tabKeys:t});return{tabs:(0,l.useMemo)(()=>{let e=[{label:"Attention required",hash:"attention-required"}];return n&&e.push({label:"Activity",hash:"in-progress"}),e},[n]),activeTab:i,onTabChange:a}},J=t(20411),K=t(18397),B=t(83158),Z=t(9110),W=t(62678),$=t(31883),Q=t(99824),Y=t(99089),V=t(63537);let X=e=>{let[n,t]=r.$zI.useModal(),[i]=(0,Y.rL)(),s=(0,r.UD8)();return{confirmAll:async(t,a)=>{let r=W.FieldActionType.PROMOTE,l=Date.now();if(!await n.confirm((0,V.nB)(Q.Me[r],Q.e_[r](a))))return;s.open({key:l,type:"loading",content:"".concat(Q.T0[r]," ").concat(a," ").concat((0,f._6)(a,"field","fields"),"..."),duration:0});let o=await i({query:{confidence_bucket:[t]},path:{monitor_config_id:e,action_type:r},body:{excluded_resource_urns:[]}});if((0,$.D4)(o)){s.open({key:l,type:"error",content:(0,V.v_)(r),duration:5});return}s.open({key:l,type:"success",content:(0,V.NM)(r,a),duration:5})},contextHolder:t}},ee=e=>{let{item:n,reviewHref:t,onConfirmAll:i}=e,s=[(0,a.jsx)(F(),{href:{pathname:t,query:{confidenceBucket:n.severity}},passHref:!0,children:(0,a.jsx)(r.wpx,{type:"text",size:"small",icon:(0,a.jsx)(r.PJP.ejL,{}),"aria-label":"Review ".concat(n.label," fields"),children:"Review"})},n.label)];return n.severity===B.$.HIGH&&i&&s.push((0,a.jsx)(r.wpx,{type:"text",size:"small",icon:(0,a.jsx)(r.PJP.WzW,{}),"aria-label":"Confirm all ".concat(n.label," fields"),onClick:i,children:"Confirm"},"confirm")),s},en=e=>{let{item:n,reviewHref:t,monitorId:i}=e,s=(0,V.Oq)(n.severity),{confirmAll:l,contextHolder:o}=X(i);return(0,a.jsxs)(a.Fragment,{children:[o,(0,a.jsx)(r.V4A,{size:"small",styles:{body:{display:"none"}},title:(0,a.jsxs)(r.vyj,{children:[(0,a.jsx)(r.t3Z,{size:24,icon:(0,a.jsx)(r.QMR,{color:"black"})}),(0,a.jsxs)(r.lKn,{type:"secondary",className:"font-normal",children:[(0,f.pF)(n.count)," ",(0,f._6)(n.count,"field","fields")]}),(0,a.jsx)(r.lKn,{children:n.label}),s&&(0,a.jsx)(Z.D,{severity:s,format:()=>null})]}),actions:ee({item:n,reviewHref:t,onConfirmAll:()=>{l(n.severity,n.count)}})})]})};var et=t(98145);let ei=e=>{let{confidenceCounts:n,reviewHref:t,monitorId:i,...s}=e;return(0,a.jsx)(r.krs,{grid:{gutter:16,column:3},dataSource:[{label:et.bI.HIGH,count:n.highConfidenceCount,severity:B.$.HIGH},{label:et.bI.MEDIUM,count:n.mediumConfidenceCount,severity:B.$.MEDIUM},{label:et.bI.LOW,count:n.lowConfidenceCount,severity:B.$.LOW}].filter(e=>e.count>0),renderItem:e=>(0,a.jsx)(r.krs.Item,{children:(0,a.jsx)(en,{item:e,reviewHref:t,monitorId:i})}),...s})};var es=t(54762),ea=t(42905),er=t.n(ea);let el=(e,n)=>{let t=et.v8.get(e);return t?(0,f._6)(n,t[0],t[1]):e},eo=e=>{let{updates:n,isAssetList:t}=e,i=(0,l.useMemo)(()=>n?Object.entries(n).filter(e=>{let[n,t]=e;return null!==t&&t>0&&!et.EP.includes(n)}).sort((e,n)=>{let t=et.H6.indexOf(e[0]),i=et.H6.indexOf(n[0]);return -1===t&&-1===i?0:-1===t?1:-1===i?-1:t-i}).map(e=>{let[n,t]=e;return"".concat((0,f.pF)(null!=t?t:0)," ").concat(el(n,null!=t?t:0))}):[],[n]);if(!n)return null;if(t){let e=i.join(", ");return(0,a.jsxs)("span",{children:[e," detected."]})}let s=i.join(", ");return(0,a.jsx)("span",{children:s})};var ec=t(71985);let{Text:ed}=r.AntTypography,eu={[ec.w.WEBSITE]:["asset","assets"],[ec.w.DATASTORE]:["field","fields"],[ec.w.INFRASTRUCTURE]:["system","systems"]},eg=e=>{let n,{monitorSummary:t,showSkeleton:i,href:s,...o}=e,{name:c,consent_status:d,total_updates:u,updates:g,last_monitored:m,secrets:p,key:h,connection_type:y,saas_config:x,monitorType:v,isTestMonitor:j}=t;if(v===ec.w.DATASTORE){var _,C,w;n={highConfidenceCount:null!==(_=null==g?void 0:g.classified_high_confidence)&&void 0!==_?_:0,mediumConfidenceCount:null!==(C=null==g?void 0:g.classified_medium_confidence)&&void 0!==C?C:0,lowConfidenceCount:null!==(w=null==g?void 0:g.classified_low_confidence)&&void 0!==w?w:0}}let[b,k]=(0,l.useState)(!1),S=!!n&&(n.highConfidenceCount>0||n.mediumConfidenceCount>0||n.lowConfidenceCount>0),I=v===ec.w.DATASTORE&&S&&!!h,T=m?(0,f.p6)(new Date(m)):void 0,M=m?E(new Date(m),new Date,{addSuffix:!0}):void 0,P=(0,f._6)(null!=u?u:0,eu[v][0],eu[v][1]);return(0,a.jsx)(r.krs.Item,{"data-testid":"monitor-result-".concat(h),...o,children:(0,a.jsx)(r.N_L,{avatar:!0,title:!1,loading:i,active:!0,children:(0,a.jsxs)(r.jqI,{vertical:!0,className:"grow",children:[(0,a.jsxs)(r.bue,{gutter:{xs:6,lg:12},className:"items-center",children:[(0,a.jsx)(r.JGx,{span:14,children:(0,a.jsx)(r.krs.Item.Meta,{avatar:(0,a.jsx)(N.ZP,{data:{kind:N.hY.CONNECTION,connectionType:y,name:c,key:h,saasType:null==x?void 0:x.type,websiteUrl:null==p?void 0:p.url}}),title:(0,a.jsxs)(r.jqI,{align:"center",gap:4,className:er()["monitor-result__title"],children:[(0,a.jsx)(F(),{href:s,"data-testid":"monitor-link",children:c}),(0,a.jsxs)(ed,{type:"secondary",children:[(0,f.pF)(null!=u?u:0)," ",P]}),d&&(0,a.jsx)(es.l,{consentStatus:d}),j&&(0,a.jsx)(r.j8w,{color:"nectar",children:"test monitor"})]}),description:!!g&&(0,a.jsx)(eo,{updates:g,isAssetList:v===ec.w.WEBSITE})})}),(0,a.jsx)(r.JGx,{span:5,className:"flex justify-end",children:!!M&&(0,a.jsx)(r.esZ,{title:T,children:(0,a.jsxs)(ed,{type:"secondary","data-testid":"monitor-date",children:[(0,a.jsx)("span",{className:"hidden lg:inline",children:"Last scan: "}),M]})})}),(0,a.jsxs)(r.JGx,{span:5,className:"flex items-center justify-end",children:[I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.wpx,{type:"link",className:"p-0",icon:b?(0,a.jsx)(r.PJP.Kh3,{}):(0,a.jsx)(r.PJP._ME,{}),iconPosition:"end",onClick:()=>k(!b),"aria-haspopup":"true","aria-expanded":b,"aria-controls":"confidence-row-".concat(h),"aria-label":"".concat(b?"Collapse":"Expand"," findings"),children:(0,a.jsxs)(r.vyj,{children:[(0,a.jsx)(r.QMR,{}),"Findings"]})}),(0,a.jsx)(r.htM,{type:"vertical",orientationMargin:0})]}),(0,a.jsx)(F(),{href:s,passHref:!0,legacyBehavior:!0,children:(0,a.jsx)(r.wpx,{type:"link",className:"p-0","data-testid":"review-button-".concat(t.key),children:"Review"})},"review")]})]}),(0,a.jsx)(J.M,{initial:!1,children:I&&b&&n&&(0,a.jsx)(K.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:(0,a.jsx)(ei,{confidenceCounts:n,reviewHref:s,monitorId:h,className:"mt-6",id:"confidence-row-".concat(h)})},"confidence-row")})]})})})};var em=()=>{var e,n,t;let i=(0,r.pmc)(),{tabs:f,activeTab:h,onTabChange:y}=G(),{flags:x}=(0,c.hz)(),{paginationProps:v,pageIndex:j,pageSize:_,resetPagination:C}=(0,m.S)(),[w,b]=(0,l.useState)(""),{webMonitor:k,heliosV2:E}=x,S=[...k?[ec.w.WEBSITE]:[],...E?[ec.w.DATASTORE]:[]],{data:N,isError:I,isLoading:T,isFetching:M}=(0,p.Ud)({page:j,size:_,search:w,monitor_type:S.length>0?S:void 0});(0,l.useEffect)(()=>{C()},[w]),(0,l.useEffect)(()=>{I&&i({title:"Error fetching data",description:"Please try again later",status:"error"})},[I,i]);let P=(null==N?void 0:null===(e=N.items)||void 0===e?void 0:e.flatMap(e=>e.key&&void 0!==e.key?[e]:[]))||[],A=M?Array.from({length:_},(e,n)=>({key:n.toString(),updates:[],last_monitored:null})):[];return k||E?(0,a.jsxs)(d.Z,{title:"Action center",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,a.jsx)(g.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity"}],isSticky:!1}),(0,a.jsx)(r.Niu,{"aria-label":"Action center tabs",mode:"horizontal",items:f.map(e=>({key:e.hash,label:e.label})),selectedKeys:[h],onClick:async e=>{let n=Object.values(s).find(n=>n===e.key);n&&await y(n)},className:"mb-4","data-testid":"action-center-tabs"}),h===s.IN_PROGRESS?(0,a.jsx)(D,{}):(0,a.jsxs)(r.jqI,{className:"h-[calc(100%-48px)] overflow-hidden",gap:"middle",vertical:!0,children:[(0,a.jsx)(r.jqI,{className:"justify-between ",children:(0,a.jsx)(o.f,{value:w,onChange:b})}),(0,a.jsx)(r.krs,{loading:T,dataSource:P||A,locale:{emptyText:(0,a.jsx)(H,{})},className:"h-full overflow-y-auto overflow-x-clip",renderItem:e=>{let n=e.key&&e.monitorType?"".concat(u.vi,"/").concat(e.monitorType,"/").concat(e.key):"";return!!(null==e?void 0:e.key)&&(0,a.jsx)(eg,{showSkeleton:M,monitorSummary:e,href:n},e.key)}}),(0,a.jsx)(r.B7X,{...v,total:(null==N?void 0:N.total)||0,showSizeChanger:{suffixIcon:(0,a.jsx)(r.PJP._ME,{})},hideOnSinglePage:(null===(n=v.pageSize)||void 0===n?void 0:n.toString())===(null===(t=v.pageSizeOptions)||void 0===t?void 0:t[0])})]})]}):(0,a.jsx)(z,{})}},42905:function(e){e.exports={"monitor-result__title":"MonitorResult_monitor-result__title__Wqv_l"}}},function(e){e.O(0,[431,7245,4589,5505,2888,9774,179],function(){return e(e.s=40741)}),_N_E=e.O()}]);