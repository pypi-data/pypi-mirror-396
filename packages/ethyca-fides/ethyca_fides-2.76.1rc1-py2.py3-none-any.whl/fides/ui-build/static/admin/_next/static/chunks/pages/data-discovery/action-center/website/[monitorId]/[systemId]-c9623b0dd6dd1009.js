(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8922],{58095:function(e,t,s){var n=s(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,s){for(var n=-1,a=null==e?0:e.length;++n<a;)if(s(t,e[n]))return!0;return!1}},8817:function(e,t,s){var n=s(95372),a=s(1129),l=s(58263);e.exports=function(e,t,s){return t==t?l(e,t,s):n(e,a,s)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,s){var n=s(52485),a=s(58095),l=s(21796),i=s(65581),r=s(47111),o=s(43735);e.exports=function(e,t,s){var d=-1,c=a,u=e.length,p=!0,h=[],m=h;if(s)p=!1,c=l;else if(u>=200){var y=t?null:r(e);if(y)return o(y);p=!1,c=i,m=new n}else m=t?[]:h;e:for(;++d<u;){var g=e[d],f=t?t(g):g;if(g=s||0!==g?g:0,p&&f==f){for(var v=m.length;v--;)if(m[v]===f)continue e;t&&m.push(f),h.push(g)}else c(m,f,s)||(m!==h&&m.push(f),h.push(g))}return h}},47111:function(e,t,s){var n=s(46151),a=s(50344),l=s(43735),i=n&&1/l(new n([,-0]))[1]==1/0?function(e){return new n(e)}:a;e.exports=i},58263:function(e){e.exports=function(e,t,s){for(var n=s-1,a=e.length;++n<a;)if(e[n]===t)return n;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,s){var n=s(92198);e.exports=function(e){return e&&e.length?n(e):[]}},14599:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/website/[monitorId]/[systemId]",function(){return s(26363)}])},45938:function(e,t,s){"use strict";s.d(t,{Gt:function(){return p},eB:function(){return h},oI:function(){return u}});var n=s(24246),a=s(34090),l=s(27378),i=s(16134),r=s(38602),o=s(58452);let d=(0,l.createRef)(),c=(0,l.createRef)(),u=()=>{let e=(0,i.T)(),t=(0,i.C)(r.DB),s=(0,l.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),n=(0,l.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!0),s())},[e,s]),a=(0,l.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,l.useCallback)(()=>t?(e((0,r.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:n,onClose:a}},p=e=>{let{id:t,name:s}=e,{dirty:n}=(0,a.u6)(),o=(0,i.T)();return(0,l.useEffect)(()=>(o((0,r.Zu)({id:t,name:s})),()=>{o((0,r.dz)({id:t}))}),[o,t,s]),(0,l.useEffect)(()=>{o((0,r.$p)({id:t,isDirty:n}))},[n,o,t]),null},h=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,i.C)(r.uv);return(0,n.jsx)(o.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},25415:function(e,t,s){"use strict";s.d(t,{a:function(){return l}});var n=s(24246);let{Text:a}=s(39158).AntTypography,l=e=>{let{count:t}=e;return(0,n.jsx)(a,{size:"sm",strong:!0,"data-testid":"selected-count",children:"".concat(t," selected")})}},2525:function(e,t,s){"use strict";s.d(t,{Q:function(){return r}});var n=s(24246),a=s(39158),l=s(27378),i=s(3110);let r=e=>{let{values:t,columnState:s,tagProps:r,onTagClose:o,onStateChange:d,...c}=e,{isExpanded:u,isWrapped:p,version:h}=s||{},[m,y]=(0,l.useState)(!u),[g,f]=(0,l.useState)(!!p),[v,x]=(0,l.useState)(u?t:null==t?void 0:t.slice(0,2));(0,l.useEffect)(()=>{y(!u)},[u,h]),(0,l.useEffect)(()=>{f(!!p)},[p]),(0,l.useEffect)(()=>{(null==t?void 0:t.length)?x(m?t.slice(0,2):t):x(t)},[m,t,d]),(0,l.useEffect)(()=>{(null==t?void 0:t.length)&&t.length<=2&&!m&&(y(!0),null==d||d(!1))},[t,d,m]);let j=(0,l.useCallback)(()=>{x(null==t?void 0:t.slice(0,2)),y(!0),null==d||d(!1)},[t,d]),b=(0,l.useCallback)(()=>{y(!1),null==d||d(!0)},[d]),C=(0,l.useCallback)(()=>{m?b():j()},[m,b,j]);return(0,l.useMemo)(()=>(null==v?void 0:v.length)?(0,n.jsxs)(a.jqI,{align:m?"center":"start",wrap:g?"wrap":"nowrap",vertical:!m,gap:"small","data-testid":"tag-expandable-cell",style:{overflowX:"auto",...c.style},...c,children:[v.map(e=>(0,n.jsx)(a.j8w,{color:"white","data-testid":e.key,onClose:o?()=>o(e.key):void 0,...r,...e.tagProps,children:(0,n.jsx)(a.lKn,{ellipsis:!!m&&{tooltip:!0},style:{color:"inherit",maxWidth:m?i.TD:void 0},children:e.label})},e.key)),t&&t.length>2&&(0,n.jsx)(a.wpx,{type:"link",size:"small",onClick:e=>{e.stopPropagation(),C()},className:"h-auto p-0",style:{fontSize:"var(--ant-font-size)"},children:m?"+".concat(t.length-2," more"):i.T5})]}):(0,n.jsx)("span",{"data-testid":"tag-expandable-cell-empty"}),[v,m,g,c,t,r,o,C])}},3110:function(e,t,s){"use strict";s.d(t,{DI:function(){return r},T5:function(){return l},TD:function(){return i}});var n=s(24246),a=s(39158);let l="show less",i=150,r=[{key:"expand-all",label:"Expand all",icon:(0,n.jsx)(a.PJP.jbG,{})},{key:"collapse-all",label:"Collapse all",icon:(0,n.jsx)(a.PJP.MVB,{})}]},26070:function(e,t,s){"use strict";s.d(t,{v:function(){return o},Q:function(){return d.Q}});var n=s(24246),a=s(39158),l=s(27378),i=s(3110);let{Text:r}=a.AntTypography,o=e=>{let{values:t,valueSuffix:s,columnState:o,containerProps:d}=e,{isExpanded:c,version:u}=o||{},[p,h]=(0,l.useState)(!c);(0,l.useEffect)(()=>{h(!c)},[c,u]);let m=(0,l.useCallback)(()=>{h(!0)},[]),y=(0,l.useCallback)(()=>{h(!1)},[]),g=(0,l.useCallback)(()=>{p?y():m()},[p,y,m]);return(0,l.useMemo)(()=>(null==t?void 0:t.length)?1===t.length?(0,n.jsx)(a.jqI,{...d,children:(0,n.jsx)(r,{ellipsis:!0,"data-testid":"list-expandable-cell-single",children:t[0]})}):(0,n.jsxs)(a.jqI,{align:p?"center":"flex-start",vertical:!p,gap:p?"small":"none","data-testid":"list-expandable-cell",...d,children:[p?(0,n.jsxs)(r,{ellipsis:!0,children:[t.length," ",s]}):(0,n.jsx)(a.krs,{dataSource:t,renderItem:e=>(0,n.jsx)("li",{children:e})}),(0,n.jsx)(a.wpx,{type:"link",size:"small",onClick:e=>{e.stopPropagation(),g()},className:"h-auto p-0",style:{fontSize:"var(--ant-font-size)"},children:p?"view":i.T5})]}):null,[p,t,s,g,d])};var d=s(2525)},54762:function(e,t,s){"use strict";s.d(t,{l:function(){return r}});var n=s(24246),a=s(39158),l=s(62165),i=s(60240);let r=e=>{let{consentStatus:t}=e,{flags:s}=(0,l.hz)(),{assetConsentStatusLabels:r}=s;return r&&(null==t?void 0:t.status)===i.pF.ALERT?(0,n.jsx)(a.esZ,{title:null==t?void 0:t.message,"data-testid":"discovery-status-icon-alert-tooltip",children:(0,n.jsx)("div",{className:"mb-px","data-testid":"discovery-status-icon-alert",children:(0,n.jsx)(a.PJP.OdJ,{style:{color:"var(--fidesui-error)"}})})}):null}},9320:function(e,t,s){"use strict";s.d(t,{_:function(){return l}});var n=s(24246),a=s(26089);let l=(e,t)=>(0,n.jsxs)(n.Fragment,{children:[e," ",t&&(0,n.jsx)(a.Z,{onClick:t,children:"View"})]})},88708:function(e,t,s){"use strict";s.d(t,{A:function(){return a}});var n,a,l=s(27378),i=s(14908),r=s(60240);(n=a||(a={})).ATTENTION_REQUIRED="attention-required",n.ADDED="added",n.IGNORED="ignored",t.Z=e=>{let{activeTab:t,onTabChange:s}=(0,i.Z)({tabKeys:Object.values(a)}),n=(0,l.useMemo)(()=>[{label:"Attention required",params:{diff_status:[r.LL.ADDITION],system:e},hash:"attention-required"},{label:"Added",params:{diff_status:[r.LL.MONITORED]},hash:"added"},{label:"Ignored",params:{diff_status:[r.LL.MUTED],system:e},hash:"ignored"}],[e]),{diff_status:o,system:d}=(0,l.useMemo)(()=>{var e;return null!==(e=n.find(e=>e.hash===t))&&void 0!==e?e:n[0]},[n,t]).params,c=(0,l.useMemo)(()=>o.includes(r.LL.MONITORED),[o]);return{filterTabs:n,activeTab:t,onTabChange:s,activeParams:(0,l.useMemo)(()=>e?{diff_status:o,system:d}:{diff_status:o},[e,o,d]),actionsDisabled:c}}},78238:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});let n=["essential","functional.service.improve","personalize","analytics","marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"];t.Z=e=>n.includes(e)},57072:function(e,t,s){"use strict";s.d(t,{Bd:function(){return n.Bd},L5:function(){return n.L5},MO:function(){return n.MO},qb:function(){return n.qb}});var n=s(5785)},26363:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eo}});var n=s(24246),a=s(86677),l=s(27378),i=s(35287),r=s(77830),o=s(58754),d=s(37059),c=s(39158),u=s(25415),p=s(60240),h=s(30952),m=s(8133),y=s(79283),g=s(34929),f=s(78238),v=e=>{let{selectedTaxonomies:t,...s}=e,{getDataUseDisplayNameProps:a,getDataUses:i}=(0,g.Z)(),r=[...i()].filter(e=>!(null==t?void 0:t.includes(e.fides_key))).sort(),o=r.filter(e=>e.active&&f.g.includes(e.fides_key)),d=r.map(e=>{let{name:t,primaryName:s}=a(e.fides_key);return{value:e.fides_key,name:t,primaryName:s,description:e.description||""}}),u=(0,l.useMemo)(()=>{let e=[],t=[];return d.forEach(s=>{o.some(e=>e.fides_key===s.value)?e.push(s):t.push(s)}),{suggested:e,all:t}},[d,o]),p=u.suggested.length?[{label:(0,n.jsxs)(c.vyj,{children:[(0,n.jsx)(c.QMR,{size:14}),(0,n.jsx)("span",{children:"Categories of consent"}),(0,n.jsx)("em",{className:"font-normal",children:"Recommended"})]}),options:u.suggested},{label:(0,n.jsxs)(c.vyj,{children:[(0,n.jsx)(c.PJP.BBB,{}),(0,n.jsx)("span",{children:"Other data uses"})]}),options:u.all}]:u.all;return(0,n.jsx)(y.l,{options:p,...s})};let{Text:x}=c.AntTypography;var j=e=>{let{onSave:t,isSaving:s,onClose:a,...i}=e,[r,o]=(0,l.useState)([]),d=()=>{o([]),a()};return(0,n.jsxs)(m.Z,{title:"Add consent category",...i,onClose:d,children:[(0,n.jsxs)(c.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(x,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,n.jsx)(v,{mode:"tags",onSelect:(e,t)=>o([...r,t.value]),variant:"outlined"})]}),(0,n.jsxs)(c.jqI,{justify:"space-between",children:[(0,n.jsx)(c.wpx,{htmlType:"reset",onClick:d,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(c.wpx,{htmlType:"submit",type:"primary",disabled:!r.length,loading:s,onClick:()=>{t(r),d()},"data-testid":"save-btn",children:"Save"})]})]})},b=s(29850),C=s(77685);let{Text:k}=c.AntTypography,w=e=>{let{onSave:t,isSaving:s,...a}=e,[i,r]=(0,l.useState)(),[o,d]=(0,l.useState)(!1),u=(0,l.useCallback)(e=>{e.preventDefault(),d(!0)},[]),p=()=>{d(!1)},h=()=>{r(void 0),a.onClose()};return(0,n.jsxs)(m.Z,{title:"Assign system",...a,onClose:h,children:[(0,n.jsxs)(c.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(k,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,n.jsx)(b.R,{placeholder:"Search or select...",onSelect:(e,t)=>{r(t)},onAddSystem:u,value:i})]})," ",(0,n.jsxs)(c.jqI,{justify:"space-between",children:[(0,n.jsx)(c.wpx,{htmlType:"reset",onClick:h,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(c.wpx,{htmlType:"submit",type:"primary",disabled:!i,loading:s,onClick:()=>{t(i),h()},"data-testid":"save-btn",children:"Save"})]}),o&&(0,n.jsx)(C.i,{isOpen:!0,onClose:p,onSuccessfulSubmit:(e,t)=>{p(),r({label:t,value:e})},toastOnSuccess:!0})]})};var _=s(8411),S=s(32735),E=s(8125),A=s(16394),T=s(98145);let{Link:I}=c.AntTypography,D=e=>{let{stagedResource:t}=e,s=(0,E.o)({pagination:{defaultPageSize:10,pageSizeOptions:[10,...S.VZ]},disableUrlState:!0}),{pageIndex:a,pageSize:i}=s,{data:r,isFetching:o,isError:u}=(0,d.mi)({stagedResourceUrn:t.urn,statuses:T.LM,page:a,size:i}),{items:p,total:h}=(0,l.useMemo)(()=>r||{items:[],total:0,pages:0,filterOptions:{assigned_users:[],systems:[]}},[r]),m=(0,l.useMemo)(()=>({enableSelection:!1,getRowKey:e=>"".concat(e.location,"-").concat(e.page),isLoading:o,dataSource:p,totalRows:null!=h?h:0,customTableProps:{scroll:{scrollToFirstRowOnChange:!0},tableLayout:"fixed"}}),[o,p,h]),y=(0,E.V)(s,m);return{columns:(0,l.useMemo)(()=>[{title:"Location",dataIndex:T.EI.LOCATION,key:T.EI.LOCATION,render:e=>{var t;let s=(0,c.QCN)(e),a=s?(0,c.c1K)({isoEntry:s,showFlag:!0}):null!==(t=null===_.Z8||void 0===_.Z8?void 0:_.Z8[e])&&void 0!==t?t:e;return(0,n.jsx)(c.AntTypography.Text,{ellipsis:{tooltip:e},children:a})},width:180},{title:"Page",dataIndex:T.EI.PAGE,key:T.EI.PAGE,render:e=>{let t=(0,A.hL)(e,50);return(0,n.jsx)(I,{href:e,target:"_blank",rel:"noopener noreferrer",variant:"primary",children:(0,n.jsx)(c.AntTypography.Text,{ellipsis:{tooltip:e},unStyled:!0,children:t})})},minWidth:100},{title:"Compliance",dataIndex:T.EI.STATUS,key:T.EI.STATUS,width:160,render:e=>{let t=T.Vq[e];return(0,n.jsx)(c.esZ,{title:t,children:(0,n.jsx)(c.j8w,{color:"error","data-testid":"status-badge_".concat(e.replace(/_/g,"-")),children:T.X1[e]})})}}],[]),data:r,isLoading:o,isError:u,totalRows:h,tableProps:y.tableProps,hasData:p.length>0}},{Paragraph:N,Text:O}=c.AntTypography,L=e=>{var t,s,a;let{isOpen:l,stagedResource:i,onCancel:r,onDownload:o}=e,{columns:d,tableProps:u,isError:p}=D({stagedResource:i});return(0,n.jsx)(c.$zI,{title:"Compliance issues",width:768,open:l,onCancel:r,footer:[(0,n.jsx)(c.wpx,{onClick:r,children:"Cancel"},"cancel"),!!o&&(0,n.jsx)(c.wpx,{type:"primary",onClick:o,children:"Download"},"download")],"data-testid":"consent-breakdown-modal",children:(0,n.jsxs)(c.jqI,{vertical:!0,className:"gap-6","data-testid":"consent-breakdown-modal-content",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(N,{children:"View all instances where this asset was detected with consent compliance issues, organized by location and page. This includes assets loaded without consent, before consent, or when CMP failed."}),(0,n.jsxs)(N,{children:[(0,n.jsx)(O,{strong:!0,children:"Asset name:"})," ",null!==(t=i.name)&&void 0!==t?t:(0,n.jsx)(O,{italic:!0,children:"Unknown"}),","," ",(0,n.jsx)(O,{strong:!0,children:"System:"})," ",null!==(s=i.system)&&void 0!==s?s:(0,n.jsx)(O,{italic:!0,children:"Unassigned"}),","," ",(0,n.jsx)(O,{strong:!0,children:"Domain:"})," ",null!==(a=i.domain)&&void 0!==a?a:(0,n.jsx)(O,{italic:!0,children:"Unknown"})]})]}),p?(0,n.jsx)(c.DUx,{type:"error",message:"Error fetching data",description:"Please try again later.",showIcon:!0}):(0,n.jsx)(c.V5H,{...u,columns:d,"data-testid":"consent-breakdown-modal-table"})]})})};var P=s(83766),R=s.n(P),M=s(62165),z=s(812),V=s(26070),Z=s(3110),U=s(46628),G=s(54762),q=s(9320),B=s(26092),K=s.n(B),$=s(88708),J=e=>!!e&&T.LM.includes(e);let Q=e=>{let{asset:t,onTabChange:s,showComplianceIssueDetails:l}=e,{flags:i}=(0,M.hz)(),{assetConsentStatusLabels:o}=i,[u,{isLoading:h}]=(0,d.EY)(),[m,{isLoading:y}]=(0,d.nS)(),[g,{isLoading:f}]=(0,d.Tj)(),v=(0,c.pmc)(),x=(0,a.useRouter)(),j=h||y||f,{urn:b,name:C,resource_type:k,diff_status:w,system_key:_,user_assigned_system_key:S,consent_aggregated:E}=t,A=K()(C||"",{length:50}),T=J(E),I=async()=>{let e=await u({urnList:[b]});if((0,z.D4)(e))v((0,U.Vo)((0,z.e$)(e.error)));else{let e=S||_,t="".concat(r.So,"/configure/").concat(e,"#assets");v((0,U.t5)((0,q._)("".concat(k,' "').concat(A,'" has been added to the system inventory.'),e?()=>x.push(t):void 0)))}},D=async()=>{let e=await m({urnList:[b]});(0,z.D4)(e)?v((0,U.Vo)((0,z.e$)(e.error))):v((0,U.t5)((0,q._)("".concat(k,' "').concat(A,'" has been ignored and will not appear in future scans.'),async()=>{await s($.A.IGNORED)})))},N=async()=>{let e=await g({urnList:[b]});(0,z.D4)(e)?v((0,U.Vo)((0,z.e$)(e.error))):v((0,U.t5)("".concat(k,' "').concat(A,'" is no longer ignored and will appear in future scans.')))};return(0,n.jsxs)(c.vyj,{children:[w!==p.LL.MUTED&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,n.jsx)(c.wpx,{"data-testid":"add-btn",size:"small",onClick:I,disabled:!t.system||j,loading:h,children:"Add"})}),(0,n.jsx)(c.wpx,{"data-testid":"ignore-btn",size:"small",onClick:D,disabled:j,loading:y,children:"Ignore"}),T&&o&&(0,n.jsx)(c.wpx,{"data-testid":"view-compliance-details-btn",size:"small",onClick:()=>{null==l||l(t)},disabled:j,loading:f,icon:(0,n.jsx)(c.PJP.OdJ,{style:{color:"var(--fidesui-error)",width:14}}),title:"View compliance issue","aria-label":"View compliance issue"})]}),w===p.LL.MUTED&&(0,n.jsx)(c.wpx,{"data-testid":"restore-btn",size:"small",onClick:N,disabled:j,loading:f,children:"Restore"})]})};var F=s(17245),Y=s(18992),W=s.n(Y),X=s(2525),H=s(31883),ee=e=>{let{asset:t,readonly:s,columnState:a,onChange:i}=e,[r,o]=(0,l.useState)(!1),[u,p]=(0,l.useState)((null==a?void 0:a.isExpanded)||!1),[h]=(0,d.Ak)(),{successAlert:m,errorAlert:y}=(0,F.VY)(),{getDataUseDisplayName:f}=(0,g.Z)(),x=[...t.preferred_data_uses||[]].sort(),j=K()(t.name||"",{length:50}),b=async e=>{let s=await h({monitorId:t.monitor_config_id,urnList:[t.urn],dataUses:[...x,e]});(0,H.D4)(s)?y((0,z.e$)(s.error)):(m("Consent category added to ".concat(t.resource_type,' "').concat(j,'".'),"Confirmed"),null==i||i([...x,e])),o(!1)},C=async e=>{let s=await h({monitorId:t.monitor_config_id,urnList:[t.urn],dataUses:x.filter(t=>t!==e)});(0,H.D4)(s)?y((0,z.e$)(s.error)):(m("Consent category removed from ".concat(t.resource_type,' "').concat(j,'".'),"Confirmed"),null==i||i(x.filter(t=>t!==e)))};return((0,l.useEffect)(()=>{p((null==a?void 0:a.isExpanded)||!1)},[null==a?void 0:a.isExpanded]),s)?(0,n.jsx)(X.Q,{values:null==x?void 0:x.map(e=>({label:f(e),key:e})),columnState:a,onStateChange:p}):(0,n.jsxs)(n.Fragment,{children:[!r&&(0,n.jsxs)(c.vyj,{align:"start",children:[(0,n.jsx)(c.j8w,{onClick:()=>o(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"}),(0,n.jsx)(X.Q,{values:null==x?void 0:x.map(e=>({label:f(e),key:e})),columnState:{...a,isExpanded:u},tagProps:{closable:!0,closeButtonLabel:"Remove data use"},onTagClose:C,onStateChange:p})]}),r&&(0,n.jsx)("div",{className:W().cellBleed,style:{backgroundColor:"var(--fides-color-white)"},children:(0,n.jsx)(v,{selectedTaxonomies:x,onSelect:b,onBlur:()=>o(!1),onKeyDown:e=>{"Escape"===e.key&&o(!1)},open:!0})})]})};let et=e=>{let{consentAggregated:t,stagedResource:s}=e,a=T.LM.includes(t);if(!(a||t===p.lg.UNKNOWN))return null;let l=!!s.data_uses&&s.data_uses.length>0,i=T.Vq[t];return t!==p.lg.UNKNOWN||l||(i="Add a category of consent to this asset to find consent information."),(0,n.jsx)(c.esZ,{title:i,children:(0,n.jsx)(c.j8w,{color:a?"error":void 0,"data-testid":"status-badge_".concat(t.replace(/_/g,"-")),children:T.X1[t]})})};var es=s(70675);let en=e=>{let{aggregateSystem:t,monitorConfigId:s,readonly:a,onChange:i}=e,{resource_type:r,name:o,urn:d,system:u,user_assigned_system_key:p,system_key:h}=t,m=K()(o||"",{length:50}),[y,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)(!1),[x,{isLoading:j}]=(0,es.NA)(),{successAlert:k,errorAlert:w}=(0,F.VY)(),_=(0,l.useCallback)(e=>{e.preventDefault(),v(!0)},[]),S=async(e,t,n)=>{let a=await x({staged_resource_urn:d,monitor_config_id:s,user_assigned_system_key:e}),l=K()(t,{length:50});(0,z.D4)(a)?w((0,z.e$)(a.error)):(k(n?"".concat(l," has been added to your system inventory and the ").concat(r,' "').concat(m,'" has been assigned to that system.'):"".concat(r,' "').concat(m,'" has been assigned to ').concat(l,"."),"Confirmed"),null==i||i(e)),g(!1)};return a?u?(0,n.jsx)(c.j8w,{"data-testid":"system-badge",color:"white",children:u}):null:(0,n.jsxs)(n.Fragment,{children:[!y&&(u?(0,n.jsxs)(c.j8w,{onClick:()=>g(!0),"data-testid":"system-badge",children:[u,(0,n.jsx)(c.PJP.I8b,{})]}):(0,n.jsx)(c.j8w,{onClick:()=>g(!0),"data-testid":"add-system-btn",addable:!0})),!!y&&(0,n.jsx)("div",{className:W().cellBleed,children:(0,n.jsx)(b.R,{variant:"borderless",autoFocus:!0,defaultOpen:!0,defaultValue:p||h,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&g(!1)},onAddSystem:_,onSelect:(e,t)=>S(e,t.label),loading:j})}),f&&(0,n.jsx)(C.i,{isOpen:!0,onClose:()=>{v(!1)},onSuccessfulSubmit:(e,t)=>S(e,t,!0)})]})},ea=e=>{let{monitorId:t,systemId:s,consentStatus:i,onShowComplianceIssueDetails:o}=e,u=(0,a.useRouter)(),h=(0,c.pmc)(),[m,y]=(0,l.useState)(s),[g,v]=(0,l.useState)(!1),[x,j]=(0,l.useState)(!1),[b,C]=(0,l.useState)(!1),[k,w]=(0,l.useState)(0),[S,I]=(0,l.useState)(0),[D,N]=(0,l.useState)(0),{flags:O}=(0,M.hz)(),{assetConsentStatusLabels:L}=O,{filterTabs:P,activeTab:B,onTabChange:K,activeParams:J,actionsDisabled:F}=(0,$.Z)(s),Y=(0,E.o)({sorting:{validColumns:Object.values(T.r6)}}),{columnFilters:W,pageIndex:X,pageSize:H,resetState:es,sortKey:ea,sortOrder:el,searchQuery:ei,updateSearch:er,updateFilters:eo,updateSorting:ed,updatePageIndex:ec,updatePageSize:eu}=Y,{data:ep,isLoading:eh,isFetching:em}=(0,d.WJ)({key:t,page:X,size:H,search:ei,sort_by:ea?[ea]:[T.r6.NAME],sort_asc:"descend"!==el,...J,...W}),[ey,{isLoading:eg}]=(0,d.EY)(),[ef,{isLoading:ev}]=(0,d.nS)(),[ex,{isLoading:ej}]=(0,d.rs)(),[eb,{isLoading:eC}]=(0,d.sX)(),[ek,{isLoading:ew}]=(0,d.Vr)(),[e_,{isLoading:eS}]=(0,d.Tj)(),eE=eg||ev||ej||eC||eS||ew,eA=eE||s===r.Kl,{data:eT}=(0,d.ut)({monitor_config_id:t,resolved_system_id:s,diff_status:null==J?void 0:J.diff_status,search:ei,...W}),eI=(0,l.useMemo)(()=>({enableSelection:B!==$.A.ADDED,getRowKey:e=>e.urn,isLoading:eh,isFetching:em,dataSource:(null==ep?void 0:ep.items)||[],totalRows:(null==ep?void 0:ep.total)||0,sortBy:[T.r6.NAME],sortAsc:!0,customTableProps:{locale:{emptyText:(0,n.jsx)("div",{children:(0,n.jsx)("div",{children:"All caught up!"})})},sticky:{offsetHeader:40}}}),[B,eh,em,null==ep?void 0:ep.items,null==ep?void 0:ep.total]),eD=(0,E.V)(Y,eI),{selectedKeys:eN,selectedRows:eO,resetSelections:eL}=eD,eP=(0,l.useMemo)(()=>{var e;let t=[{title:"Asset",dataIndex:T.r6.NAME,key:T.r6.NAME,sorter:!0,sortOrder:ea===T.r6.NAME?el:null,render:e=>(0,n.jsx)(c.lKn,{ellipsis:{tooltip:!0},style:{maxWidth:300},children:e}),fixed:"left",width:200},{title:"Type",dataIndex:T.r6.RESOURCE_TYPE,key:T.r6.RESOURCE_TYPE,sorter:!0,sortOrder:ea===T.r6.RESOURCE_TYPE?el:null,filters:(0,A.nZ)(null==eT?void 0:eT.resource_type),filteredValue:(null==W?void 0:W.resource_type)||null},{title:"System",dataIndex:T.r6.SYSTEM,key:T.r6.SYSTEM,render:(e,t)=>!!t.monitor_config_id&&(0,n.jsx)(en,{aggregateSystem:t,monitorConfigId:t.monitor_config_id,readonly:F||B===$.A.IGNORED,onChange:()=>{eL()}}),width:200},{title:"Categories of consent",key:T.r6.DATA_USES,menu:{items:Z.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(C(!0),N(e=>e+1)):"collapse-all"===e.key&&(C(!1),N(e=>e+1))}},filters:(0,A.nZ)(null==eT?void 0:null===(e=eT.data_uses)||void 0===e?void 0:e.filter(e=>(0,f.Z)(e))),filteredValue:(null==W?void 0:W.data_uses)||null,render:(e,t)=>(0,n.jsx)(ee,{asset:t,readonly:F||B===$.A.IGNORED,columnState:{isExpanded:b,version:D},onChange:()=>{eL()}}),width:200},{title:"Locations",dataIndex:T.r6.LOCATIONS,key:T.r6.LOCATIONS,menu:{items:Z.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(v(!0),w(e=>e+1)):"collapse-all"===e.key&&(v(!1),w(e=>e+1))}},filters:(0,A.nZ)(null==eT?void 0:eT.locations,e=>{var t;let s=(0,c.QCN)(e);return s?(0,c.c1K)({isoEntry:s}):null!==(t=_.Z8[e])&&void 0!==t?t:e}),filteredValue:(null==W?void 0:W.locations)||null,render:e=>{var t;return(0,n.jsx)(V.Q,{values:null!==(t=null==e?void 0:e.map(e=>{var t;let s=(0,c.QCN)(e);return{label:s?(0,c.c1K)({isoEntry:s}):null!==(t=_.Z8[e])&&void 0!==t?t:e,key:e}}))&&void 0!==t?t:[],columnState:{isExpanded:g,version:k}})}},{title:"Domain",dataIndex:T.r6.DOMAIN,key:T.r6.DOMAIN},{title:"Detected on",dataIndex:T.r6.PAGE,menu:{items:Z.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(j(!0),I(e=>e+1)):"collapse-all"===e.key&&(j(!1),I(e=>e+1))}},key:T.r6.PAGE,render:e=>(0,n.jsx)(V.v,{values:e,valueSuffix:"pages",columnState:{isExpanded:x,version:S}})}];return L&&t.push({title:()=>(0,n.jsxs)(c.vyj,{children:[(0,n.jsx)("div",{children:"Compliance"}),(null==i?void 0:i.status)===p.pF.ALERT&&(0,n.jsx)(G.l,{consentStatus:i})]}),dataIndex:T.r6.CONSENT_AGGREGATED,key:T.r6.CONSENT_AGGREGATED,sorter:!0,sortOrder:ea===T.r6.CONSENT_AGGREGATED?el:null,filters:(0,A.nZ)(null==eT?void 0:eT[T.r6.CONSENT_AGGREGATED],e=>{var t;return null!==(t=T.X1[e])&&void 0!==t?t:e}),filteredValue:(null==W?void 0:W[T.r6.CONSENT_AGGREGATED])||null,render:(e,t)=>(0,n.jsx)(et,{consentAggregated:null!=e?e:p.lg.UNKNOWN,stagedResource:t}),width:160}),F||t.push({title:"Actions",key:T.r6.ACTIONS,fixed:"right",render:(e,t)=>(0,n.jsx)(Q,{asset:t,onTabChange:K,showComplianceIssueDetails:o})}),t},[ea,el,eT,W,L,F,B,b,D,eL,g,k,x,S,i,K,o]);(0,l.useEffect)(()=>{if(ep){var e;y((null===(e=ep.items[0])||void 0===e?void 0:e.system)||m||s||"")}},[ep,s,m]);let eR=(0,l.useCallback)(async()=>{var e,t;let s=await ey({urnList:eN}),n=(null===(e=eO[0])||void 0===e?void 0:e.user_assigned_system_key)||(null===(t=eO[0])||void 0===t?void 0:t.system_key),a=eO.every(e=>(e.user_assigned_system_key||e.system_key)===n)?n:void 0;(0,z.D4)(s)?h((0,U.Vo)((0,z.e$)(s.error))):(h((0,U.t5)((0,q._)("".concat(eN.length," assets from ").concat(m," have been added to the system inventory."),a?()=>u.push("".concat(r.So,"/configure/").concat(a,"#assets")):()=>u.push(r.So)))),eL())},[ey,eN,eO,m,h,u,eL]),eM=(0,l.useCallback)(async e=>{if("string"==typeof(null==e?void 0:e.value)){let s=await eb({monitorId:t,urnList:eN,systemKey:e.value});(0,z.D4)(s)?h((0,U.Vo)((0,z.e$)(s.error))):(h((0,U.t5)("".concat(eN.length," assets have been assigned to ").concat(e.label,"."),"Confirmed")),eL())}},[eb,t,eN,h,eL]),ez=(0,l.useCallback)(async e=>{if(!eO.length)return;let s=eO.map(t=>{let s=R()([...t.preferred_data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:s}}),n=await ek({monitorId:t,assets:s});(0,z.D4)(n)?h((0,U.Vo)((0,z.e$)(n.error))):(h((0,U.t5)("Consent categories added to ".concat(eN.length," assets").concat(m?" from ".concat(m):"","."),"Confirmed")),eL())},[eO,ek,t,eN,m,h,eL]),eV=(0,l.useCallback)(async()=>{let e=await ef({urnList:eN});(0,z.D4)(e)?h((0,U.Vo)((0,z.e$)(e.error))):(h((0,U.t5)(m===r.Kl?"".concat(eN.length," uncategorized assets have been ignored and will not appear in future scans."):"".concat(eN.length," assets from ").concat(m," have been ignored and will not appear in future scans."),"Confirmed")),eL())},[ef,eN,m,h,eL]),eZ=(0,l.useCallback)(async()=>{let e=await e_({urnList:eN});(0,z.D4)(e)?h((0,U.Vo)((0,z.e$)(e.error))):(h((0,U.t5)("".concat(eN.length," assets have been restored and will appear in future scans."),"Confirmed")),eL())},[e_,eN,h,eL]),eU=(0,l.useCallback)(async()=>{let e=(null==ep?void 0:ep.items.length)||0,n=await ex({monitor_config_key:t,resolved_system_ids:[s]});(0,z.D4)(n)?h((0,U.Vo)((0,z.e$)(n.error))):(u.push({pathname:r.lA,query:{monitorId:encodeURIComponent(t)}}),h((0,U.t5)("".concat(e," assets from ").concat(m," have been added to the system inventory."),"Confirmed")),eL())},[null==ep?void 0:ep.items.length,ex,t,s,u,h,m,eL]),eG=(0,l.useCallback)(async e=>{await K(e),es(),eL()},[K,es,eL]);return{columns:eP,data:ep,isLoading:eh,isFetching:em,tableState:Y,searchQuery:ei,updateSearch:er,updateFilters:eo,updateSorting:ed,updatePageIndex:ec,updatePageSize:eu,resetState:es,tableProps:eD.tableProps,selectionProps:eD.selectionProps,filterTabs:P,activeTab:B,handleTabChange:eG,activeParams:J,actionsDisabled:F,selectedRows:eO,selectedUrns:eN,hasSelectedRows:eD.hasSelectedRows,resetSelections:eL,systemName:m,consentStatus:i,handleBulkAdd:eR,handleBulkAssignSystem:eM,handleBulkAddDataUse:ez,handleBulkIgnore:eV,handleBulkRestore:eZ,handleAddAll:eU,anyBulkActionIsLoading:eE,isAddingResults:eg,isIgnoringResults:ev,isAddingAllResults:ej,isBulkUpdatingSystem:eC,isBulkAddingDataUses:ew,isRestoringResults:eS,disableAddAll:eA}},el=e=>{var t;let{monitorId:s,systemId:a,consentStatus:i}=e,[r,o]=(0,l.useState)(!1),[d,m]=(0,l.useState)(!1),[y,g]=(0,l.useState)(null),{columns:f,searchQuery:v,updateSearch:x,resetState:b,tableProps:C,selectionProps:k,filterTabs:_,activeTab:S,handleTabChange:E,activeParams:A,actionsDisabled:T,selectedUrns:I,hasSelectedRows:D,resetSelections:N,handleBulkAdd:O,handleBulkAssignSystem:P,handleBulkAddDataUse:R,handleBulkIgnore:M,handleBulkRestore:z,handleAddAll:V,anyBulkActionIsLoading:Z,isAddingAllResults:U,isBulkUpdatingSystem:G,isBulkAddingDataUses:q,disableAddAll:B}=ea({monitorId:s,systemId:a,consentStatus:i,onShowComplianceIssueDetails:e=>{g(e)}}),K=async e=>{await P(e),o(!1)},$=async e=>{await R(e),m(!1)};return s&&a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Niu,{"aria-label":"Asset state filter",mode:"horizontal",items:_.map(e=>({key:e.hash,label:e.label})),selectedKeys:[S],onClick:async e=>{await E(e.key)},className:"mb-4","data-testid":"asset-state-filter"}),(0,n.jsxs)(c.jqI,{justify:"space-between",align:"center",className:"sticky -top-6 z-10 mb-4 bg-white py-4",children:[(0,n.jsx)(h.f,{value:v,onChange:x,placeholder:"Search by asset name..."}),(0,n.jsxs)(c.vyj,{size:"large",children:[D&&(0,n.jsx)(u.a,{count:I.length}),(0,n.jsxs)(c.vyj,{size:"small",children:[(0,n.jsx)(c.wpx,{onClick:()=>{b(),N()},"data-testid":"clear-filters",children:"Clear filters"}),(0,n.jsx)(c.S0p,{overlayClassName:"bulk-actions-menu-dropdown",menu:{items:[...(null==A?void 0:null===(t=A.diff_status)||void 0===t?void 0:t.includes(p.LL.MUTED))?[{key:"restore",label:"Restore",onClick:z}]:[{key:"add",label:"Add",onClick:O},{key:"add-data-use",label:"Add consent category",onClick:()=>m(!0)},{key:"assign-system",label:"Assign system",onClick:()=>o(!0)},{type:"divider"},{key:"ignore",label:"Ignore",onClick:M}]]},trigger:["click"],children:(0,n.jsx)(c.wpx,{icon:(0,n.jsx)(c.PJP._ME,{}),iconPosition:"end",loading:Z,"data-testid":"bulk-actions-menu",disabled:!D||Z||T,type:"primary",children:"Actions"})}),(0,n.jsx)(c.esZ,{title:B?"These assets require a system before you can add them to the inventory.":void 0,children:(0,n.jsx)(c.wpx,{onClick:V,disabled:B,loading:U,type:"primary",icon:(0,n.jsx)(c.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,n.jsx)(c.V5H,{...C,columns:f,rowSelection:k,locale:{emptyText:(0,n.jsx)(c.oj8,{image:c.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})},"aria-labelledby":"breadcrumb-current-page"}),(0,n.jsx)(w,{isOpen:r,onClose:()=>{o(!1)},onSave:K,isSaving:G}),(0,n.jsx)(j,{isOpen:d,onClose:()=>{m(!1)},onSave:$,isSaving:q}),y&&(0,n.jsx)(L,{isOpen:!!y,stagedResource:y,onCancel:()=>{g(null)}})]}):null};var ei=s(71985),er=s(98243),eo=()=>{let e=(0,a.useRouter)(),t=decodeURIComponent(e.query.monitorId),s=decodeURIComponent(e.query.systemId),{data:c}=(0,d.wi)({key:t,page:1,size:1,search:"",diff_status:[er.L.ADDITION],resolved_system_id:s}),u=null==c?void 0:c.items[0];return(0,l.useEffect)(()=>{c&&0===c.items.length&&e.push({pathname:r.lA,query:{monitorId:encodeURIComponent(t)}})},[c,e,t]),(0,n.jsxs)(i.Z,{title:"Action center - Discovered assets",children:[(0,n.jsx)(o.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:r.vi},{title:t,href:"".concat(r.vi,"/").concat(ei.w.WEBSITE,"/").concat(t)},{title:s===r.Kl?"Uncategorized assets":null==u?void 0:u.name}],isSticky:!1}),(0,n.jsx)(el,{monitorId:t,systemId:s,consentStatus:null==u?void 0:u.consent_status})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)},18992:function(e){e.exports={cellBleed:"Cells_cellBleed__dik43"}}},function(e){e.O(0,[431,6344,7245,3931,401,4589,1438,2888,9774,179],function(){return e(e.s=14599)}),_N_E=e.O()}]);