"""Fix differences

Revision ID: 2889a136b81c
Revises: 5095a5b6d7dd
Create Date: 2024-10-30 10:42:11.623700

"""

from typing import Sequence, Union

import sqlalchemy as sa
from alembic import op
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision: str = "2889a136b81c"
down_revision: Union[str, None] = "5095a5b6d7dd"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    from basejump.core.database.crud.crud_utils import gen_client_id_suffixes
    from basejump.core.database.db_connect import ConnectDB, conn_params_noasync

    conn_db = ConnectDB(conn_params=conn_params_noasync)
    basejump_engine_noasync = conn_db.connect_db()
    suffixes = gen_client_id_suffixes(engine=basejump_engine_noasync, reverse=False, local_override=True)
    print("Running suffixes...", suffixes)
    print("Dropping views...")
    for suffix in suffixes:
        if not suffix or suffix == "0":
            continue
        for table in [
            # "connect.team_connection",
            # "connect.table_connection",
            # "connect.connection",
            # "connect.database",
            # "connect.db_conn",
            # "connect.vector_db",
            # "connect.database_tables",
            # "connect.table_columns",
            # "ai_model.user_chat_id",
            # "ai_model.prompt_history",
            # "ai_model.chat_history",
            # "ai_model.result_history",
            "ai_model.token_count",
            # "transaction.deposit_history",
            # "transaction.withdraw_history",
            # "transaction.basejump_credit_ledger",
        ]:
            table_name = f"{table.split('.')[0] + suffix}.{table.split('.')[1]}"
            # Drop the view
            op.execute(f"DROP VIEW {table_name}")
    op.drop_constraint("token_count_client_id_fkey", "token_count", schema="ai_model", type_="foreignkey")
    op.create_foreign_key(
        None,
        "token_count",
        "prompt_history",
        ["client_id", "prompt_id"],
        ["client_id", "prompt_id"],
        source_schema="ai_model",
        referent_schema="ai_model",
        ondelete="CASCADE",
    )

    for suffix in suffixes:
        if not suffix or suffix == "0":
            continue
        # Create views
        for table in [
            # "connect.team_connection",
            # "connect.table_connection",
            # "connect.connection",
            # "connect.database",
            # "connect.db_conn",
            # "connect.vector_db",
            # "connect.database_tables",
            # "connect.table_columns",
            # "ai_model.user_chat_id",
            # "ai_model.prompt_history",
            # "ai_model.chat_history",
            # "ai_model.result_history",
            "ai_model.token_count",
            # "transaction.deposit_history",
            # "transaction.withdraw_history",
            # "transaction.basejump_credit_ledger",
        ]:
            table_name_w_suffix = f"{table.split('.')[0] + suffix}.{table.split('.')[1]}"
            op.execute(
                f"""\
        CREATE VIEW {table_name_w_suffix} WITH(security_invoker=TRUE) AS \
        SELECT * FROM {table} \
        WHERE client_id = {suffix}"""
            )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, "withdraw_history", schema="transaction", type_="foreignkey")
    op.create_foreign_key(
        "withdraw_history_client_id_prompt_id_fkey",
        "withdraw_history",
        "prompt_history",
        ["client_id", "prompt_id"],
        ["client_id", "prompt_id"],
        source_schema="transaction",
        referent_schema="ai_model",
    )
    op.create_foreign_key(
        "withdraw_history_client_id_fkey",
        "withdraw_history",
        "client",
        ["client_id"],
        ["client_id"],
        source_schema="transaction",
        referent_schema="account",
        ondelete="CASCADE",
    )
    op.alter_column(
        "withdraw_history",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="transaction",
    )
    op.alter_column(
        "withdraw_history",
        "withdrawal_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="transaction",
    )
    op.create_unique_constraint(
        "deposit_history_client_id_deposit_uuid_key",
        "deposit_history",
        ["client_id", "deposit_uuid"],
        schema="transaction",
    )
    op.alter_column(
        "deposit_history",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="transaction",
    )
    op.alter_column(
        "deposit_history",
        "deposit_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="transaction",
    )
    op.drop_constraint(None, "basejump_credit_ledger", schema="transaction", type_="foreignkey")
    op.create_foreign_key(
        "basejump_credit_ledger_client_id_withdrawal_id_fkey",
        "basejump_credit_ledger",
        "withdraw_history",
        ["client_id", "withdrawal_id"],
        ["client_id", "withdrawal_id"],
        source_schema="transaction",
        referent_schema="transaction",
    )
    op.create_foreign_key(
        "basejump_credit_ledger_client_id_fkey",
        "basejump_credit_ledger",
        "client",
        ["client_id"],
        ["client_id"],
        source_schema="transaction",
        referent_schema="account",
        ondelete="CASCADE",
    )
    op.alter_column(
        "basejump_credit_ledger",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="transaction",
    )
    op.alter_column(
        "basejump_credit_ledger",
        "purchased_credit_bal",
        existing_type=sa.NUMERIC(),
        nullable=True,
        existing_server_default=sa.text("0"),
        schema="transaction",
    )
    op.alter_column(
        "basejump_credit_ledger",
        "credit_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="transaction",
    )
    op.drop_constraint(None, "team_connection", schema="connect", type_="foreignkey")
    op.create_foreign_key(
        "team_connection_client_id_fkey",
        "team_connection",
        "client",
        ["client_id"],
        ["client_id"],
        source_schema="connect",
        referent_schema="account",
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "team_connection_conn_id_fkey",
        "team_connection",
        "connection",
        ["conn_id"],
        ["conn_id"],
        source_schema="connect",
        referent_schema="connect",
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "table_columns_client_id_fkey",
        "table_columns",
        "client",
        ["client_id"],
        ["client_id"],
        source_schema="connect",
        referent_schema="account",
        ondelete="CASCADE",
    )
    op.alter_column(
        "table_columns",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="connect",
    )
    op.alter_column(
        "table_columns",
        "distinct_values",
        existing_type=postgresql.ARRAY(sa.String()),
        type_=postgresql.ARRAY(sa.TEXT()),
        existing_nullable=True,
        schema="connect",
    )
    op.alter_column(
        "table_columns",
        "col_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="connect",
    )
    op.alter_column(
        "database_tables",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="connect",
    )
    op.alter_column(
        "database_tables",
        "primary_keys",
        existing_type=postgresql.ARRAY(sa.String()),
        type_=postgresql.ARRAY(sa.TEXT()),
        existing_nullable=True,
        schema="connect",
    )
    op.alter_column(
        "database_tables",
        "tbl_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="connect",
    )
    op.alter_column(
        "user_chat_id",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="ai_model",
    )
    op.alter_column(
        "user_chat_id",
        "chat_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="ai_model",
    )
    op.drop_constraint(None, "token_count", schema="ai_model", type_="foreignkey")
    op.create_foreign_key(
        "token_count_client_id_fkey",
        "token_count",
        "client",
        ["client_id"],
        ["client_id"],
        source_schema="ai_model",
        referent_schema="account",
        ondelete="CASCADE",
    )
    op.create_foreign_key(
        "token_count_client_id_prompt_id_fkey",
        "token_count",
        "prompt_history",
        ["client_id", "prompt_id"],
        ["client_id", "prompt_id"],
        source_schema="ai_model",
        referent_schema="ai_model",
    )
    op.alter_column(
        "token_count",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="ai_model",
    )
    op.alter_column("token_count", "prompt_id", existing_type=sa.INTEGER(), nullable=True, schema="ai_model")
    op.alter_column(
        "token_count",
        "token_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="ai_model",
    )
    op.drop_constraint(None, "result_history", schema="ai_model", type_="foreignkey")
    op.create_foreign_key(
        "result_history_result_conn_id_fkey",
        "result_history",
        "connection",
        ["result_conn_id"],
        ["conn_id"],
        source_schema="ai_model",
        referent_schema="connect",
        ondelete="CASCADE",
    )
    op.alter_column(
        "result_history",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="ai_model",
    )
    op.alter_column(
        "result_history",
        "saved_result",
        existing_type=sa.BOOLEAN(),
        nullable=True,
        existing_server_default=sa.text("false"),
        schema="ai_model",
    )
    op.alter_column(
        "result_history",
        "share_w_team",
        existing_type=sa.BOOLEAN(),
        nullable=True,
        existing_server_default=sa.text("false"),
        schema="ai_model",
    )
    op.alter_column(
        "result_history",
        "result_deleted",
        existing_type=sa.BOOLEAN(),
        nullable=True,
        existing_server_default=sa.text("false"),
        schema="ai_model",
    )
    op.alter_column(
        "result_history",
        "result_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="ai_model",
    )
    op.alter_column(
        "prompt_history",
        "prompt_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="ai_model",
    )
    op.create_foreign_key(
        "chat_history_client_id_fkey",
        "chat_history",
        "client",
        ["client_id"],
        ["client_id"],
        source_schema="ai_model",
        referent_schema="account",
        ondelete="CASCADE",
    )
    op.alter_column(
        "chat_history",
        "timestamp",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="ai_model",
    )
    op.alter_column("chat_history", "content", existing_type=sa.VARCHAR(), nullable=True, schema="ai_model")
    op.alter_column(
        "chat_history",
        "prompt_time",
        existing_type=postgresql.TIMESTAMP(timezone=True),
        nullable=True,
        existing_server_default=sa.text("CURRENT_TIMESTAMP"),
        schema="ai_model",
    )
    op.alter_column("chat_history", "parent_msg_uuid", existing_type=sa.UUID(), nullable=True, schema="ai_model")
    op.alter_column(
        "chat_history",
        "msg_uuid",
        existing_type=sa.UUID(),
        nullable=True,
        existing_server_default=sa.text("gen_random_uuid()"),
        schema="ai_model",
    )
    op.create_table(
        "user_chat_id_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("chat_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("chat_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("user_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("team_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("chat_name", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("chat_description", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        sa.Column("last_updt_date", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="ai_model",
    )
    op.create_table(
        "chat_history_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("msg_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("msg_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("parent_msg_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("result_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("chat_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("prompt_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("initial_prompt", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("prompt_time", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        sa.Column("content", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("internal_content", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("role", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("msg_type", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("sql_query", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("result_type", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="ai_model",
    )
    op.create_table("traffic_violations_p_hash", sa.Column("seqid", sa.INTEGER(), autoincrement=False, nullable=True))
    op.create_table(
        "withdraw_history_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("withdrawal_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("withdrawal_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("prompt_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("sub_plan_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("transaction_amt", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("transaction_description", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("withdrawn_credits", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="transaction",
    )
    op.create_table(
        "basejump_credit_ledger_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("credit_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("credit_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("sub_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("withdrawal_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("deposit_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("allotted_credit_bal", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("purchased_credit_bal", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="transaction",
    )
    op.create_table(
        "deposit_history_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("deposit_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("deposit_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("sub_plan_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("transaction_item_description", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("transaction_item_quantity", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("transaction_item_cost", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("transaction_description", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("transaction_type", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("transaction_total_cost", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("deposited_credits", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="transaction",
    )
    op.create_table(
        "table_connection_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("conn_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("tbl_id", sa.INTEGER(), autoincrement=False, nullable=True),
        schema="connect",
    )
    op.create_table(
        "result_history_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("result_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("result_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("result_conn_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("result_exp_time", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        sa.Column("result_deleted", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("result_file_path", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("row_num_total", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("preview_file_path", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("row_num_preview", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("result_type", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("title", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("description", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("author_user_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("author_team_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("share_w_team", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("saved_result", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("refresh_result", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("sql_query", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="ai_model",
    )
    op.create_table(
        "team_connection_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("conn_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("team_id", sa.INTEGER(), autoincrement=False, nullable=True),
        schema="connect",
    )
    op.create_table(
        "prompt_history_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("prompt_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("prompt_uuid", sa.UUID(), autoincrement=False, nullable=True),
        schema="ai_model",
    )
    op.create_table(
        "token_count_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("token_id", sa.BIGINT(), autoincrement=False, nullable=True),
        sa.Column("token_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("prompt_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("prompt", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("user_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("team_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("ai_model_provider", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("ai_model_nm", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("cost_per_1k_tokens_input", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("cost_per_1k_tokens_output", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("total_embedding_token_count", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("prompt_llm_token_count", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("completion_llm_token_count", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("total_llm_token_count", sa.NUMERIC(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="ai_model",
    )
    op.create_table(
        "traffic_violations_p_hash_p1", sa.Column("seqid", sa.INTEGER(), autoincrement=False, nullable=True)
    )
    op.create_table(
        "table_columns_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("col_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("col_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("tbl_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("column_name", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("column_type", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("description", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("foreign_key_table_name", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("foreign_key_column_name", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("primary_key", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("distinct_values", postgresql.ARRAY(sa.VARCHAR()), autoincrement=False, nullable=True),
        sa.Column("ignore", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="connect",
    )
    op.create_table(
        "database_tables_migrate",
        sa.Column("client_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("tbl_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("tbl_uuid", sa.UUID(), autoincrement=False, nullable=True),
        sa.Column("db_id", sa.INTEGER(), autoincrement=False, nullable=True),
        sa.Column("table_name", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("context", sa.VARCHAR(), autoincrement=False, nullable=True),
        sa.Column("ignore", sa.BOOLEAN(), autoincrement=False, nullable=True),
        sa.Column("primary_keys", postgresql.ARRAY(sa.VARCHAR()), autoincrement=False, nullable=True),
        sa.Column("timestamp", postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
        schema="connect",
    )
    # ### end Alembic commands ###
