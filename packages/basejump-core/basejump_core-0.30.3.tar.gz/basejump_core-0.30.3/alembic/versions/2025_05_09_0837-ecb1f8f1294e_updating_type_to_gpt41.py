"""Updating type to GPT41

Revision ID: ecb1f8f1294e
Revises: 3eb29c0d455f
Create Date: 2025-05-09 08:37:33.221604

"""

from typing import Sequence, Union

from alembic import op

# revision identifiers, used by Alembic.
revision: str = "ecb1f8f1294e"
down_revision: Union[str, None] = "3eb29c0d455f"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.execute("ALTER TYPE aimodelschemas RENAME TO aimodelschemas_old")
    op.execute(
        "CREATE TYPE aimodelschemas AS ENUM ('llama3-70b-8192','gpt-4o','gpt-41', 'gpt-41o', 'gpt-4','gpt-4o-mini','gpt-3.5-turbo','gpt-3.5-turbo-0613','text-embedding-ada-002','text-embedding-3-large','text-embedding-3-small','us.anthropic.claude-3-5-sonnet-20241022-v2:0','us.anthropic.claude-3-7-sonnet-20250219-v1:0')"
    )
    op.execute("""ALTER TABLE account.client ALTER COLUMN llm DROP DEFAULT;""")
    op.execute(
        """ALTER TABLE account.client
    ALTER COLUMN llm
    TYPE aimodelschemas
    USING llm::text::aimodelschemas;"""
    )
    op.execute("UPDATE account.client SET llm = 'gpt-41' WHERE llm = 'gpt-41o'")
    op.execute("ALTER TABLE account.client ALTER COLUMN llm SET DEFAULT 'gpt-4o';")
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###
