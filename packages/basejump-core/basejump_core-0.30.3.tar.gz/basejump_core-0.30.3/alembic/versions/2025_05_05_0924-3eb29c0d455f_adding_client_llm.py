"""Adding client LLM

Revision ID: 3eb29c0d455f
Revises: 24eadde936f1
Create Date: 2025-05-05 09:24:31.555285

"""

from typing import Sequence, Union

import sqlalchemy as sa
from alembic import op

# revision identifiers, used by Alembic.
revision: str = "3eb29c0d455f"
down_revision: Union[str, None] = "e3b9232ad75d"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.execute(
        "CREATE TYPE aimodelschemas AS ENUM ('llama3-70b-8192','gpt-4o','gpt-41o', 'gpt-4','gpt-4o-mini','gpt-3.5-turbo','gpt-3.5-turbo-0613','text-embedding-ada-002','text-embedding-3-large','text-embedding-3-small','us.anthropic.claude-3-5-sonnet-20241022-v2:0','us.anthropic.claude-3-7-sonnet-20250219-v1:0')"
    )
    op.add_column(
        "client",
        sa.Column(
            "llm",
            sa.Enum(
                "llama3-70b-8192",
                "gpt-41o",
                "gpt-4o",
                "gpt-4",
                "gpt-4o-mini",
                "gpt-3.5-turbo",
                "gpt-3.5-turbo-0613",
                "text-embedding-ada-002",
                "text-embedding-3-large",
                "text-embedding-3-small",
                "us.anthropic.claude-3-5-sonnet-20241022-v2:0",
                "us.anthropic.claude-3-7-sonnet-20250219-v1:0",
                name="aimodelschemas",
            ),
            server_default=sa.text("'gpt-4o'"),
            nullable=True,
        ),
        schema="account",
    )
    op.execute("UPDATE account.client SET llm = 'gpt-4o'")
    op.alter_column("client", "llm", server_default=sa.text("'gpt-4o'"), schema="account", nullable=False)
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column("client", "llm", schema="account")
    # ### end Alembic commands ###
