{% load static i18n %}

<!-- ========== Left Sidebar Start ========== -->
<div class="spectra-sidebar" id="spectra-sidebar">
    <div class="sidebar-inner" data-simplebar>
        
        <!-- Logo Section -->
        <div class="sidebar-logo">
            <a href="{% url 'admin:index' %}" class="logo-link">
                {% if SPECTRA_CONFIG.logo %}
                <img src="{% static SPECTRA_CONFIG.logo %}" alt="{{ SPECTRA_CONFIG.site_title }}" class="logo-img">
                {% else %}
                <span class="logo-text">{{ SPECTRA_CONFIG.site_header|default:"Spectra" }}</span>
                {% endif %}
            </a>
            <button class="sidebar-toggle-btn" id="sidebar-toggle-btn" aria-label="Toggle Sidebar">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
        </div>

        <!-- User Profile Section (Optional) -->
        {% if SPECTRA_CONFIG.sidebar_show_user %}
        <div class="sidebar-user">
            <div class="user-avatar">
                {% if user.profile_image %}
                <img src="{{ user.profile_image.url }}" alt="{{ user.get_full_name|default:user.username }}">
                {% else %}
                <div class="avatar-placeholder">
                    {{ user.get_full_name|default:user.username|slice:":1"|upper }}
                </div>
                {% endif %}
            </div>
            <div class="user-info">
                <div class="user-name">{{ user.get_full_name|default:user.username }}</div>
                <div class="user-role">{{ user.groups.first.name|default:"Administrator" }}</div>
            </div>
        </div>
        {% endif %}

        <!-- Navigation Menu -->
        <nav class="sidebar-nav" id="sidebar-nav">
            <ul class="nav-list">
                
                <!-- Dashboard -->
                <li class="nav-item">
                    <a href="{% url 'admin:index' %}" class="nav-link {% if request.resolver_match.url_name == 'index' %}active{% endif %}">
                        <span class="nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                        </span>
                        <span class="nav-text">{% trans "Dashboard" %}</span>
                        {% if SPECTRA_CONFIG.show_badges %}
                        <span class="nav-badge badge-primary">New</span>
                        {% endif %}
                    </a>
                </li>

                <!-- Divider -->
                <li class="nav-divider">
                    <span class="divider-text">{% trans "Applications" %}</span>
                </li>

                <!-- Dynamic Admin Apps -->
                {% for app in app_list %}
                <li class="nav-item {% if app.models|length > 1 %}has-submenu{% endif %}">
                    {% if app.models|length == 1 %}
                        <!-- Single Model - Direct Link -->
                        <a href="{{ app.models.0.admin_url }}" class="nav-link">
                            <span class="nav-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                            </span>
                            <span class="nav-text">{{ app.models.0.name }}</span>
                        </a>
                    {% else %}
                        <!-- Multiple Models - Dropdown -->
                        <a href="javascript:void(0);" class="nav-link" data-toggle="submenu">
                            <span class="nav-icon">
                                {% if app.app_label == 'auth' %}
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="8.5" cy="7" r="4"></circle>
                                    <polyline points="17 11 19 13 23 9"></polyline>
                                </svg>
                                {% elif app.app_label == 'contenttypes' %}
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                                {% else %}
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                                </svg>
                                {% endif %}
                            </span>
                            <span class="nav-text">{{ app.name }}</span>
                            <span class="nav-arrow">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </span>
                        </a>
                        <ul class="nav-submenu">
                            {% for model in app.models %}
                            <li class="submenu-item">
                                <a href="{{ model.admin_url }}" class="submenu-link">
                                    <span class="submenu-text">{{ model.name }}</span>
                                    {% if model.add_url %}
                                    <a href="{{ model.add_url }}" class="submenu-add-btn" title="Add {{ model.name }}">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </a>
                                    {% endif %}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </li>
                {% endfor %}

                <!-- Custom Menu Items from Config -->
                {% if SPECTRA_CONFIG.sidebar_menu_items %}
                    <li class="nav-divider">
                        <span class="divider-text">{% trans "Quick Links" %}</span>
                    </li>
                    {% for item in SPECTRA_CONFIG.sidebar_menu_items %}
                    <li class="nav-item">
                        <a href="{{ item.url }}" class="nav-link" {% if item.target %}target="{{ item.target }}"{% endif %}>
                            <span class="nav-icon">
                                {% if item.icon %}
                                    {{ item.icon|safe }}
                                {% else %}
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12 6 12 12 16 14"></polyline>
                                </svg>
                                {% endif %}
                            </span>
                            <span class="nav-text">{{ item.label }}</span>
                            {% if item.badge %}
                            <span class="nav-badge badge-{{ item.badge_class|default:'info' }}">{{ item.badge }}</span>
                            {% endif %}
                        </a>
                    </li>
                    {% endfor %}
                {% endif %}

                <!-- Settings & Logout -->
                <li class="nav-divider">
                    <span class="divider-text">{% trans "System" %}</span>
                </li>

                {% if user.is_superuser %}
                <li class="nav-item">
                    <a href="{% url 'admin:index' %}" class="nav-link">
                        <span class="nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6m8.66-11l-5.2 3m-6.92 4l-5.2 3m0-12l5.2 3m6.92 4l5.2 3"></path>
                            </svg>
                        </span>
                        <span class="nav-text">{% trans "Settings" %}</span>
                    </a>
                </li>
                {% endif %}

                <li class="nav-item">
                    <a href="{% url 'admin:logout' %}" class="nav-link">
                        <span class="nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                        </span>
                        <span class="nav-text">{% trans "Logout" %}</span>
                    </a>
                </li>

            </ul>
        </nav>

        <!-- Sidebar Footer -->
        <div class="sidebar-footer">
            <div class="footer-content">
                <span class="footer-version">v{{ SPECTRA_VERSION|default:"2.0.0" }}</span>
            </div>
        </div>

    </div>
</div>

<!-- Sidebar Overlay for Mobile -->
<div class="sidebar-overlay" id="sidebar-overlay"></div>
