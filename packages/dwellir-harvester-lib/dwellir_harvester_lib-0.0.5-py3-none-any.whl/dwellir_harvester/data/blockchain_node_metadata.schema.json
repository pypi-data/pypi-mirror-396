{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Dwellir Harvester Metadata",
  "description": "Standardized metadata about a node, its system, and collected data",
  "type": "object",
  "properties": {
    "harvester": {
      "type": "object",
      "properties": {
        "harvester-version": {
          "type": "string"
        },
        "collection_time": {
          "type": "string",
          "format": "date-time"
        },
        "collectors_used": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["harvester-version", "collection_time", "collectors_used"]
    },
    "host": {
      "type": "object",
      "additionalProperties": true
    },
    "collectors": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "meta": {
            "type": "object",
            "properties": {
              "collector_type": { "type": "string" },
              "collector_name": { "type": "string" },
              "collector_version": { "type": "string" },
              "collection_time": { 
                "type": "string",
                "format": "date-time"
              }
            },
            "required": ["collector_type", "collector_name", "collector_version", "collection_time"]
          },
          "data": {
            "type": "object",
            "additionalProperties": true
          },
          "message": {
            "type": "string"
          }
        },
        "required": ["meta", "data"]
      }
    }
  },
  "required": ["harvester", "host", "collectors"]
}