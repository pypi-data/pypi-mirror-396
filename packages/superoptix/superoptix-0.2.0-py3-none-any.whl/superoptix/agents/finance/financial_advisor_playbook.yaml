apiVersion: agent/v1
kind: AgentSpec
metadata:
  name: Financial Advisor
  id: financial_advisor
  namespace: finance
  version: 1.0.0
  agent_type: Supervised
  level: oracles
  description: An agent that provides basic financial planning advice and investment guidance.
spec:
  language_model:
    location: local
    provider: ollama
    model: llama3.1:8b
    api_base: http://localhost:11434
  input_fields:
  - name: financial_situation
    type: str
    description: Client's current financial situation including income and expenses
    required: true
  - name: financial_goals
    type: str
    description: Client's short-term and long-term financial goals
    required: true
  output_fields:
  - name: financial_analysis
    type: str
    description: Step-by-step analysis of the client's financial situation
    required: true
  - name: recommendations
    type: str
    description: Personalized financial recommendations and action plan
    required: true
  persona:
    name: FinBot
    role: Financial Advisor
    goal: Help individuals make informed financial decisions and plan for their future
    traits:
    - analytical
    - prudent
    - knowledgeable
    - trustworthy
  tasks:
  - name: create_financial_plan
    instruction: You are a Financial Advisor. Think through the client's financial situation step-by-step to create a comprehensive
      financial plan. Consider income, expenses, goals, and risk tolerance.
    inputs:
    - name: financial_situation
      type: str
      description: Client's current financial situation including income and expenses
      required: true
    - name: financial_goals
      type: str
      description: Client's short-term and long-term financial goals
      required: true
    outputs:
    - name: financial_analysis
      type: str
      description: Step-by-step analysis of the client's financial situation
    - name: recommendations
      type: str
      description: Personalized financial recommendations and action plan
  agentflow:
  - name: analyze_finances_systematically
    type: Think
    task: create_financial_plan
  evaluation:
    builtin_metrics:
    - name: answer_correctness
      threshold: 0.8
  feature_specifications:
    scenarios:
    - name: retirement_planning_analysis
      description: Given a client's retirement planning needs, the agent should provide comprehensive retirement strategy
        with specific recommendations
      input:
        financial_situation: Age 35, annual income $80,000, current 401k $25,000, monthly expenses $4,500, no debt
        financial_goals: Retire at 65 with 80% income replacement, children's college fund, travel budget
      expected_output:
        financial_analysis: "**Retirement Planning Analysis for 35-Year-Old Client**\n                    \n**Step 1: Current\
          \ Financial Position**\n- Annual Income: $80,000 (strong earning potential)\n- Monthly Cash Flow: $6,667 - $4,500\
          \ = $2,167 available\n- Current 401k: $25,000 (good start for age 35)\n- Debt Status: No debt (excellent position)\n\
          \n**Step 2: Retirement Goal Assessment**\n- Target Retirement: Age 65 (30 years to save)\n- Income Replacement:\
          \ 80% \xD7 $80,000 = $64,000 annually\n- Required Portfolio: ~$1.6M (using 4% withdrawal rule)\n- Time Horizon:\
          \ 30 years for growth\n\n**Step 3: Current Trajectory Analysis**\n- With $25,000 at 7% growth for 30 years = ~$190,000\n\
          - Gap to fill: $1.6M - $190,000 = $1.41M needed\n- Required monthly savings: ~$1,400 for remaining goal"
        recommendations: '**Priority Action Plan:**


          **Immediate Actions (Month 1-3):**

          1. Maximize 401k contribution to at least 15% ($12,000/year)

          2. Secure employer match if available (free money)

          3. Open Roth IRA for additional $6,000 annual contribution

          4. Set up automatic monthly investments


          **Medium-term Strategy (Year 1-5):**

          - Target 20% savings rate ($16,000+ annually)

          - Consider backdoor Roth if income increases

          - Review and rebalance portfolio annually

          - Increase contributions with salary raises


          **Long-term Considerations:**

          - Plan for healthcare costs in retirement

          - Consider long-term care insurance after age 50

          - Evaluate Social Security benefits projection

          - Estate planning documents by age 40'
    - name: debt_consolidation_strategy
      description: When a client has multiple debts, the agent should provide strategic debt payoff plan with prioritization
      input:
        financial_situation: Annual income $65,000, credit card debt $15,000 (18% APR), student loans $30,000 (4.5% APR),
          car loan $12,000 (6% APR), monthly minimum payments $800
        financial_goals: Become debt-free, improve credit score, start emergency fund
      expected_output:
        financial_analysis: "**Debt Analysis & Prioritization**\n\n**Step 1: Debt Inventory**\n- Credit Cards: $15,000 @ 18%\
          \ APR (HIGH PRIORITY)\n- Student Loans: $30,000 @ 4.5% APR (LOW PRIORITY) \n- Car Loan: $12,000 @ 6% APR (MEDIUM\
          \ PRIORITY)\n- Total Debt: $57,000\n- Current Payments: $800/month\n\n**Step 2: Interest Cost Analysis**\n- Credit\
          \ Card Interest: $2,700 annually\n- Car Loan Interest: $720 annually  \n- Student Loan Interest: $1,350 annually\n\
          - Total Annual Interest: $4,770\n\n**Step 3: Available Cash Flow**\n- Monthly Income: ~$5,417\n- Assuming expenses:\
          \ ~$3,500\n- Available for debt payoff: ~$1,917"
        recommendations: '**Debt Elimination Strategy: Modified Avalanche Method**


          **Phase 1: Credit Card Attack (Months 1-10)**

          - Pay minimums on all debts

          - Attack credit cards with all extra funds

          - Target payment: $1,500/month to credit cards

          - Payoff timeline: ~10 months, save $1,800 in interest


          **Phase 2: Car Loan Focus (Months 11-18)**

          - Redirect credit card payments to car loan

          - Target payment: $1,500/month to car

          - Payoff timeline: 8 additional months


          **Phase 3: Student Loan Strategy (Months 19+)**

          - Consider income-driven repayment plans

          - Evaluate loan forgiveness programs

          - May keep minimum payments due to low rate


          **Immediate Actions:**

          - Stop using credit cards completely

          - Consider balance transfer to 0% APR card

          - Side income opportunities to accelerate payoff

          - Build $1,000 mini emergency fund first'
    - name: financial_advisor_best_practices
      description: When asked about finance best practices, the agent should provide current industry standards and guidelines
      input:
        financial_situation: Industry best practices for finance operations
        financial_goals: ''
      expected_output:
        financial_analysis: Comprehensive best practices guide with implementation steps
        recommendations: ''
    - name: financial_advisor_compliance_guidance
      description: Given regulatory requirements, the agent should provide compliance guidance specific to finance
      input:
        financial_situation: Compliance requirements for finance operations
        financial_goals: ''
      expected_output:
        financial_analysis: Detailed compliance checklist with regulatory requirements
        recommendations: ''
    - name: financial_advisor_strategic_planning
      description: When developing finance strategies, the agent should provide forward-thinking recommendations
      input:
        financial_situation: Strategic planning for finance growth and optimization
        financial_goals: ''
      expected_output:
        financial_analysis: Comprehensive strategic plan with measurable objectives and timelines
        recommendations: ''
  optimization:
    optimizer:
      name: GEPA
      params:
        metric: answer_exact_match
        auto: light
        reflection_lm: llama3.1:8b
        max_full_evals: 3
        skip_perfect_score: true
    metric: answer_exact_match
    metric_threshold: 0.8
