apiVersion: agent/v1
kind: AgentSpec
metadata:
  name: mlx_test_agent
  namespace: testing
  id: mlx-test-v1-0-0
  version: 1.0.0
  agent_type: Interactive
  level: genies
description: A test agent using MLX Llama-3.2-3B-Instruct-4bit for Genie-tier ReAct capabilities
spec:
  language_model:
    provider: mlx
    model: mlx-community/Llama-3.2-3B-Instruct-4bit
    temperature: 0.1
    max_tokens: 2000
    api_base: http://localhost:8000
  input_fields:
  - name: question
    type: str
    description: User's question or request
    required: true
  - name: context
    type: str
    description: Additional context
    required: false
  output_fields:
  - name: answer
    type: str
    description: Comprehensive answer based on reasoning and tool usage
    required: true
  - name: reasoning
    type: str
    description: Step-by-step reasoning process
    required: true
  persona:
    name: MLXTestBot
    role: MLX Test Assistant
    goal: Test Genie-tier capabilities with local MLX model
    traits:
    - analytical
    - helpful
    - precise
  tasks:
  - name: answer_question
    instruction: Answer questions using tools and step-by-step reasoning
    type: react
    inputs:
    - name: question
      type: str
      description: User's question or request
      required: true
    - name: context
      type: str
      description: Additional context
      required: false
    outputs:
    - name: answer
      type: str
      description: Comprehensive answer based on reasoning and tool usage
    - name: reasoning
      type: str
      description: Step-by-step reasoning process
  react_config:
    max_iters: 5
    max_tool_calls: 3
    tool_selection_strategy: automatic
    reasoning_style: step_by_step
    error_handling: retry
    enable_tracing: true
  evaluation:
    builtin_metrics:
    - name: answer_correctness
      threshold: 0.7
    - name: reasoning_quality
      threshold: 0.6
    - name: tool_usage_effectiveness
      threshold: 0.5
  optimization:
    optimizer:
      name: GEPA
      params:
        metric: answer_exact_match
        auto: light
        reflection_lm: llama3.1:8b
        max_full_evals: 5
        skip_perfect_score: true
        reflection_minibatch_size: 3
    metric: answer_exact_match
    metric_threshold: 0.75
  feature_specifications:
    scenarios:
    - name: basic_qa
      description: Basic question answering with reasoning
      input:
        question: What is the capital of France and why is it significant?
      expected_output:
        answer: The capital of France is Paris
        reasoning: Step-by-step reasoning about Paris as the capital
