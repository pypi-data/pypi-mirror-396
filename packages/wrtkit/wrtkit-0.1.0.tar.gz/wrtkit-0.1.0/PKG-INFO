Metadata-Version: 2.4
Name: wrtkit
Version: 0.1.0
Summary: A Python library for managing OpenWRT configuration over SSH
Author-email: Thibaut Lamadon <thibaut.lamadon@gmail.com>
License: MIT
Project-URL: Homepage, https://github.com/tlamadon/wrtkit
Project-URL: Documentation, https://github.com/tlamadon/wrtkit#readme
Project-URL: Repository, https://github.com/tlamadon/wrtkit
Project-URL: Issues, https://github.com/tlamadon/wrtkit/issues
Keywords: openwrt,uci,network,configuration,ssh
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: System Administrators
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: System :: Networking
Classifier: Topic :: System :: Systems Administration
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: paramiko>=3.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: ruff>=0.1.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Provides-Extra: docs
Requires-Dist: mkdocs>=1.5.0; extra == "docs"
Requires-Dist: mkdocs-material>=9.0.0; extra == "docs"
Requires-Dist: mkdocstrings[python]>=0.24.0; extra == "docs"
Dynamic: license-file

# WRTKit

A Python library for managing OpenWRT configuration over SSH using UCI (Unified Configuration Interface).

## Features

- **Declarative Configuration**: Define OpenWRT configurations using Python objects with a simple builder pattern
- **Remote Management**: Connect to OpenWRT devices over SSH
- **Configuration Diff**: Compare local configuration with remote device configuration
- **Safe Apply**: Review changes before applying them to remote devices
- **Type Safety**: Strongly typed configuration objects for better IDE support

## Installation

```bash
pip install wrtkit
```

## Quick Start

```python
from wrtkit import UCIConfig, Network, Wireless, DHCP, Firewall
from wrtkit import SSHConnection

# Define your configuration
config = UCIConfig()

# Configure network
lan_bridge = config.network.device("br_lan") \
    .name("br-lan") \
    .type("bridge") \
    .add_port("lan1") \
    .add_port("lan2") \
    .add_port("lan3")

lan = config.network.interface("lan") \
    .device("br-lan") \
    .proto("static") \
    .ipaddr("192.168.10.1") \
    .netmask("255.255.255.0")

wan = config.network.interface("wan") \
    .device("eth1") \
    .proto("dhcp")

# Configure DHCP
dhcp_lan = config.dhcp.dhcp("lan") \
    .interface("lan") \
    .start(100) \
    .limit(150) \
    .leasetime("12h")

# Configure wireless
config.wireless.radio("radio0") \
    .channel(11) \
    .htmode("HT20") \
    .country("US") \
    .disabled(False)

config.wireless.wifi_iface("ap_two") \
    .device("radio0") \
    .mode("ap") \
    .network("lan") \
    .ssid("my-network") \
    .encryption("psk2") \
    .key("your-password")

# Connect to remote device
ssh = SSHConnection("192.168.1.1", username="root", password="your-password")

# Compare with remote configuration
diff = config.diff(ssh)
print(diff)

# Apply configuration if satisfied
if input("Apply changes? (y/n): ") == "y":
    config.apply(ssh)
```

## Supported UCI Components

Currently supported UCI packages and options:

### Network
- **Devices**: bridges, VLANs (8021q)
- **Interfaces**: static, DHCP, batman-adv, batman-adv hardif

### Wireless
- **Radios**: channel, htmode, country, txpower
- **Interfaces**: AP, mesh, station modes
- **Features**: 802.11r fast roaming, WPA2/WPA3 encryption

### DHCP
- DHCP server configuration
- IP range, lease time, interface binding

### Firewall
- Zones (input/output/forward policies)
- Forwarding rules
- Masquerading and MTU fix

## Examples

Check out the [examples](examples/) directory for:
- [simple_example.py](examples/simple_example.py) - Basic router setup
- [router_config.py](examples/router_config.py) - Advanced mesh network configuration

## Development

### Running Tests

```bash
pip install -e ".[dev]"
pytest
```

### Code Quality

```bash
black src/ tests/ examples/
ruff check src/ tests/ examples/
mypy src/wrtkit
```

## Publishing to PyPI

See [PUBLISHING.md](PUBLISHING.md) for detailed instructions on how to publish this package to PyPI.

## Contributing

Contributions are welcome! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.

## License

MIT License - see [LICENSE](LICENSE) for details.
