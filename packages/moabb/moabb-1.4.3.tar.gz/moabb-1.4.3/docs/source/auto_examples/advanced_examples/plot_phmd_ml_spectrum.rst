
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/advanced_examples/plot_phmd_ml_spectrum.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_advanced_examples_plot_phmd_ml_spectrum.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_advanced_examples_plot_phmd_ml_spectrum.py:


================================
Spectral analysis of the trials
================================

This example demonstrates how to perform spectral
analysis on epochs extracted from a specific subject
within the :class:`moabb.datasets.Cattan2019_PHMD`  dataset.

.. GENERATED FROM PYTHON SOURCE LINES 11-27

.. code-block:: Python


    # Authors: Pedro Rodrigues <pedro.rodrigues01@gmail.com>
    # Modified by: Gregoire Cattan <gcattan@hotmail.fr>
    # License: BSD (3-clause)

    import warnings

    import matplotlib.pyplot as plt
    import numpy as np

    from moabb.datasets import Cattan2019_PHMD
    from moabb.paradigms import RestingStateToP300Adapter


    warnings.filterwarnings("ignore")


.. GENERATED FROM PYTHON SOURCE LINES 28-36

Initialization
--------------

1) Specify the channel and subject to compute the power spectrum.
2) Create an instance of the :class:`moabb.datasets.Cattan2019_PHMD` dataset.
3) Create an instance of the :class:`moabb.paradigms.RestingStateToP300Adapter`  paradigm.
   By default, the data is filtered between 1-35 Hz,
   and epochs are extracted from 10 to 50 seconds after event tagging.

.. GENERATED FROM PYTHON SOURCE LINES 36-45

.. code-block:: Python


    # Select channel and subject for the remaining of the example.
    channel = "Cz"
    subject = 1

    dataset = Cattan2019_PHMD()
    events = ["on", "off"]
    paradigm = RestingStateToP300Adapter(events=events, channels=[channel])


.. GENERATED FROM PYTHON SOURCE LINES 46-50

Estimate Power Spectral Density
-------------------------------
1) Obtain the epochs for the specified subject.
2) Use Welch's method to estimate the power spectral density.

.. GENERATED FROM PYTHON SOURCE LINES 50-53

.. code-block:: Python


    f, S, _, y = paradigm.psd(subject, dataset)


.. GENERATED FROM PYTHON SOURCE LINES 54-59

Display of the data
-------------------

Plot the averaged Power Spectral Density (PSD) for each label condition,
using the selected channel specified at the beginning of the script.

.. GENERATED FROM PYTHON SOURCE LINES 59-72

.. code-block:: Python


    fig, ax = plt.subplots(facecolor="white", figsize=(8.2, 5.1))
    for condition in events:
        mean_power = np.mean(S[y == condition], axis=0).flatten()
        ax.plot(f, 10 * np.log10(mean_power), label=condition)

    ax.set_xlim(paradigm.fmin, paradigm.fmax)
    ax.set_ylim(100, 135)
    ax.set_ylabel("Spectrum Magnitude (dB)", fontsize=14)
    ax.set_xlabel("Frequency (Hz)", fontsize=14)
    ax.set_title("PSD for Channel " + channel, fontsize=16)
    ax.legend()
    fig.show()

**Estimated memory usage:**  0 MB


.. _sphx_glr_download_auto_examples_advanced_examples_plot_phmd_ml_spectrum.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_phmd_ml_spectrum.ipynb <plot_phmd_ml_spectrum.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_phmd_ml_spectrum.py <plot_phmd_ml_spectrum.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_phmd_ml_spectrum.zip <plot_phmd_ml_spectrum.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
