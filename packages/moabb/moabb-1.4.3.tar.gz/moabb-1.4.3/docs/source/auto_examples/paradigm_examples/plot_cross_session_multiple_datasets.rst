
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/paradigm_examples/plot_cross_session_multiple_datasets.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_paradigm_examples_plot_cross_session_multiple_datasets.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_paradigm_examples_plot_cross_session_multiple_datasets.py:


==================================
Cross-Session on Multiple Datasets
==================================

This example shows how to perform a cross-session analysis on two MI datasets
using a CSP+LDA pipeline

The cross session evaluation context will evaluate performance using a leave
one session out cross-validation. For each session in the dataset, a model
is trained on every other session and performance are evaluated on the current
session.

.. GENERATED FROM PYTHON SOURCE LINES 14-37

.. code-block:: Python


    # Authors: Sylvain Chevallier <sylvain.chevallier@uvsq.fr>
    #
    # License: BSD (3-clause)

    import warnings

    import matplotlib.pyplot as plt
    import seaborn as sns
    from mne.decoding import CSP
    from sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA
    from sklearn.pipeline import make_pipeline

    import moabb
    from moabb.datasets import BNCI2014_001, Zhou2016
    from moabb.evaluations import CrossSessionEvaluation
    from moabb.paradigms import LeftRightImagery


    warnings.simplefilter(action="ignore", category=FutureWarning)
    warnings.simplefilter(action="ignore", category=RuntimeWarning)
    moabb.set_log_level("info")


.. GENERATED FROM PYTHON SOURCE LINES 38-42

Loading Dataset
---------------

Load 2 subjects of BNCI 2014-004 and Zhou2016 datasets, with 2 session each

.. GENERATED FROM PYTHON SOURCE LINES 42-52

.. code-block:: Python


    subjects_list = [1, 2]

    datasets = [Zhou2016(), BNCI2014_001()]

    for d in datasets:
        # replace the subject list
        d.subject_list = subjects_list



.. GENERATED FROM PYTHON SOURCE LINES 53-58

Choose Paradigm
---------------

We select the paradigm MI, applying a bandpass filter (8-35 Hz) on
the data and we will keep only left- and right-hand motor imagery

.. GENERATED FROM PYTHON SOURCE LINES 58-61

.. code-block:: Python


    paradigm = LeftRightImagery(fmin=8, fmax=35)


.. GENERATED FROM PYTHON SOURCE LINES 62-67

Create Pipelines
----------------

Use the Common Spatial Patterns with 8 components and a Linear Discriminant
Analysis classifier.

.. GENERATED FROM PYTHON SOURCE LINES 67-71

.. code-block:: Python


    pipeline = {}
    pipeline["CSP+LDA"] = make_pipeline(CSP(n_components=8), LDA())


.. GENERATED FROM PYTHON SOURCE LINES 72-82

Get Data (optional)
-------------------

To get access to the EEG signals downloaded from the dataset, you could
use `dataset.get_data(subjects=[subject_id])` to obtain the EEG under
an MNE format, stored in a dictionary of sessions and runs.
Otherwise, `paradigm.get_data(dataset=dataset, subjects=[subject_id])`
allows to obtain the EEG data in sklearn format, the labels and the meta
information. The data are preprocessed according to the paradigm
requirements.

.. GENERATED FROM PYTHON SOURCE LINES 82-91

.. code-block:: Python


    # X_all, labels_all, meta_all = [], [], []
    # for d in datasets:
    #     # sessions = d.get_data(subjects=[2])
    #     X, labels, meta = paradigm.get_data(dataset=d, subjects=[2])
    #     X_all.append(X)
    #     labels_all.append(labels)
    #     meta_all.append(meta)


.. GENERATED FROM PYTHON SOURCE LINES 92-97

Evaluation
----------

The evaluation will return a DataFrame containing a single AUC score for
each subject / session of the dataset, and for each pipeline.

.. GENERATED FROM PYTHON SOURCE LINES 97-107

.. code-block:: Python


    overwrite = True  # set to True if we want to overwrite cached results

    evaluation = CrossSessionEvaluation(
        paradigm=paradigm, datasets=datasets, suffix="examples", overwrite=overwrite
    )
    results = evaluation.process(pipeline)

    print(results.head())


.. GENERATED FROM PYTHON SOURCE LINES 108-112

Plot Results
----------------

Here we plot the results, indicating the score for each session and subject

.. GENERATED FROM PYTHON SOURCE LINES 112-123

.. code-block:: Python


    sns.catplot(
        data=results,
        x="session",
        y="score",
        hue="subject",
        col="dataset",
        kind="bar",
        palette="viridis",
    )
    plt.show()

**Estimated memory usage:**  0 MB


.. _sphx_glr_download_auto_examples_paradigm_examples_plot_cross_session_multiple_datasets.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_cross_session_multiple_datasets.ipynb <plot_cross_session_multiple_datasets.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_cross_session_multiple_datasets.py <plot_cross_session_multiple_datasets.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_cross_session_multiple_datasets.zip <plot_cross_session_multiple_datasets.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
