
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/paradigm_examples/plot_within_session_ssvep.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_paradigm_examples_plot_within_session_ssvep.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_paradigm_examples_plot_within_session_ssvep.py:


=====================
Within Session SSVEP
=====================

This Example shows how to perform a within-session SSVEP analysis on the
MAMEM dataset 3, using a CCA pipeline.

The within-session evaluation assesses the performance of a classification
pipeline using a 5-fold cross-validation. The reported metric (here, accuracy)
is the average of all fold.

.. GENERATED FROM PYTHON SOURCE LINES 13-35

.. code-block:: Python


    # Authors: Sylvain Chevallier <sylvain.chevallier@uvsq.fr>
    #
    # License: BSD (3-clause)

    import warnings

    import matplotlib.pyplot as plt
    import seaborn as sns
    from sklearn.pipeline import make_pipeline

    import moabb
    from moabb.datasets import Kalunga2016
    from moabb.evaluations import WithinSessionEvaluation
    from moabb.paradigms import SSVEP
    from moabb.pipelines import SSVEP_CCA


    warnings.simplefilter(action="ignore", category=FutureWarning)
    warnings.simplefilter(action="ignore", category=RuntimeWarning)
    moabb.set_log_level("info")


.. GENERATED FROM PYTHON SOURCE LINES 36-40

Loading Dataset
---------------

Load 2 subjects of Kalunga2016 dataset

.. GENERATED FROM PYTHON SOURCE LINES 40-45

.. code-block:: Python


    subj = [1, 3]
    dataset = Kalunga2016()
    dataset.subject_list = subj


.. GENERATED FROM PYTHON SOURCE LINES 46-52

Choose Paradigm
---------------

We select the paradigm SSVEP, applying a bandpass filter (3-15 Hz) on
the data and we keep only the first 3 classes, that is stimulation
frequency of 13Hz, 17Hz and 21Hz.

.. GENERATED FROM PYTHON SOURCE LINES 52-55

.. code-block:: Python


    paradigm = SSVEP(fmin=10, fmax=40, n_classes=3)


.. GENERATED FROM PYTHON SOURCE LINES 56-60

Create Pipelines
----------------

Use a Canonical Correlation Analysis classifier

.. GENERATED FROM PYTHON SOURCE LINES 60-67

.. code-block:: Python


    interval = dataset.interval
    freqs = paradigm.used_events(dataset)

    pipeline = {}
    pipeline["CCA"] = make_pipeline(SSVEP_CCA(interval=interval, freqs=freqs, n_harmonics=3))


.. GENERATED FROM PYTHON SOURCE LINES 68-78

Get Data (optional)
-------------------

To get access to the EEG signals downloaded from the dataset, you could
use `dataset.get_data(subjects=[subject_id])` to obtain the EEG under
MNE format, stored in a dictionary of sessions and runs.
Otherwise, `paradigm.get_data(dataset=dataset, subjects=[subject_id])`
allows to obtain the EEG data in scikit format, the labels and the meta
information. In `paradigm.get_data`, the EEG are preprocessed according
to the paradigm requirement.

.. GENERATED FROM PYTHON SOURCE LINES 78-82

.. code-block:: Python


    # sessions = dataset.get_data(subjects=[3])
    # X, labels, meta = paradigm.get_data(dataset=dataset, subjects=[3])


.. GENERATED FROM PYTHON SOURCE LINES 83-88

Evaluation
----------

The evaluation will return a DataFrame containing a single AUC score for
each subject and pipeline.

.. GENERATED FROM PYTHON SOURCE LINES 88-98

.. code-block:: Python


    overwrite = True  # set to True if we want to overwrite cached results

    evaluation = WithinSessionEvaluation(
        paradigm=paradigm, datasets=dataset, suffix="examples", overwrite=overwrite
    )
    results = evaluation.process(pipeline)

    print(results.head())


.. GENERATED FROM PYTHON SOURCE LINES 99-103

Plot Results
----------------

Here we plot the results, indicating the score for each subject

.. GENERATED FROM PYTHON SOURCE LINES 103-107

.. code-block:: Python


    plt.figure()
    sns.barplot(data=results, y="score", x="session", hue="subject", palette="viridis")


.. GENERATED FROM PYTHON SOURCE LINES 108-109

And the computation time in seconds

.. GENERATED FROM PYTHON SOURCE LINES 109-114

.. code-block:: Python


    plt.figure()
    ax = sns.barplot(data=results, y="time", x="session", hue="subject", palette="Reds")
    ax.set_ylabel("Time (s)")
    plt.show()

**Estimated memory usage:**  0 MB


.. _sphx_glr_download_auto_examples_paradigm_examples_plot_within_session_ssvep.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_within_session_ssvep.ipynb <plot_within_session_ssvep.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_within_session_ssvep.py <plot_within_session_ssvep.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_within_session_ssvep.zip <plot_within_session_ssvep.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
