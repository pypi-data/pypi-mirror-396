/*! For license information please see add_forge_now.e85d09463e38c1e19632.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.swh=t():(e.swh=e.swh||{},e.swh.add_forge_now=t())}(self,function(){return function(){var __webpack_modules__={887:function(e,t,n){var r=n(16993),o=n(11791);e.exports=function(e,t,n,a,s){return new o(r().w(e,t,n,a),s||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},4373:function(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},4633:function(e,t,n){var r=n(25172),o=n(16993),a=n(55869),s=n(887),i=n(11791),u=n(4373),c=n(30579);function p(){"use strict";var t=o(),n=t.m(p),l=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function d(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))}var f={throw:1,return:2,break:3,continue:3};function _(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,f[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,c(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=p=function(){return{wrap:function(e,n,r,o){return t.w(_(e),n,r,o&&o.reverse())},isGeneratorFunction:d,mark:t.m,awrap:function(e,t){return new r(e,t)},AsyncIterator:i,async:function(e,t,n,r,o){return(d(t)?s:a)(_(e),t,n,r,o)},keys:u,values:c}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=p,e.exports.__esModule=!0,e.exports.default=e.exports},8545:function(e,t,n){"use strict";n.d(t,{Eb:function(){return p},Jq:function(){return i},Kb:function(){return u},Tv:function(){return o},XE:function(){return a},jt:function(){return l},lY:function(){return s},wv:function(){return c}});n(54756);var r=n(18987);function o(e,t){if(void 0===t&&(t=[]),!e.ok&&$.inArray(e.status,t))throw e;return e}function a(e,t){var n="";try{var r=JSON.parse(e.reason);Object.entries(r).forEach(function(e,t){var r=e[0],o=e[1][0];n+="\n"+r+": "+o})}catch(t){n=e.reason}return n?"Error: "+n:t}function s(e,t){var n="/static/"+e;return n.startsWith("/")&&t&&(n=t+n),n}function i(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=null),t["X-CSRFToken"]=r.A.get("csrftoken"),fetch(e,{credentials:"include",headers:t,method:"POST",body:n})}function u(e){var t=document.createElement("textarea");return t.innerText=e,t.innerHTML}function c(e,t){void 0===t&&(t=[]);var n=null,r=!0;try{n=new URL(e)}catch(e){r=!1}return r&&t.length&&(r=void 0!==t.find(function(e){return e===n.protocol})),r?n:null}function p(e){return new Date(e).toLocaleString()}function l(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=""),"display"===t&&e){var o=encodeURI(e);r||(r=o);var a="";return n&&(a='target="_blank" rel="noopener noreferrer"'),'<a href="'+o+'" '+a+">"+r+"</a>"}return e}},10467:function(e,t,n){"use strict";function r(e,t,n,r,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var s=e.apply(t,n);function i(e){r(s,o,a,i,u,"next",e)}function u(e){r(s,o,a,i,u,"throw",e)}i(void 0)})}}n.d(t,{A:function(){return o}})},11032:function(e,t,n){"use strict";n.d(t,{JX:function(){return j},gM:function(){return k},sI:function(){return T}});var r,o=n(58168),a=n(10467),s=n(77387),i=n(65579),u=n(54756),c=n.n(u),p=n(8545),l=n(71407),d=n.n(l),f=n(23717),_="swh-add-forge-user-filter",h=d()({inputId:_,checked:!1}),g=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.A)(t,e),t}((0,i.A)(Error));function m(e,t,n){var r=("\n    GET "+e+"\n    "+n+"\n\n    Remove all user/group/repo names.\n    Remove everything after both of those.").replace(/^\s+/,"").replace(/\n[ \t]+/g,"\n"),o=("\n    "+t+":\n\n    "+r).replace(/^\s+/,"").replace(/\n[ \t]+/g,"\n"),a=r.replaceAll("\n\n","\n"),s=(0,p.Kb)(a);throw $("#userMessage").text(t),$("#userMessageDetail").html(s),$("#userMessage").removeClass("text-bg-info"),$("#userMessage").addClass("text-bg-danger"),$("#swh-input-forge-url").get(0).setCustomValidity(o),n}function v(e){var t="GitLab instance has no public projects";throw $("#userMessage").text(e),$("#userMessageDetail").text(t),$("#userMessage").removeClass("text-bg-info"),$("#userMessage").addClass("text-bg-danger"),$("#swh-input-forge-url").get(0).setCustomValidity(t),new g(t)}function b(){$("#userMessage").text("GitLab instance has public projects"),$("#userMessageDetail").empty(),$("#userMessage").removeClass("text-bg-info"),$("#userMessage").addClass("text-bg-success")}function w(){return y.apply(this,arguments)}function y(){return(y=(0,a.A)(c().mark(function e(){var t,n,r,o,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $("#userMessage").text("GitLab instance projects API loading"),$("#userMessageDetail").text("Checking available public projects"),$("#userMessage").removeClass("text-bg-danger"),$("#userMessage").removeClass("text-bg-success"),$("#userMessage").addClass("text-bg-info"),t=$("#swh-input-forge-url").val().trim(),n=t+"api/v4/projects?per_page=1",r="GitLab instance projects API issue",e.prev=1,e.next=2,fetch(n);case 2:return(o=e.sent).ok||m(n,r,"HTTP "+o.status+" "+o.statusText),e.next=3,o.json();case 3:a=e.sent,Array.isArray(a)?0===a.length?v(r):b():m(n,r,"JSON data is not an array"),e.next=6;break;case 4:if(e.prev=4,!((s=e.catch(1))instanceof g)){e.next=5;break}throw s;case 5:m(n,r,s);case 6:case"end":return e.stop()}},e,null,[[1,4]])}))).apply(this,arguments)}function x(){return R.apply(this,arguments)}function R(){return(R=(0,a.A)(c().mark(function e(){var t;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$("#swh-input-forge-type").val(),!["gitlab","heptapod"].includes(t)){e.next=1;break}return e.next=1,w();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(){$(document).ready(function(){$("#requestCreateForm").submit(function(){var e=(0,a.A)(c().mark(function e(t){var n,o,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),"on"!==$("#swh-input-forge-validate").val()){e.next=4;break}return e.prev=1,e.next=2,x();case 2:e.next=4;break;case 3:return e.prev=3,e.catch(1),e.abrupt("return");case 4:return e.prev=4,e.next=5,(0,p.Jq)($(this).attr("action"),{"Content-Type":"application/x-www-form-urlencoded"},$(this).serialize());case 5:n=e.sent,(0,p.Tv)(n),$("#userMessageDetail").empty(),$("#userMessage").text("Your request has been submitted"),$("#userMessage").removeClass("text-bg-danger"),$("#userMessage").addClass("text-bg-success"),r.draw(),e.next=8;break;case 6:return e.prev=6,s=e.catch(4),$("#userMessageDetail").empty(),e.next=7,s.json();case 7:a=e.sent,o=409===s.status?a:(0,p.XE)(a,"An unknown error occurred during the request creation"),$("#userMessage").text(o),$("#userMessage").removeClass("text-bg-success"),$("#userMessage").addClass("text-bg-danger");case 8:case"end":return e.stop()}},e,this,[[1,3],[4,6]])}));return function(t){return e.apply(this,arguments)}}()),T()})}function T(){r=$("#add-forge-request-browse").on("error.dt",function(e,t,n,r){$("#add-forge-browse-request-error").text(r)}).DataTable((0,o.A)({},f._k,{retrieve:!0,searching:!0,dom:'<"row mb-2"<"col-sm-3"l><"col-sm-6 text-start user-requests-filter"><"col-sm-3"f>><"row"<"col-sm-12"tr>><"row mt-2"<"col-sm-5"i><"col-sm-7"p>>',ajax:{url:Urls.add_forge_request_list_datatables(),data:function(e){var t=$("#"+_).prop("checked");swh.webapp.isUserLoggedIn()&&(void 0===t||t)&&(e.user_requests_only="1")}},fnInitComplete:function(){swh.webapp.isUserLoggedIn()&&($("div.user-requests-filter").html(h),$("#"+_).on("change",function(){r.draw()}),r.draw())},columns:[{data:"submission_date",name:"submission_date",render:p.Eb},{data:"forge_type",name:"forge_type",render:$.fn.dataTable.render.text()},{data:"forge_url",name:"forge_url",render:function(e,t,n){var r=$.fn.dataTable.render.text().display(e);return(0,p.jt)(r,t,!0)}},{data:"status",name:"status",render:function(e,t,n,r){return swh.add_forge_now.formatRequestStatusName(e)}},{render:function(e,t,n){if("FIRST_ORIGIN_LOADED"===n.status){var r=$.fn.dataTable.render.text().display(n.forge_url),o=Urls.browse_search()+"?q="+encodeURIComponent(r);return'<a href="'+(o+="&with_visit=true&with_content=true")+'" target="_blank" rel="noopener noreferrer" class="swh-search-forge-origins" title="Search for origins listed from that forge"><i class="mdi mdi-magnify" aria-hidden="true"></i></a>'}return""}}],order:[[0,"desc"]]}))}function M(e){return RegExp(e.replace(/\s+|#.*/g,""))}var C=M("\n  /\n  (\n    (projects|users)\n    (\n      # end of URL path\n    |\n      /\n      (\n        # end of URL path\n      |\n        [^/]+\n        (\n          # end of URL path\n        |\n          /repos/[^/]+/browse\n        )\n      )\n    )\n  |\n    repos\n  |\n    login\n  |\n    getting-started\n  |\n    about\n  |\n    plugins/servlet/search\n  )$"),S=M("\n  /\n  (\n    [^/]+/(refs|log|commit|diff|patch|stats|plain|snapshot)/.*\n  )$"),E=M("\n  ^\n  (\n    \\?q=[^;&]+\n  )$"),A=M("\n  /\n  (\n    explore\n    (\n      # end of URL path\n    |\n      /\n      (\n        projects\n        (\n          # end of URL path\n        |\n          /\n          (trending|starred|topics)\n        )\n      |\n        groups\n      |\n        catalog\n      |\n        snippets\n      )\n    )\n  |\n    help\n    (\n      # end of URL path\n    |\n      /\n      (\n        # end of URL path\n      |\n        .*\\.md\n      )\n    )\n  |\n    users/\n    (\n      sign_(in|up)\n    |\n      password/new\n    )\n  |\n    [^/]+/([^/]+/)+(activity|container_registry)\n  |\n    [^/]+/([^/]+/)+-/(tree|commits?|archive|blob|raw|blame|network|wikis|issues?|\n                      activity|project_members|labels|boards|milestones|merge_requests|\n                      branches|tags|starrers|compare|snippets?|pipelines?|jobs?|pipeline_schedules?|\n                      artifacts?|releases?|ml|environments?|incidents?|graphs|value_stream_analytics)/.*\n  )$"),U=M("\n  /\n  (\n    explore\n    (\n      # end of URL path\n    |\n      /\n      (\n        repos\n      |\n        users\n      |\n        organizations\n      |\n        code\n      )\n    )\n  |\n    user/(login|forgot_password)\n  |\n    [^/]+/([^/]+/)+\n    (\n      \\.rss\n    |\n      /\n      (\n        actions|activity|branches|commits?|src|compare|find|forks|issues|packages\n        |projects|pulls|labels|milestones|releases|stars|tags|watchers|wiki\n      )(|/.*)\n    )\n  )$"),O=M("\n  ^\n  (\n    \\?format=(TEXT|JSON)\n  )$"),L=M("\n  /\n  (\n    login/.*\n  |\n    [^/]+/\\+\n    (\n      refs\n    |\n      /refs/(heads|tags)/.*\n    |\n      log\n    |\n      log/refs/(heads|tags)/.*\n    |\n      log/[a-f0-9]{40}(|/.*)\n    |\n      blame/[a-f0-9]{40}/.+\n    |\n      archive/refs/(heads|tags)/.*\n    |\n      archive/[a-f0-9]{40}\\.tar\\.gz\n    |\n      /[a-f0-9]{40}(|/.*|\\^|\\^/.*|\\^!|\\^!/.*)\n    )\n  )$"),F=M("\n  (\n    \\?\n    (\n      p=.*\n    |\n      a=project_list[&;].*\n    |\n      a=project_index\n    |\n      a=opml\n    )\n  )$"),q=M("\n  /\n  (\n    [^/]+/log\\.html\n  |\n    [^/]+/files\\.html\n  |\n    [^/]+/refs\\.html\n  |\n    [^/]+/file/.*\\.html\n  |\n    [^/]+/commit/[a-f0-9]{40}\\.html\n  |\n  )$");function j(e){var t="";(0,p.wv)(e.value.trim(),["http:","https:"])||(t="The provided forge URL is not valid."),function(e){var t;try{t=new URL(e)}catch(e){return!1}var n=t.hostname;return!!["github.com","www.github.com"].includes(n)||!!new RegExp("(^|\\.)github\\.(com|org|io)$").test(n)}(e.value.trim())&&(t="The provided forge URL is on GitHub.\nUse Save code now instead."),function(e){var t;try{t=new URL(e)}catch(e){return!1}var n=t.hostname;return!!["gitlab.com","www.gitlab.com"].includes(n)||!!new RegExp("(^|\\.)gitlab\\.(com|org|io)$").test(n)}(e.value.trim())&&(t="The provided forge URL is on GitLab.\nUse Save code now instead."),function(e){var t;try{t=new URL(e)}catch(e){return!1}return t.origin===e}(e.value.trim())&&(t="The provided forge URL was not a canonical URL.\nAdd a forward slash character to the end.");var n=function(e){var t;try{t=new URL(e)}catch(e){return null}var n=null,r=$("#swh-input-forge-type").val();return"bitbucket"===r?n=C.exec(t.pathname):"cgit"===r?n=S.exec(t.pathname)||E.exec(t.search):["gitlab","heptapod"].includes(r)?n=A.exec(t.pathname):["gogs","gitea","forgejo"].includes(r)?n=U.exec(t.pathname):"gitiles"===r?n=L.exec(t.pathname)||O.exec(t.search):"gitweb"===r?n=F.exec(t.search):"stagit"===r&&(n=q.exec(t.pathname)),n?n[1]:null}(e.value.trim());n&&(t=("\n      The provided forge URL was not a base URL.\n\n      Remove this string from the URL:\n\n      "+n+"\n\n      Remove all user/group/repo names.\n      Remove everything after both of those.").replace(/^\s+/,"").replace(/\n[ \t]+/g,"\n")),e.setCustomValidity(t)}},11791:function(e,t,n){var r=n(25172),o=n(75546);e.exports=function e(t,n){function a(e,o,s,i){try{var u=t[e](o),c=u.value;return c instanceof r?n.resolve(c.v).then(function(e){a("next",e,s,i)},function(e){a("throw",e,s,i)}):n.resolve(c).then(function(e){u.value=e,s(u)},function(e){return a("throw",e,s,i)})}catch(e){i(e)}}var s;this.next||(o(e.prototype),o(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),o(this,"_invoke",function(e,t,r){function o(){return new n(function(t,n){a(e,r,t,n)})}return s=s?s.then(o,o):o()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},16993:function(e,t,n){var r=n(75546);function o(){var t,n,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function u(e,o,a,s){var i=o&&o.prototype instanceof p?o:p,u=Object.create(i.prototype);return r(u,"_invoke",function(e,r,o){var a,s,i,u=0,p=o||[],l=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,s=0,i=t,d.n=n,c}};function f(e,r){for(s=e,i=r,n=0;!l&&u&&!o&&n<p.length;n++){var o,a=p[n],f=d.p,_=a[2];e>3?(o=_===r)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=f&&((o=e<2&&f<a[1])?(s=0,d.v=r,d.n=a[1]):f<_&&(o=e<3||a[0]>r||r>_)&&(a[4]=e,a[5]=r,d.n=_,s=0))}if(o||e>1)return c;throw l=!0,r}return function(o,p,_){if(u>1)throw TypeError("Generator is already running");for(l&&1===p&&f(p,_),s=p,i=_;(n=s<2?t:i)||!l;){a||(s?s<3?(s>1&&(d.n=-1),f(s,i)):d.n=i:d.v=i);try{if(u=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=t}else if((n=(l=d.n<0)?i:e.call(r,d))!==c)break}catch(e){a=t,s=1,i=e}finally{u=1}}return{value:n,done:l}}}(e,a,s),!0),u}var c={};function p(){}function l(){}function d(){}n=Object.getPrototypeOf;var f=[][s]?n(n([][s]())):(r(n={},s,function(){return this}),n),_=d.prototype=p.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,i,"GeneratorFunction")),e.prototype=Object.create(_),e}return l.prototype=d,r(_,"constructor",d),r(d,"constructor",l),l.displayName="GeneratorFunction",r(d,i,"GeneratorFunction"),r(_),r(_,i,"Generator"),r(_,s,function(){return this}),r(_,"toString",function(){return"[object Generator]"}),(e.exports=o=function(){return{w:u,m:h}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},18987:function(e,t,n){"use strict";function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{A:function(){return o}});var o=function e(t,n){function o(e,o,a){if("undefined"!=typeof document){"number"==typeof(a=r({},n,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var i in a)a[i]&&(s+="; "+i,!0!==a[i]&&(s+="="+a[i].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+s}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var a=n[o].split("="),s=a.slice(1).join("=");try{var i=decodeURIComponent(a[0]);if(r[i]=t.read(s,i),e===i)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){o(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},23717:function(e,t,n){"use strict";n.d(t,{_k:function(){return r}});var r={serverSide:!0,processing:!0,language:{processing:'<img src="'+(0,n(8545).lY)("img/swh-spinner.gif")+'"></img>'},fixedHeader:!0,lengthMenu:[10,25,50,100,1e3],scrollCollapse:!0,searchDelay:1e3}},25172:function(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},30579:function(e,t,n){var r=n(73738).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},36136:function(module){module.exports=function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{})__append("\nHello "),__append(escapeFn(forgeAdmin)),__append(",\n\nThe mission of Software Heritage is to collect, preserve and share all\nthe publicly available source code: https://www.softwareheritage.org\n\nWe would like to add the code hosted at the URL below to the list of\nsoftware origins that are regularly archived, and we understand that\nyou are or know the contact person for this site.\n\n"),__append(escapeFn(forgeUrl)),__append('\n\nIn order to archive the code contents, we will have to periodically\npull the public repositories it contains and clone them into the\nSoftware Heritage archive. FAQs for our processes are available:\n\nhttps://docs.softwareheritage.org/user/faq/#add-forge-now\nhttps://www.softwareheritage.org/faq/\n\nPlease let us know if there are any issues to consider before\nwe launch the archival of the public repositories hosted on your\ninfrastructure. Please use "Reply all" to ensure our system will\nprocess your answer properly.\n\nIn the absence of an answer to this message, we will start to\narchive your code in the coming weeks. Only the publicly\naccessible repositories will be archived.\n\nThank you in advance for your help.\n\nKind regards,\nThe Software Heritage team\n');return __output}},36324:function(e,t,n){"use strict";n.d(t,{A:function(){return a}});var r=n(52176),o=n(63662);function a(e,t,n){if((0,r.A)())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,t);var s=new(e.bind.apply(e,a));return n&&(0,o.A)(s,n.prototype),s}},48697:function(e,t,n){"use strict";n.d(t,{R:function(){return p},T:function(){return c}});var r=n(58168),o=n(10467),a=n(54756),s=n.n(a),i=n(8545),u=n(23717);function c(){p()}function p(){return l.apply(this,arguments)}function l(){return(l=(0,o.A)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$("#swh-add-forge-now-moderation-list").on("error.dt",function(e,t,n,r){$("#swh-add-forge-now-moderation-list-error").text(r)}).DataTable((0,r.A)({},u._k,{searching:!0,dom:'<"row mb-2"<"col-sm-3"l><"col-sm-6"><"col-sm-3"f>><"row"<"col-sm-12"tr>><"row mt-2"<"col-sm-5"i><"col-sm-7"p>>',ajax:{url:Urls.add_forge_request_list_datatables()},columns:[{data:"id",name:"id",render:function(e,t,n,r){return"<a href="+Urls.add_forge_now_request_dashboard(e)+">"+e+"</a>"}},{data:"submission_date",name:"submission_date",render:i.Eb},{data:"forge_type",name:"forge_type",render:$.fn.dataTable.render.text()},{data:"forge_url",name:"forge_url",render:function(e,t,n){var r=$.fn.dataTable.render.text().display(e);return(0,i.jt)(r,t,!0)}},{data:"last_moderator",name:"last_moderator",render:$.fn.dataTable.render.text()},{data:"last_modified_date",name:"last_modified_date",render:i.Eb},{data:"status",name:"status",render:function(e,t,n,r){return swh.add_forge_now.formatRequestStatusName(e)}},{render:function(e,t,n){var r='<div class="d-flex">';if(r+='<a class="swh-forge-request-dashboard-link" href="'+Urls.add_forge_now_request_dashboard(n.id)+'" title="Go to request dashboard"><i class="mdi mdi-square-edit-outline" aria-hidden="true"></i></a>',"FIRST_ORIGIN_LOADED"===n.status){var o=$.fn.dataTable.render.text().display(n.forge_url),a=Urls.browse_search()+"?q="+encodeURIComponent(o);r+='<a href="'+(a+="&with_visit=true&with_content=true")+'" target="_blank" rel="noopener noreferrer" class="swh-search-forge-origins" title="Search for origins listed from that forge"><i class="mdi mdi-magnify" aria-hidden="true"></i></a>'}return r+="</div>"}}],order:[[0,"desc"]]}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}},52176:function(e,t,n){"use strict";function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(r=function(){return!!e})()}n.d(t,{A:function(){return r}})},53954:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{A:function(){return r}})},54756:function(e,t,n){var r=n(4633)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},55869:function(e,t,n){var r=n(887);e.exports=function(e,t,n,o,a){var s=r(e,t,n,o,a);return s.next().then(function(e){return e.done?e.value:s.next()})},e.exports.__esModule=!0,e.exports.default=e.exports},58168:function(e,t,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(null,arguments)}n.d(t,{A:function(){return r}})},63662:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{A:function(){return r}})},65579:function(e,t,n){"use strict";n.d(t,{A:function(){return i}});var r=n(53954),o=n(63662),a=n(70202),s=n(36324);function i(e){var t="function"==typeof Map?new Map:void 0;return i=function(e){if(null===e||!(0,a.A)(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return(0,s.A)(e,arguments,(0,r.A)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,o.A)(n,e)},i(e)}},70202:function(e,t,n){"use strict";function r(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}n.d(t,{A:function(){return r}})},71407:function(module){module.exports=function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{})__append('\n<div class="form-check swhid-option">\n  <input class="form-check-input" value="option-user-requests-filter" type="checkbox"\n    '),checked&&__append('\n         checked="checked"\n    '),__append('\n         id="'),__append(escapeFn(inputId)),__append('">\n  <label class="form-check-label font-weight-normal" for="'),__append(escapeFn(inputId)),__append('">\n    show only your own requests\n  </label>\n</div>\n');return __output}},73738:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},75546:function(e){function t(n,r,o,a){var s=Object.defineProperty;try{s({},"",{})}catch(n){s=0}e.exports=t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?s?s(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,o,a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},77387:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(63662);function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,r.A)(e,t)}},83052:function(module){module.exports=function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{})__append("Dear forge administrator,\n\nWe are happy to announce to you that your forge is now successfully\narchived.\n\nThe forge repositories are now available in the archive :\nhttps://archive.softwareheritage.org/browse/search/?q="),__append(escapeFn(forgeUrl)),__append("&with_visit=true&with_content=true\n\nKind regards,\n\nThe Software Heritage team");return __output}},93874:function(e,t,n){"use strict";n.d(t,{E:function(){return v},r:function(){return _}});var r,o=n(10467),a=n(54756),s=n.n(a),i=n(8545),u=n(99238),c=n.n(u),p=n(36136),l=n.n(p),d=n(83052),f=n.n(d);function _(e,t){$(document).ready(function(){h(e,t),$("#contactForgeAdmin").click(function(e){!function(){var e=encodeURIComponent($("#contactForgeAdmin").attr("emailTo")),t=encodeURIComponent($("#contactForgeAdmin").attr("emailCc")),n=encodeURIComponent($("#contactForgeAdmin").attr("emailReply")),o=encodeURIComponent($("#contactForgeAdmin").attr("emailSubject")),a="";"PENDING"===r.status&&(a=encodeURIComponent(l()({forgeUrl:r.forge_url,forgeAdmin:r.forge_contact_name}).trim().replace(/\n/g,"\r\n")));"FIRST_ORIGIN_LOADED"===r.status&&(a=encodeURIComponent(f()({forgeUrl:encodeURIComponent(r.forge_url)}).trim().replace(/\n/g,"\r\n")));var s=window.open("","_blank","",!0);s.location.href="mailto:"+e+"?Cc="+t+"&Reply-To="+n+"&Mail-Reply-To="+n+"&Mail-Followup-To="+n+"&Subject="+o+"&body="+a,s.focus()}()}),$("#updateRequestForm").submit(function(){var n=(0,o.A)(s().mark(function n(r){var o;return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,n.next=2,(0,i.Jq)($(this).attr("action"),{"Content-Type":"application/x-www-form-urlencoded"},$(this).serialize());case 2:o=n.sent,(0,i.Tv)(o),$("#userMessage").text("The request status has been updated "),$("#userMessage").removeClass("text-bg-danger"),$("#userMessage").addClass("text-bg-success"),h(e,t),n.next=4;break;case 3:n.prev=3,n.catch(1),$("#userMessage").text("Sorry; Updating the request failed"),$("#userMessage").removeClass("text-bg-success"),$("#userMessage").addClass("text-bg-danger");case 4:case"end":return n.stop()}},n,this,[[1,3]])}));return function(e){return n.apply(this,arguments)}}())})}function h(e,t){return g.apply(this,arguments)}function g(){return(g=(0,o.A)(s().mark(function e(t,n){var o,a,u,c,p,l,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,fetch(Urls.api_1_add_forge_request_get(t));case 1:return o=e.sent,(0,i.Tv)(o),e.next=2,o.json();case 2:a=e.sent,r=a.request,$("#requestStatus").text(swh.add_forge_now.formatRequestStatusName(r.status)),$("#requestType").text(r.forge_type),u='<a href="'+encodeURI(r.forge_url)+'" target="_blank" rel="noopener noreferrer">'+swh.webapp.filterXSS(r.forge_url)+"</a>",$("#requestURL").html(u),$("#requestContactName").text(r.forge_contact_name),$("#requestContactConsent").text(r.submitter_forward_username),$("#requestContactEmail").text(r.forge_contact_email),$("#submitterMessage").text(r.forge_contact_comment),$("#updateComment").val(""),c=r.forge_contact_name+" <"+r.forge_contact_email+">",p=r.inbound_email_address,l=p+", Software Heritage Archival Moderators <archival@softwareheritage.org>, "+c,$("#contactForgeAdmin").attr("emailTo",c),$("#contactForgeAdmin").attr("emailCc",p),$("#contactForgeAdmin").attr("emailReply",l),$("#contactForgeAdmin").attr("emailSubject","Software Heritage archival notification for "+r.forge_domain),m(a.history),v(r.status,n),e.next=5;break;case 3:if(e.prev=3,!((d=e.catch(0))instanceof Response)){e.next=4;break}$("#fetchError").removeClass("d-none"),$("#requestDetails").addClass("d-none"),e.next=5;break;case 4:throw d;case 5:case"end":return e.stop()}},e,null,[[0,3]])}))).apply(this,arguments)}function m(e){$("#requestHistory").children().remove(),e.forEach(function(e,t){var n=c()({event:e,index:t,getHumanReadableDate:i.Eb});$("#requestHistory").append(n)})}function v(e,t){var n=t[e];$("#decisionOptions").children().remove(),n.forEach(function(e,t){var n=swh.add_forge_now.formatRequestStatusName(e);$("#decisionOptions").append('<option value="'+e+'">'+n+"</option>")}),$("#decisionOptions").append("<option hidden disabled selected value> -- Add a comment -- </option>")}},99238:function(module){module.exports=function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{})__append('\n<div class="history-item">\n\t<div class="card border-dark">\n\t\t<div class="card-header" id="historyItem'),__append(escapeFn(index)),__append('">\n\t\t\t<h2 class="mb-0">\n\t\t\t\t<button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#historyItemBody'),__append(escapeFn(index)),__append('" aria-expanded="true" aria-controls="collapse$'),__append(escapeFn(index)),__append('">\n\t\t\t\t\t\t\t\tFrom '),__append(escapeFn(event.actor)),__append(" ("),__append(escapeFn(event.actor_role)),__append(") on "),__append(escapeFn(getHumanReadableDate(event.date))),__append("\n\t\t\t\t\t"),null!==event.new_status&&(__append('\n\t\t\t\t\t<span style="padding-left: 10px;">New status:</span> '),__append(escapeFn(swh.add_forge_now.formatRequestStatusName(event.new_status))),__append("\n\t\t\t\t\t")),__append('\n\t\t\t\t</button>\n\t\t\t</h2>\n\t\t</div>\n\t\t<div id="historyItemBody'),__append(escapeFn(index)),__append('" class="collapse" aria-labelledby="historyItem'),__append(escapeFn(index)),__append('" data-parent="#requestHistory">\n\t\t\t<div class="card-body">\n\t\t\t\t'),event.text&&(__append("\n\t\t\t\t<pre>"),__append(escapeFn(event.text)),__append("</pre>\n\t\t\t\t")),__append("\n\t\t\t\t"),null!==event.message_source_url&&(__append('\n\t\t\t\t<p><a href="'),__append(escapeFn(event.message_source_url)),__append('">Open original message in email client</a></p>\n\t\t\t\t')),__append("\n\t\t\t\t"),null!==event.new_status&&(__append("\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<span>Status changed to:</span> <strong>"),__append(escapeFn(swh.add_forge_now.formatRequestStatusName(event.new_status))),__append("</strong>\n\t\t\t\t\t</p>\n\t\t\t\t")),__append("\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n");return __output}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{formatRequestStatusName:function(){return r},onCreateRequestPageLoad:function(){return e.gM},onModerationPageLoad:function(){return t.T},onRequestDashboardLoad:function(){return n.r},populateDecisionSelectOption:function(){return n.E},populateModerationList:function(){return t.R},populateRequestBrowseList:function(){return e.sI},validateForgeUrl:function(){return e.JX}});var e=__webpack_require__(11032),t=__webpack_require__(48697),n=__webpack_require__(93874);function r(e){var t={PENDING:"Pending",WAITING_FOR_FEEDBACK:"Waiting for feedback",FEEDBACK_TO_HANDLE:"Feedback to handle",ACCEPTED:"Accepted",SCHEDULED:"Scheduled",FIRST_LISTING_DONE:"First listing done",FIRST_ORIGIN_LOADED:"First origin loaded",REJECTED:"Rejected",SUSPENDED:"Suspended",UNSUCCESSFUL:"Unsuccessful"};return e in t?t[e]:e}}(),__webpack_exports__}()});
//# sourceMappingURL=add_forge_now.e85d09463e38c1e19632.js.map