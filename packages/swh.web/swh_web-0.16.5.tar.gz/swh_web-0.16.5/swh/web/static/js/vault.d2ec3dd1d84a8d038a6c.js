/*! For license information please see vault.d2ec3dd1d84a8d038a6c.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.swh=t():(e.swh=e.swh||{},e.swh.vault=t())}(self,function(){return function(){var __webpack_modules__={887:function(e,t,n){var r=n(16993),o=n(11791);e.exports=function(e,t,n,a,i){return new o(r().w(e,t,n,a),i||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},4373:function(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},4633:function(e,t,n){var r=n(25172),o=n(16993),a=n(55869),i=n(887),s=n(11791),c=n(4373),u=n(30579);function l(){"use strict";var t=o(),n=t.m(l),p=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function d(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))}var f={throw:1,return:2,break:3,continue:3};function _(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,f[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,u(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=l=function(){return{wrap:function(e,n,r,o){return t.w(_(e),n,r,o&&o.reverse())},isGeneratorFunction:d,mark:t.m,awrap:function(e,t){return new r(e,t)},AsyncIterator:s,async:function(e,t,n,r,o){return(d(t)?i:a)(_(e),t,n,r,o)},keys:c,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports},8545:function(e,t,n){"use strict";n.d(t,{EQ:function(){return a},Iu:function(){return s},Jq:function(){return i},Tv:function(){return o}});n(54756);var r=n(18987);function o(e,t){if(void 0===t&&(t=[]),!e.ok&&$.inArray(e.status,t))throw e;return e}function a(e,t){void 0===t&&(t=[]);for(var n=0;n<e.length;++n)if(!e[n].ok&&$.inArray(e[n].status,t))throw e[n];return e}function i(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=null),t["X-CSRFToken"]=r.A.get("csrftoken"),fetch(e,{credentials:"include",headers:t,method:"POST",body:n})}function s(e,t,n){void 0===n&&(n=!1);var r="",o="";return n&&(r='<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',o="alert-dismissible"),'<div class="alert alert-'+e+" "+o+'" role="alert">'+t+r+"</div>"}},10467:function(e,t,n){"use strict";function r(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,c,"next",e)}function c(e){r(i,o,a,s,c,"throw",e)}s(void 0)})}}n.d(t,{A:function(){return o}})},11791:function(e,t,n){var r=n(25172),o=n(75546);e.exports=function e(t,n){function a(e,o,i,s){try{var c=t[e](o),u=c.value;return u instanceof r?n.resolve(u.v).then(function(e){a("next",e,i,s)},function(e){a("throw",e,i,s)}):n.resolve(u).then(function(e){c.value=e,i(c)},function(e){return a("throw",e,i,s)})}catch(e){s(e)}}var i;this.next||(o(e.prototype),o(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),o(this,"_invoke",function(e,t,r){function o(){return new n(function(t,n){a(e,r,t,n)})}return i=i?i.then(o,o):o()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},16993:function(e,t,n){var r=n(75546);function o(){var t,n,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function c(e,o,a,i){var s=o&&o.prototype instanceof l?o:l,c=Object.create(s.prototype);return r(c,"_invoke",function(e,r,o){var a,i,s,c=0,l=o||[],p=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,i=0,s=t,d.n=n,u}};function f(e,r){for(i=e,s=r,n=0;!p&&c&&!o&&n<l.length;n++){var o,a=l[n],f=d.p,_=a[2];e>3?(o=_===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=f&&((o=e<2&&f<a[1])?(i=0,d.v=r,d.n=a[1]):f<_&&(o=e<3||a[0]>r||r>_)&&(a[4]=e,a[5]=r,d.n=_,i=0))}if(o||e>1)return u;throw p=!0,r}return function(o,l,_){if(c>1)throw TypeError("Generator is already running");for(p&&1===l&&f(l,_),i=l,s=_;(n=i<2?t:s)||!p;){a||(i?i<3?(i>1&&(d.n=-1),f(i,s)):d.n=s:d.v=s);try{if(c=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((n=(p=d.n<0)?s:e.call(r,d))!==u)break}catch(e){a=t,i=1,s=e}finally{c=1}}return{value:n,done:p}}}(e,a,i),!0),c}var u={};function l(){}function p(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(r(n={},i,function(){return this}),n),_=d.prototype=l.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e}return p.prototype=d,r(_,"constructor",d),r(d,"constructor",p),p.displayName="GeneratorFunction",r(d,s,"GeneratorFunction"),r(_),r(_,s,"Generator"),r(_,i,function(){return this}),r(_,"toString",function(){return"[object Generator]"}),(e.exports=o=function(){return{w:c,m:h}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},18987:function(e,t,n){"use strict";function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{A:function(){return o}});var o=function e(t,n){function o(e,o,a){if("undefined"!=typeof document){"number"==typeof(a=r({},n,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var s in a)a[s]&&(i+="; "+s,!0!==a[s]&&(i+="="+a[s].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+i}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var a=n[o].split("="),i=a.slice(1).join("=");try{var s=decodeURIComponent(a[0]);if(r[s]=t.read(i,s),e===s)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){o(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},25172:function(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},30579:function(e,t,n){var r=n(73738).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},38556:function(e,t){"use strict";var n=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;t.t=function(e){if(!e)return!1;if(e.length>254)return!1;if(!n.test(e))return!1;var t=e.split("@");return!(t[0].length>64)&&!t[1].split(".").some(function(e){return e.length>63})}},53056:function(module){module.exports=function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return null==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){null!=e&&(__output+=e)}with(locals||{})__append("\n\n"),cookingTask.swhid.match(/^swh:1:dir:.*/)?(__append('\n  <tr id="vault-task-'),__append(escapeFn(cookingTask.swhid)),__append('" title="Once downloaded, the directory can be extracted with the following command:\n\n$ tar xvzf '),__append(escapeFn(cookingTask.swhid.replaceAll(":","_"))),__append('.tar.gz">\n')):(__append('\n  </tr><tr id="vault-task-'),__append(escapeFn(cookingTask.swhid)),__append("\" title=\"Once downloaded, the git repository can be imported to a 'new_repository' directory with the following commands:\n\n$ tar xvf "),__append(escapeFn(cookingTask.swhid.replaceAll(":","_"))),__append(".git.tar\n$ git clone "),__append(escapeFn(cookingTask.swhid)),__append('.git new_repository\n$ cd new_repository/">\n')),__append('\n    <td>\n      <div class="form-check">\n      <input type="checkbox" class="form-check-input vault-task-toggle-selection" id="vault-task-toggle-selection-'),__append(escapeFn(cookingTask.swhid)),__append('">\n      <label class="form-check-label" for="vault-task-toggle-selection-'),__append(escapeFn(cookingTask.swhid)),__append('">\n      </label>\n    </div></td>\n    '),cookingTask.origin?(__append('\n      <td class="vault-origin">\n        <a href="'),__append(escapeFn(Urls.browse_origin())),__append("?origin_url="),__append(escapeFn(cookingTask.origin)),__append('">\n          '),__append(escapeFn(decodeURIComponent(cookingTask.origin))),__append("\n        </a>\n      </td>\n    ")):__append('\n      <td class="vault-origin">unknown</td>\n    '),__append('\n    <td>\n      <i class="'),__append(escapeFn(swh.webapp.getSwhObjectIcon(cookingTask.swhid.match(/swh:1:([a-z]+):/)[1]))),__append(' mdi-fw"></i>\n      '),__append(escapeFn(cookingTask.bundle_type)),__append('\n    </td>\n    <td class="vault-object-info" data-swhid="'),__append(escapeFn(cookingTask.swhid)),__append('">\n      <b>id:</b>&nbsp;<a href="'),__append(escapeFn(browseUrl)),__append('">'),__append(escapeFn(cookingTask.swhid)),__append("</a>\n      "),cookingTask.path&&(__append("\n        <br><b>path:</b>&nbsp;"),__append(escapeFn(cookingTask.path)),__append("\n      ")),__append("\n    </td>\n    <td>"),__append(progressBar.outerHTML),__append('</td>\n    <td class="vault-dl-link">\n      '),"done"===cookingTask.status&&(__append('\n        <button class="btn btn-secondary btn-sm" onclick="swh.vault.fetchCookedObject(\''),__append(escapeFn(cookingTask.fetch_url)),__append('\')">\n          <i class="mdi mdi-download mdi-fw" aria-hidden="true"></i>Download\n        </button>\n      ')),__append("\n    </td>\n  </tr>\n");return __output}},54756:function(e,t,n){var r=n(4633)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},55869:function(e,t,n){var r=n(887);e.exports=function(e,t,n,o,a){var i=r(e,t,n,o,a);return i.next().then(function(e){return e.done?e.value:i.next()})},e.exports.__esModule=!0,e.exports.default=e.exports},73738:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},75097:function(e,t,n){"use strict";n.d(t,{Bn:function(){return h},hm:function(){return f},iF:function(){return w},jh:function(){return g}});var r=n(10467),o=n(54756),a=n.n(o),i=n(8545),s=n(53056),c=n.n(s);var u,l,p=5e3;function d(e,t){"new"===t.status?e.css("background-color","rgba(128, 128, 128, 0.5)"):"pending"===t.status?e.css("background-color","rgba(0, 0, 255, 0.5)"):"done"===t.status?e.css("background-color","#5cb85c"):"failed"===t.status&&(e.css("background-color","rgba(255, 0, 0, 0.5)"),e.css("background-image","none"));var n,r,o=(t.progress_message||t.status).split("\n",2);n=o[0],r=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}(o).slice(1),e.text(n),r.length&&e.prop("title",r[0]),"new"===t.status||"pending"===t.status?e.addClass("progress-bar-animated"):e.removeClass("progress-bar-striped")}function f(e){return _.apply(this,arguments)}function _(){return(_=(0,r.A)(a().mark(function e(t){var n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=null,e.next=1,fetch(t);case 1:if(!e.sent.ok){e.next=2;break}$("#vault-download-iframe").attr("src",t),e.next=6;break;case 2:if(!(n=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")))){e.next=5;break}r=0;case 3:if(!(r<n.length)){e.next=5;break}if(n[r].fetch_url!==t){e.next=4;break}return l=n[r],e.abrupt("continue",5);case 4:++r,e.next=3;break;case 5:$("#vault-recook-object-modal").modal("show");case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){return v.apply(this,arguments)}function v(){return(v=(0,r.A)(a().mark(function e(){var t,n,r,o,s,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=8;break}return clearTimeout(u),t="flat"===l.bundle_type?Urls.api_1_vault_cook_flat(l.swhid):Urls.api_1_vault_cook_git_bare(l.swhid),l.email&&(t+="?email="+l.email),e.prev=1,e.next=2,(0,i.Jq)(t);case 2:n=e.sent,(0,i.Tv)(n),l.status="new",r=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")),o=0;case 3:if(!(o<r.length)){e.next=5;break}if(r[o].swhid!==l.swhid){e.next=4;break}return r[o]=l,e.abrupt("continue",5);case 4:++o,e.next=3;break;case 5:localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(r)),swh.vault.displayCookingTaskCreatedAlert(),e.next=7;break;case 6:e.prev=6,e.catch(1),swh.vault.displayCookingTaskCreationFailedAlert();case 7:e.next=9;break;case 8:s=$("#vault-recook-object-modal").attr("swh-object-type"),c=$("#vault-recook-object-modal").attr("swh-object-swhid"),"directory"===s?swh.vault.cookDirectoryArchive(null,c):"revision"===s&&swh.vault.cookRevisionArchive(null,c);case 9:return $("#vault-recook-object-modal").modal("hide"),e.next=10,b();case 10:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}function b(){return k.apply(this,arguments)}function k(){return(k=(0,r.A)(a().mark(function e(){var t,n,r,o,s,l,f,_,h,v,k,w,g,m,y,x,j,T,S;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")))&&0!==t.length){e.next=1;break}return $(".swh-vault-table tbody tr").remove(),u=setTimeout(b,p),e.abrupt("return");case 1:n=[],r={},o=[],s=0;case 2:if(!(s<t.length)){e.next=8;break}if(void 0===(l=t[s]).object_type){e.next=6;break}if("directory"!==l.object_type){e.next=3;break}l.swhid="swh:1:dir:"+l.object_id,l.bundle_type="flat",l.fetch_url=Urls.api_1_vault_download_flat(l.swhid),e.next=5;break;case 3:if("revision"!==l.object_type){e.next=4;break}l.swhid="swh:1:rev:"+l.object_id,l.bundle_type="git_bare",l.fetch_url=Urls.api_1_vault_download_git_bare(l.swhid),e.next=5;break;case 4:return console.error("Unexpected cookingTask.object_type: "+l.object_type),e.abrupt("continue",7);case 5:delete l.object_type,delete l.object_id;case 6:o.push(l.swhid),r[l.swhid]=l,f=void 0,f="flat"===l.bundle_type?Urls.api_1_vault_cook_flat(l.swhid):Urls.api_1_vault_cook_git_bare(l.swhid),"done"!==l.status&&"failed"!==l.status&&n.push(fetch(f));case 7:++s,e.next=2;break;case 8:return $(".swh-vault-table tbody tr").each(function(e,t){var n=$(t).find(".vault-object-info").data("swhid");-1===$.inArray(n,o)&&$(t).remove()}),e.prev=9,e.next=10,Promise.all(n);case 10:return _=e.sent,(0,i.EQ)(_,[404]),e.next=11,Promise.all(_.map(function(e){return e.json()}));case 11:for(h=e.sent,v=$("#vault-cooking-tasks tbody"),k=0;k<h.length;++k)(w=r[h[k].swhid])&&(w.status=h[k].status,w.fetch_url=h[k].fetch_url,w.progress_message=h[k].progress_message);for(g=0;g<t.length;++g)m=t[g],(y=$("#vault-task-"+CSS.escape(m.swhid))).length?(d(y.find(".progress-bar"),m),T=y.find(".vault-dl-link"),"done"===m.status?T[0].innerHTML='<button class="btn btn-secondary btn-sm" onclick="swh.vault.fetchCookedObject(\''+m.fetch_url+'\')"><i class="mdi mdi-download mdi-fw" aria-hidden="true"></i>Download</button>':T[0].innerHTML=""):((x=m.browse_url)||(x=Urls.browse_swhid(m.swhid)),j=$.parseHTML('<div class="progress">\n    <div class="progress-bar progress-bar-success progress-bar-striped"\n          role="progressbar" aria-valuenow="100" aria-valuemin="0"\n          aria-valuemax="100" style="width: 100%;height: 100%;">\n    </div>\n  </div>;')[0],d($(j).find(".progress-bar"),m),v.prepend(c()({browseUrl:x,cookingTask:m,progressBar:j,Urls:Urls,swh:swh})));localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(t)),u=setTimeout(b,p),e.next=13;break;case 12:e.prev=12,S=e.catch(9),console.log("Error when fetching vault cooking tasks:",S);case 13:case"end":return e.stop()}},e,null,[[9,12]])}))).apply(this,arguments)}function w(e){var t=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks"));t&&(t=$.grep(t,function(t){return-1===$.inArray(t.swhid,e)}),localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(t)))}function g(){$("#vault-tasks-toggle-selection").change(function(e){$(".vault-task-toggle-selection").prop("checked",e.currentTarget.checked)}),$("#vault-remove-tasks").click(function(){clearTimeout(u);var e=[];$(".swh-vault-table tbody tr").each(function(t,n){if($(n).find(".vault-task-toggle-selection").prop("checked")){var r=$(n).find(".vault-object-info").data("swhid");e.push(r),$(n).remove()}}),w(e),$("#vault-tasks-toggle-selection").prop("checked",!1),u=setTimeout(b,p)}),b(),window.onfocus=function(){clearTimeout(u),b()}}},75546:function(e){function t(n,r,o,a){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}e.exports=t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,o,a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},94196:function(e,t,n){"use strict";n.d(t,{Ib:function(){return u},MO:function(){return k},OH:function(){return h},SI:function(){return l},aS:function(){return w},eo:function(){return v},mE:function(){return p}});var r=n(10467),o=n(54756),a=n.n(o),i=n(38556),s=n(8545),c={position:"fixed",left:"1rem",bottom:"1rem","z-index":"100000"};function u(){var e=$((0,s.Iu)("success",'Archive cooking request successfully submitted.<br/>Go to the <a class="alert-link" href="'+Urls.vault()+'">Downloads</a> page to get the download link once it is ready.',!0));e.css(c),$("body").append(e)}function l(){var e=$((0,s.Iu)("danger","Archive cooking request submission failed.",!0));e.css(c),$("body").append(e)}function p(e,t){return d.apply(this,arguments)}function d(){return(d=(0,r.A)(a().mark(function e(t,n){var r,o,i,u,l;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="directory"===t?Urls.api_1_vault_cook_flat(n):Urls.api_1_vault_cook_git_bare(n),e.next=1,fetch(r);case 1:return o=e.sent,e.next=2,o.json();case 2:i=e.sent,u=["failed","pending","new"],"NotFoundExc"===i.exception||u.includes(i.status)?(swh.vault.removeCookingTaskInfo([n]),$("#vault-cook-"+t+"-modal").modal("show")):"done"===i.status?$("#vault-download-"+t+"-modal").modal("show"):((l=$((0,s.Iu)("danger","Something unexpected happened when requesting the archive cooking service.<br/>Please try again later.",!0))).css(c),$("body").append(l));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(e,t){return _.apply(this,arguments)}function _(){return(_=(0,r.A)(a().mark(function e(t,n){var r,o,i,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=swh.webapp.getSwhIdsContext(),n.origin=r[t].context.origin,n.path=r[t].context.path,n.browse_url=r[t].swhid_with_context_url,n.browse_url||(n.browse_url=r[t].swhid_url),(o=JSON.parse(localStorage.getItem("swh-vault-cooking-tasks")))||(o=[]),void 0!==o.find(function(e){return e.bundle_type===n.bundle_type&&e.swhid===n.swhid})){e.next=4;break}return i="flat"===n.bundle_type?Urls.api_1_vault_cook_flat(n.swhid):Urls.api_1_vault_cook_git_bare(n.swhid),n.email&&(i+="?email="+encodeURIComponent(n.email)),e.prev=1,e.next=2,(0,s.Jq)(i);case 2:c=e.sent,(0,s.Tv)(c),o.push(n),localStorage.setItem("swh-vault-cooking-tasks",JSON.stringify(o)),$("#vault-cook-directory-modal").modal("hide"),$("#vault-cook-revision-modal").modal("hide"),u(),e.next=4;break;case 3:e.prev=3,e.catch(1),$("#vault-cook-directory-modal").modal("hide"),$("#vault-cook-revision-modal").modal("hide"),l();case 4:case"end":return e.stop()}},e,null,[[1,3]])}))).apply(this,arguments)}function h(e,t){e&&e.preventDefault();var n=$("#swh-vault-directory-email").val().trim();!n||i.t(n)?f("directory",{bundle_type:"flat",swhid:t,email:n,status:"new"}):$("#invalid-email-modal").modal("show")}function v(e){return b.apply(this,arguments)}function b(){return(b=(0,r.A)(a().mark(function e(t){var n,r,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $("#vault-download-directory-modal").modal("hide"),$("#vault-recook-object-modal").attr("swh-object-type","directory"),$("#vault-recook-object-modal").attr("swh-object-swhid",t),n=Urls.api_1_vault_cook_flat(t),e.next=1,fetch(n);case 1:return r=e.sent,e.next=2,r.json();case 2:o=e.sent,swh.vault.fetchCookedObject(o.fetch_url);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(e,t){e&&e.preventDefault();var n=$("#swh-vault-revision-email").val().trim();!n||i.t(n)?f("revision",{bundle_type:"git_bare",swhid:t,email:n,status:"new"}):$("#invalid-email-modal").modal("show")}function w(e){return g.apply(this,arguments)}function g(){return(g=(0,r.A)(a().mark(function e(t){var n,r,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $("#vault-download-revision-modal").modal("hide"),$("#vault-recook-object-modal").attr("swh-object-type","revision"),$("#vault-recook-object-modal").attr("swh-object-swhid",t),n=Urls.api_1_vault_cook_git_bare(t),e.next=1,fetch(n);case 1:return r=e.sent,e.next=2,r.json();case 2:o=e.sent,swh.vault.fetchCookedObject(o.fetch_url);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{cookDirectoryArchive:function(){return t.OH},cookRevisionArchive:function(){return t.MO},displayCookingTaskCreatedAlert:function(){return t.Ib},displayCookingTaskCreationFailedAlert:function(){return t.SI},fetchCookedObject:function(){return e.hm},fetchDirectoryArchive:function(){return t.eo},fetchRevisionArchive:function(){return t.aS},initUi:function(){return e.jh},recookObject:function(){return e.Bn},removeCookingTaskInfo:function(){return e.iF},vaultRequest:function(){return t.mE}});var e=__webpack_require__(75097),t=__webpack_require__(94196)}(),__webpack_exports__}()});
//# sourceMappingURL=vault.d2ec3dd1d84a8d038a6c.js.map