"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[4506],{34506:(e,t,n)=>{n.r(t),n.d(t,{IMercuryShell:()=>d,MercuryApp:()=>h,MercuryShell:()=>u,default:()=>w});var i={};n.r(i),n.d(i,{default:()=>x});var o=n(15948),s=n(82514),r=n(73475),a=n(25884),l=n(12756),c=n(9521);const d=new a.Token("mercury-application:IMercuryShell");class u extends c.Widget{constructor(){super(),this._updated=new l.Signal(this),this.layout=new c.BoxLayout,this.id="main",this._currentWidget=null}get updated(){return this._updated}activateById(e){}add(e,t,n){this.layout.widgets.length>0||"mercury"!==t||(c.BoxLayout.setStretch(e,1),this.layout.addWidget(e),this._currentWidget=e)}get currentWidget(){return this._currentWidget}*widgets(e){yield*this.layout.widgets}onUpdateRequest(e){super.onUpdateRequest(e),this._updated.emit()}}class h extends o.JupyterFrontEnd{constructor(e={}){var t,n;if(super({...e,shell:null!==(t=e.shell)&&void 0!==t?t:new u}),this.name="Mercury",this.namespace=this.name,this.version=null!==(n=r.PageConfig.getOption("appVersion"))&&void 0!==n?n:"unknown",e.mimeExtensions)for(const t of(0,s.jO)(e.mimeExtensions))this.registerPlugin(t)}get paths(){return{urls:{base:r.PageConfig.getOption("baseUrl"),notFound:r.PageConfig.getOption("notFoundUrl"),app:r.PageConfig.getOption("appUrl"),static:r.PageConfig.getOption("staticUrl"),settings:r.PageConfig.getOption("settingsUrl"),themes:r.PageConfig.getOption("themesUrl"),doc:r.PageConfig.getOption("docUrl"),translations:r.PageConfig.getOption("translationsApiUrl")},directories:{appSettings:r.PageConfig.getOption("appSettingsDir"),schemas:r.PageConfig.getOption("schemasDir"),static:r.PageConfig.getOption("staticDir"),templates:r.PageConfig.getOption("templatesDir"),themes:r.PageConfig.getOption("themesDir"),userSettings:r.PageConfig.getOption("userSettingsDir"),serverRoot:r.PageConfig.getOption("serverRoot"),workspaces:r.PageConfig.getOption("workspacesDir")}}}registerPluginModule(e){let t=e.default;Object.prototype.hasOwnProperty.call(e,"__esModule")||(t=e),Array.isArray(t)||(t=[t]),t.forEach(e=>{try{this.registerPlugin(e)}catch(e){console.error(e)}})}registerPluginModules(e){e.forEach(e=>{this.registerPluginModule(e)})}}var m=n(93855),p=n(52018),g=n(34562),b=n(43834),f=n(7748);class y{constructor(e){var t;this.notebooks=[],this.menuOpen=!1,this.opts={...e,attachTo:null!==(t=e.attachTo)&&void 0!==t?t:document.body}}async mount(){var e,t;this.injectStyles(),this.buildHeader(),this.opts.attachTo.insertBefore(this.header,this.opts.attachTo.firstChild);const n=this.header.getBoundingClientRect().height||52;null===(t=(e=this.opts).onHeightChange)||void 0===t||t.call(e,n),await this.loadNotebooks(),this.bindGlobalHandlers()}destroy(){var e,t;this.unbindGlobalHandlers(),null===(e=this.header)||void 0===e||e.remove(),null===(t=this.styleEl)||void 0===t||t.remove()}injectStyles(){const e=document.createElement("style");e.id="mrc-header-style",e.textContent="\n        :root { color-scheme: light dark; }\n        .mrc-hidden { display: none; }\n  \n        /* Header */\n        .mrc-hdr {\n          position: fixed; top: 0; left: 0; right: 0; z-index: 10000;\n          background: #0b0b0c;\n          border-bottom: 1px solid rgba(255,255,255,0.08);\n        }\n        .mrc-hdr-inner {\n          margin: 0 auto;\n          display: flex; align-items: center; justify-content: space-between;\n          padding: .6rem .75rem;\n        }\n        .mrc-brand {\n          font-weight: 750; letter-spacing: -.01em;\n          color: #f3f4f6; font-size: clamp(14px, 2vw, 20px);\n          text-decoration: none;\n          font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\n        }\n        .mrc-brand:hover { text-decoration: underline; }\n  \n        /* Button */\n        .mrc-btn {\n          display: inline-flex; align-items: center; gap: .5rem;\n          border: 1px solid #e5e7eb;\n          background: #fff; color: #374151;\n          padding: .45rem .75rem; font-size: 13px; border-radius: .5rem;\n          transition: box-shadow .15s ease, transform .15s ease;\n          cursor: pointer;\n        }\n        .mrc-btn[disabled] { opacity: .7; cursor: progress; }\n        .mrc-btn:hover { text-decoration: none; box-shadow: 0 1px 8px rgba(0,0,0,.06); }\n        .mrc-caret { transition: transform .15s ease; }\n  \n        /* Menu (dropdown) */\n        .mrc-menu{\n          position:absolute; right:0; margin-top:.5rem; width:22rem; max-height:28rem; overflow:auto;\n          border:1px solid rgba(0,0,0,.08); border-radius:1rem;\n          background:rgba(255,255,255,.95); backdrop-filter:blur(8px);\n          box-shadow:0 10px 30px rgba(0,0,0,.08);\n        }\n        .mrc-menu-list{ padding:.4rem; }\n        .mrc-menu-item{\n          display:flex; align-items:center; gap:.7rem;\n          padding:.6rem .65rem; border-radius:.75rem;\n          color:#111827; font-size:14px;\n          text-decoration:none;\n          transition: background-color .12s ease, transform .12s ease;\n          font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;\n        }\n        .mrc-menu-item:hover{ background:#f8fafc; text-decoration:none; }\n        .mrc-menu-item:active{ transform: translateY(0.5px); }\n        .mrc-menu-thumb{\n          width:36px; height:28px; border-radius:.6rem;\n          display:grid; place-items:center; font-weight:700; line-height:1;\n          box-shadow: inset 0 0 0 1px rgba(0,0,0,.03);\n        }\n      ",document.head.appendChild(e),this.styleEl=e}buildHeader(){const e=document.createElement("header");e.className="mrc-hdr",e.setAttribute("role","banner");const t=document.createElement("div");t.className="mrc-hdr-inner";const n=document.createElement("a");n.className="mrc-brand",n.href=this.opts.baseUrl||"/",n.textContent=this.opts.title||"Mercury";const i=document.createElement("div");i.style.position="relative";const o=document.createElement("button");o.type="button",o.className="mrc-btn",o.id="mrcNbBtn",o.setAttribute("aria-haspopup","menu"),o.setAttribute("aria-expanded","false"),o.textContent="Notebooks";const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","mrc-caret"),s.setAttribute("width","16"),s.setAttribute("height","16"),s.setAttribute("viewBox","0 0 20 20"),s.setAttribute("fill","currentColor"),s.setAttribute("aria-hidden","true"),s.innerHTML='<path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 0 1 1.08 1.04l-4.25 4.25a.75.75 0 0 1-1.06 0L5.21 8.27a.75.75 0 0 1 .02-1.06z" clip-rule="evenodd"/>',o.appendChild(s);const r=document.createElement("div");r.id="mrcNbMenu",r.className="mrc-menu mrc-hidden",r.setAttribute("role","menu"),r.setAttribute("aria-label","Notebook list");const a=document.createElement("div");a.id="mrcNbMenuList",a.className="mrc-menu-list",a.setAttribute("role","none"),r.appendChild(a),i.appendChild(o),i.appendChild(r),t.appendChild(n),t.appendChild(i),e.appendChild(t),o.addEventListener("click",e=>{e.preventDefault(),this.notebooks.length&&this.setMenu(!this.menuOpen)}),this.header=e,this.btn=o,this.menu=r,this.menuList=a,this.caret=s}bindGlobalHandlers(){this.clickAway=e=>{if(!this.menuOpen||!this.menu||!this.btn)return;const t=e.target;this.menu.contains(t)||this.btn.contains(t)||this.setMenu(!1)},this.keyHandler=e=>{"escape"===String(e.key).toLowerCase()&&this.setMenu(!1)},document.addEventListener("click",this.clickAway),document.addEventListener("keydown",this.keyHandler)}unbindGlobalHandlers(){this.clickAway&&document.removeEventListener("click",this.clickAway),this.keyHandler&&document.removeEventListener("keydown",this.keyHandler)}setMenu(e){this.menu&&this.btn&&this.caret&&(this.menu.classList.toggle("mrc-hidden",!e),this.btn.setAttribute("aria-expanded",String(e)),this.caret.style.transform=e?"rotate(180deg)":"rotate(0deg)",this.menuOpen=e)}sizeThumb(e){const t=(e.textContent||"").trim();let n="1.0rem";t.length>6?n="0.4rem":t.length>4?n="0.6rem":t.length>2&&(n="0.8rem"),e.style.fontSize=n}renderMenu(e){if(!this.menuList)return;const t=document.createDocumentFragment();for(const n of e){const e=document.createElement("a");e.className="mrc-menu-item",e.href=n.slug||"#",e.setAttribute("role","menuitem");const i=document.createElement("div");i.className="mrc-menu-thumb",i.style.background=n.thumbnail_bg||"#f1f5f9",i.style.color=n.thumbnail_text_color||"#0f172a",i.textContent=n.thumbnail_text||"ðŸ“’",this.sizeThumb(i);const o=document.createElement("span");o.textContent=n.name||"Notebook",e.appendChild(i),e.appendChild(o),t.appendChild(e)}this.menuList.innerHTML="",this.menuList.appendChild(t)}async loadNotebooks(){var e;if(this.btn&&this.menu)try{this.btn.disabled=!0;const e=await fetch(this.opts.apiUrl,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();if(this.notebooks=Array.isArray(t)?t:[],0===this.notebooks.length)return this.btn.style.display="none",void this.menu.remove();this.renderMenu(this.notebooks)}catch(t){console.warn("[Mercury] Failed to load notebooks menu:",t),this.btn.style.display="none",null===(e=this.menu)||void 0===e||e.remove()}finally{this.btn.disabled=!1}}}const v={id:"mercury-application:opener",autoStart:!0,requires:[g.IDocumentManager,f.IMercuryCellExecutor],optional:[p.IEditorServices,m.ISessionContextDialogs,b.ITranslator],activate:(e,t,n,i,o,s)=>{const{mimeTypeService:l}=null!=i?i:{};Promise.all([e.started,e.restored]).then(async()=>{const i=r.PageConfig.getOption("notebookPath"),c=t.open(i,"Mercury");c.toolbar.hide(),e.shell.add(c,"mercury");const d=r.PageConfig.getBaseUrl()||"/";if(!new URLSearchParams(window.location.search).has("no-navbar")){const e=new y({baseUrl:d,title:r.PageConfig.getOption("title")||"Mercury",apiUrl:`${d}mercury/api/notebooks`,onHeightChange:e=>{const t=c.node.querySelector(".mercury-main-panel");if(t)t.style.paddingTop=`${e}px`;else{const t=c.node.querySelector(".jp-Notebook");t&&(t.style.paddingTop=`${e}px`)}}});await e.mount(),c.disposed.connect(()=>e.destroy())}c.context.ready.then(async()=>{let e=c.context.sessionContext.session;if(!e){const[,t]=await(0,r.signalToPromise)(c.context.sessionContext.sessionChanged);e=t.newValue}let t=null==e?void 0:e.kernel;if(!t){const[,n]=await(0,r.signalToPromise)(e.kernelChanged);t=n.newValue}const i=async()=>{if("connected"===(null==t?void 0:t.connectionStatus)&&"idle"===(null==t?void 0:t.status)){t.connectionStatusChanged.disconnect(i),t.statusChanged.disconnect(i);const e=new Set,r=c.context.model,d=r.getMetadata("language_info"),u=d?null==l?void 0:l.getMimeTypeByLanguage(d):void 0,h=t=>{e.add(t.cell.model.id)},m=t=>{e.delete(t.cell.model.id)};for(const e of c.content.widgets[0].cellWidgets)u&&(e.child.model.mimeType=u),await n.runCell({cell:e.child,notebook:r,notebookConfig:c.content.notebookConfig,onCellExecuted:m,onCellExecutionScheduled:h,sessionContext:c.context.sessionContext,sessionDialogs:null!=o?o:void 0,translator:null!=s?s:void 0});const p=new a.PromiseDelegate,g=setInterval(()=>{0===e.size&&(clearInterval(g),p.resolve())},500);await p.promise}};null==t||t.connectionStatusChanged.connect(i),null==t||t.statusChanged.connect(i),i()})})}},C={id:"mercury-application:paths",autoStart:!0,provides:o.JupyterFrontEnd.IPaths,activate:e=>{if(!(e instanceof h))throw new Error(`${C.id} can only be activated in Mercury.`);return e.paths}},x=[C,v],w=i}}]);
//# sourceMappingURL=4506.js.map