"use strict";(self.webpackChunkjupyterlab_notifications_extension=self.webpackChunkjupyterlab_notifications_extension||[]).push([[750],{750:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var o=n(324),a=n(247),i=n(603),s=n(596);async function c(e="",t={}){const n=s.ServerConnection.makeSettings(),o=i.URLExt.join(n.baseUrl,"jupyterlab-notifications-extension",e);let a;try{a=await s.ServerConnection.makeRequest(o,t,n)}catch(e){throw new s.ServerConnection.NetworkError(e)}let c=await a.text();if(c.length>0)try{c=JSON.parse(c)}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok)throw new s.ServerConnection.ResponseError(a,c.message||c);return c}async function l(e){try{const t=await c("notifications");t.notifications&&t.notifications.length>0&&(console.log(`Received ${t.notifications.length} notification(s) from server`),t.notifications.forEach(t=>{const n={autoClose:t.autoClose};void 0!==t.data&&(n.data=t.data),t.actions&&t.actions.length>0&&(n.actions=t.actions.map(e=>({label:e.label,caption:e.caption||"",displayType:e.displayType||"default",callback:()=>{console.log(`Action clicked: ${e.label}`)}}))),e.commands.execute("apputils:notify",{message:t.message,type:t.type,options:n}).catch(e=>{console.error("Failed to display notification:",e)})}))}catch(e){console.error("Failed to fetch notifications from server:",e)}}const d={id:"jupyterlab_notifications_extension:plugin",description:"Jupyterlab extension to receive and display notifications in the main panel. Those can be from the jupyterjub administrator or from other places.",autoStart:!0,requires:[o.ICommandPalette],activate:(e,t)=>{console.log("JupyterLab extension jupyterlab_notifications_extension is activated!");const n="jupyterlab-notifications:send";e.commands.addCommand(n,{label:"Send Notification",caption:"Send a notification to all JupyterLab users",execute:async e=>{let t=e.message,n=e.type||"info",i=void 0!==e.autoClose?e.autoClose:5e3,s=e.actions||[];const l=e.data;if(!t){const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.gap="10px";const c=document.createElement("label");c.textContent="Message:";const l=document.createElement("input");l.type="text",l.placeholder="Enter notification message",l.style.width="100%",l.style.padding="5px";const d=document.createElement("label");d.textContent="Type:";const r=document.createElement("select");r.style.width="100%",r.style.padding="5px",["info","success","warning","error","in-progress"].forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,r.appendChild(t)});const p=document.createElement("div");p.style.display="flex",p.style.alignItems="center",p.style.gap="10px";const u=document.createElement("input");u.type="checkbox",u.id="autoCloseCheckbox",u.checked=!0;const m=document.createElement("label");m.htmlFor="autoCloseCheckbox",m.textContent="Auto-close after",m.style.cursor="pointer";const y=document.createElement("input");y.type="number",y.value="5",y.min="1",y.style.width="60px",y.style.padding="3px";const f=document.createElement("span");f.textContent="seconds",p.appendChild(u),p.appendChild(m),p.appendChild(y),p.appendChild(f),u.addEventListener("change",()=>{y.disabled=!u.checked});const h=document.createElement("input");h.type="checkbox",h.id="dismissCheckbox";const b=document.createElement("label");b.htmlFor="dismissCheckbox",b.textContent=" Include dismiss button",b.style.display="flex",b.style.alignItems="center",b.style.gap="5px",b.style.cursor="pointer",b.prepend(h),e.appendChild(c),e.appendChild(l),e.appendChild(d),e.appendChild(r),e.appendChild(p),e.appendChild(b);const g=new a.Widget({node:e}),C=new o.Dialog({title:"Send Notification",body:g,buttons:[o.Dialog.cancelButton(),o.Dialog.okButton({label:"Send"})]});if(!(await C.launch()).button.accept)return;if(t=l.value,!t)return;n=r.value,i=!!u.checked&&1e3*parseInt(y.value),s=h.checked?[{label:"Dismiss",caption:"Close this notification",displayType:"default"}]:[]}try{const e={message:t,type:n,autoClose:i};s.length>0&&(e.actions=s),void 0!==l&&(e.data=l),await c("ingest",{method:"POST",body:JSON.stringify(e)}),console.log("Notification sent successfully")}catch(e){console.error("Failed to send notification:",e)}}}),t.addItem({command:n,category:"Notifications"}),l(e),setInterval(()=>{l(e)},3e4),console.log("Notification polling started (interval: 30s)")}}}}]);