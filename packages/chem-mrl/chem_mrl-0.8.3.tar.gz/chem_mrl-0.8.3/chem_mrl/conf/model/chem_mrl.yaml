defaults:
  - chem_mrl_schema
  - _self_

model_name: Derify/ModChemBERT-IR-BASE # Name of the model to use. Must be either a file path or a HF transformer model name.

# MaxPoolBERT configuration (mutually exclusive with `embedding_pooling` and `use_2d_matryoshka` options)
max_pool_bert:
  enable: false # Disable MaxPoolBERT by default
  num_attention_heads: 4 # Number of attention heads for multi-head attention
  last_k_layers: 3 # Number of last hidden layers to use for pooling
  pooling_strategy: mha # Default pooling strategy (options: cls, max_cls, mha, max_seq_mha, mean_seq_mha, sum_seq_mha)

embedding_pooling: mean # Pooling layer method applied to the embeddings.
# For details visit: https://sbert.net/docs/package_reference/sentence_transformer/models.html#sentence_transformers.models.Pooling
# Valid options
# - mean
# - mean_sqrt_len_tokens
# - weightedmean
loss_func: tanimotosentloss # ChemMRL loss function
# Valid options
# - tanimotosentloss
# - tanimotosimilarityloss
# - cosentloss
# - angleloss
tanimoto_similarity_loss_func: null # Base loss function for tanimoto similarity loss function (only used if loss_func=tanimotosimilarityloss)
# Valid options
# - null
# - mse
# - l1
# - smooth_l1
# - huber
# - bin_cross_entropy
# - kldiv
# - cosine_embedding_loss
eval_similarity_fct: tanimoto # Similarity function to use for evaluation
# Valid options
# - tanimoto
# - cosine
# - dot
# - euclidean
# - manhattan
eval_metric: spearman # Metric to use for evaluation
# Valid options
# - spearman
# - pearson
mrl_dimensions:
  [1024, 512, 256, 128, 64, 32, 16, 8] # A list of embedding dimensions to be used for the loss function.
  # Each value must be less than equal to the base transformer's hidden dimension.
mrl_dimension_weights:
  [1, 1, 1, 1, 1, 1, 1, 1] # A list of weights to be used for the loss function.
  # The number of dimension weights must match that of the MRL dimensions.
n_dims_per_step:
  -1 # The number of dimensions to use per step. If -1, then all dimensions are used.
  # If > 0, then a random sample of n_dims_per_step dimensions are used per step.
use_2d_matryoshka: false # Disable 2D Matryoshka
