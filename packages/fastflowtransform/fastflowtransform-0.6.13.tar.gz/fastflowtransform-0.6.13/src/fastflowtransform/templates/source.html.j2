<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>{{ source.source_name }}.{{ source.table_name }} – Source – FastFlowTransform</title>
  <style>
    :root {
      --bg:#ffffff; --fg:#0f172a; --muted:#6b7280; --card:#ffffff; --border:#e5e7eb;
      --chip-src-bg:#e8f1ff; --chip-src-fg:#0a1f44;
      --accent:#2563eb;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg:#0b0f1a; --fg:#e5e7eb; --muted:#94a3b8; --card:#111827; --border:#1f2937;
        --chip-src-bg:#0e1a2c; --chip-src-fg:#93c5fd;
        --accent:#60a5fa;
      }
    }
    * { box-sizing: border-box; }
    body {
      margin: 24px;
      background: var(--bg);
      color: var(--fg);
      font: 14px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .muted { color: var(--muted); }
    .card {
      border:1px solid var(--border);
      background:var(--card);
      border-radius:14px;
      padding:16px;
    }
    .row {
      display:grid;
      gap:16px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 900px) {
      .row { grid-template-columns: 2fr 1fr; }
    }
    .chip {
      font-size:12px;
      padding:2px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: var(--chip-src-bg);
      color: var(--chip-src-fg);
    }
    .kv {
      display:grid;
      grid-template-columns: 140px 1fr;
      gap:8px 12px;
      align-items:start;
    }
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 12px;
    }
    ul.inline { list-style:none; padding:0; margin:0; }
    ul.inline li { display:inline; }
    ul.inline li+li::before { content:", "; }
    .pill {
      display:inline-block;
      padding:1px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      font-size:12px;
    }
    .pill-none { background:rgba(127,127,127,.04); color:var(--muted); }
    .pill-warn { background:#fff7e8; color:#7a4a00; border-color:#f6db9b; }
    .pill-error { background:#fef2f2; color:#991b1b; border-color:#fecaca; }
    .desc { overflow-wrap:anywhere; white-space: normal; }
  </style>
</head>
<body>
  <p><a href="index.html">← Back to overview</a></p>

  <header style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;">
    <div>
      <h1 style="margin:0 0 6px 0; font-size:1.25rem;">
        {{ source.source_name }}.<span>{{ source.table_name }}</span>
      </h1>
      <div class="muted">Source Detail • FastFlowTransform</div>
    </div>
    <span class="chip">source</span>
  </header>

  <div class="row">
    {% if source.description_html %}
    <section class="card">
      <h2 style="margin:0 0 10px 0; font-size:1rem;">Description</h2>
      <div class="desc">{{ source.description_html | safe }}</div>
    </section>
    {% endif %}

    <section class="card">
      <h2 style="margin:0 0 10px 0; font-size:1rem;">Metadata</h2>
      <div class="kv">
        <div class="muted">Source</div>
        <div><code>{{ source.source_name }}</code></div>

        <div class="muted">Table</div>
        <div><code>{{ source.table_name }}</code></div>

        <div class="muted">Relation</div>
        <div><code>{{ source.relation }}</code></div>

        <div class="muted">Loaded at field</div>
        <div>
          {% if source.loaded_at_field %}
            <code>{{ source.loaded_at_field }}</code>
          {% else %}
            <span class="muted">–</span>
          {% endif %}
        </div>

        <div class="muted">Warn after</div>
        <div>
          {% if source.warn_after_minutes is not none %}
            <span class="pill pill-warn">{{ source.warn_after_minutes }} min</span>
          {% else %}
            <span class="pill pill-none">not set</span>
          {% endif %}
        </div>

        <div class="muted">Error after</div>
        <div>
          {% if source.error_after_minutes is not none %}
            <span class="pill pill-error">{{ source.error_after_minutes }} min</span>
          {% else %}
            <span class="pill pill-none">not set</span>
          {% endif %}
        </div>

        <div class="muted">Consumers</div>
        <div>
          {% if source.consumers and source.consumers|length %}
            <ul class="inline">
              {% for m in source.consumers %}
                <li><a href="{{ m }}.html">{{ m }}</a></li>
              {% endfor %}
            </ul>
          {% else %}
            <span class="muted">No models referencing this source (via <code>source('{{ source.source_name }}','{{ source.table_name }}')</code>)</span>
          {% endif %}
        </div>
      </div>
    </section>

    <aside class="card">
      <h2 style="margin:0 0 10px 0; font-size:1rem;">Tips</h2>
      <ul style="margin:0 0 0 18px;">
        <li><code>source('{{ source.source_name }}', '{{ source.table_name }}')</code> is used in models to reference this table.</li>
        <li><code>loaded_at_field</code> is used for freshness checks in <code>fft source freshness</code>.</li>
        <li><code>warn_after</code> and <code>error_after</code> are configured in <code>sources.yml</code> with dbt-style windows (count + period).</li>
      </ul>
    </aside>
  </div>
</body>
</html>
