import pytest

from codeaudit.pypi_package_scan import find_download_url , get_pypi_download_info

#Note This testfunction does NOT make real API calls to PyPI! So check if testdata is still correct in cause of errors.

test_data = ('6.0b1',
 [{'comment_text': '',
   'digests': {'blake2b_256': '553e5e5514b8a5a146fda33f04b86b2a92ad0d663d6341cb1977060353d8aa33',
    'md5': 'f078926d71b936548354ccbc7e3d17d8',
    'sha256': '77627ca1909b1c9efdd42d7c7f680b22e620ffda5f64b01ba282bd5a59a5d108'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-macosx_10_9_x86_64.whl',
   'has_sig': False,
   'md5_digest': 'f078926d71b936548354ccbc7e3d17d8',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 197617,
   'upload_time': '2021-10-04T19:44:04',
   'upload_time_iso_8601': '2021-10-04T19:44:04.684882Z',
   'url': 'https://files.pythonhosted.org/packages/55/3e/5e5514b8a5a146fda33f04b86b2a92ad0d663d6341cb1977060353d8aa33/PyYAML-6.0b1-cp310-cp310-macosx_10_9_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'cd68e7c5abbd3e6655d5e84429e79b37a757f98c9141e2da1aed5057cc6c1cd2',
    'md5': 'a0b08c77feaa04a930ac6ced87be45cf',
    'sha256': 'acd3d75d7ce71850f9d3972f68baca1133a8cd27e6153d64d00be8504a491c8c'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-macosx_11_0_arm64.whl',
   'has_sig': False,
   'md5_digest': 'a0b08c77feaa04a930ac6ced87be45cf',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 174003,
   'upload_time': '2021-10-04T19:44:07',
   'upload_time_iso_8601': '2021-10-04T19:44:07.204890Z',
   'url': 'https://files.pythonhosted.org/packages/cd/68/e7c5abbd3e6655d5e84429e79b37a757f98c9141e2da1aed5057cc6c1cd2/PyYAML-6.0b1-cp310-cp310-macosx_11_0_arm64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'b170907fb200f12ad6fc0b9eb9ffb5d826334cd6f8894b3bc177d7393f213aa5',
    'md5': '863174302d12ac086ea154297d04531a',
    'sha256': '69b8e0559a01ef14b5d76882c2b49f643ab6d5b953ec5e5590411d2bdb707f4a'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'has_sig': False,
   'md5_digest': '863174302d12ac086ea154297d04531a',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 733319,
   'upload_time': '2021-10-04T19:44:09',
   'upload_time_iso_8601': '2021-10-04T19:44:09.240977Z',
   'url': 'https://files.pythonhosted.org/packages/b1/70/907fb200f12ad6fc0b9eb9ffb5d826334cd6f8894b3bc177d7393f213aa5/PyYAML-6.0b1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '4fbf4399283ca29df01d6b7c1e45b9155bf52764559657d41326e51902d1d96c',
    'md5': 'dc80db4eba4126e2fb6fb1f3fff1d356',
    'sha256': '11dae7bfe84016061d528c355bbe0faa0775f077f21831b1fbaa7997b266ca99'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'has_sig': False,
   'md5_digest': 'dc80db4eba4126e2fb6fb1f3fff1d356',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 757522,
   'upload_time': '2021-10-04T19:44:10',
   'upload_time_iso_8601': '2021-10-04T19:44:10.865143Z',
   'url': 'https://files.pythonhosted.org/packages/4f/bf/4399283ca29df01d6b7c1e45b9155bf52764559657d41326e51902d1d96c/PyYAML-6.0b1-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'e569da731cc3075cef20f5ad4eda9ddff50db779d2119a93804cbf5794363673',
    'md5': '7aa8e66627335130788b7ab8d149f0f0',
    'sha256': 'a978f8308deff49581479be11e7455af9b3d368dd3c3cb5c22b32c691b12b172'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'has_sig': False,
   'md5_digest': '7aa8e66627335130788b7ab8d149f0f0',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 681780,
   'upload_time': '2021-10-04T19:44:13',
   'upload_time_iso_8601': '2021-10-04T19:44:13.240881Z',
   'url': 'https://files.pythonhosted.org/packages/e5/69/da731cc3075cef20f5ad4eda9ddff50db779d2119a93804cbf5794363673/PyYAML-6.0b1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '9a5faf5d9444ed29425816f9f3e7abc0ec6f3130be69fecaa8a09e133cd67030',
    'md5': '831bfc4eba6aa5ca0dc9a78a6c694a5e',
    'sha256': '0044ec607d28033fc79d9900748eafdd62e9a79d3882858e8c0c001f30e9c79a'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-win32.whl',
   'has_sig': False,
   'md5_digest': '831bfc4eba6aa5ca0dc9a78a6c694a5e',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 138149,
   'upload_time': '2021-10-04T19:44:15',
   'upload_time_iso_8601': '2021-10-04T19:44:15.305496Z',
   'url': 'https://files.pythonhosted.org/packages/9a/5f/af5d9444ed29425816f9f3e7abc0ec6f3130be69fecaa8a09e133cd67030/PyYAML-6.0b1-cp310-cp310-win32.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '1690acfd7b4d020fae6742cc67685204410b60d44645397fcf7ec4986d03bb03',
    'md5': 'b088472733f8e6c353aaed7f87f19b12',
    'sha256': 'b811ca77229f55eab2d9b3c6abc6d44c9be3f04461f04ab87f523d778c55c782'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp310-cp310-win_amd64.whl',
   'has_sig': False,
   'md5_digest': 'b088472733f8e6c353aaed7f87f19b12',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp310',
   'requires_python': '>=3.6',
   'size': 151676,
   'upload_time': '2021-10-04T19:44:16',
   'upload_time_iso_8601': '2021-10-04T19:44:16.804281Z',
   'url': 'https://files.pythonhosted.org/packages/16/90/acfd7b4d020fae6742cc67685204410b60d44645397fcf7ec4986d03bb03/PyYAML-6.0b1-cp310-cp310-win_amd64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '83c93d6a4d1445b90c07cc98217bf54ea5cab21977f0c479c8800a1976e51570',
    'md5': 'c709f0b5319f54ce3b696ec173d2abb9',
    'sha256': '0b2167570ea8e96a2710efaae860d71cc3f80e35fe07a915093c596170f024bf'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp36-cp36m-macosx_10_9_x86_64.whl',
   'has_sig': False,
   'md5_digest': 'c709f0b5319f54ce3b696ec173d2abb9',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp36',
   'requires_python': '>=3.6',
   'size': 189365,
   'upload_time': '2021-10-04T19:44:18',
   'upload_time_iso_8601': '2021-10-04T19:44:18.400882Z',
   'url': 'https://files.pythonhosted.org/packages/83/c9/3d6a4d1445b90c07cc98217bf54ea5cab21977f0c479c8800a1976e51570/PyYAML-6.0b1-cp36-cp36m-macosx_10_9_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '6ea0359e075ebc2135cc972f099cca82159f545180f78b2c8f31846d9b603924',
    'md5': '09dba4bba3f135ca3fc344304b9b4f77',
    'sha256': '26fdf07f0d7442fe4cc637aadeb08e9e6dc853f9a4d99a3d813bd23dc6e1cc52'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp36-cp36m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'has_sig': False,
   'md5_digest': '09dba4bba3f135ca3fc344304b9b4f77',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp36',
   'requires_python': '>=3.6',
   'size': 668292,
   'upload_time': '2021-10-04T19:44:19',
   'upload_time_iso_8601': '2021-10-04T19:44:19.992888Z',
   'url': 'https://files.pythonhosted.org/packages/6e/a0/359e075ebc2135cc972f099cca82159f545180f78b2c8f31846d9b603924/PyYAML-6.0b1-cp36-cp36m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'b130b1315a228db3e14f6b902ca4cf4b38eaedf9f07f983e6258ce259ada09e6',
    'md5': '94a635237ce3cbff4d710e973307f191',
    'sha256': 'e47100ec1e464ff8a43e4c96758fd9cd66d202986d93de0f2962c1a7cb851391'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp36-cp36m-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'has_sig': False,
   'md5_digest': '94a635237ce3cbff4d710e973307f191',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp36',
   'requires_python': '>=3.6',
   'size': 695039,
   'upload_time': '2021-10-04T19:44:22',
   'upload_time_iso_8601': '2021-10-04T19:44:22.297008Z',
   'url': 'https://files.pythonhosted.org/packages/b1/30/b1315a228db3e14f6b902ca4cf4b38eaedf9f07f983e6258ce259ada09e6/PyYAML-6.0b1-cp36-cp36m-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '9cde139d5599ab806a6e8422f69fb68e1bc351d29acb28dcebcb2290e130c1d3',
    'md5': '78ce53f26590e89bff6e5982172e4c2c',
    'sha256': '267bf63c911ab6302341e37329f049ddfcab4aea26c8895da1e6a5bcdf1bcc37'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp36-cp36m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'has_sig': False,
   'md5_digest': '78ce53f26590e89bff6e5982172e4c2c',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp36',
   'requires_python': '>=3.6',
   'size': 603604,
   'upload_time': '2021-10-04T19:44:23',
   'upload_time_iso_8601': '2021-10-04T19:44:23.844881Z',
   'url': 'https://files.pythonhosted.org/packages/9c/de/139d5599ab806a6e8422f69fb68e1bc351d29acb28dcebcb2290e130c1d3/PyYAML-6.0b1-cp36-cp36m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'd470c51986f3d97c7c41c99f9975a611917054c5af2a5b7111af92a71fec374a',
    'md5': '72129890c61c58794d1f25ea77340541',
    'sha256': '171533a79a71520ccdf08136012ea0c8fe7f152cda69168dc38ea34da67c9f80'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp36-cp36m-win32.whl',
   'has_sig': False,
   'md5_digest': '72129890c61c58794d1f25ea77340541',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp36',
   'requires_python': '>=3.6',
   'size': 138599,
   'upload_time': '2021-10-04T19:44:26',
   'upload_time_iso_8601': '2021-10-04T19:44:26.044881Z',
   'url': 'https://files.pythonhosted.org/packages/d4/70/c51986f3d97c7c41c99f9975a611917054c5af2a5b7111af92a71fec374a/PyYAML-6.0b1-cp36-cp36m-win32.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '845cc2c828007dea939a376cf160d84105578f24225e7990920c6c656c603181',
    'md5': 'eec47234ef05d0c397e5fe210d75d80c',
    'sha256': 'ebf35bb455f33c1ff3a61031a68f930bd69e88ee3a0882d3d5e677b823785d1e'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp36-cp36m-win_amd64.whl',
   'has_sig': False,
   'md5_digest': 'eec47234ef05d0c397e5fe210d75d80c',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp36',
   'requires_python': '>=3.6',
   'size': 153080,
   'upload_time': '2021-10-04T19:44:28',
   'upload_time_iso_8601': '2021-10-04T19:44:28.013247Z',
   'url': 'https://files.pythonhosted.org/packages/84/5c/c2c828007dea939a376cf160d84105578f24225e7990920c6c656c603181/PyYAML-6.0b1-cp36-cp36m-win_amd64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'fd41d65030b94463666dc8915117240cfad0826a6b83e084d0fc39adf5eb7a4d',
    'md5': '178038bd981c3c36b807ece38c61a63c',
    'sha256': 'e35aff01f870f898f4e4b5360a3f18c98f9c47edab1c2d6bdfa5c876bf74ab73'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp37-cp37m-macosx_10_9_x86_64.whl',
   'has_sig': False,
   'md5_digest': '178038bd981c3c36b807ece38c61a63c',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp37',
   'requires_python': '>=3.6',
   'size': 189330,
   'upload_time': '2021-10-04T19:44:29',
   'upload_time_iso_8601': '2021-10-04T19:44:29.475716Z',
   'url': 'https://files.pythonhosted.org/packages/fd/41/d65030b94463666dc8915117240cfad0826a6b83e084d0fc39adf5eb7a4d/PyYAML-6.0b1-cp37-cp37m-macosx_10_9_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'b3c9cfd2eb2f4675779e585b66be92f371c1a4097febf56da7014619308b8e67',
    'md5': 'fb6ebdb3acad5cf2839277235c00beb5',
    'sha256': 'e628d48defb4a7eacb2087d42f9a7576324279c9b769625941ba39d78c441e29'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'has_sig': False,
   'md5_digest': 'fb6ebdb3acad5cf2839277235c00beb5',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp37',
   'requires_python': '>=3.6',
   'size': 656566,
   'upload_time': '2021-10-04T19:44:31',
   'upload_time_iso_8601': '2021-10-04T19:44:31.298747Z',
   'url': 'https://files.pythonhosted.org/packages/b3/c9/cfd2eb2f4675779e585b66be92f371c1a4097febf56da7014619308b8e67/PyYAML-6.0b1-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '01636800f011f3e049dd4d4ded27b272170a0743be1c076737a029adcc092b47',
    'md5': 'bd9d24bb9845884f92d7695458d71b65',
    'sha256': '1114a62d443cb157ac36beb79fc323d830f4a0586ffd1da8319d72fbf4514d6c'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp37-cp37m-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'has_sig': False,
   'md5_digest': 'bd9d24bb9845884f92d7695458d71b65',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp37',
   'requires_python': '>=3.6',
   'size': 681420,
   'upload_time': '2021-10-04T19:44:32',
   'upload_time_iso_8601': '2021-10-04T19:44:32.948881Z',
   'url': 'https://files.pythonhosted.org/packages/01/63/6800f011f3e049dd4d4ded27b272170a0743be1c076737a029adcc092b47/PyYAML-6.0b1-cp37-cp37m-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'd4c0b24f6280fd1aa5b762892a3653f83b55655436463b6d6550741e0050f822',
    'md5': 'ca22bfa1cf58f3b3e011a31dd3e81c83',
    'sha256': '2ea9326fba939d5e87a1890c27a7aaf5a75e49cfe2c1696bc4fbb25305ca2767'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'has_sig': False,
   'md5_digest': 'ca22bfa1cf58f3b3e011a31dd3e81c83',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp37',
   'requires_python': '>=3.6',
   'size': 595908,
   'upload_time': '2021-10-04T19:44:34',
   'upload_time_iso_8601': '2021-10-04T19:44:34.760882Z',
   'url': 'https://files.pythonhosted.org/packages/d4/c0/b24f6280fd1aa5b762892a3653f83b55655436463b6d6550741e0050f822/PyYAML-6.0b1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '3e68b7af259bd7f0b797649abd1e21a65c1c5ff21bca0e11c908d3c3907b0a1c',
    'md5': 'b58830df231c8bd79f4f3b4c156c4489',
    'sha256': '437e3796f5dd7f2ad8f70084f7fe82472b11483aa1c53c073ab430974bdf1b6d'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp37-cp37m-win32.whl',
   'has_sig': False,
   'md5_digest': 'b58830df231c8bd79f4f3b4c156c4489',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp37',
   'requires_python': '>=3.6',
   'size': 138658,
   'upload_time': '2021-10-04T19:44:36',
   'upload_time_iso_8601': '2021-10-04T19:44:36.692927Z',
   'url': 'https://files.pythonhosted.org/packages/3e/68/b7af259bd7f0b797649abd1e21a65c1c5ff21bca0e11c908d3c3907b0a1c/PyYAML-6.0b1-cp37-cp37m-win32.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '07d7db6a4f57d158904bf7cff0f1428a9182ad5c45bcd3fe635250db3ed9ace6',
    'md5': '854bf275318cea18dcac4240e061d0cd',
    'sha256': '33d6ec1e993c063d4fb4009f439a3d81773ca81cc4109f701eb7a4782d171495'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp37-cp37m-win_amd64.whl',
   'has_sig': False,
   'md5_digest': '854bf275318cea18dcac4240e061d0cd',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp37',
   'requires_python': '>=3.6',
   'size': 153181,
   'upload_time': '2021-10-04T19:44:38',
   'upload_time_iso_8601': '2021-10-04T19:44:38.344884Z',
   'url': 'https://files.pythonhosted.org/packages/07/d7/db6a4f57d158904bf7cff0f1428a9182ad5c45bcd3fe635250db3ed9ace6/PyYAML-6.0b1-cp37-cp37m-win_amd64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'ac1077a80fc33c03a045672b69008262e6b8de1f53ee2e64994ca627c79cfce2',
    'md5': '065b88786988c97ed215b95da16dd940',
    'sha256': '839f695fedfb65dbca690ce57907e076d355ee7c34b857c13926e251d1381ce7'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp38-cp38-macosx_10_9_x86_64.whl',
   'has_sig': False,
   'md5_digest': '065b88786988c97ed215b95da16dd940',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp38',
   'requires_python': '>=3.6',
   'size': 192191,
   'upload_time': '2021-10-04T19:44:39',
   'upload_time_iso_8601': '2021-10-04T19:44:39.924882Z',
   'url': 'https://files.pythonhosted.org/packages/ac/10/77a80fc33c03a045672b69008262e6b8de1f53ee2e64994ca627c79cfce2/PyYAML-6.0b1-cp38-cp38-macosx_10_9_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '40cce6f38b6b12e3465007e2f70870bb1d7c7224f25e86ed1a48af3c6ad2f924',
    'md5': 'e97c5f2b6f7aedca284fc6923d980f83',
    'sha256': '4983bee1be18c3faed20c8eead1c543c1356a2b468984c1385b523e23d3ab0ed'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'has_sig': False,
   'md5_digest': 'e97c5f2b6f7aedca284fc6923d980f83',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp38',
   'requires_python': '>=3.6',
   'size': 721350,
   'upload_time': '2021-10-04T19:44:41',
   'upload_time_iso_8601': '2021-10-04T19:44:41.554925Z',
   'url': 'https://files.pythonhosted.org/packages/40/cc/e6f38b6b12e3465007e2f70870bb1d7c7224f25e86ed1a48af3c6ad2f924/PyYAML-6.0b1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '2c8e74a78571fb13b0ef280c195f8999dd853decc119af6223d9f9ad3f5a739d',
    'md5': 'cfa5ebd5e14b529aee7b71c0f1cb9a42',
    'sha256': '1fffde5b126e4433829530b621a209c07a4c2a808b03e5b808419745b3509c79'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'has_sig': False,
   'md5_digest': 'cfa5ebd5e14b529aee7b71c0f1cb9a42',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp38',
   'requires_python': '>=3.6',
   'size': 749862,
   'upload_time': '2021-10-04T19:44:42',
   'upload_time_iso_8601': '2021-10-04T19:44:42.910564Z',
   'url': 'https://files.pythonhosted.org/packages/2c/8e/74a78571fb13b0ef280c195f8999dd853decc119af6223d9f9ad3f5a739d/PyYAML-6.0b1-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '5d1f8b31ee553735fdb3093341f9d64ffee9b7371db56c63cef5c45c1013c97a',
    'md5': '3b50dd228daa130e689ff02ef362060d',
    'sha256': 'da51ac8b4d42f9197cad065d6c3e2815eb768eac1d7fc0f9c343db280b1b9edc'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'has_sig': False,
   'md5_digest': '3b50dd228daa130e689ff02ef362060d',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp38',
   'requires_python': '>=3.6',
   'size': 700876,
   'upload_time': '2021-10-04T19:44:44',
   'upload_time_iso_8601': '2021-10-04T19:44:44.500970Z',
   'url': 'https://files.pythonhosted.org/packages/5d/1f/8b31ee553735fdb3093341f9d64ffee9b7371db56c63cef5c45c1013c97a/PyYAML-6.0b1-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '019971fa5f61a70d8488045a3fa7d9e62e49d39f39a944bebdfeb34e6dad3c1c',
    'md5': '13a1fdd787878f167a0b8e9ae9ed7d7b',
    'sha256': '68877239810a357a100157233314784ab332ee33bc978de030d0135553db69e2'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp38-cp38-win32.whl',
   'has_sig': False,
   'md5_digest': '13a1fdd787878f167a0b8e9ae9ed7d7b',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp38',
   'requires_python': '>=3.6',
   'size': 140465,
   'upload_time': '2021-10-04T19:44:46',
   'upload_time_iso_8601': '2021-10-04T19:44:46.874048Z',
   'url': 'https://files.pythonhosted.org/packages/01/99/71fa5f61a70d8488045a3fa7d9e62e49d39f39a944bebdfeb34e6dad3c1c/PyYAML-6.0b1-cp38-cp38-win32.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '801cb38f2f934b729a4cd39292502edaea0cbc0646e50e87cc9f0f2749b5dbbf',
    'md5': '078d0d68c6fb44286d394bd82ff16d18',
    'sha256': '09317957e01b6b4da6f9ea96f9e661225662212acee57fcb201775a82196523e'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp38-cp38-win_amd64.whl',
   'has_sig': False,
   'md5_digest': '078d0d68c6fb44286d394bd82ff16d18',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp38',
   'requires_python': '>=3.6',
   'size': 155451,
   'upload_time': '2021-10-04T19:44:48',
   'upload_time_iso_8601': '2021-10-04T19:44:48.628884Z',
   'url': 'https://files.pythonhosted.org/packages/80/1c/b38f2f934b729a4cd39292502edaea0cbc0646e50e87cc9f0f2749b5dbbf/PyYAML-6.0b1-cp38-cp38-win_amd64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '4e2b19601b2f33a28568a7ba6e770846faf040c0e13efd9ba75bfcf9573c718b',
    'md5': '9e33f931b33fd15b4b930406d04887a9',
    'sha256': 'dfeba8c78b9db00667b94cddb1db6559e068cb7f469e681a4e9aa74dc3e86b24'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-macosx_10_9_x86_64.whl',
   'has_sig': False,
   'md5_digest': '9e33f931b33fd15b4b930406d04887a9',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 197609,
   'upload_time': '2021-10-04T19:44:50',
   'upload_time_iso_8601': '2021-10-04T19:44:50.092892Z',
   'url': 'https://files.pythonhosted.org/packages/4e/2b/19601b2f33a28568a7ba6e770846faf040c0e13efd9ba75bfcf9573c718b/PyYAML-6.0b1-cp39-cp39-macosx_10_9_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '97a0c62b90a03a27e49bb4d94626aa92f0fe3c91f2f248cf54f9acd9ff942d5e',
    'md5': '384a12e43b9a443f4efbe508ff6efa85',
    'sha256': '639787884913ee65a617fd826abb6d8b0c4896d533d0caae05b031d7b4089faf'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-macosx_11_0_arm64.whl',
   'has_sig': False,
   'md5_digest': '384a12e43b9a443f4efbe508ff6efa85',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 173986,
   'upload_time': '2021-10-04T19:44:51',
   'upload_time_iso_8601': '2021-10-04T19:44:51.608476Z',
   'url': 'https://files.pythonhosted.org/packages/97/a0/c62b90a03a27e49bb4d94626aa92f0fe3c91f2f248cf54f9acd9ff942d5e/PyYAML-6.0b1-cp39-cp39-macosx_11_0_arm64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '865e859766a6bfa71b8b136e8db9cf0a5275693f45c0159e22420df62df26dc6',
    'md5': '45b4fe6e39f3e2c8be4f3db84c29dc7d',
    'sha256': '9175c938a11a371421e2221faf1ae9d32e86462953917854d70afd2048bb7495'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'has_sig': False,
   'md5_digest': '45b4fe6e39f3e2c8be4f3db84c29dc7d',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 730737,
   'upload_time': '2021-10-04T19:44:53',
   'upload_time_iso_8601': '2021-10-04T19:44:53.253050Z',
   'url': 'https://files.pythonhosted.org/packages/86/5e/859766a6bfa71b8b136e8db9cf0a5275693f45c0159e22420df62df26dc6/PyYAML-6.0b1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '9803516798acfaf41152f090d1a9da3d0651eba1d112e90bebc068b39911de2b',
    'md5': '965637e3e06241db116977d19f4be0a0',
    'sha256': '499b0b45b68671df4b47b185a5a664d6e3871c93956c6f70bf04de5344c6ef02'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'has_sig': False,
   'md5_digest': '965637e3e06241db116977d19f4be0a0',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 755556,
   'upload_time': '2021-10-04T19:44:54',
   'upload_time_iso_8601': '2021-10-04T19:44:54.968881Z',
   'url': 'https://files.pythonhosted.org/packages/98/03/516798acfaf41152f090d1a9da3d0651eba1d112e90bebc068b39911de2b/PyYAML-6.0b1-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '223cece36832e11b81d56437c4127c8dd8585aebdb1598a0bc4f534ef53c9517',
    'md5': '2932e6b8018c580d5e0cf52c73017ab4',
    'sha256': '0495b956bd45025c5d13ae8af0ea238923e88f2d98efd7484ec99dac46291d22'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'has_sig': False,
   'md5_digest': '2932e6b8018c580d5e0cf52c73017ab4',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 661445,
   'upload_time': '2021-10-04T19:44:56',
   'upload_time_iso_8601': '2021-10-04T19:44:56.598223Z',
   'url': 'https://files.pythonhosted.org/packages/22/3c/ece36832e11b81d56437c4127c8dd8585aebdb1598a0bc4f534ef53c9517/PyYAML-6.0b1-cp39-cp39-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': '6fbb272aa5a514ce1a8ad46df6ce5df1c0f1aad00f11d828a472ae82a51830e7',
    'md5': '7b6e7a97a4a4a95b9762461fac5a2aaf',
    'sha256': '56e213cbb463f43f354a9d0a455b68128599df9a8aed0f7ac8e7b7fbbc219bee'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-win32.whl',
   'has_sig': False,
   'md5_digest': '7b6e7a97a4a4a95b9762461fac5a2aaf',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 138064,
   'upload_time': '2021-10-04T19:44:58',
   'upload_time_iso_8601': '2021-10-04T19:44:58.030467Z',
   'url': 'https://files.pythonhosted.org/packages/6f/bb/272aa5a514ce1a8ad46df6ce5df1c0f1aad00f11d828a472ae82a51830e7/PyYAML-6.0b1-cp39-cp39-win32.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'd95b2fa808c25fd1973657885c0f5043d714ef8236f4147c2ddb1198be53dad6',
    'md5': 'f94c732b4183ed908c70ee20d06aad4e',
    'sha256': 'fb03b63e01fd848abb4219b2c2103a1962358c8f4db5150f7a5c1136d3e24d2e'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1-cp39-cp39-win_amd64.whl',
   'has_sig': False,
   'md5_digest': 'f94c732b4183ed908c70ee20d06aad4e',
   'packagetype': 'bdist_wheel',
   'python_version': 'cp39',
   'requires_python': '>=3.6',
   'size': 151672,
   'upload_time': '2021-10-04T19:44:59',
   'upload_time_iso_8601': '2021-10-04T19:44:59.452191Z',
   'url': 'https://files.pythonhosted.org/packages/d9/5b/2fa808c25fd1973657885c0f5043d714ef8236f4147c2ddb1198be53dad6/PyYAML-6.0b1-cp39-cp39-win_amd64.whl',
   'yanked': False,
   'yanked_reason': None},
  {'comment_text': '',
   'digests': {'blake2b_256': 'ac2bf872e3b78e6b2471c00e559bef89a89715888538dd3fa87528afa669ae08',
    'md5': '08a020193f8320d58aad3f7ab00187d0',
    'sha256': '40f637ea3333c0969c3f4127393a5f908f40f7e85605f9e6f568cff2c66849ef'},
   'downloads': -1,
   'filename': 'PyYAML-6.0b1.tar.gz',
   'has_sig': False,
   'md5_digest': '08a020193f8320d58aad3f7ab00187d0',
   'packagetype': 'sdist',
   'python_version': 'source',
   'requires_python': '>=3.6',
   'size': 125073,
   'upload_time': '2021-10-04T19:45:01',
   'upload_time_iso_8601': '2021-10-04T19:45:01.020896Z',
   'url': 'https://files.pythonhosted.org/packages/ac/2b/f872e3b78e6b2471c00e559bef89a89715888538dd3fa87528afa669ae08/PyYAML-6.0b1.tar.gz',
   'yanked': False,
   'yanked_reason': None}])

def test_find_download_url():
    """Check if function works with stored pyyaml json data from PYPI"""            
   
    correct_url ='https://files.pythonhosted.org/packages/ac/2b/f872e3b78e6b2471c00e559bef89a89715888538dd3fa87528afa669ae08/PyYAML-6.0b1.tar.gz'
    found_url = find_download_url(test_data,'source')    
    assert  found_url == correct_url

def test_url_extension():
    url = find_download_url(test_data,'source') 
    assert url.endswith(".tar.gz")



def test_get_pypi_download_info_codeaudit(monkeypatch):
    # --- Mock responses for dependencies ---

    # Mock PyPI JSON API result structure
    mock_pypi_response = {
        "releases": {
            "1.0.0": [
                {"packagetype": "bdist_wheel", "url": "https://files.../codeaudit-1.0.0.whl"},
                {"packagetype": "sdist", "url": "https://files.../codeaudit-1.0.0.tar.gz"}
            ]
        }
    }

    # Mock get_pypi_package_info(package_name)
    def mock_get_pypi_package_info(package_name):
        if package_name == "codeaudit":
            return mock_pypi_response
        return None

    # Mock find_download_url(tuple, "source")
    def mock_find_download_url(last_item, source):
        # Return the expected .tar.gz URL
        return "https://files.pythonhosted.org/packages/.../codeaudit-1.0.0.tar.gz"

    # Apply mocks
    monkeypatch.setattr(
        "codeaudit.pypi_package_scan.get_pypi_package_info",
        mock_get_pypi_package_info
    )
    monkeypatch.setattr(
        "codeaudit.pypi_package_scan.find_download_url",
        mock_find_download_url
    )

    # --- Run the function ---
    result = get_pypi_download_info("codeaudit")

    # --- Assertions ---
    assert result is not False
    assert "download_url" in result
    assert result["download_url"].endswith(".tar.gz")
    assert result["release"] == "1.0.0"
