"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4496],{5216:(e,t,l)=>{l.d(t,{Ay:()=>u,v6:()=>n});let a=(0,l(58976).Z0)({name:"derivedColumns",initialState:{columns:[],initialized:!1},reducers:{initializeDerivedColumns:(e,t)=>{e.initialized||(e.columns=[],e.initialized=!0)},addDerivedColumn:(e,t)=>{let l=e.columns.findIndex(e=>e.name===t.payload.name);-1!==l?e.columns[l]=t.payload:e.columns.push(t.payload)},removeDerivedColumn:(e,t)=>{e.columns=e.columns.filter(e=>e.name!==t.payload)},reset:e=>{e.columns=[],e.initialized=!1}}}),{initializeDerivedColumns:n,addDerivedColumn:r,removeDerivedColumn:o,reset:i}=a.actions,u=a.reducer},7043:(e,t,l)=>{l.d(t,{DA:()=>i,O4:()=>o,p6:()=>r});var a=l(53663);function n(e){let t=e.trim();if(!t.toUpperCase().startsWith("STRUCT"))throw Error("Invalid struct type: must start with STRUCT");let l=t.match(/^STRUCT\s*\((.+)\)$/i);if(!l)throw Error("Invalid struct format: missing or malformed parentheses");return function(e){let t=[],l=0;for(;l<e.length;){let r=function(e,t){let l=t;for(;l<e.length&&/\s/.test(e[l]);)l++;if(l>=e.length)return null;let r="";if('"'===e[l]){for(l++;l<e.length&&'"'!==e[l];)r+=e[l],l++;l<e.length&&l++}else for(;l<e.length&&!/[\s,()]/.test(e[l]);)r+=e[l],l++;for(;l<e.length&&/\s/.test(e[l]);)l++;let o=function(e,t){let l=t;for(;l<e.length&&/\s/.test(e[l]);)l++;if(l>=e.length)return null;if(e.substring(l).toUpperCase().startsWith("STRUCT")){let t=l;for(l+=6;l<e.length&&/\s/.test(e[l]);)l++;if(l>=e.length||"("!==e[l])throw Error("Expected opening parenthesis after STRUCT");let a=0,r=l;for(;r<e.length&&("("===e[r]?a++:")"===e[r]&&a--,r++,0!==a););let o=e.substring(t,r),i=n(o);return{type:o,nextPos:r,children:i}}{let t="",a=0;for(;l<e.length;){let n=e[l];if("("===n)a++,t+=n;else if(")"===n){if(a--,t+=n,0===a){l++;break}}else if(0===a&&/[,)]/.test(n))break;else t+=n;l++}return{type:t.trim(),nextPos:l}}}(e,l);if(!o)throw Error("Failed to parse field type for field: ".concat(r));return{field:{name:r,type:o.type,isPrimitive:function(e){let t=e.trim().toUpperCase();return!/(STRUCT|LIST|MAP|ARRAY)\s*\(/i.test(t)&&(0,a.TR)(t).isPrimitive}(o.type),children:o.children},nextPos:o.nextPos}}(e,l);if(r)for(t.push(r.field),l=r.nextPos;l<e.length&&/[,\s]/.test(e[l]);)l++;else break}return t}(l[1])}function r(e,t){if(/\s/.test(e))return[];try{let l=n(t);return function e(t,l){let a=[];for(let r of l){var n;if(n=r.name,/\s/.test(n))continue;let l="".concat(t,".").concat(r.name);r.isPrimitive?a.push({column_name:l,duckdbType:r.type}):r.children&&a.push(...e(l,r.children))}return a}(e,l)}catch(e){return console.error(e),[]}}function o(e){let t=e.trim().toUpperCase();return t.startsWith("STRUCT")&&!t.endsWith("[]")}function i(e){if(!o(e))return!1;try{let t=n(e);if(2!==t.length)return!1;let l=t.find(e=>"bytes"===e.name.toLowerCase());if(!l||"BLOB"!==l.type.toUpperCase())return!1;let a=t.find(e=>"path"===e.name.toLowerCase());if(!a||!a.type.toUpperCase().startsWith("VARCHAR"))return!1;return!0}catch(e){return!1}}},14282:(e,t,l)=>{l.d(t,{R:()=>a});var a=function(e){return e.NONE="none",e.ENUM="myEnum",e.RANGE="myRange",e.TEXT="myText",e}({})},16023:(e,t,l)=>{l.d(t,{gU:()=>u,m4:()=>o,rn:()=>s,w4:()=>i});var a=l(46336),n=l.n(a),r=l(62252);let o="./api",i="https://cdn.smoosense.ai";function u(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("iframe+http://")||e.startsWith("iframe+https://")||e.startsWith("s3://")||e.startsWith("ftp://")||e.startsWith("file://")||e.startsWith("./")||e.startsWith("~/")||e.startsWith("/")}function s(e,t){if(!n().isArray(e)||0===e.length)return!1;let l=e.filter(e=>"string"==typeof e&&""!==e.trim());return l.length>0&&l.every(e=>(function(e,t){if(!u(e))return!1;let l=e.split("/"),a=l[l.length-1].split("?")[0];return(0,r.t)(a)===t})(e,t))}},18607:(e,t,l)=>{function a(e){return"string"==typeof e&&e.includes("://")}function n(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];if(0===t.length)return"";let a=t.filter(e=>e&&"string"==typeof e&&""!==e.trim());if(0===a.length)return"";if(1===a.length)return a[0];let n=a[0];for(let e=1;e<a.length;e++){let t=a[e];n.endsWith("/")||t.startsWith("/")?n.endsWith("/")&&t.startsWith("/")&&(n=n.slice(0,-1)):n+="/",n+=t}return n}function r(e){if(!e||"string"!=typeof e)return"";if("/"===e||"~"===e)return e;if(a(e)){let t=e.replace(/\/+$/,""),l=t.indexOf("://")+3;if(!t.substring(l).includes("/"))return e;let a=t.lastIndexOf("/");return -1===a?"":t.substring(a+1)}{let t=e.replace(/\\/g,"/").replace(/\/+$/,""),l=t.lastIndexOf("/");return -1===l?t:t.substring(l+1)}}function o(e){if(!e||"string"!=typeof e||"/"===e||"~"===e)return"";if(a(e)){let t=e.replace(/\/+$/,""),l=t.lastIndexOf("/");if(-1===l)return"";let a=t.substring(0,l),n=t.indexOf("://")+3;return t.substring(n).includes("/")?(!a.substring(n).includes("/"),a):""}{let t=e.replace(/\\/g,"/").replace(/\/+$/,""),l=t.lastIndexOf("/");return -1===l?"":0===l?"/":t.substring(0,l)}}function i(e,t){if(!e||!t||"string"!=typeof e||"string"!=typeof t)return"";let l=t.replace(/\/+$/,""),a=e.replace(/\/+$/,"");if(l===a||!a.startsWith(l))return"";let n=a.substring(l.length);return n.startsWith("/")&&(n=n.substring(1)),n}l.d(t,{CN:()=>n,Gl:()=>o,cK:()=>i,uk:()=>r,ww:()=>u});let u=o},20691:(e,t,l)=>{l.d(t,{Ay:()=>m,h5:()=>o,ov:()=>s});var a=l(58976),n=l(59877),r=l(68518);l(28602);let o=(0,a.zD)("colBaseStats/queryBaseColumnStats",async(e,t)=>{let{columnName:l,sqlQuery:a,filterType:r}=e,{dispatch:o,getState:i}=t,u=i(),s=u.ui.queryEngine,d=u.ui.tablePath;if(!s)throw Error("queryEngine is required");if(!d)throw Error("tablePath is required");return(0,n.sb)({columnName:l,dispatch:o,keyPrefix:"colstats",sqlQuery:a,filterType:r,queryEngine:s,tablePath:d})}),i=(0,a.Z0)({name:"colBaseStats",initialState:{},reducers:(0,r.LD)(),extraReducers:e=>{(0,r.i)(e,o,"Failed to query column statistics")}}),{clearStats:u,clearColumnStats:s,clearColumnError:d,setNeedRefresh:c}=i.actions,m=i.reducer},28280:(e,t,l)=>{l.d(t,{Ay:()=>i,ou:()=>n});let a=(0,l(58976).Z0)({name:"sqlHistory",initialState:{executions:{}},reducers:{addExecution:(e,t)=>{e.executions[t.payload.sqlKey]={query:t.payload.query,result:t.payload.result,timestamp:new Date().toISOString()}},clearHistory:e=>{e.executions={}},removeExecution:(e,t)=>{delete e.executions[t.payload]}}}),{addExecution:n,clearHistory:r,removeExecution:o}=a.actions,i=a.reducer},28602:(e,t,l)=>{l.d(t,{G:()=>r});var a=l(46336),n=l.n(a);let r=e=>{var t,l;let{min:a,step:r,round_to:o,cntValues:i}=e,u=null!=(l=null==(t=n().maxBy(i,"binIdx"))?void 0:t.binIdx)?l:0,s=n().fromPairs(n().map(i,e=>[e.binIdx,e]));return n().range(u+1).map(e=>{var t;let l=n().round(e*r+a,o),i=n().round(l+r,o),u="[".concat(l,", ").concat(i,")");return{...s[e]||{},binIdx:e,value:u,binMin:l,binMax:i,cnt:(null==(t=s[e])?void 0:t.cnt)||0}})}},32446:(e,t,l)=>{l.d(t,{$w:()=>i,Ay:()=>f,SV:()=>u,Vz:()=>c,Zj:()=>o,aN:()=>d,lR:()=>m,rp:()=>n,ss:()=>s});let a=(0,l(58976).Z0)({name:"viewing",initialState:{pageSize:10,pageNumber:1,totalRows:null,justClickedRowId:null,samplingCondition:null},reducers:{setPageSize:(e,t)=>{e.pageSize=t.payload,e.pageNumber=1},setPageNumber:(e,t)=>{e.pageNumber=t.payload},nextPage:e=>{e.totalRows&&e.pageNumber*e.pageSize<e.totalRows&&(e.pageNumber+=1)},previousPage:e=>{e.pageNumber>1&&(e.pageNumber-=1)},firstPage:e=>{e.pageNumber=1},lastPage:e=>{e.totalRows&&(e.pageNumber=Math.ceil(e.totalRows/e.pageSize))},setTotalRows:(e,t)=>{e.totalRows=t.payload},setJustClickedRowId:(e,t)=>{e.justClickedRowId=t.payload},setSamplingCondition:(e,t)=>{e.samplingCondition=t.payload},resetViewing:e=>{e.pageSize=10,e.pageNumber=1,e.totalRows=null,e.justClickedRowId=null,e.samplingCondition=null}}}),{setPageSize:n,setPageNumber:r,nextPage:o,previousPage:i,firstPage:u,lastPage:s,setTotalRows:d,setJustClickedRowId:c,setSamplingCondition:m,resetViewing:p}=a.actions,f=a.reducer},37835:(e,t,l)=>{l.d(t,{b:()=>n});var a=l(58976);function n(e){let{name:t,fetchFunction:l,shouldWait:n,onFulfilled:r,errorMessage:o="Failed to fetch ".concat(t)}=e,i=(0,a.zD)("".concat(t,"/fetch").concat(t.charAt(0).toUpperCase()+t.slice(1)),async(e,t)=>{let{dispatch:a,getState:n}=t,o=await l(e,a,n);return r&&o&&r(o,a),o},{condition:(e,l)=>{let{getState:a}=l,r=a()[t];return(!n||!!n(e))&&(!r.data||r.needRefresh)}}),u=(0,a.Z0)({name:t,initialState:{data:null,loading:!1,error:null,needRefresh:!1},reducers:{["clear".concat(t.charAt(0).toUpperCase()+t.slice(1))]:e=>{e.data=null,e.loading=!1,e.error=null,e.needRefresh=!1},["set".concat(t.charAt(0).toUpperCase()+t.slice(1),"Error")]:(e,t)=>{e.error=t.payload,e.loading=!1},setNeedRefresh:(e,t)=>{e.needRefresh=t.payload}},extraReducers:e=>{e.addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,t)=>{e.data=t.payload,e.loading=!1,e.error=null,e.needRefresh=!1}).addCase(i.rejected,(e,t)=>{e.data=null,e.loading=!1,e.error=t.error.message||o,e.needRefresh=!1})}});return{slice:u,fetchThunk:i,actions:u.actions,reducer:u.reducer}}},38710:(e,t,l)=>{l.d(t,{Ay:()=>s,Mv:()=>r});var a=l(58976),n=l(95914);let r=(0,a.zD)("columnMeta/fetchColumnMetadata",async(e,t)=>{let{dispatch:l,getState:a}=t,r=a().ui.queryEngine;return await (0,n.OC)(e,l,r)},{condition:(e,t)=>{let{getState:l}=t;if(!e||""===e.trim())return!1;let a=l().columnMeta;return!a.data&&!a.loading}}),o=(0,a.Z0)({name:"columnMeta",initialState:{data:null,loading:!1,error:null},reducers:{clearColumnMeta:e=>{e.data=null,e.loading=!1,e.error=null},setColumnMetaError:(e,t)=>{e.error=t.payload,e.loading=!1}},extraReducers:e=>{e.addCase(r.pending,e=>{e.loading=!0,e.error=null}).addCase(r.fulfilled,(e,t)=>{e.data=t.payload,e.loading=!1,e.error=null}).addCase(r.rejected,(e,t)=>{e.data=null,e.loading=!1,e.error=t.error.message||"Failed to fetch column metadata"})}}),{clearColumnMeta:i,setColumnMetaError:u}=o.actions,s=o.reducer},49174:(e,t,l)=>{l.d(t,{Ay:()=>c,Bo:()=>i,EL:()=>o,tQ:()=>s});var a=l(58976),n=l(95914),r=l(88453);function o(e){var t,l,a,n,r,o;if("BOOLEAN"===e.duckdbType){let t=null!=(n=null==(a=e.stats)?void 0:a.cntAll)?n:null;return{approxCntD:2,cntD:2,distinctRatio:t?2/t:null,cardinality:"low",source:"from metadata"}}if((null==(t=e.stats)?void 0:t.allNull)===!0)return{approxCntD:0,cntD:0,distinctRatio:0,cardinality:"low",source:"from metadata"};if((null==(l=e.stats)?void 0:l.singleValue)===!0){let t=null!=(o=null==(r=e.stats)?void 0:r.cntAll)?o:null;return{approxCntD:1,cntD:1,distinctRatio:t?1/t:null,cardinality:"low",source:"from metadata"}}return e.typeShortcuts.isPrimitive?null:{approxCntD:null,cntD:null,distinctRatio:null,cardinality:"unknown",source:"from metadata"}}let i=(0,a.zD)("cardinality/queryCardinality",async(e,t)=>{let{columnName:l,tablePath:a}=e,{dispatch:o,getState:i}=t,u=i().ui.queryEngine,s="\n      SELECT\n        approx_count_distinct(".concat((0,r.r)(l),") AS approxCntD,\n        approxCntD / COUNT(*) AS distinctRatio,\n        CASE\n          WHEN approx_count_distinct(").concat((0,r.r)(l),") <= ").concat(1e3," THEN COUNT(DISTINCT ").concat((0,r.r)(l),")\n          ELSE NULL\n        END AS cntD,\n        CASE\n          WHEN approx_count_distinct(").concat((0,r.r)(l),") <= ").concat(1e3," THEN 'low'\n          ELSE 'high'\n        END AS cardinality\n      FROM ").concat("lance"===u?"lance_table":"'".concat(a,"'"),"\n      WHERE ").concat((0,r.r)(l)," IS NOT NULL\n    ").trim(),d=new AbortController;try{let e=setTimeout(()=>{d.abort()},5e3),t=(0,n.bL)("cardinality_".concat(l)),r=await (0,n.eW)(s,t,o,u,a);if(clearTimeout(e),d.signal.aborted)throw Error("Query timeout");if("error"===r.status)throw Error(r.error||"Query failed");if(0===r.rows.length)throw Error("No results returned");let i=r.rows[0],c=i[0],m=i[1],p=i[2],f=i[3];return{columnName:l,cardinality:{approxCntD:c,cntD:p,distinctRatio:m,cardinality:f,source:"from query"}}}catch(e){var c;if((null==(c=d.signal)?void 0:c.aborted)||e instanceof Error&&"Query timeout"===e.message)return{columnName:l,cardinality:{approxCntD:null,cntD:null,distinctRatio:null,cardinality:"high",source:"query timeout"}};throw e}}),u=(0,a.Z0)({name:"cardinality",initialState:{},reducers:{setCardinality:(e,t)=>{let{columnName:l,cardinality:a}=t.payload;e[l]={data:a,loading:!1,error:null}},clearColumnError:(e,t)=>{let l=t.payload;e[l]&&(e[l].error=null)}},extraReducers:e=>{e.addCase(i.pending,(e,t)=>{let l=t.meta.arg.columnName;e[l]||(e[l]={data:null,loading:!1,error:null}),e[l].loading=!0,e[l].error=null}).addCase(i.fulfilled,(e,t)=>{let{columnName:l,cardinality:a}=t.payload;e[l]={data:a,loading:!1,error:null}}).addCase(i.rejected,(e,t)=>{let l=t.meta.arg.columnName;e[l]||(e[l]={data:null,loading:!1,error:null}),e[l]={data:{approxCntD:null,cntD:null,distinctRatio:null,cardinality:"unknown",source:"query error"},loading:!1,error:t.error.message||"Failed to query cardinality"}})}}),{setCardinality:s,clearColumnError:d}=u.actions,c=u.reducer},53663:(e,t,l)=>{l.d(t,{TR:()=>r});let a={INTEGER:["TINYINT","SMALLINT","INTEGER","BIGINT","HUGEINT","UTINYINT","USMALLINT","UINTEGER","UBIGINT"],BOOLEAN:["BOOLEAN"],FLOAT:["FLOAT","DOUBLE","DECIMAL","REAL"],STRING:["VARCHAR","CHAR","STRING","TEXT","BINARY"],DATETIME:["TIMESTAMP","DATE","TIME","TIMESTAMP_NS"]};function n(e){return e?e.toString().toUpperCase().trim().split("(")[0].split(" ")[0]:""}function r(e){let t=e.toString().toUpperCase().trim(),l=t.endsWith("[]"),r=n(e),o=a.INTEGER.includes(r),i=a.FLOAT.includes(r),u=a.STRING.includes(r),s=a.BOOLEAN.includes(r),d=a.DATETIME.includes(r),c=o||i,m=n(l?t.slice(0,-2):t),p=a.INTEGER.includes(m),f=a.FLOAT.includes(m);return{isInteger:o,isFloat:i,isNumeric:c,isBoolean:s,isString:u,isPrimitive:c||s||u||d,agType:c?"number":s?"boolean":d?"dateString":"text",isDatetime:d,isNumericArray:l&&(p||f),isArray:l}}},59877:(e,t,l)=>{l.d(t,{ZX:()=>s,el:()=>u,sb:()=>o,wD:()=>i});var a=l(95914),n=l(14282),r=l(28602);async function o(e){let{columnName:t,dispatch:l,keyPrefix:o,sqlQuery:i,filterType:u,queryEngine:s,tablePath:d}=e,c=new AbortController;try{let e=setTimeout(()=>{c.abort()},15e3),m=(0,a.bL)("".concat(o,"_").concat(t)),p=await (0,a.l4)(i,m,l,s,d);if(clearTimeout(e),c.signal.aborted)throw Error("Query timeout after 15 seconds");if(0===p.length)throw Error("No results returned");let f=function(e,t){let l;if(t===n.R.ENUM){let t=e[0];l={type:n.R.ENUM,...t}}else if(t===n.R.RANGE){let t=(e=>{let t=e[0],{min:l,step:a,round_to:n}=t.bin,o=(0,r.G)({min:l,step:a,round_to:n,cntValues:t.cnt_values});return{...t,cnt_values:o}})(e);l={type:n.R.RANGE,...t}}else{let t={...e[0],cnt_values:[]};l={type:n.R.TEXT,...t}}return l}(p,u);return{columnName:t,stats:f}}catch(e){var m;if((null==(m=c.signal)?void 0:m.aborted)||e instanceof Error&&e.message.includes("timeout"))throw Error("Query timeout after 15 seconds");throw e}}function i(e){return(null==e?void 0:e.type)===n.R.ENUM?e:null}function u(e){return(null==e?void 0:e.type)===n.R.RANGE?e:null}function s(e){return(null==e?void 0:e.type)===n.R.TEXT?e:null}},62252:(e,t,l)=>{l.d(t,{p:()=>a,t:()=>n});var a=function(e){return e.Json="json",e.Yaml="yaml",e.ColumnarTable="columnar-table",e.RowTable="row-table",e.Image="image",e.Video="video",e.Audio="audio",e.Model3D="model-3d",e.Text="text",e.Pdf="pdf",e.Unknown="unknown",e}({});function n(e){let t=e.toLowerCase().split(".").pop()||"";return"gz"===t&&e.toLowerCase().endsWith(".csv.gz")?"row-table":["json"].includes(t)?"json":["yaml","yml"].includes(t)?"yaml":["parquet"].includes(t)?"columnar-table":["jsonl","csv","tsv","xlsx","xls"].includes(t)?"row-table":["jpg","jpeg","png","gif","bmp","svg","webp","tiff","tif","ico","heic","heif"].includes(t)?"image":["mp4","avi","mov","wmv","flv","webm","mkv","m4v","3gp","ogv"].includes(t)?"video":["mp3","wav","ogg","flac","m4a","aac","wma","opus","webm"].includes(t)?"audio":["glb"].includes(t)?"model-3d":["pdf"].includes(t)?"pdf":["txt","md","markdown","rst","log","py","js","jsx","ts","tsx","html","htm","css","scss","sass","less","java","c","cpp","h","hpp","cs","php","rb","go","rs","swift","sh","bash","zsh","fish","ps1","bat","cmd","xml","sql","r","scala","kt","dart","lua","perl","vim","dockerfile","gitignore","gitattributes","editorconfig","toml","ini","cfg","conf","properties"].includes(t)?"text":"unknown"}},62318:(e,t,l)=>{l.d(t,{Ay:()=>p,Eb:()=>u,SR:()=>m,tu:()=>s});var a=l(95914),n=l(37835),r=l(32446);let o=async(e,t)=>{let{query:l,tablePath:n,queryEngine:r}=e;return await (0,a.l4)(l,"rowData",t,r,n)},i=(0,n.b)({name:"rowData",fetchFunction:o,shouldWait:e=>{let{query:t}=e;return!!t&&""!==t.trim()},errorMessage:"Failed to fetch row data"}),u=()=>(e,t)=>{let{samplingCondition:l}=t().viewing;null===l&&e((0,r.lR)("TRUE")),e(m(!0))};i.slice;let s=i.fetchThunk,{clearRowData:d,setRowDataError:c,setNeedRefresh:m}=i.actions,p=i.reducer},67217:(e,t,l)=>{l.d(t,{Ay:()=>f,Zg:()=>i,fl:()=>p,qz:()=>d});var a=l(58976),n=l(59877),r=l(68518),o=l(81876);let i=(0,a.zD)("colFilteredStats/queryFilteredColumnStats",async(e,t)=>{let{columnName:l,sqlQuery:a,filterType:r}=e,{dispatch:o,getState:i}=t,u=i(),s=u.ui.queryEngine,d=u.ui.tablePath;if(!s)throw Error("queryEngine is required");if(!d)throw Error("tablePath is required");return(0,n.sb)({columnName:l,dispatch:o,keyPrefix:"colFilteredStats",sqlQuery:a,filterType:r,queryEngine:s,tablePath:d})}),u=(0,a.Z0)({name:"colFilteredStats",initialState:{},reducers:{...(0,r.LD)(),setFilteredColumnStats:(e,t)=>{let{columnName:l,stats:a}=t.payload;e[l]={data:a,loading:!1,error:null,needRefresh:!1}}},extraReducers:e=>{(0,r.i)(e,i,"Failed to query filtered column statistics"),e.addCase(o.tT,e=>{Object.keys(e).forEach(t=>{delete e[t]})})}}),{clearStats:s,clearColumnStats:d,clearColumnError:c,setNeedRefresh:m,setFilteredColumnStats:p}=u.actions,f=u.reducer},68518:(e,t,l)=>{l.d(t,{LD:()=>n,i:()=>r});let a=()=>({data:null,loading:!1,error:null,needRefresh:!1}),n=()=>({clearStats:()=>({}),clearColumnStats:(e,t)=>{let l=t.payload;delete e[l]},clearColumnError:(e,t)=>{let l=t.payload;e[l]&&(e[l].error=null)},setNeedRefresh:(e,t)=>{let{columnName:l,needRefresh:n}=t.payload;e[l]||(e[l]=a()),e[l].needRefresh=n}}),r=(e,t,l)=>{e.addCase(t.pending,(e,t)=>{let l=t.meta.arg.columnName;e[l]||(e[l]=a()),e[l].loading=!0,e[l].error=null}).addCase(t.fulfilled,(e,t)=>{let{columnName:l,stats:a}=t.payload;e[l]={data:a,loading:!1,error:null,needRefresh:!1}}).addCase(t.rejected,(e,t)=>{var n;let r=t.meta.arg.columnName;e[r]||(e[r]=a());let o=null==(n=t.error.message)?void 0:n.includes("timeout");e[r].loading=!1,e[r].error=o?"timeout":t.error.message||l,e[r].data=null,e[r].needRefresh=!1})}},69984:(e,t,l)=>{l.r(t),l.d(t,{default:()=>$,setActiveEmbTab:()=>s,setActivePlotTab:()=>u,setActiveTab:()=>i,setAutoPlayAllVideos:()=>A,setBaseUrl:()=>y,setBatchUISettings:()=>Y,setBoxPlotBreakdownColumn:()=>j,setBoxPlotColumns:()=>V,setBoxPlotSortBy:()=>X,setBoxPlotSorting:()=>Z,setBubblePlotBreakdownColumn:()=>U,setBubblePlotColorColumn:()=>H,setBubblePlotColorScale:()=>q,setBubblePlotMarkerSizeContrastRatio:()=>z,setBubblePlotMaxMarkerSize:()=>O,setBubblePlotMinMarkerSize:()=>L,setBubblePlotOpacity:()=>F,setBubblePlotXColumn:()=>B,setBubblePlotYColumn:()=>k,setColumnForGalleryCaption:()=>T,setColumnForGalleryVisual:()=>w,setCropMediaToFitCover:()=>P,setDebugMode:()=>o,setEmbColumn:()=>d,setFileInfoToShow:()=>Q,setFontSize:()=>n,setGalleryCaptionHeight:()=>x,setGalleryItemHeight:()=>N,setGalleryItemWidth:()=>R,setGalleryVideoMuted:()=>v,setHeaderPlotHeight:()=>S,setHeatmapXColumn:()=>W,setHeatmapYColumn:()=>G,setHistogramBreakdownColumn:()=>I,setHistogramColumn:()=>_,setHistogramNumberOfBins:()=>M,setQueryEngine:()=>h,setRootFolder:()=>f,setRowHeight:()=>C,setShowRowDetailsPanel:()=>D,setSqlQuery:()=>b,setSqlResult:()=>g,setTableCellSpacing:()=>E,setTablePath:()=>p,setUmapMinDist:()=>m,setUmapNNeighbors:()=>c,toggleDebugMode:()=>r,uiSlice:()=>a});let a=(0,l(58976).Z0)({name:"ui",initialState:{fontSize:14,debugMode:!1,activeTab:"Table",activePlotTab:"BubblePlot",activeEmbTab:"UMAP",embColumn:null,umapNNeighbors:15,umapMinDist:.1,tablePath:null,rootFolder:null,baseUrl:null,queryEngine:"duckdb",sqlQuery:"",sqlResult:null,rowHeight:80,headerPlotHeight:48,tableCellSpacing:4,histogramNumberOfBins:50,columnForGalleryVisual:"",columnForGalleryCaption:"",galleryItemWidth:200,galleryItemHeight:200,galleryCaptionHeight:60,cropMediaToFitCover:!1,galleryVideoMuted:!0,autoPlayAllVideos:!0,showRowDetailsPanel:!0,histogramBreakdownColumn:null,histogramColumn:"",bubblePlotXColumn:"",bubblePlotYColumn:"",bubblePlotBreakdownColumn:null,bubblePlotMaxMarkerSize:20,bubblePlotMinMarkerSize:7,bubblePlotOpacity:.7,bubblePlotMarkerSizeContrastRatio:4.2,bubblePlotColorColumn:"",bubblePlotColorScale:"Jet",heatmapXColumn:null,heatmapYColumn:null,boxPlotBreakdownColumn:null,boxPlotColumns:[],boxPlotSortBy:"avg",boxPlotSorting:[],fileInfoToShow:"size"},reducers:{setFontSize:(e,t)=>{e.fontSize=t.payload},toggleDebugMode:e=>{e.debugMode=!e.debugMode},setDebugMode:(e,t)=>{e.debugMode=t.payload},setActiveTab:(e,t)=>{e.activeTab=t.payload},setActivePlotTab:(e,t)=>{e.activePlotTab=t.payload},setActiveEmbTab:(e,t)=>{e.activeEmbTab=t.payload},setEmbColumn:(e,t)=>{e.embColumn=t.payload},setUmapNNeighbors:(e,t)=>{e.umapNNeighbors=Math.max(2,Math.min(100,t.payload))},setUmapMinDist:(e,t)=>{e.umapMinDist=Math.max(0,Math.min(1,t.payload))},setTablePath:(e,t)=>{e.tablePath=t.payload,t.payload&&t.payload!==e.tablePath&&(e.sqlQuery="SELECT * FROM '".concat(t.payload,"' LIMIT 10"),e.sqlResult=null)},setRootFolder:(e,t)=>{e.rootFolder=t.payload},setBaseUrl:(e,t)=>{e.baseUrl=t.payload},setQueryEngine:(e,t)=>{e.queryEngine=t.payload},setSqlQuery:(e,t)=>{e.sqlQuery=t.payload},setSqlResult:(e,t)=>{e.sqlResult=t.payload},setRowHeight:(e,t)=>{e.rowHeight=t.payload},setTableCellSpacing:(e,t)=>{e.tableCellSpacing=Math.max(1,Math.min(16,t.payload))},setHistogramNumberOfBins:(e,t)=>{e.histogramNumberOfBins=Math.max(5,Math.min(200,t.payload))},setHeaderPlotHeight:(e,t)=>{e.headerPlotHeight=Math.max(24,Math.min(96,t.payload))},setColumnForGalleryVisual:(e,t)=>{e.columnForGalleryVisual=t.payload},setColumnForGalleryCaption:(e,t)=>{e.columnForGalleryCaption=t.payload},setGalleryItemWidth:(e,t)=>{e.galleryItemWidth=Math.max(100,Math.min(600,t.payload))},setGalleryItemHeight:(e,t)=>{e.galleryItemHeight=Math.max(100,Math.min(600,t.payload))},setGalleryCaptionHeight:(e,t)=>{e.galleryCaptionHeight=Math.max(40,Math.min(200,t.payload))},setCropMediaToFitCover:(e,t)=>{e.cropMediaToFitCover=t.payload},setGalleryVideoMuted:(e,t)=>{e.galleryVideoMuted=t.payload},setAutoPlayAllVideos:(e,t)=>{e.autoPlayAllVideos=t.payload},setShowRowDetailsPanel:(e,t)=>{e.showRowDetailsPanel=t.payload},setHistogramBreakdownColumn:(e,t)=>{e.histogramBreakdownColumn=t.payload},setHistogramColumn:(e,t)=>{e.histogramColumn=t.payload},setBubblePlotXColumn:(e,t)=>{e.bubblePlotXColumn=t.payload},setBubblePlotYColumn:(e,t)=>{e.bubblePlotYColumn=t.payload},setBubblePlotBreakdownColumn:(e,t)=>{e.bubblePlotBreakdownColumn=t.payload},setBubblePlotMaxMarkerSize:(e,t)=>{e.bubblePlotMaxMarkerSize=Math.max(5,Math.min(50,t.payload))},setBubblePlotMinMarkerSize:(e,t)=>{e.bubblePlotMinMarkerSize=Math.max(2,Math.min(15,t.payload))},setBubblePlotOpacity:(e,t)=>{e.bubblePlotOpacity=Math.max(.1,Math.min(1,t.payload))},setBubblePlotMarkerSizeContrastRatio:(e,t)=>{e.bubblePlotMarkerSizeContrastRatio=Math.max(-7,Math.min(7,t.payload))},setBubblePlotColorColumn:(e,t)=>{e.bubblePlotColorColumn=t.payload},setBubblePlotColorScale:(e,t)=>{e.bubblePlotColorScale=t.payload},setHeatmapXColumn:(e,t)=>{e.heatmapXColumn=t.payload},setHeatmapYColumn:(e,t)=>{e.heatmapYColumn=t.payload},setBoxPlotBreakdownColumn:(e,t)=>{e.boxPlotBreakdownColumn=t.payload},setBoxPlotColumns:(e,t)=>{e.boxPlotColumns=t.payload},setBoxPlotSortBy:(e,t)=>{e.boxPlotSortBy=t.payload},setBoxPlotSorting:(e,t)=>{e.boxPlotSorting=t.payload},setFileInfoToShow:(e,t)=>{e.fileInfoToShow=t.payload},setBatchUISettings:(e,t)=>{Object.entries(t.payload).forEach(t=>{let[l,a]=t;l in e&&void 0!==a&&("tableCellSpacing"===l&&"number"==typeof a?e.tableCellSpacing=Math.max(1,Math.min(16,a)):"histogramNumberOfBins"===l&&"number"==typeof a?e.histogramNumberOfBins=Math.max(5,Math.min(200,a)):"headerPlotHeight"===l&&"number"==typeof a?e.headerPlotHeight=Math.max(24,Math.min(96,a)):"galleryItemWidth"===l&&"number"==typeof a?e.galleryItemWidth=Math.max(100,Math.min(600,a)):"galleryItemHeight"===l&&"number"==typeof a?e.galleryItemHeight=Math.max(100,Math.min(600,a)):"galleryCaptionHeight"===l&&"number"==typeof a?e.galleryCaptionHeight=Math.max(40,Math.min(200,a)):"bubblePlotMaxMarkerSize"===l&&"number"==typeof a?e.bubblePlotMaxMarkerSize=Math.max(5,Math.min(50,a)):"bubblePlotOpacity"===l&&"number"==typeof a?e.bubblePlotOpacity=Math.max(.1,Math.min(1,a)):"bubblePlotMarkerSizeContrastRatio"===l&&"number"==typeof a?e.bubblePlotMarkerSizeContrastRatio=Math.max(-7,Math.min(7,a)):Object.assign(e,{[l]:a}))})}}}),{setFontSize:n,toggleDebugMode:r,setDebugMode:o,setActiveTab:i,setActivePlotTab:u,setActiveEmbTab:s,setEmbColumn:d,setUmapNNeighbors:c,setUmapMinDist:m,setTablePath:p,setRootFolder:f,setBaseUrl:y,setQueryEngine:h,setSqlQuery:b,setSqlResult:g,setRowHeight:C,setHeaderPlotHeight:S,setTableCellSpacing:E,setHistogramNumberOfBins:M,setColumnForGalleryVisual:w,setColumnForGalleryCaption:T,setGalleryItemWidth:R,setGalleryItemHeight:N,setGalleryCaptionHeight:x,setCropMediaToFitCover:P,setGalleryVideoMuted:v,setAutoPlayAllVideos:A,setShowRowDetailsPanel:D,setHistogramBreakdownColumn:I,setHistogramColumn:_,setBubblePlotXColumn:B,setBubblePlotYColumn:k,setBubblePlotBreakdownColumn:U,setBubblePlotMaxMarkerSize:O,setBubblePlotMinMarkerSize:L,setBubblePlotOpacity:F,setBubblePlotMarkerSizeContrastRatio:z,setBubblePlotColorColumn:H,setBubblePlotColorScale:q,setHeatmapXColumn:W,setHeatmapYColumn:G,setBoxPlotBreakdownColumn:j,setBoxPlotColumns:V,setBoxPlotSortBy:X,setBoxPlotSorting:Z,setFileInfoToShow:Q,setBatchUISettings:Y}=a.actions,$=a.reducer},81876:(e,t,l)=>{l.d(t,{$_:()=>s,As:()=>u,Ay:()=>y,Fh:()=>i,J_:()=>m,O7:()=>d,rr:()=>r,tG:()=>p,tT:()=>c,us:()=>n});let a=(0,l(58976).Z0)({name:"ag",initialState:{columnDefs:null,filters:{},sorting:[],columnDefsInitialized:!1},reducers:{initializeFromColumnMetadata:(e,t)=>{let{columns:l,derivedColumns:a=[]}=t.payload;e.columnDefs=[...l.map(e=>({field:e.column_name,headerName:e.column_name,width:150,pinned:null,hide:!1})),...a.map(e=>({field:e.name,headerName:e.name,width:150,pinned:"left",hide:!1}))],e.columnDefsInitialized=!0},updateColumnDef:(e,t)=>{if(!e.columnDefs)return;let{field:l,updates:a}=t.payload,n=e.columnDefs.findIndex(e=>e.field===l);-1!==n&&(e.columnDefs[n]={...e.columnDefs[n],...a})},updateMultipleColumnDefs:(e,t)=>{e.columnDefs&&t.payload.forEach(t=>{let{field:l,updates:a}=t,n=e.columnDefs.findIndex(e=>e.field===l);-1!==n&&(e.columnDefs[n]={...e.columnDefs[n],...a})})},reorderColumns:(e,t)=>{if(!e.columnDefs)return;let l=t.payload,a=[];l.forEach(t=>{let l=e.columnDefs.find(e=>e.field===t);l&&a.push(l)}),e.columnDefs.forEach(e=>{l.includes(e.field)||a.push(e)}),e.columnDefs=a},updateColumnWidth:(e,t)=>{if(!e.columnDefs)return;let{field:l,width:a}=t.payload,n=e.columnDefs.findIndex(e=>e.field===l);-1!==n&&(e.columnDefs[n].width=a)},toggleColumnVisibility:(e,t)=>{if(!e.columnDefs)return;let l=t.payload,a=e.columnDefs.findIndex(e=>e.field===l);-1!==a&&(e.columnDefs[a].hide=!e.columnDefs[a].hide)},toggleColumnPin:(e,t)=>{if(!e.columnDefs)return;let l=t.payload,a=e.columnDefs.findIndex(e=>e.field===l);if(-1!==a){let t=e.columnDefs[a].pinned;e.columnDefs[a].pinned="left"===t?null:"left"}},setColumnFilter:(e,t)=>{let{columnName:l,filter:a}=t.payload;void 0===a?delete e.filters[l]:e.filters[l]=a},setSorting:(e,t)=>{e.sorting=t.payload},onlyShowColumns:(e,t)=>{if(!e.columnDefs)return;let l=t.payload,a=[];l.forEach(t=>{let l=e.columnDefs.find(e=>e.field===t);l&&a.push({...l,hide:!1})}),e.columnDefs.forEach(e=>{l.includes(e.field)||a.push({...e,hide:!0})}),e.columnDefs=a},reset:e=>{e.columnDefs=null,e.filters={},e.sorting=[],e.columnDefsInitialized=!1}}}),{initializeFromColumnMetadata:n,updateColumnDef:r,updateMultipleColumnDefs:o,reorderColumns:i,updateColumnWidth:u,toggleColumnVisibility:s,toggleColumnPin:d,setColumnFilter:c,setSorting:m,onlyShowColumns:p,reset:f}=a.actions,y=a.reducer},85828:(e,t,l)=>{l.d(t,{Ay:()=>s,_4:()=>o});let a=(0,l(58976).Z0)({name:"renderType",initialState:{},reducers:{setRenderType:(e,t)=>{let{columnName:l,renderType:a}=t.payload;e[l]=a},setRenderTypes:(e,t)=>{Object.assign(e,t.payload)},initializeRenderTypes:(e,t)=>{t.payload.forEach(t=>{let{columnName:l,renderType:a}=t;l in e||(e[l]=a)})},clearRenderType:(e,t)=>{let l=t.payload;delete e[l]},clearAllRenderTypes:()=>({})}}),{setRenderType:n,setRenderTypes:r,initializeRenderTypes:o,clearRenderType:i,clearAllRenderTypes:u}=a.actions,s=a.reducer},88453:(e,t,l)=>{l.d(t,{B:()=>r,r:()=>o});var a=l(66848),n=l.n(a);let r=e=>{if(n()(e))return"NULL";if("string"==typeof e){let t=e.replace(/'/g,"''");return"'".concat(t,"'")}if("number"==typeof e)return"".concat(e);if("boolean"==typeof e)return e?"TRUE":"FALSE";if(Array.isArray(e))return"("+e.map(r).join(",")+")";else throw Error("Unknown value type: ".concat(typeof e))},o=e=>{if(n()(e))return"NULL";if("string"!=typeof e)throw Error("Expecting a string for name, but got ".concat(typeof e,": ").concat(e));{let t=e.trim();if(""===t)throw Error("Empty name");return t.includes(".")?t.split(".").map(o).join("."):'"'.concat(t,'"')}}},89022:(e,t,l)=>{l.d(t,{A:()=>r,V:()=>n});let a=(0,l(58976).Z0)({name:"isCategorical",initialState:{},reducers:{setIsCategorical:(e,t)=>{let{columnName:l,isCategorical:a}=t.payload;e[l]=a}}}),{setIsCategorical:n}=a.actions,r=a.reducer},95914:(e,t,l)=>{l.d(t,{eW:()=>h,l4:()=>b,bL:()=>C,OC:()=>g});var a=l(46336),n=l.n(a),r=l(53663),o=l(7043),i=l(88453);async function u(e,t,l,a){if(0===a.length)return{};let n="lance"===l?"lance_table":"'".concat(e,"'"),r=a.map(e=>{let t=(0,i.r)(e);return"\n      SELECT\n        '".concat(e,"' AS columnName,\n        MAX(array_length(").concat(t,")) AS maxLength,\n        MIN(array_length(").concat(t,")) AS minLength,\n        (MAX(array_length(").concat(t,")) = MIN(array_length(").concat(t,"))\n          AND MAX(array_length(").concat(t,")) > 10) AS isEmb\n      FROM ").concat(n,"\n    ")}).join(" UNION ");try{let a=await b(r,"embedding_dimensions",t,l,e),n={};for(let e of a){let t=String(e.columnName),l=null!==e.maxLength?Number(e.maxLength):null;!0===e.isEmb&&null!==l?n[t]=l:n[t]=null}return n}catch(e){return console.error("Failed to get embedding dimensions:",e),{}}}var s=l(28280),d=l(16023),c=l(62252);async function m(e,t,l){if("lance"!==l)return null;try{let a=await b("SUMMARIZE SELECT * FROM lance_table","lance_stats",t,l,e),n={};for(let e of a){let t=String(e.column_name),l=null===e.min||"boolean"==typeof e.min?null:e.min,a=null===e.max||"boolean"==typeof e.max?null:e.max,r=Number(e.count||0),o=Number(e.null_percentage||0),i=Math.round(o/100*r);n[t]={min:l,max:a,cntAll:r,cntNull:i,hasNull:i>0,singleValue:null!==l&&null!==a&&l===a,allNull:i===r}}return n}catch(e){return console.error(e),null}}async function p(e,t,l){try{let a=await b("\n      SELECT\n        REPLACE(path_in_schema, ', ', '.') AS column_name,\n        SUM(num_values) AS cntAll,\n        MIN(stats_min_value) AS min,\n        MAX(stats_max_value) AS max,\n        -- Sometimes parquet metadata may be wrong for columns with all null values\n        (CASE WHEN (MIN(stats_min_value) IS NULL AND MAX(stats_max_value) IS NULL)\n         THEN SUM(num_values)\n         ELSE SUM(stats_null_count) END) AS cntNull\n      FROM parquet_metadata('".concat(e,"')\n      GROUP BY path_in_schema\n    "),"parquet_stats",t,l,e),n={};for(let e of a){let t=String(e.column_name),l=null===e.min||"boolean"==typeof e.min?null:e.min,a=null===e.max||"boolean"==typeof e.max?null:e.max,r=Number(e.cntAll),o=Number(e.cntNull);n[t]={min:l,max:a,cntAll:r,cntNull:o,hasNull:o>0,singleValue:null!==l&&null!==a&&l===a,allNull:o===r}}return n}catch(e){return console.error(e),null}}async function f(e,t,l){if((0,c.t)(e)!==c.p.RowTable)return null;try{let a=await b("SUMMARIZE SELECT * FROM '".concat(e,"'"),"row_table_stats",t,l,e),n={};for(let e of a){let t=String(e.column_name),l=null===e.min||"boolean"==typeof e.min?null:e.min,a=null===e.max||"boolean"==typeof e.max?null:e.max,r=Number(e.count||0),o=Number(e.null_percentage||0),i=Math.round(o/100*r);n[t]={min:l,max:a,cntAll:r,cntNull:i,hasNull:i>0,singleValue:null!==l&&null!==a&&l===a,allNull:i===r}}return n}catch(e){return console.error(e),null}}async function y(e,t,l){if("lance"===l)return m(e,t,l);let a=(0,c.t)(e);return a===c.p.ColumnarTable?p(e,t,l):a===c.p.RowTable?f(e,t,l):null}async function h(e,t,l,a,n){if(!e.trim())throw Error("Query cannot be empty");l((0,s.ou)({sqlKey:t,query:e.trim(),result:{column_names:[],rows:[],runtime:0,status:"running"}}));let r={query:e.trim(),queryEngine:a,tablePath:n};try{let a=await fetch("".concat(d.m4,"/query"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let n=await a.json();return l((0,s.ou)({sqlKey:t,query:e.trim(),result:n})),n}catch(n){let a={column_names:[],rows:[],runtime:0,status:"error",error:n instanceof Error?n.message:"Unknown error occurred"};return l((0,s.ou)({sqlKey:t,query:e.trim(),result:a})),a}}async function b(e,t,l,a,r){let o=await h(e,t,l,a,r);if("error"===o.status)throw Error(o.error||"Query failed");return o.rows.map((e,t)=>({...n().zipObject(o.column_names,e),rowIndex:t}))}async function g(e,t,l){if(!e.trim())throw Error("Table path cannot be empty");let a="lance"===l?"lance_table":"'".concat(e,"'"),n=await b("SELECT column_name, column_type FROM (DESCRIBE SELECT * FROM ".concat(a,")"),"column_metadata",t,l,e),i=await y(e,t,l),s=[];for(let e of n){let t=String(e.column_name);(function(e){let t=e.toUpperCase().trim();return"FLOAT[]"===t||"DOUBLE[]"===t})(String(e.column_type))&&s.push(t)}let d=await u(e,t,l,s),c=[];for(let e of n){var m;let t=String(e.column_name),l=String(e.column_type);if(c.push({column_name:t,duckdbType:l,typeShortcuts:(0,r.TR)(l),stats:(null==i?void 0:i[t])||null,embDim:null!=(m=d[t])?m:null}),(0,o.O4)(l)&&!(0,o.DA)(l))try{for(let e of(0,o.p6)(t,l))c.push({column_name:e.column_name,duckdbType:e.duckdbType,typeShortcuts:(0,r.TR)(e.duckdbType),stats:(null==i?void 0:i[e.column_name])||null,embDim:null})}catch(e){console.error(e)}}return c}function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"sql",t=Date.now(),l=Math.random().toString(36).substring(2,8);return"".concat(e,"_").concat(t,"_").concat(l)}}}]);