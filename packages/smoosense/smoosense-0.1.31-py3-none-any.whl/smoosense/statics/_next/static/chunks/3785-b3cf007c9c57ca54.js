"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3785],{48:(t,e,a)=>{a.d(e,{$t:()=>s,Ay:()=>y,SR:()=>d});var n=a(95914),o=a(37835),c=a(88453),l=a(46336),i=a.n(l);let r=async(t,e)=>{let{bubblePlotXColumn:a,bubblePlotYColumn:o,bubblePlotBreakdownColumn:l,tablePath:r,queryEngine:p,filterCondition:s,xBin:b,yBin:u}=t,d=s?"WHERE ".concat(s):"",y="\n    WITH filtered AS (\n      SELECT\n        ".concat((0,c.r)(a)," AS x,\n        ").concat((0,c.r)(o)," AS y,\n        ").concat((0,c.r)(l)," AS breakdown\n      FROM ").concat("lance"===p?"lance_table":"'".concat(r,"'"),"\n      ").concat(d?"".concat(d," AND"):"WHERE"," x IS NOT NULL AND y IS NOT NULL\n    ), binned AS (\n      SELECT\n        p.*,\n        FLOOR((p.x - ").concat(b.min,") / ").concat(b.step,")::INT AS bin_x,\n        FLOOR((p.y - ").concat(u.min,") / ").concat(u.step,')::INT AS bin_y\n      FROM filtered AS p\n    )\n    SELECT bin_x, bin_y,\n      -- Compute the "bubble" center as the average x and y within that bin\n      AVG(x) AS x,\n      AVG(y) AS y,\n      COUNT(*) AS size,\n      HISTOGRAM(breakdown) AS color\n    FROM binned\n    GROUP BY 1, 2\n    ORDER BY 1, 2\n  '),m=await (0,n.l4)(y,"balanceMap",e,p,r),h=i().map(m,"x"),A=i().map(m,"y");return[{name:"All",x:h,y:A,customdata:i().map(m,t=>{let e=t.bin_x*b.step+b.min,n=e+b.step,l=t.bin_y*u.step+u.min,i=l+u.step,r=(0,c.r)(a),p=(0,c.r)(o);return{condExpr:["".concat(r," >= ").concat(e),"".concat(r," < ").concat(n),"".concat(p," >= ").concat(l),"".concat(p," < ").concat(i)].join(" AND "),count:t.size,breakdownHistogram:t.color}})}]},p=(0,o.b)({name:"balanceMap",fetchFunction:r,shouldWait:t=>!!(t.bubblePlotXColumn&&t.bubblePlotYColumn&&t.bubblePlotBreakdownColumn&&t.tablePath&&t.xBin&&t.yBin),errorMessage:"Failed to fetch balance map data"});p.slice;let s=p.fetchThunk,{clearBalanceMap:b,setBalanceMapError:u,setNeedRefresh:d}=p.actions,y=p.reducer},31874:(t,e,a)=>{a.d(e,{Ay:()=>y,Np:()=>s,SR:()=>d});var n=a(95914),o=a(37835),c=a(88453),l=a(66848),i=a.n(l);let r=async(t,e)=>{let{boxPlotColumns:a,boxPlotBreakdownColumn:o,tablePath:l,queryEngine:r,filterCondition:p}=t;if(0===a.length)return[];let s="\n    WITH filtered AS (\n      SELECT ".concat(i()(o)?"NULL":(0,c.r)(o)," AS breakdown,\n      ").concat(a.map(c.r).join(", "),"\n      ").concat("FROM ".concat("lance"===r?"lance_table":"'".concat(l,"'")),"\n      ").concat(p?"WHERE ".concat(p):"","\n    ) SELECT breakdown, COUNT(*) AS count, ").concat(a.map(t=>(t=>{let e=(0,c.r)(t);return"{\n      'min' : MIN(".concat(e,"),\n      'max' : MAX(").concat(e,"),\n      'std' : STDDEV_POP(").concat(e,"),\n      'skewness': SKEWNESS(").concat(e,"),\n      'avg' : AVG(").concat(e,"),\n      'q25' : QUANTILE_CONT(").concat(e,", 0.25),\n      'q50' : QUANTILE_CONT(").concat(e,", 0.5),\n      'q75' : QUANTILE_CONT(").concat(e,", 0.75)\n    } AS ").concat(e)})(t)).join(", "),"\n    FROM filtered\n    GROUP BY breakdown\n  ");return await (0,n.l4)(s,"boxPlot",e,r,l)},p=(0,o.b)({name:"boxPlot",fetchFunction:r,shouldWait:t=>!!(t.boxPlotColumns.length>0&&t.tablePath),errorMessage:"Failed to fetch box plot data"});p.slice;let s=p.fetchThunk,{clearBoxPlot:b,setBoxPlotError:u,setNeedRefresh:d}=p.actions,y=p.reducer},31929:(t,e,a)=>{a.d(e,{Ay:()=>A,Bb:()=>r,Rw:()=>d,SR:()=>h});var n=a(95914),o=a(37835),c=a(88453),l=a(46336),i=a.n(l);let r="__y__label__value__",p=t=>({min:i().min(t)||0,max:i().max(t)||0,sum:i().sum(t)}),s=async(t,e)=>{let{heatmapXColumn:a,heatmapYColumn:o,tablePath:l,queryEngine:s,filterCondition:b}=t;if(!a||!o||!l)throw Error("Missing required parameters for heatmap");let u=b?"WHERE ".concat(b):"",d="\nWITH filtered AS (\n      SELECT\n        ".concat((0,c.r)(a)," AS x,\n        ").concat((0,c.r)(o)," AS y\n      FROM ").concat("lance"===s?"lance_table":"'".concat(l,"'"),"\n      ").concat(u?"".concat(u," AND"):"WHERE"," x IS NOT NULL AND y IS NOT NULL\n  ) SELECT x, y, COUNT(*) AS cnt\n   FROM filtered\n   GROUP BY x, y\n  ");return(t=>{let e=i()(t).map("x").uniq().map(String).value(),a=i()(t).groupBy("y").map((t,e)=>({...i()(t).map(t=>[t.x,t]).fromPairs().value(),[r]:e})).value(),n=p(i().map(t,"cnt")),o=i().fromPairs(i().map(a,t=>{let e=i()(t).values().map(t=>null==t?void 0:t.cnt).filter(t=>"number"==typeof t).value();return[t[r],p(e)]})),c=i().fromPairs(i().map(e,t=>{let e=i().map(a,e=>{let a=e[t];return null==a?void 0:a.cnt}).filter(t=>"number"==typeof t);return[t,p(e)]}));return{xLabels:e,rowData:i().map(a,t=>({rowTotal:o[t[r]].sum,...t})),xStats:c,yStats:o,allStats:n}})(await (0,n.l4)(d,"heatMap",e,s,l))},b=(0,o.b)({name:"heatmap",fetchFunction:s,shouldWait:t=>!!(t.heatmapXColumn&&t.heatmapYColumn&&t.tablePath),errorMessage:"Failed to fetch heatmap data"}),u=b.slice,d=b.fetchThunk,{clearHeatmap:y,setHeatmapError:m,setNeedRefresh:h}=b.actions,A=u.reducer},35484:(t,e,a)=>{a.d(e,{Ay:()=>b,Pj:()=>i});var n=a(58976),o=a(69984),c=a(81876);let l=(0,n.Z0)({name:"aiQuickActions",initialState:{actions:[],initialized:!1},reducers:{initializeQuickActions:(t,e)=>{let{fileName:a}=e.payload;t.actions=function(t){var e;let a=[],n=(null==(e=t.split("/").pop())?void 0:e.toLowerCase())||"";return"bbox.parquet"===n?a.push({name:"Abnormally small bbox",confirmation:"Great! I've switched to Table view. \n      Only related columns are shown, sorted by smallest bbox area.\n      You can see more details in the interactive GUI. \n      ",actions:[{type:o.setActiveTab.type,payload:"Table"},{type:c.tG.type,payload:["bbox_area","bbox","image_url","category_name","bbox_width","bbox_height"]},{type:c.J_.type,payload:[{field:"bbox_area",direction:"asc"}]}]},{name:"Show bounding boxes with uncommon width-height ratio.",confirmation:"You can analyze it in Bubble Plot with width vs height. Drag-select interesting areas to see samples.",actions:[{type:o.setActiveTab.type,payload:"Plot"},{type:o.setActivePlotTab.type,payload:"BubblePlot"},{type:o.setBubblePlotXColumn.type,payload:"bbox_width"},{type:o.setBubblePlotYColumn.type,payload:"bbox_height"},{type:o.setColumnForGalleryCaption.type,payload:"category_name"},{type:o.setColumnForGalleryVisual.type,payload:"bbox"}]},{name:"Which category has big variation in bounding box sizes?",confirmation:"Box Plot is perfect for this purpose. You can click on a boxplot cell and see samples.",actions:[{type:o.setActiveTab.type,payload:"Plot"},{type:o.setActivePlotTab.type,payload:"BoxPlot"},{type:o.setBoxPlotBreakdownColumn.type,payload:"category_name"},{type:o.setBoxPlotSortBy.type,payload:"std"},{type:o.setBoxPlotColumns.type,payload:["bbox_area","bbox_percentage"]},{type:o.setBoxPlotSorting.type,payload:[{field:"bbox_percentage",direction:"desc"}]},{type:o.setColumnForGalleryCaption.type,payload:"category_name"},{type:o.setColumnForGalleryVisual.type,payload:"bbox"}]}):"images-emb-2d.parquet"===n&&a.push({name:"Use embedding to check if training/validation/testing are balanced",confirmation:'\nHappy to help. In the table I see column `fold` and pre-computed embedding columns.\nHere is the overall distribution:\n\n<HeaderStatsCellRendererImpl columnname="fold" side="bottom"></HeaderStatsCellRendererImpl>\n  \nI used BalanceMap to create a bubble plot: images are clustered by semantic similarity and color-coded by local relative ratios.\n\n- A neutral color indicates balance\n- Deeper colors highlight imbalance.\n \nYou can click any bubble to explore the samples in that region.\n',actions:[{type:o.setActiveTab.type,payload:"Plot"},{type:o.setActivePlotTab.type,payload:"BalanceMap"},{type:o.setBubblePlotBreakdownColumn.type,payload:"fold"},{type:o.setBubblePlotMarkerSizeContrastRatio.type,payload:2},{type:o.setBubblePlotXColumn.type,payload:"emb_x"},{type:o.setBubblePlotYColumn.type,payload:"emb_y"},{type:o.setColumnForGalleryCaption.type,payload:"fold"},{type:o.setColumnForGalleryVisual.type,payload:"coco_url"}]}),a}(a),t.initialized=!0},addQuickAction:(t,e)=>{let a=t.actions.findIndex(t=>t.name===e.payload.name);-1!==a?t.actions[a]=e.payload:t.actions.push(e.payload)},removeQuickAction:(t,e)=>{t.actions=t.actions.filter(t=>t.name!==e.payload)},reset:t=>{t.actions=[],t.initialized=!1}}}),{initializeQuickActions:i,addQuickAction:r,removeQuickAction:p,reset:s}=l.actions,b=l.reducer},43462:(t,e,a)=>{a.d(e,{Ay:()=>A,F$:()=>d,SR:()=>h});var n=a(95914),o=a(37835),c=a(88453),l=a(28602),i=a(66848),r=a.n(i),p=a(46336),s=a.n(p);let b=async(t,e)=>{let{histogramColumn:a,histogramBreakdownColumn:o,tablePath:i,queryEngine:p,filterCondition:b,histogramStatsData:u}=t;if(!(null==u?void 0:u.bin))throw Error("Missing histogram bin data");let{min:d,step:y,round_to:m}=u.bin,h=b?"WHERE ".concat(b):"",A="lance"===p?"lance_table":"'".concat(i,"'"),S="\n    WITH filtered AS (\n      SELECT\n        ".concat((0,c.r)(a)," AS value,\n        ").concat(r()(o)?"NULL":(0,c.r)(o)," AS breakdown\n      FROM ").concat(A,"\n      ").concat(h?"".concat(h," AND"):"WHERE"," value IS NOT NULL\n    )\n    SELECT breakdown, FLOOR((value - ").concat(d,") / ").concat(y,") AS binIdx,\n        COUNT(*) AS cnt\n    FROM filtered\n    GROUP BY 1, 2\n    ORDER BY 1, 2\n  "),x=await (0,n.l4)(S,"histogram",e,p,i);return s()(x).groupBy("breakdown").toPairs().map(t=>{let[e,n]=t,i=(0,l.G)({min:d,step:y,round_to:m,cntValues:n}),p=s().map(i,"value"),b=s().map(i,"cnt"),u=s().map(i,t=>({condExpr:["".concat((0,c.r)(a)," >= ").concat(t.binMin),"".concat((0,c.r)(a)," < ").concat(t.binMax),...r()(o)?[]:["".concat((0,c.r)(o)," = '").concat(e,"'")]].join(" AND ")}));return{name:e||"All",x:p,y:b,customdata:u}}).value()},u=(0,o.b)({name:"histogram",fetchFunction:b,shouldWait:t=>{var e;return!!(t.histogramColumn&&t.tablePath&&(null==(e=t.histogramStatsData)?void 0:e.bin))},errorMessage:"Failed to fetch histogram data"});u.slice;let d=u.fetchThunk,{clearHistogram:y,setHistogramError:m,setNeedRefresh:h}=u.actions,A=u.reducer},44558:(t,e,a)=>{a.d(e,{Ay:()=>h,SR:()=>m,wk:()=>u});var n=a(95914),o=a(37835),c=a(88453),l=a(66848),i=a.n(l),r=a(46336),p=a.n(r);let s=async(t,e)=>{let{bubblePlotXColumn:a,bubblePlotYColumn:o,bubblePlotBreakdownColumn:l,bubblePlotColorColumn:r,tablePath:s,queryEngine:b,filterCondition:u,xBin:d,yBin:y}=t,m=u?"WHERE ".concat(u):"",h="lance"===b?"lance_table":"'".concat(s,"'"),A=r?"".concat((0,c.r)(r)," AS color_col"):"NULL AS color_col",S="\n    WITH filtered AS (\n      SELECT\n        ".concat((0,c.r)(a)," AS x,\n        ").concat((0,c.r)(o)," AS y,\n        ").concat(i()(l)?"NULL":(0,c.r)(l)," AS breakdown,\n        ").concat(A,"\n      FROM ").concat(h,"\n      ").concat(m?"".concat(m," AND"):"WHERE"," x IS NOT NULL AND y IS NOT NULL\n    ), binned AS (\n      SELECT\n        p.*,\n        FLOOR((p.x - ").concat(d.min,") / ").concat(d.step,")::INT AS bin_x,\n        FLOOR((p.y - ").concat(y.min,") / ").concat(y.step,')::INT AS bin_y\n      FROM filtered AS p\n    )\n    SELECT breakdown, bin_x, bin_y,\n      -- Compute the "bubble" center as the average x and y within that bin\n      AVG(x) AS x,\n      AVG(y) AS y,\n      COUNT(*) AS count,\n      ').concat(r?"AVG(color_col) AS color_value":"NULL AS color_value","\n    FROM binned\n    GROUP BY 1, 2, 3\n    ORDER BY 1, 2, 3\n  "),x=await (0,n.l4)(S,"bubblePlot",e,b,s);return p()(x).groupBy("breakdown").toPairs().map(t=>{let[e,n]=t,r=p().map(n,"x"),s=p().map(n,"y"),b=p().map(n,t=>{let n=t.bin_x*d.step+d.min,r=n+d.step,p=t.bin_y*y.step+y.min,s=p+y.step,b=(0,c.r)(a),u=(0,c.r)(o),m=(0,c.r)(l);return{condExpr:["".concat(b," >= ").concat(n),"".concat(b," < ").concat(r),"".concat(u," >= ").concat(p),"".concat(u," < ").concat(s),...i()(l)?[]:["".concat(m," = '").concat(e,"'")]].join(" AND "),count:t.count,colorValue:t.color_value}});return{name:e||"All",x:r,y:s,customdata:b}}).value()},b=(0,o.b)({name:"bubblePlot",fetchFunction:s,shouldWait:t=>!!(t.bubblePlotXColumn&&t.bubblePlotYColumn&&t.tablePath&&t.xBin&&t.yBin),errorMessage:"Failed to fetch bubble plot data"});b.slice;let u=b.fetchThunk,{clearBubblePlot:d,setBubblePlotError:y,setNeedRefresh:m}=b.actions,h=b.reducer}}]);