# ICSC Ava Upload Toolkit

完整的檔案上傳工具套件，包含 MCP Server 和 Mock File Service，支援工具鏈設計，專為 LibreChat 系統設計。

## 功能

### MCP Server (icsc-ava-upload-mcp-server)
- **download_and_upload**: [CHAINING TOOL] 接收來自上游工具的暫存 URL，下載檔案並上傳到 LibreChat 後端系統

### Mock File Service (mock-file-service)  
- **FastAPI 模擬服務**: 模擬 Node.js Fastify 的 AVA File Service
- **檔案上傳/下載**: 提供完整的檔案管理 API
- **多種儲存類型**: 支援 chat、crawler、doc、logs 等不同類型的檔案儲存

## 安裝

### 使用 uv 安裝

```bash
# 安裝專案依賴
uv sync

# 或者以開發模式安裝
uv pip install -e .
```

### 使用 uvx 直接運行

#### MCP Server

```bash
# 從本地專案運行 MCP Server (STDIO 模式)
uvx --from . icsc-ava-upload-server stdio

# MCP Server (HTTP 模式) - 可指定 host 和 port
uvx --from . icsc-ava-upload-server http 127.0.0.1 8001

# 使用簡短命令
uvx --from . icsc-ava-mcp stdio
```

#### Mock File Service

```bash
# 從本地專案運行 Mock File Service - 可指定 host 和 port
uvx --from . mock-file-service 127.0.0.1 8090

# 使用簡短命令
uvx --from . icsc-ava-mock-service 127.0.0.1 8090

# 開發模式 (支援熱重載)
uvx --from . mock-file-service 127.0.0.1 8090 --reload
```

## 運行模式

### STDIO 模式

適用於本地 MCP Client 連接：

```bash
# 使用 uv run
uv run python -m icsc_ava_upload_mcp_server.server stdio

# 或使用安裝後的命令
uv run icsc-ava-upload-server stdio
```

### Streamable HTTP 模式

適用於遠端 MCP Client 連接：

```bash
# 使用 uv run
uv run python -m icsc_ava_upload_mcp_server.server http

# 或使用安裝後的命令
uv run icsc-ava-upload-server http
```

HTTP 模式預設監聽 `http://127.0.0.1:8001`

## MCP Client 設定範例

### Claude Desktop (stdio 模式)

在 `claude_desktop_config.json` 中加入：

```json
{
  "mcpServers": {
    "icsc-ava-upload": {
      "command": "uvx",
      "args": ["--from", "D:\\project\\icsc-file-uploader", "icsc-ava-upload-server", "stdio"]
    }
  }
}
```

### HTTP 模式連接

啟動 HTTP 伺服器後，MCP Client 可連接到：
- URL: `http://127.0.0.1:8001/mcp`

## 開發

### VSCode 啟動設定

專案已包含 `.vscode/launch.json`，提供兩種除錯模式：
- **MCP Server (STDIO)**: 以 stdio 模式啟動
- **MCP Server (HTTP)**: 以 streamable-http 模式啟動

## 授權

MIT License
