import{d as $,r as d,b as A,o as I,a7 as V,f as w,W as K,l as e,V as j,w as o,i as n,v as F,h as C,k as G,m as W,n as X,p as J,U as M,B as T,s as v,t as u,d0 as P,d1 as Q,c as Y,A as Z,e as q,a8 as ee,cX as ne,a9 as oe,af as se,aH as te,a6 as R,d2 as ae,N as le,O as re,am as ie,aG as _e,d3 as ce,E as ue}from"./index-BHd9xypC.js";import{A as de}from"./Add-CMAgnUAh.js";import{U as B}from"./UserMultiple-CU1yflou.js";const me={class:"flex justify-end"},pe=$({__name:"OrgModal",props:{type:{}},emits:["success"],setup(D,{expose:U,emit:O}){const m=d(),{t:l}=A(),y=O,b=d(!1),p=d(!1),h=()=>{p.value=!1,t.value={name:void 0,user_ids:void 0,admin_ids:void 0}},z=()=>{p.value=!0},_=d({name:{required:!0,message:l("common.required")},user_ids:{required:!0,message:l("common.required")},admin_ids:{required:!0,message:l("common.required")}}),r=d(null),t=d({name:void 0,user_ids:void 0,admin_ids:void 0}),x=()=>{var i;(i=r.value)==null||i.validate(async s=>{if(s)return;const[f,a]=await P(t.value);!f&&(a==null?void 0:a.status)===0&&(y("success"),h())})},L=async()=>{var f;const[i,s]=await Q();!i&&(s==null?void 0:s.status)===0&&(m.value=(f=s.data)==null?void 0:f.map(a=>({...a,label:a.user_name,value:a.user_id})))};return I(()=>{L()}),U({open:z,close:h}),(i,s)=>{const f=X,a=W,k=J,N=G,c=T,S=M,E=F,H=K;return w(),V(H,{show:e(p),"onUpdate:show":s[3]||(s[3]=g=>j(p)?p.value=g:null),"mask-closable":!1,"close-on-esc":!1},{default:o(()=>[n(E,{bordered:!1,"content-class":"!px-5",style:{width:"700px"}},{default:o(()=>[n(N,{ref_key:"formRef",ref:r,model:e(t),rules:e(_),size:"small"},{default:o(()=>[n(a,{label:e(l)("org.orgName"),path:"name"},{default:o(()=>[n(f,{disabled:i.type==="edit",value:e(t).name,"onUpdate:value":s[0]||(s[0]=g=>e(t).name=g)},null,8,["disabled","value"])]),_:1},8,["label"]),n(a,{label:e(l)("org.admin"),path:"admin_ids"},{default:o(()=>[n(k,{value:e(t).admin_ids,"onUpdate:value":s[1]||(s[1]=g=>e(t).admin_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"]),n(a,{label:e(l)("org.member"),path:"user_ids"},{default:o(()=>[n(k,{value:e(t).user_ids,"onUpdate:value":s[2]||(s[2]=g=>e(t).user_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),C("div",me,[n(S,null,{default:o(()=>[n(c,{onClick:h,loading:e(b)},{default:o(()=>[v(u(e(l)("common.cancel")),1)]),_:1},8,["loading"]),n(c,{type:"primary",onClick:x,loading:e(b)},{default:o(()=>[v(u(e(l)("common.OK")),1)]),_:1},8,["loading"])]),_:1})])]),_:1})]),_:1},8,["show"])}}}),fe=["onClick"],ge={class:"flex items-center gap-1"},ve={class:"flex items-center gap-1"},xe=$({__name:"OrgAuth",setup(D){const U=Y(),O=Z(),{t:m}=A(),l=d(),y=d(),b=d(),p=async()=>{var t;const[_,r]=await ce();!_&&(r==null?void 0:r.status)===0&&(b.value=(t=r==null?void 0:r.data)==null?void 0:t.organizations)},h=()=>{y.value={type:"insert",show:!0},ue(()=>{var _;(_=l.value)==null||_.open()})},z=_=>{U.push({name:"org",query:{id:_}})};return I(()=>{p()}),(_,r)=>{var k,N;const t=T,x=le,L=ae,i=ie,s=M,f=te,a=_e;return w(),q("div",null,[n(ne,{title:e(m)("org.orgList")},{extra:o(()=>[n(t,{type:"primary",onClick:h},{icon:o(()=>[n(e(de))]),default:o(()=>[v(" "+u(e(m)("org.createOrg")),1)]),_:1})]),_:1},8,["title"]),n(a,{cols:4,"x-gap":16,"y-gap":16},{default:o(()=>[(w(!0),q(oe,null,se(e(b),c=>(w(),V(f,{key:c.organization_id},{default:o(()=>[C("div",{class:"border rounded-xl cursor-pointer",style:R({borderColor:e(O).dividerColor}),onClick:()=>z(c.organization_id)},[n(L,{class:"px-3 py-2 min-h-20 flex items-center"},{default:o(()=>[n(x,{class:"mr-1",component:e(re)},null,8,["component"]),v(" "+u(c.organization_name),1)]),_:2},1024),C("div",{class:"px-2 py-3 border-t",style:R({borderColor:e(O).dividerColor})},[n(s,null,{default:o(()=>[n(i,{bordered:!1,type:"success",round:""},{default:o(()=>[v(" ID "+u(c.organization_id),1)]),_:2},1024),n(i,{bordered:!1,type:"warning",round:""},{default:o(()=>[C("div",ge,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(c.member_count)+" "+u(e(m)("org.cmember")),1)])]),_:2},1024),n(i,{bordered:!1,type:"info",round:""},{default:o(()=>[C("div",ve,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(c.device_count)+" "+u(e(m)("org.cdevice")),1)])]),_:2},1024)]),_:2},1024)],4)],12,fe)]),_:2},1024))),128))]),_:1}),(k=e(y))!=null&&k.show?(w(),V(pe,{key:0,type:(N=e(y))==null?void 0:N.type,ref_key:"orgModalRef",ref:l,onSuccess:p},null,8,["type"])):ee("",!0)])}}});export{xe as default};
