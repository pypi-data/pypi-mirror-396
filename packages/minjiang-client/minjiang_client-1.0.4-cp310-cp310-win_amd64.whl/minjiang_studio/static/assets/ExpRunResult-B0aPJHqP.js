import{d as Xt,e as te,f as C,h as H,aW as st,aX as ca,r as G,C as da,c as pa,K as _a,A as ga,b as ma,L as Vt,a0 as zt,I as $,bW as ya,p as ha,n as va,aI as ba,B as ve,N as wa,cF as Ta,o as xa,F as Ot,ae as Aa,i as K,w as L,a9 as it,af as Pt,l as i,a7 as ae,ap as Ca,aQ as Ia,aq as Ea,V as Jt,t as W,ak as Oa,a8 as Ke,aj as Pa,s as Ee,a6 as Ra,aF as ka,j as La,ba as Ma,v as Na,S as Ua,W as Fa,E as He,b1 as $a}from"./index-BHd9xypC.js";import{u as Da,a as Sa,v as qa,w as Ba,x as Ga,y as Ka,z as Ha,A as Va}from"./exp-VCEEBlLK.js";import{_ as za}from"./DynamicForm.vue_vue_type_script_setup_true_lang-jtwxeB2H.js";import{i as Ja}from"./json-editor-vue-DXYCBDpP.js";import{u as Wa}from"./exp-BmX6R77-.js";import{c as ja}from"./index-Due476Fm.js";import{N as Xa}from"./InputNumber-Bb1z8BQ5.js";import{N as Ya}from"./Switch-t-7rbxnR.js";import{_ as Qa}from"./Popconfirm-2ujZaRoc.js";import{_ as Za}from"./Image-D3gvlp1C.js";import{_ as er}from"./DataTable-08tqtwQR.js";import"./index.browser-OxPLOBIU.js";import"./download-C2161hUv.js";import"./Checkbox-DKKtBMeF.js";import"./RadioGroup-rQxCkFUy.js";import"./Pagination-DKvHZiJi.js";const tr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},nr=Xt({name:"Edit",render:function(ee,I){return C(),te("svg",tr,I[0]||(I[0]=[H("path",{d:"M2 26h28v2H2z",fill:"currentColor"},null,-1),H("path",{d:"M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z",fill:"currentColor"},null,-1)]))}});var Ve={exports:{}};Ve.exports;var Wt;function ar(){return Wt||(Wt=1,function(Oe,ee){var I=200,lt="Expected a function",$e="__lodash_hash_undefined__",be=1,a=2,M=9007199254740991,pe="[object Arguments]",j="[object Array]",ne="[object Boolean]",we="[object Date]",re="[object Error]",se="[object Function]",ut="[object GeneratorFunction]",X="[object Map]",De="[object Number]",ie="[object Object]",ze="[object Promise]",Se="[object RegExp]",_e="[object Set]",le="[object String]",Pe="[object Symbol]",Te="[object WeakMap]",Re="[object ArrayBuffer]",ke="[object DataView]",ot="[object Float32Array]",Le="[object Float64Array]",ft="[object Int8Array]",ct="[object Int16Array]",qe="[object Int32Array]",Me="[object Uint8Array]",dt="[object Uint8ClampedArray]",pt="[object Uint16Array]",_t="[object Uint32Array]",Je=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/,d=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g=/[\\^$.*+?()[\]{}|]/g,m=/\\(\\)?/g,h=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,f={};f[ot]=f[Le]=f[ft]=f[ct]=f[qe]=f[Me]=f[dt]=f[pt]=f[_t]=!0,f[pe]=f[j]=f[Re]=f[ne]=f[ke]=f[we]=f[re]=f[se]=f[X]=f[De]=f[ie]=f[Se]=f[_e]=f[le]=f[Te]=!1;var v=typeof st=="object"&&st&&st.Object===Object&&st,y=typeof self=="object"&&self&&self.Object===Object&&self,p=v||y||Function("return this")(),w=ee&&!ee.nodeType&&ee,_=w&&!0&&Oe&&!Oe.nodeType&&Oe,T=_&&_.exports===w,V=T&&v.process,x=function(){try{return V&&V.binding("util")}catch{}}(),z=x&&x.isTypedArray;function D(e,t,n,r){for(var o=-1,s=e?e.length:0;++o<s;){var c=e[o];t(r,c,n(c),e)}return r}function Y(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function N(e){return function(t){return t==null?void 0:t[e]}}function E(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function O(e){return function(t){return e(t)}}function P(e,t){return e==null?void 0:e[t]}function k(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function J(e){var t=-1,n=Array(e.size);return e.forEach(function(r,o){n[++t]=[o,r]}),n}function U(e,t){return function(n){return e(t(n))}}function xe(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var ge=Array.prototype,mt=Function.prototype,Ne=Object.prototype,yt=p["__core-js_shared__"],Rt=function(){var e=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),kt=mt.toString,ue=Ne.hasOwnProperty,Ue=Ne.toString,Yt=RegExp("^"+kt.call(ue).replace(g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Lt=p.Symbol,Mt=p.Uint8Array,Qt=Ne.propertyIsEnumerable,Zt=ge.splice,en=U(Object.keys,Object),ht=Fe(p,"DataView"),Be=Fe(p,"Map"),vt=Fe(p,"Promise"),bt=Fe(p,"Set"),wt=Fe(p,"WeakMap"),Ge=Fe(Object,"create"),tn=Ce(ht),nn=Ce(Be),an=Ce(vt),rn=Ce(bt),sn=Ce(wt),We=Lt?Lt.prototype:void 0,Tt=We?We.valueOf:void 0,Nt=We?We.toString:void 0;function Ae(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ln(){this.__data__=Ge?Ge(null):{}}function un(e){return this.has(e)&&delete this.__data__[e]}function on(e){var t=this.__data__;if(Ge){var n=t[e];return n===$e?void 0:n}return ue.call(t,e)?t[e]:void 0}function fn(e){var t=this.__data__;return Ge?t[e]!==void 0:ue.call(t,e)}function cn(e,t){var n=this.__data__;return n[e]=Ge&&t===void 0?$e:t,this}Ae.prototype.clear=ln,Ae.prototype.delete=un,Ae.prototype.get=on,Ae.prototype.has=fn,Ae.prototype.set=cn;function oe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function dn(){this.__data__=[]}function pn(e){var t=this.__data__,n=Xe(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Zt.call(t,n,1),!0}function _n(e){var t=this.__data__,n=Xe(t,e);return n<0?void 0:t[n][1]}function gn(e){return Xe(this.__data__,e)>-1}function mn(e,t){var n=this.__data__,r=Xe(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}oe.prototype.clear=dn,oe.prototype.delete=pn,oe.prototype.get=_n,oe.prototype.has=gn,oe.prototype.set=mn;function fe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yn(){this.__data__={hash:new Ae,map:new(Be||oe),string:new Ae}}function hn(e){return Ye(this,e).delete(e)}function vn(e){return Ye(this,e).get(e)}function bn(e){return Ye(this,e).has(e)}function wn(e,t){return Ye(this,e).set(e,t),this}fe.prototype.clear=yn,fe.prototype.delete=hn,fe.prototype.get=vn,fe.prototype.has=bn,fe.prototype.set=wn;function je(e){var t=-1,n=e?e.length:0;for(this.__data__=new fe;++t<n;)this.add(e[t])}function Tn(e){return this.__data__.set(e,$e),this}function xn(e){return this.__data__.has(e)}je.prototype.add=je.prototype.push=Tn,je.prototype.has=xn;function ce(e){this.__data__=new oe(e)}function An(){this.__data__=new oe}function Cn(e){return this.__data__.delete(e)}function In(e){return this.__data__.get(e)}function En(e){return this.__data__.has(e)}function On(e,t){var n=this.__data__;if(n instanceof oe){var r=n.__data__;if(!Be||r.length<I-1)return r.push([e,t]),this;n=this.__data__=new fe(r)}return n.set(e,t),this}ce.prototype.clear=An,ce.prototype.delete=Cn,ce.prototype.get=In,ce.prototype.has=En,ce.prototype.set=On;function Pn(e,t){var n=ye(e)||Gt(e)?E(e.length,String):[],r=n.length,o=!!r;for(var s in e)ue.call(e,s)&&!(o&&(s=="length"||Dt(s,r)))&&n.push(s);return n}function Xe(e,t){for(var n=e.length;n--;)if(Bt(e[n][0],t))return n;return-1}function Rn(e,t,n,r){return kn(e,function(o,s,c){t(r,o,n(o),c)}),r}var kn=Jn(Mn),Ln=Wn();function Mn(e,t){return e&&Ln(e,t,nt)}function Ut(e,t){t=Qe(t,e)?[t]:Ft(t);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Ze(t[n++])];return n&&n==r?e:void 0}function Nn(e){return Ue.call(e)}function Un(e,t){return e!=null&&t in Object(e)}function xt(e,t,n,r,o){return e===t?!0:e==null||t==null||!et(e)&&!tt(t)?e!==e&&t!==t:Fn(e,t,xt,n,r,o)}function Fn(e,t,n,r,o,s){var c=ye(e),R=ye(t),A=j,F=j;c||(A=me(e),A=A==pe?ie:A),R||(F=me(t),F=F==pe?ie:F);var q=A==ie&&!k(e),B=F==ie&&!k(t),S=A==F;if(S&&!q)return s||(s=new ce),c||sa(e)?$t(e,t,n,r,o,s):jn(e,t,A,n,r,o,s);if(!(o&a)){var Q=q&&ue.call(e,"__wrapped__"),Z=B&&ue.call(t,"__wrapped__");if(Q||Z){var he=Q?e.value():e,de=Z?t.value():t;return s||(s=new ce),n(he,de,r,o,s)}}return S?(s||(s=new ce),Xn(e,t,n,r,o,s)):!1}function $n(e,t,n,r){var o=n.length,s=o;if(e==null)return!s;for(e=Object(e);o--;){var c=n[o];if(c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){c=n[o];var R=c[0],A=e[R],F=c[1];if(c[2]){if(A===void 0&&!(R in e))return!1}else{var q=new ce,B;if(!(B===void 0?xt(F,A,r,be|a,q):B))return!1}}return!0}function Dn(e){if(!et(e)||ea(e))return!1;var t=Kt(e)||k(e)?Yt:h;return t.test(Ce(e))}function Sn(e){return tt(e)&&It(e.length)&&!!f[Ue.call(e)]}function qn(e){return typeof e=="function"?e:e==null?oa:typeof e=="object"?ye(e)?Kn(e[0],e[1]):Gn(e):fa(e)}function Bn(e){if(!ta(e))return en(e);var t=[];for(var n in Object(e))ue.call(e,n)&&n!="constructor"&&t.push(n);return t}function Gn(e){var t=Yn(e);return t.length==1&&t[0][2]?qt(t[0][0],t[0][1]):function(n){return n===e||$n(n,e,t)}}function Kn(e,t){return Qe(e)&&St(t)?qt(Ze(e),t):function(n){var r=la(n,e);return r===void 0&&r===t?ua(n,e):xt(t,r,void 0,be|a)}}function Hn(e){return function(t){return Ut(t,e)}}function Vn(e){if(typeof e=="string")return e;if(Et(e))return Nt?Nt.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Ft(e){return ye(e)?e:na(e)}function zn(e,t){return function(n,r){var o=ye(n)?D:Rn,s=t?t():{};return o(n,e,qn(r),s)}}function Jn(e,t){return function(n,r){if(n==null)return n;if(!Ct(n))return e(n,r);for(var o=n.length,s=-1,c=Object(n);++s<o&&r(c[s],s,c)!==!1;);return n}}function Wn(e){return function(t,n,r){for(var o=-1,s=Object(t),c=r(t),R=c.length;R--;){var A=c[++o];if(n(s[A],A,s)===!1)break}return t}}function $t(e,t,n,r,o,s){var c=o&a,R=e.length,A=t.length;if(R!=A&&!(c&&A>R))return!1;var F=s.get(e);if(F&&s.get(t))return F==t;var q=-1,B=!0,S=o&be?new je:void 0;for(s.set(e,t),s.set(t,e);++q<R;){var Q=e[q],Z=t[q];if(r)var he=c?r(Z,Q,q,t,e,s):r(Q,Z,q,e,t,s);if(he!==void 0){if(he)continue;B=!1;break}if(S){if(!Y(t,function(de,Ie){if(!S.has(Ie)&&(Q===de||n(Q,de,r,o,s)))return S.add(Ie)})){B=!1;break}}else if(!(Q===Z||n(Q,Z,r,o,s))){B=!1;break}}return s.delete(e),s.delete(t),B}function jn(e,t,n,r,o,s,c){switch(n){case ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Re:return!(e.byteLength!=t.byteLength||!r(new Mt(e),new Mt(t)));case ne:case we:case De:return Bt(+e,+t);case re:return e.name==t.name&&e.message==t.message;case Se:case le:return e==t+"";case X:var R=J;case _e:var A=s&a;if(R||(R=xe),e.size!=t.size&&!A)return!1;var F=c.get(e);if(F)return F==t;s|=be,c.set(e,t);var q=$t(R(e),R(t),r,o,s,c);return c.delete(e),q;case Pe:if(Tt)return Tt.call(e)==Tt.call(t)}return!1}function Xn(e,t,n,r,o,s){var c=o&a,R=nt(e),A=R.length,F=nt(t),q=F.length;if(A!=q&&!c)return!1;for(var B=A;B--;){var S=R[B];if(!(c?S in t:ue.call(t,S)))return!1}var Q=s.get(e);if(Q&&s.get(t))return Q==t;var Z=!0;s.set(e,t),s.set(t,e);for(var he=c;++B<A;){S=R[B];var de=e[S],Ie=t[S];if(r)var Ht=c?r(Ie,de,S,t,e,s):r(de,Ie,S,e,t,s);if(!(Ht===void 0?de===Ie||n(de,Ie,r,o,s):Ht)){Z=!1;break}he||(he=S=="constructor")}if(Z&&!he){var at=e.constructor,rt=t.constructor;at!=rt&&"constructor"in e&&"constructor"in t&&!(typeof at=="function"&&at instanceof at&&typeof rt=="function"&&rt instanceof rt)&&(Z=!1)}return s.delete(e),s.delete(t),Z}function Ye(e,t){var n=e.__data__;return Zn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Yn(e){for(var t=nt(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,St(o)]}return t}function Fe(e,t){var n=P(e,t);return Dn(n)?n:void 0}var me=Nn;(ht&&me(new ht(new ArrayBuffer(1)))!=ke||Be&&me(new Be)!=X||vt&&me(vt.resolve())!=ze||bt&&me(new bt)!=_e||wt&&me(new wt)!=Te)&&(me=function(e){var t=Ue.call(e),n=t==ie?e.constructor:void 0,r=n?Ce(n):void 0;if(r)switch(r){case tn:return ke;case nn:return X;case an:return ze;case rn:return _e;case sn:return Te}return t});function Qn(e,t,n){t=Qe(t,e)?[t]:Ft(t);for(var r,o=-1,c=t.length;++o<c;){var s=Ze(t[o]);if(!(r=e!=null&&n(e,s)))break;e=e[s]}if(r)return r;var c=e?e.length:0;return!!c&&It(c)&&Dt(s,c)&&(ye(e)||Gt(e))}function Dt(e,t){return t=t??M,!!t&&(typeof e=="number"||u.test(e))&&e>-1&&e%1==0&&e<t}function Qe(e,t){if(ye(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Et(e)?!0:gt.test(e)||!Je.test(e)||t!=null&&e in Object(t)}function Zn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ea(e){return!!Rt&&Rt in e}function ta(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Ne;return e===n}function St(e){return e===e&&!et(e)}function qt(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var na=At(function(e){e=ia(e);var t=[];return d.test(e)&&t.push(""),e.replace(l,function(n,r,o,s){t.push(o?s.replace(m,"$1"):r||n)}),t});function Ze(e){if(typeof e=="string"||Et(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Ce(e){if(e!=null){try{return kt.call(e)}catch{}try{return e+""}catch{}}return""}var aa=zn(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function At(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(lt);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var c=e.apply(this,r);return n.cache=s.set(o,c),c};return n.cache=new(At.Cache||fe),n}At.Cache=fe;function Bt(e,t){return e===t||e!==e&&t!==t}function Gt(e){return ra(e)&&ue.call(e,"callee")&&(!Qt.call(e,"callee")||Ue.call(e)==pe)}var ye=Array.isArray;function Ct(e){return e!=null&&It(e.length)&&!Kt(e)}function ra(e){return tt(e)&&Ct(e)}function Kt(e){var t=et(e)?Ue.call(e):"";return t==se||t==ut}function It(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=M}function et(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function tt(e){return!!e&&typeof e=="object"}function Et(e){return typeof e=="symbol"||tt(e)&&Ue.call(e)==Pe}var sa=z?O(z):Sn;function ia(e){return e==null?"":Vn(e)}function la(e,t,n){var r=e==null?void 0:Ut(e,t);return r===void 0?n:r}function ua(e,t){return e!=null&&Qn(e,t,Un)}function nt(e){return Ct(e)?Pn(e):Bn(e)}function oa(e){return e}function fa(e){return Qe(e)?N(Ze(e)):Hn(e)}Oe.exports=aa}(Ve,Ve.exports)),Ve.exports}var rr=ar();const sr=ca(rr),ir={class:"flex gap-3"},lr={class:"w-64 pl-2"},ur={class:"mb-5"},or={class:"text-xl"},fr={class:"text-sm opacity-80"},cr={key:0,class:"text-right mt-2"},dr={class:"flex justify-between items-center mb-2"},pr={class:"flex-1"},_r={key:0},gr={class:"text-xl"},mr={class:"opacity-75 italic pl-2"},yr={key:1,class:"text-xl"},hr={key:0,class:"flex gap-2"},vr={class:"mt-4 mb-2 text-xl"},br={class:"flex justify-end mt-5 gap-2"},b="__SPACE_PARAMETER_UPDATING__",jt="__SELECTED_SPACE_PARAMETER_UPDATING__",$r=Xt({__name:"ExpRunResult",setup(Oe){const ee=G(!1),I=da(),lt=pa(),$e=_a(),be=ga(),a=Wa(),{t:M}=ma(),pe=G(),j=G({show:!1}),ne=G(!1),we=G(!1),re=G(!1),se=G(!1),ut=[{label:"str",value:"str"},{label:"int",value:"int"},{label:"float",value:"float"},{label:"bool",value:"bool"},{label:"list",value:"list"},{label:"tuple",value:"tuple"},{label:"dict",value:"dict"},{label:"complex",value:"complex"},{label:"ndarray",value:"ndarray"}],X=G(),De=G(),ie=G(),ze=async()=>{var g,m;const[d,l]=await Da();if(!d&&(l==null?void 0:l.status)===0){ie.value=l.data;const[h]=(m=(g=a==null?void 0:a.expInfo)==null?void 0:g.exp)!=null&&m.template?a.expInfo.exp.template.split("/"):"";h&&l.data[h]?(X.value=h,He(()=>{Te(h,!0)})):(X.value=Object.keys(l.data)[0],He(()=>{Te(Object.keys(l.data)[0])}))}},Se=async()=>{var g,m,h;if(!I.query.exp_id)return;const[d,l]=await Sa({exp_id:I.query.exp_id,device_group_name:I.query.device_group_name,space_id:I.query.space_id});if(!d&&(l==null?void 0:l.status)===0){if((g=l.data)!=null&&g.data){l.data.data=JSON.parse(l.data.data);const u=(m=l.data.data)!=null&&m.tables?(h=l.data.data)==null?void 0:h.tables[b]:null;u&&(u.crows=u.rows)}a.result=l.data}},_e=Vt(()=>{var m,h;const d=[];(m=a.result)!=null&&m.data&&zt((h=a.result.data)==null?void 0:h.tables,u=>{const f=u.rows.map(y=>{var w;const p={};return(w=u.columns)==null||w.forEach((_,T)=>{p[_.name]=typeof y[T]!==void 0?`${y[T]}`:y[T]}),p}),v=u.columns.map((y,p)=>{const w={...y,title:y.name,key:y.name};return y.name==="key"?{...w,minWidth:200,render(_){return $(ya,{},{default:()=>Le.value&&Le.value[_.key]?$("div",`${M("expInfo.latestParamsTips")}: ${Le.value[_.key]}`):$("div",_.key),trigger:()=>$("div",{class:"cursor-pointer"},_.key)})}}:y.name==="type"&&u.name===b?{...w,width:200,render(_,T){if(ee.value){const V=u.crows?u.crows[T][p]:null;return $(ha,{class:V!=_.type?"!outline !outline-red-500 w-32":"w-32",options:ut,value:_.type,onUpdateValue:x=>{var z,D,Y,N,E,O,P,k;(D=(z=a==null?void 0:a.result)==null?void 0:z.data)!=null&&D.tables&&((N=(Y=a==null?void 0:a.result)==null?void 0:Y.data)!=null&&N.tables[b])&&(((O=(E=a==null?void 0:a.result)==null?void 0:E.data)==null?void 0:O.tables[b]).rows[T][p]=x,x==="bool"&&(((k=(P=a==null?void 0:a.result)==null?void 0:P.data)==null?void 0:k.tables[b]).rows[T][p+1]=!1))}})}return _.type}}:y.name==="value"&&u.name===b?{...w,render:(_,T)=>{const V=u.crows?u.crows[T][p]:null;if(ee.value){const x=$(Xa,{value:+_.value,class:V!=_.value?"outline outline-red-500 w-full":"w-full",onUpdateValue(N){var E,O,P,k,J,U;(O=(E=a==null?void 0:a.result)==null?void 0:E.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[b])&&(((U=(J=a==null?void 0:a.result)==null?void 0:J.data)==null?void 0:U.tables[b]).rows[T][p]=N)}}),z=$(va,{value:String(_.value),class:V!==_.value?"!outline !outline-red-500":"",onUpdateValue(N){var E,O,P,k,J,U;(O=(E=a==null?void 0:a.result)==null?void 0:E.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[b])&&(((U=(J=a==null?void 0:a.result)==null?void 0:J.data)==null?void 0:U.tables[b]).rows[T][p]=N)}}),D=$("div",{class:"flex gap-2 h-[34px] leading-[34px]"},[$("div",{class:V!=_.value?"outline outline-red-500":""},$(ba,{lineClamp:1},{default:()=>_.value})),$(ve,{type:"info",size:"tiny",class:"!h-[34px] !w-[34px]",onClick:()=>{j.value={show:!0,info:{rowIdx:T,cidx:p,value:_.value}}}},{icon:()=>$(nr)})]),Y=$(Ya,{class:V!=_.value?"!outline !outline-red-500 w-32":"w-32",checkedValue:"true",uncheckedValue:"false",onUpdateValue:N=>{var E,O,P,k,J,U;(O=(E=a==null?void 0:a.result)==null?void 0:E.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[b])&&(((U=(J=a==null?void 0:a.result)==null?void 0:J.data)==null?void 0:U.tables[b]).rows[T][p]=N)}});return $("div",{class:"flex items-center"},ja([["float","int"].includes(_.type)?x:null,["str","complex"].includes(_.type)?z:null,["dict","list","tuple","ndarray"].includes(_.type)?D:null,["bool"].includes(_.type)?Y:null]))}return _.value}}:w});ee.value&&u.name===b&&v.push({title:M("expInfo.tableOptions"),key:"options",width:100,align:"rigth",render(y,p){const w=u.columns.findIndex(x=>x.name==="type"),_=u.crows?u.crows[p][w]:null,T=u.columns.findIndex(x=>x.name==="value"),V=u.crows?u.crows[p][T]:null;return $(ve,{type:"info",size:"small",class:"!h-[34px]",onClick:()=>{var x,z,D,Y,N,E,O,P;(z=(x=a==null?void 0:a.result)==null?void 0:x.data)!=null&&z.tables&&((Y=(D=a==null?void 0:a.result)==null?void 0:D.data)!=null&&Y.tables[b])&&(((E=(N=a==null?void 0:a.result)==null?void 0:N.data)==null?void 0:E.tables[b]).rows[p][T]=V,((P=(O=a==null?void 0:a.result)==null?void 0:O.data)==null?void 0:P.tables[b]).rows[p][w]=_)}},{icon:()=>$(wa,{component:Ta})})}}),u.name===b&&ee.value&&v.unshift({type:"selection",key:"selection"}),d.push({oname:u.name,name:u.name===b?M("expInfo.needUpdateParams"):u.name===jt?M("expInfo.updatedParams"):u.name,columns:v,rows:f})});const[l,g]=sr(d,{oname:jt});return[...l,...g]}),le=G(),Pe=G(),Te=async(d,l)=>{var h,u,f;const[g,m]=await qa({fitter_group_name:d});if(!g&&(m==null?void 0:m.status)===0){De.value=m.data;const v=(f=(u=(h=a==null?void 0:a.expInfo)==null?void 0:h.exp)==null?void 0:u.template)==null?void 0:f.split("/")[1];v&&m.data[v]&&l?(le.value=v,He(()=>{Re(v)})):(le.value=Object.keys(m.data)[0],He(()=>{Re(Object.keys(m.data)[0])}))}},Re=async d=>{if(ne.value)return;ne.value=!0;const[l,g]=await Ba({fitter_group_name:X.value,fitter_name:d,group_name:I.query.device_group_name,space_id:I.query.space_id});ne.value=!1,!l&&(g==null?void 0:g.status)===0&&(g.data.exp_id&&(g.data.exp_id.default=I.query.exp_id?Number(I.query.exp_id):null),Pe.value=g.data)},ke=d=>{Te(d)},ot=d=>{Re(d)},Le=G(),ft=async()=>{var m;const d=[];(m=_e.value)==null||m.forEach(h=>{h.rows.forEach(u=>{u.key&&d.push(u.key)})});const[l,g]=await Va({device_group_name:I.query.device_group_name,space_id:+(I.query.space_id||""),keys:d});!l&&(g==null?void 0:g.status)===0&&(Le.value=g.data)},ct=async()=>{var f;if(!pe.value||we.value)return;we.value=!0;const d=await((f=pe.value[0])==null?void 0:f.submit()),l=$a(d);if(Ot(l))return;const{device_group_name:g,space_id:m}=I.query,[h,u]=await Ga({setting:l,group_name:g,space_id:m,fitter_group:X.value,fitter_name:le.value});if(we.value=!1,!h&&(u==null?void 0:u.status)===0){a.result={...u.data,big_picture_url:"/"+u.data.plot_file_in_static};const[v,y]=await Ka("/"+u.data.table_file_in_static);v||(ee.value=!0,zt(y==null?void 0:y.tables,(p,w)=>{w===b&&(p.crows=JSON.parse(JSON.stringify(p.rows)),Me.value=p.crows.map(_=>_[0]))}),a.result={...a.result||{},data:y},He(()=>{ft()}))}},qe=async(d=!1)=>{var h,u,f,v,y;if(d){if(se.value)return;se.value=!0}else{if(re.value)return;re.value=!0}const l={group_name:I.query.device_group_name,space_id:I.query.space_id,exp_id:I.query.exp_id,task_id:((h=a.expInfo)==null?void 0:h.task_id)||"",img_file:((u=a.result)==null?void 0:u.plot_file)||"",table_file:((f=a.result)==null?void 0:f.table_file)||"",update_space_parameters:d};if(d){const p=(v=_e.value)==null?void 0:v.find(w=>w.oname===b);l.space_parameters=(y=Me.value)==null?void 0:y.map(w=>{var _;return(_=p.rows)==null?void 0:_.find(T=>T.key===w)})}const[g,m]=await Ha(l);!g&&(m==null?void 0:m.status)===0&&($e.success("Submit Successfully"),await Se(),ee.value=!1),d?se.value=!1:re.value=!1},Me=G(),dt=d=>{Me.value=d};xa(()=>{if(!I.query.exp_id){lt.back();return}ze(),Se()});const pt=()=>{qe()},_t=Vt(()=>{var l,g,m,h,u,f;const d=(g=(l=a.result)==null?void 0:l.data)!=null&&g.tables?(h=(m=a.result)==null?void 0:m.data)==null?void 0:h.tables[b]:null;if(!Ot(d)){const v=(u=d.columns)==null?void 0:u.findIndex(y=>y.name==="value");return v<0?!1:(f=d.crows)==null?void 0:f.some((y,p)=>y[v]!==d.rows[p][v])}return!1}),Je=()=>{j.value={show:!1,info:void 0}},gt=()=>{var m,h,u,f,v,y;const{rowIdx:d,cidx:l,value:g}=j.value.info;(h=(m=a==null?void 0:a.result)==null?void 0:m.data)!=null&&h.tables&&((f=(u=a==null?void 0:a.result)==null?void 0:u.data)!=null&&f.tables[b])&&(((y=(v=a==null?void 0:a.result)==null?void 0:v.data)==null?void 0:y.tables[b]).rows[d][l]=g),Je()};return Aa(()=>{a.result=void 0}),(d,l)=>{const g=Pa,m=Oa,h=ka,u=Qa,f=La,v=Za,y=er,p=Ca,w=Ea,_=Ia,T=Na,V=Fa;return C(),te("div",null,[K(w,{type:"card",placement:"top",animated:"",onUpdateValue:ke,value:i(X),"onUpdate:value":l[3]||(l[3]=x=>Jt(X)?X.value=x:null),class:"!h-full"},{default:L(()=>[(C(!0),te(it,null,Pt(i(ie),(x,z)=>(C(),ae(p,{key:z,name:z,tab:x.title,disabled:i(ne)},{default:L(()=>[K(_,{class:"p-3 min-h-[260px]"},{default:L(()=>[K(w,{type:"line",placement:"left",value:i(le),"onUpdate:value":l[2]||(l[2]=D=>Jt(le)?le.value=D:null),size:"small",onUpdateValue:ot,style:{height:"calc(100vh - 330px)"}},{default:L(()=>[(C(!0),te(it,null,Pt(i(De),(D,Y)=>(C(),ae(p,{key:Y,name:Y,tab:D.title,disabled:i(ne)},{default:L(()=>{var N,E,O,P,k,J;return[H("div",ir,[H("div",lr,[H("div",ur,[H("div",or,W(D.title),1),H("div",fr,W(D.desc),1)]),K(m,{show:i(ne)},{default:L(()=>{var U,xe;return[K(g,{style:{"max-height":"calc(100vh - 450px)"}},{default:L(()=>[i(Pe)&&!i(ne)?(C(),ae(za,{key:0,cfgs:i(Pe),ref_for:!0,ref_key:"dynamicFormRef",ref:pe},null,8,["cfgs"])):Ke("",!0)]),_:1}),(xe=(U=i(a))==null?void 0:U.expInfo)!=null&&xe.exp_id?(C(),te("div",cr,[K(i(ve),{type:"primary",onClick:ct,loading:i(we)},{default:L(()=>[Ee(W(i(M)("expInfo.ffitting")),1)]),_:1},8,["loading"])])):Ke("",!0)]}),_:1},8,["show"])]),H("div",{class:"flex-1 pl-3",style:Ra({borderLeft:`1px solid ${i(be).dividerColor}`})},[i(Ot)(i(a).result)?(C(),ae(h,{key:0,description:i(M)("expInfo.nores"),class:"mt-20"},null,8,["description"])):(C(),te(it,{key:1},[H("div",dr,[H("div",pr,[!((N=i(a).result)!=null&&N.plot_file)&&!((E=i(a).result)!=null&&E.table_file)&&((O=i(a).result)!=null&&O.create_time)?(C(),te("div",_r,[H("span",gr,W(i(M)("expInfo.resUploaded")),1),H("span",mr,W((P=i(a).result)==null?void 0:P.create_time),1)])):(C(),te("div",yr,W(i(M)("expInfo.result")),1))]),(k=i(a).result)!=null&&k.plot_file||(J=i(a).result)!=null&&J.table_file?(C(),te("div",hr,[i(_t)?(C(),ae(u,{key:0,onPositiveClick:pt},{trigger:L(()=>[K(i(ve),{loading:i(re),type:"primary",disabled:i(se)},{default:L(()=>[Ee(W(i(M)("expInfo.uploadOnly")),1)]),_:1},8,["loading","disabled"])]),default:L(()=>[Ee(" "+W(i(M)("expInfo.updateOnlyTips")),1)]),_:1})):(C(),ae(i(ve),{key:1,loading:i(re),type:"primary",onClick:l[0]||(l[0]=()=>qe()),disabled:i(se)},{default:L(()=>[Ee(W(i(M)("expInfo.uploadOnly")),1)]),_:1},8,["loading","disabled"])),K(i(ve),{loading:i(se),type:"primary",onClick:l[1]||(l[1]=()=>qe(!0)),disabled:i(re)},{default:L(()=>[Ee(W(i(M)("expInfo.uploadAndModifyParams")),1)]),_:1},8,["loading","disabled"])])):Ke("",!0)]),K(f,{class:"!my-2"}),K(g,{style:{"max-height":"calc(100vh - 400px)"}},{default:L(()=>{var U,xe;return[(U=i(a).result)!=null&&U.big_picture_url?(C(),ae(v,{key:0,src:i(Ma)((xe=i(a).result)==null?void 0:xe.big_picture_url,"t",String(+new Date)),alt:"",class:"max-w-full"},null,8,["src"])):Ke("",!0),(C(!0),te(it,null,Pt(i(_e),(ge,mt)=>(C(),te("div",{key:mt},[H("div",vr,W(ge.name),1),ge.oname===b?(C(),ae(y,{key:0,columns:ge.columns,data:ge.rows,"checked-row-keys":i(Me),"row-key":Ne=>Ne.key,"onUpdate:checkedRowKeys":dt},null,8,["columns","data","checked-row-keys","row-key"])):(C(),ae(y,{key:1,columns:ge.columns,data:ge.rows},null,8,["columns","data"]))]))),128))]}),_:2},1024)],64))],4)])]}),_:2},1032,["name","tab","disabled"]))),128))]),_:2},1032,["value"])]),_:2},1024)]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"]),K(V,{show:i(j).show,"onUpdate:show":l[5]||(l[5]=x=>i(j).show=x),"mask-closable":!1},{default:L(()=>[K(T,{style:{width:"1000px","min-height":"500px"},size:"huge",bordered:!1},{default:L(()=>[i(j).info?(C(),ae(i(Ja),{key:0,class:Ua(["w-full h-[70vh] overflow-auto",[i(be).baseColor==="#000"?"jse-theme-dark":""]]),modelValue:i(j).info.value,"onUpdate:modelValue":l[4]||(l[4]=x=>i(j).info.value=x),mode:"text"},null,8,["class","modelValue"])):Ke("",!0),H("div",br,[K(i(ve),{onClick:Je},{default:L(()=>[Ee(W(i(M)("common.cancel")),1)]),_:1}),K(i(ve),{type:"primary",onClick:gt},{default:L(()=>[Ee(W(i(M)("common.OK")),1)]),_:1})])]),_:1})]),_:1},8,["show"])])}}});export{$r as default};
