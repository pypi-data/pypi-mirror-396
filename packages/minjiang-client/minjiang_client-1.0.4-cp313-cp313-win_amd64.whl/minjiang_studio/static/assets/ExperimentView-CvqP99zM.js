import{d as D,e as k,f as u,aR as jt,h as r,a0 as Ee,F as se,r as V,a7 as E,w as c,i as n,v as Re,l as t,V as A,W as Ve,A as Mt,j as Et,aj as Ht,S as Qt,aM as Gt,b as St,K as Jt,C as Rt,c as Vt,o as Lt,a3 as Ft,b2 as $t,E as Y,b9 as Wt,L as Kt,aU as Yt,aw as Xt,as as Tt,a9 as qe,au as Zt,a8 as R,N as Q,O as ea,t as d,at as ta,am as aa,s as q,B as sa,T as oa,a6 as na,ba as It,af as la,aN as bt,aY as K,n as ia,b3 as ra,b4 as ca,av as pa,b5 as ke,b6 as kt,a2 as da,ay as ua,I as p,aq as _a,aA as fa,aB as ma}from"./index-BHd9xypC.js";import{b as xa,c as ga,e as va,f as ha,s as wa,h as ya,i as Ia,d as ba,j as ka,k as Ca,a as za}from"./exp-VCEEBlLK.js";import{h as qa,R as Ma}from"./RecordStop24Regular-Qo7SzBWJ.js";import{A as Ct,d as zt,f as Ea,F as qt}from"./FileSaver.min-d42zzFzh.js";import{u as Sa}from"./useInterval-B2bios_E.js";import{u as Ce}from"./exp-BmX6R77-.js";import{u as Ra}from"./groupDetail-DFK7jpc0.js";import{n as Va}from"./index.browser-OxPLOBIU.js";import{_ as La}from"./DataTable-08tqtwQR.js";import{o as Me}from"./index-BVShyVl-.js";import{_ as Fa,a as $a,H as Ta,D as Da,E as Na}from"./ExpsTpl-BXBwBsJ-.js";import{i as Oa}from"./json-editor-vue-DXYCBDpP.js";import{A as Pa}from"./Add-CMAgnUAh.js";import{F as Aa}from"./Folder-C04LPKmd.js";import{_ as Ba}from"./Image-D3gvlp1C.js";import{_ as Ua}from"./Badge-B5F7I3Cl.js";import{P as ja}from"./PulseSquare24Regular-Ng5sg-7S.js";import"./index-_045hRnh.js";import"./index-Due476Fm.js";import"./Copy16Filled-Cfb9i9ZZ.js";import"./HandRight24Filled-D73iODma.js";import"./Popconfirm-2ujZaRoc.js";import"./PaginationView.vue_vue_type_script_setup_true_lang-BxX_Je6t.js";import"./Pagination-DKvHZiJi.js";import"./Switch-t-7rbxnR.js";import"./Checkbox-DKKtBMeF.js";import"./RadioGroup-rQxCkFUy.js";import"./download-C2161hUv.js";import"./DynamicForm.vue_vue_type_script_setup_true_lang-jtwxeB2H.js";import"./InputNumber-Bb1z8BQ5.js";const Ha={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Qa=D({name:"QuadrantPlot",render:function(m,i){return u(),k("svg",Ha,i[0]||(i[0]=[jt('<path d="M30 15H17V2h-2v13H2v2h13v13h2V17h13v-2z" fill="currentColor"></path><path d="M5 30a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M8 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M22 13a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><circle cx="11" cy="11" r="2" fill="currentColor"></circle><circle cx="11" cy="21" r="2" fill="currentColor"></circle><circle cx="21" cy="21" r="2" fill="currentColor"></circle><circle cx="22" cy="28" r="2" fill="currentColor"></circle><circle cx="28" cy="24" r="2" fill="currentColor"></circle><circle cx="4" cy="11" r="2" fill="currentColor"></circle><circle cx="28" cy="4" r="2" fill="currentColor"></circle>',11)]))}}),Ga={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Ja=D({name:"ScriptReference",render:function(m,i){return u(),k("svg",Ga,i[0]||(i[0]=[r("path",{d:"M4 20v2h4.586L2 28.586L3.414 30L10 23.414V28h2v-8H4z",fill:"currentColor"},null,-1),r("path",{d:"M27.17 26l-2.58 2.58L26 30l4-4l-4-4l-1.42 1.41L27.17 26z",fill:"currentColor"},null,-1),r("path",{d:"M18.83 26l2.58-2.58L20 22l-4 4l4 4l1.42-1.41L18.83 26z",fill:"currentColor"},null,-1),r("path",{d:"M25.7 9.3l-7-7A.909.909 0 0 0 18 2H8a2.006 2.006 0 0 0-2 2v12h2V4h8v6a2.006 2.006 0 0 0 2 2h6v6h2v-8a.91.91 0 0 0-.3-.7zM18 10V4.4l5.6 5.6z",fill:"currentColor"},null,-1)]))}}),Wa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Ka=D({name:"BellOutlined",render:function(m,i){return u(),k("svg",Wa,i[0]||(i[0]=[r("path",{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z",fill:"currentColor"},null,-1)]))}}),Ya={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Xa=D({name:"ExperimentTwotone",render:function(m,i){return u(),k("svg",Ya,i[0]||(i[0]=[r("path",{d:"M551.9 513c19.6 0 35.9-14.2 39.3-32.8A40.02 40.02 0 0 1 552 512a40 40 0 0 1-40-39.4v.5c0 22 17.9 39.9 39.9 39.9zM752 687.8l-.3-.3c-29-17.5-62.3-26.8-97-26.8c-44.9 0-87.2 15.7-121 43.8a256.27 256.27 0 0 1-164.9 59.9c-41.2 0-81-9.8-116.7-28L210.5 844h603l-59.9-155.2l-1.6-1z","fill-opacity":".15",fill:"currentColor"},null,-1),r("path",{d:"M879 824.9L696.3 352V178H768v-68H256v68h71.7v174L145 824.9c-2.8 7.4-4.3 15.2-4.3 23.1c0 35.3 28.7 64 64 64h614.6c7.9 0 15.7-1.5 23.1-4.3c33-12.7 49.4-49.8 36.6-82.8zM395.7 364.7V180h232.6v184.7L719.2 600c-20.7-5.3-42.1-8-63.9-8c-61.2 0-119.2 21.5-165.3 60a188.78 188.78 0 0 1-121.3 43.9c-32.7 0-64.1-8.3-91.8-23.7l118.8-307.5zM210.5 844l41.6-107.6l.1-.2c35.7 18.1 75.4 27.8 116.6 27.8c61.2 0 119.2-21.5 165.3-60c33.9-28.2 76.3-43.9 121.3-43.9c35 0 68.4 9.5 97.6 27.1l.6 1.6L813.5 844h-603z",fill:"currentColor"},null,-1),r("path",{d:"M552 512c19.3 0 35.4-13.6 39.2-31.8c.6-2.7.8-5.4.8-8.2c0-22.1-17.9-40-40-40s-40 17.9-40 40v.6a40 40 0 0 0 40 39.4z",fill:"currentColor"},null,-1)]))}}),Za={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},es=D({name:"AttachArrowRight20Filled",render:function(m,i){return u(),k("svg",Za,i[0]||(i[0]=[r("g",{fill:"none"},[r("path",{d:"M5.28 10.609l5.304-5.304a2.75 2.75 0 0 1 4.064 3.697a5.487 5.487 0 0 1 1.611.285a4.252 4.252 0 0 0-6.736-5.042L4.22 9.548a.75.75 0 0 0 1.06 1.06zm2.829 4.95l.893-.894a5.48 5.48 0 0 0 .349 1.773l-.182.181A2.75 2.75 0 0 1 5.28 12.73l5.657-5.657a.75.75 0 1 1 1.06 1.06l-5.656 5.658a1.25 1.25 0 0 0 1.768 1.768zM19 14.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0zm-2.147.354l.003-.003a.499.499 0 0 0 .144-.348v-.006a.5.5 0 0 0-.146-.35l-2-2a.5.5 0 0 0-.708.707L15.293 14H12.5a.5.5 0 0 0 0 1h2.793l-1.147 1.146a.5.5 0 0 0 .708.708l2-2z",fill:"currentColor"})],-1)]))}}),ts={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},as=D({name:"BookDatabase20Regular",render:function(m,i){return u(),k("svg",ts,i[0]||(i[0]=[r("g",{fill:"none"},[r("path",{d:"M4 4v12a2 2 0 0 0 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8zM8.483 6.345C8.126 6.552 8 6.787 8 7c0 .213.126.448.483.655C8.841 7.863 9.374 8 10 8c.626 0 1.159-.137 1.517-.345c.357-.207.483-.442.483-.655c0-.213-.126-.448-.483-.655C11.159 6.137 10.626 6 10 6c-.626 0-1.159.137-1.517.345zM12 8.531c-.544.31-1.254.469-2 .469c-.747 0-1.456-.16-2-.47V11c0 .123.107.365.496.607c.367.228.9.393 1.504.393s1.137-.165 1.504-.393c.389-.242.496-.484.496-.607V8.53zM7 7c0-.687.434-1.202.981-1.52C8.528 5.163 9.245 5 10 5c.755 0 1.472.163 2.019.48c.547.318.981.833.981 1.52v4c0 .627-.452 1.135-.968 1.456c-.538.334-1.256.544-2.032.544s-1.494-.21-2.032-.544C7.452 12.136 7 11.627 7 11V7z",fill:"currentColor"})],-1)]))}}),ss={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},os=D({name:"Play24Regular",render:function(m,i){return u(),k("svg",ss,i[0]||(i[0]=[r("g",{fill:"none"},[r("path",{d:"M7.608 4.615a.75.75 0 0 0-1.108.659v13.452a.75.75 0 0 0 1.108.659l12.362-6.726a.75.75 0 0 0 0-1.318L7.608 4.615zM5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.726c1.566.853 1.566 3.101 0 3.953L8.325 20.702C6.826 21.518 5 20.432 5 18.726V5.274z",fill:"currentColor"})],-1)]))}});function Se(g){var I,o,M,e,b,z,L,N,w,O,B,oe,ne,le,ie,G,re,ce,pe,de,ue,_e,fe,me,xe;const m=Ce();m.expFolderId=String(g.data.exp_folder_id||"root"),m.expInfo=g.data,m.program={waveform_script:(o=(I=g.data)==null?void 0:I.exp)==null?void 0:o.waveform_script,space_parameter_script:(e=(M=g.data)==null?void 0:M.exp)==null?void 0:e.space_parameter_script},m.running={formValue:{title:(z=(b=g.data)==null?void 0:b.exp)==null?void 0:z.title,desc:(N=(L=g.data)==null?void 0:L.exp)==null?void 0:N.desc,...(O=(w=g.data)==null?void 0:w.exp)==null?void 0:O.options},paramsList:[]};const i=JSON.parse(JSON.stringify(m.allQubits));let C=[];Ee((ne=(oe=(B=g.data)==null?void 0:B.exp)==null?void 0:oe.wave_circuit)==null?void 0:ne.gates,U=>{C=C.concat(U.entity)}),C.length>0&&i.forEach(U=>{C.includes(U.value)?U.visible=!0:U.visible=!1}),m.allQubits=i,se((G=(ie=(le=g.data)==null?void 0:le.exp)==null?void 0:ie.wave_circuit)==null?void 0:G.gates)||(m.gates=(pe=(ce=(re=g.data)==null?void 0:re.exp)==null?void 0:ce.wave_circuit)==null?void 0:pe.gates),se((_e=(ue=(de=g.data)==null?void 0:de.exp)==null?void 0:ue.wave_circuit)==null?void 0:_e.layers)||(m.layers=Object.values((xe=(me=(fe=g.data)==null?void 0:fe.exp)==null?void 0:me.wave_circuit)==null?void 0:xe.layers))}const ns=D({__name:"MsgView",setup(g,{expose:m}){const i=Ce(),C=V(!1),I=[{title:"Message Id",key:"message_id",width:100},{title:"Sub Process Id",key:"sub_process_id",width:130},{title:"Message Level",key:"message_level",width:130},{title:"Message",key:"message"},{title:"Timestamp",key:"timestamp",width:180,render:e=>e.timestamp?new Date(e.timestamp).toLocaleString():""}],o=e=>{e||M()},M=()=>{C.value=!1};return m({open:()=>C.value=!0,close:M}),(e,b)=>{const z=La,L=Re,N=Ve;return u(),E(N,{show:t(C),"onUpdate:show":b[0]||(b[0]=w=>A(C)?C.value=w:null),"on-update:show":o},{default:c(()=>[n(L,{style:{width:"80vw"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true",class:"!pt-0"},{default:c(()=>{var w,O;return[n(z,{columns:I,data:(O=(w=t(i))==null?void 0:w.expInfo)==null?void 0:O.exp_msg,pagination:!1,"scroll-x":1e3,"max-height":"500px"},null,8,["data"])]}),_:1})]),_:1},8,["show"])}}}),ls=D({__name:"TemplateData",props:{templateData:{}},setup(g,{expose:m}){const i=V(),C=Mt(),I=V(!1);return m({open:()=>{I.value=!0}}),(M,e)=>{const b=Et,z=Ht,L=Re,N=Ve;return u(),E(N,{show:t(I),"onUpdate:show":e[0]||(e[0]=w=>A(I)?I.value=w:null)},{default:c(()=>[n(L,{style:{width:"700px"},"aria-hidden":""},{default:c(()=>[e[1]||(e[1]=r("div",{class:"text-xl text-center"},"Template Data",-1)),n(b,{class:"!my-2"}),n(z,{style:{"max-height":"600px","min-height":"200px"}},{default:c(()=>[n(t(Oa),{class:Qt(["w-full",[t(C).baseColor==="#000"?"jse-theme-dark":""]]),"model-value":M.templateData,mode:"text",ref_key:"jsonEditorRef",ref:i},null,8,["class","model-value"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),is={class:"min-h-[98px] flex justify-between"},rs={key:0,class:"flex flex-col pr-4 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},cs={class:"text-xl font-bold mr-2"},ps={class:"text-xl font-bold"},ds={class:"text-sm font-light mt-2 opacity-60"},us={class:"flex-1 flex"},_s={class:"flex flex-col gap-1.5 min-w-[260px] pr-5 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},fs={class:"flex"},ms={class:"inline-block pr-1"},xs={class:"font-bold"},gs={class:"inline-flex items-center"},vs={class:"flex-1 flex gap-1.5 min-w-[260px]"},hs={class:"flex flex-col gap-1.5 flex-1 mr-5"},ws={class:"flex"},ys={key:0,class:"pr-1"},Is={class:"font-bold"},bs={class:"z-breadcrumb-item__link"},ks={class:"flex items-center"},Cs={key:0,class:"italic opacity-70 pr-1 text-xs"},zs={key:1,class:"italic pr-1 text-xs"},qs={key:2,class:"ml-1"},Ms={class:"flex"},Es={key:1,class:"flex flex-col gap-2 min-w-52"},Ss={class:"flex gap-4 justify-between"},Rs={key:1},Vs={class:"flex gap-2"},Ls={class:"flex items-center gap-2"},Fs={class:"text-lg mb-4 flex justify-between"},$s={class:"text-lg mb-4 flex justify-between"},Ts={class:"relative"},Ds=D({__name:"ExpInfoView",setup(g){const m=Gt(),{t:i}=St(),C=Mt(),I=Jt(),o=Rt(),M=Vt(),e=Ce(),b=Ra(),z=V(),L=V(),N=()=>{var s,a,l;(a=(s=e.expInfo)==null?void 0:s.exp)!=null&&a.template&&((l=L.value)==null||l.open())},w=V(),O=async()=>{const s=o.query.device_group_name;if(!s)return;const[a,l]=await pa({device_group_name:s});if(!a&&(l==null?void 0:l.status)===0){const{space_list:f,..._}=l.data;b.groupInfo=_,b.spaceList=f.map(v=>({...v,label:v.space_name,value:v.space_id}))}},B=async()=>{var l;if(o.query.exp_id===void 0||o.query.exp_id==="")return;const[s,a]=await za({exp_id:o.query.exp_id,device_group_name:o.query.device_group_name,space_id:o.query.space_id});!s&&(a==null?void 0:a.status)===0&&((l=a.data)!=null&&l.data&&(a.data.data=JSON.parse(a.data.data)),e.result=a.data)},oe=async()=>{e.loading=!0;const{device_group_name:s,exp_id:a}=o.query;if(!s||!a){e.loading=!1;return}const[l,f]=await ka({device_group_name:s,exp_id:a});e.loading=!1,!l&&(f==null?void 0:f.status)===0&&(Se(f),Y(()=>{o.query.dup&&(_e(),Y(()=>{setTimeout(()=>{M.replace({name:"expSettings",query:Me(o.query,["dup","fid"])})},300)}))}),o.query.dup||B())},ne=async()=>{var l;if((l=e==null?void 0:e.expInfo)!=null&&l.status&&[K.COMPLETE,K.CANCELED,K.ERROR].includes(e.expInfo.status)){G();return}if(!o.query.exp_id){G();return}const[s,a]=await Ca({device_group_name:o.query.device_group_name,exp_id:o.query.exp_id});!s&&(a==null?void 0:a.status)===0&&(e.expInfo={...e.expInfo,...a.data||{}})},le=async()=>{var l,f;const[s,a]=await xa();if(!s&&(a==null?void 0:a.status)===0){const _={};Object.keys(a.data).forEach(S=>{_[S]=a.data[S].default?a.data[S].default:void 0});const v=(f=(l=e.expInfo)==null?void 0:l.exp)==null?void 0:f.options;e.expOptions=a.data,e.running={...e.running,formValue:{...e.running.formValue,...se(v)?_:{}}}}},{start:ie,stop:G}=Sa(ne,{isManual:!0,duration:3*1e3}),re=async()=>{const[s,a]=await ga();!s&&(a==null?void 0:a.status)===0&&(e.waveCompiler=a.data)},ce=async()=>{const[s,a]=await va();!s&&(a==null?void 0:a.status)===0&&(e.waveFunctions=a.data)},pe=async()=>{const[s,a]=await ha({device_group_name:o.query.device_group_name,space_id:o.query.space_id});if(!s&&(a==null?void 0:a.status)===0){let l=[];if(Ee(a.data,(f,_)=>{l=l.concat(f.map((v,S)=>({id:Va(),value:v,visible:S<10,type:_})))}),e.allQubits=l,!o.query.exp_id){const f=JSON.parse(JSON.stringify(e.allQubits));let _=[];Ee(e==null?void 0:e.gates,v=>{_=_.concat(v.entity)}),_.length>0&&f.forEach(v=>{_.includes(v.value)?v.visible=!0:v.visible=!1}),e.allQubits=f;return}Y(()=>{oe(),ie()})}},de=()=>{var s;(s=w.value)==null||s.open()},ue=()=>{const s=new URLSearchParams({device_group_name:o.query.device_group_name,task_id:o.query.task_id,task_title:o.query.task_title,space_id:o.query.space_id,exp_id:o.query.exp_id,dup:String(1),fid:e.expFolderId||"root"});window.open(`/experiment/expSettings?${s.toString()}`,m.expOpenForm)},_e=()=>{const s=JSON.parse(JSON.stringify(e.expInfo));delete s.exp_id,delete s.progress,delete s.status,delete s.exp_msg,e.expInfo=s,e.result=void 0,Y(()=>{I.success("Duplicated successfully"),M.replace({name:"expSettings",query:Me(o.query,["exp_id"])})})},fe=async()=>{const[s,a]=await wa({exp_id:o.query.exp_id});!s&&(a==null?void 0:a.status)===0&&I.success("实验终止成功")},me=()=>{var s;(s=z.value)==null||s.open()};Lt(()=>{le(),pe(),O(),$e(),setTimeout(()=>{re(),ce()},100)}),Ft(o,s=>{if(s.query.create=="1"){const a=$t("t"),l=s.query.fid;a&&(Se(a),Y(()=>{setTimeout(()=>{M.replace({name:"expSettings",query:Me(o.query,["create","fid"])}).then(()=>{l&&(e.expFolderId=l),localStorage.removeItem("t")})},200)}))}},{immediate:!0});const xe=async()=>{var ge,ve,he,we,ye,te,J,W,Ie,y,F,$,T,P;if(e.showPlotParamsModal)return;e.showPlotParamsModal=!0;const s={};(ge=e==null?void 0:e.layers)==null||ge.forEach((H,be)=>{s[String(be)]=H});const{title:a,desc:l,...f}=(ve=e.running)==null?void 0:ve.formValue,_={template_name:(we=(he=e==null?void 0:e.expInfo)==null?void 0:he.exp)==null?void 0:we.template.split("/")[1],device_group_name:o.query.device_group_name,space_id:o.query.space_id,task_id:(ye=e==null?void 0:e.expInfo)==null?void 0:ye.task_id,experiment_json:{...(e==null?void 0:e.expInfo)||{},title:a,desc:l,template:(J=(te=e==null?void 0:e.expInfo)==null?void 0:te.exp)==null?void 0:J.template,template_data:(Ie=(W=e==null?void 0:e.expInfo)==null?void 0:W.exp)==null?void 0:Ie.template_data,wave_circuit:{gates:(e==null?void 0:e.gates)||{},layers:s},waveform_script:((y=e==null?void 0:e.program)==null?void 0:y.waveform_script)||[],space_parameter_script:((F=e==null?void 0:e.program)==null?void 0:F.space_parameter_script)||[],options:f},exp_folder_id:e.expFolderId==="root"?null:e.expFolderId};($=_==null?void 0:_.experiment_json)!=null&&$.exp&&((T=_==null?void 0:_.experiment_json)==null||delete T.exp),(P=_==null?void 0:_.experiment_json)==null||delete P.nr;const[v,S]=await ya(_);e.showPlotParamsModal=!1,!v&&(S==null?void 0:S.status)===0&&(I.success("Experiment Running"),M.replace({name:"finalSetting",query:{...o.query,exp_id:S.data.exp_id}}).then(()=>{window.location.reload()}))};Wt(G);const U=async()=>{var l,f;const[s,a]=await Ia({group_name:o.query.device_group_name,exp_id:String((l=e==null?void 0:e.expInfo)==null?void 0:l.exp_id)});!s&&(a==null?void 0:a.status)===0&&qt.saveAs(`${ke(location.origin)}/${ke((f=a==null?void 0:a.data)==null?void 0:f.filename)}`,kt(a.data.filename))},Dt=async()=>{var l,f;const[s,a]=await ba({group_name:o.query.device_group_name,space_id:o.query.space_id,version:String((l=e.expInfo)==null?void 0:l.space_timestamp)});!s&&(a==null?void 0:a.status)===0&&qt.saveAs(`${ke(location.origin)}/${ke((f=a==null?void 0:a.data)==null?void 0:f.filename)}`,kt(a.data.filename))},X=V(!1),Nt=s=>{s||(X.value=!1)},ze=V(),j=V(),Ot=()=>{var s;(s=ze.value)==null||s.refresh()},Le=()=>{X.value=!0},Z=V(!1),Pt=s=>{s||(Z.value=!1,j.value="")},ee=V(!1),At=s=>{s||(ee.value=!1)},Bt=()=>{var s;(s=e.expInfo)!=null&&s.exp_id?ee.value=!0:Z.value=!0},Fe=Kt(()=>Yt(e.expFolderTree||[],e.expFolderId==="root"?null:+e.expFolderId)),Ut=({exp_folder_id:s})=>{const a={device_group_name:o.query.device_group_name,task_id:o.query.task_id,task_title:o.query.task_title,space_id:o.query.space_id};s&&(a.fid=String(s)||"");const l=new URLSearchParams(a);window.open(`/groupDetail/task/experimentList?${l.toString()}`)},$e=async()=>{var f;if(!o.query.device_group_name)return;const[a,l]=await qa({task_id:+(((f=o.query)==null?void 0:f.task_id)||""),include_experiments:!1});!a&&l&&l.status===0&&(Array.isArray(l.data.folder_tree)||(l.data.folder_tree=[l.data.folder_tree]),e.expFolderTree=l.data.folder_tree)};return Xt(()=>{$e()}),(s,a)=>{const l=Q,f=Tt("router-link"),_=aa,v=sa,S=oa,ge=Ba,ve=$a,he=Fa,we=Ua,ye=Zt,te=Et,J=Re,W=Ve,Ie=ia;return u(),k(qe,null,[n(ye,{type:"info","show-icon":!1},{default:c(()=>{var y,F,$,T,P,H,be,Te,De,Ne,Oe,Pe,Ae,Be,Ue,je,He,Qe,Ge,Je,We,Ke,Ye,Xe,Ze,et,tt,at,st,ot,nt,lt,it,rt,ct,pt,dt,ut,_t,ft,mt,xt,gt,vt,ht,wt;return[r("div",is,[(y=t(b))!=null&&y.groupInfo?(u(),k("div",rs,[n(f,{class:"underline underline-offset-4 inline-flex items-end gap-2",to:{name:"deviceGroup",query:{org:($=(F=t(b))==null?void 0:F.groupInfo)==null?void 0:$.organization_id}}},{default:c(()=>{var x;return[n(l,{size:"24",component:t(ea)},null,8,["component"]),r("span",cs,d((x=t(b).groupInfo)==null?void 0:x.organization_name),1)]}),_:1},8,["to"]),n(f,{class:"underline underline-offset-4 inline-flex items-end gap-2 mt-2",to:{name:"taskList",query:{device_group_name:t(o).query.device_group_name}}},{default:c(()=>{var x,h;return[n(l,{component:t(ta),size:"24"},null,8,["component"]),r("span",ps,d((h=(x=t(b))==null?void 0:x.groupInfo)==null?void 0:h.device_group_name),1)]}),_:1},8,["to"]),r("span",ds,d((P=(T=t(b))==null?void 0:T.groupInfo)==null?void 0:P.description),1)])):R("",!0),r("div",us,[(H=t(e))!=null&&H.expInfo?(u(),k(qe,{key:0},[r("div",_s,[r("div",fs,[r("span",ms,[n(_,{type:"success",size:"small",color:{color:"#b63636",textColor:"#fff"}},{default:c(()=>{var x,h;return[q(d(t(i)("expInfo.task"))+" "+d((h=(x=t(e))==null?void 0:x.expInfo)==null?void 0:h.task_id),1)]}),_:1})]),n(f,{to:{name:"experimentList",query:{device_group_name:t(o).query.device_group_name,task_id:(Te=(be=t(e))==null?void 0:be.expInfo)==null?void 0:Te.task_id,task_title:(Ne=(De=t(e))==null?void 0:De.expInfo)==null?void 0:Ne.task_title,space_id:t(o).query.space_id}},class:"underline underline-offset-4"},{default:c(()=>{var x,h;return[r("span",xs,d((h=(x=t(e))==null?void 0:x.expInfo)==null?void 0:h.task_title),1)]}),_:1},8,["to"]),n(v,{type:"primary",size:"small",class:"!ml-2 !h-[22px]",onClick:me},{icon:c(()=>[n(t(Pa))]),default:c(()=>[q(" "+d(t(i)("expInfo.create")),1)]),_:1})]),r("div",null,[r("span",gs,[q(d(t(i)("expInfo.space"))+"： ",1),n(_,{size:"small",class:"!cursor-pointer",type:"warning",onClick:Bt},{default:c(()=>{var x,h,ae,yt;return[q(d((h=(x=t(e))==null?void 0:x.expInfo)==null?void 0:h.space_name)+" ( "+d((yt=(ae=t(e))==null?void 0:ae.expInfo)==null?void 0:yt.space_time_str)+" ) ",1)]}),_:1}),n(S,{trigger:"hover"},{trigger:c(()=>[n(v,{type:"info",class:"!ml-1",size:"tiny",onClick:Dt},{icon:c(()=>[n(t(Ct))]),_:1})]),default:c(()=>[q(" "+d(t(i)("expInfo.downloadSpaceParams")),1)]),_:1})])]),r("div",null,d((Pe=(Oe=t(e))==null?void 0:Oe.expInfo)==null?void 0:Pe.task_desc),1)]),r("div",vs,[(Ae=t(e).result)!=null&&Ae.small_picture_url?(u(),E(ge,{key:0,src:t(It)((Be=t(e).result)==null?void 0:Be.small_picture_url,"t",String(+new Date)),"preview-src":((Ue=t(e).result)==null?void 0:Ue.big_picture_url)||t(It)((je=t(e).result)==null?void 0:je.small_picture_url,"t",String(+new Date)),alt:"",class:"mr-2 h-fit p-[1px] w-[100px]",style:na({border:`1px solid ${t(C).dividerColor}`})},null,8,["src","preview-src","style"])):R("",!0),r("div",hs,[r("div",ws,[(Qe=(He=t(e))==null?void 0:He.expInfo)!=null&&Qe.exp_id?(u(),k("span",ys,[n(_,{color:{color:"#7816ff",textColor:"#fff"},size:"small"},{default:c(()=>{var x,h;return[q(d(t(i)("expInfo.exp"))+" "+d((h=(x=t(e))==null?void 0:x.expInfo)==null?void 0:h.exp_id),1)]}),_:1})])):R("",!0),r("span",Is,d((Je=(Ge=t(e))==null?void 0:Ge.expInfo)==null?void 0:Je.exp_title),1),t(se)(t(Fe))?R("",!0):(u(),E(_,{key:1,bordered:!1,size:"small",class:"ml-2"},{default:c(()=>[n(he,null,{default:c(()=>[(u(!0),k(qe,null,la(t(Fe),(x,h)=>(u(),E(ve,{onClick:()=>Ut(x),separator:">",key:x.exp_folder_id},{default:c(()=>[r("span",bs,[h===0?(u(),E(l,{key:0,component:t(Ta)},null,8,["component"])):(u(),E(l,{key:1,component:t(Aa)},null,8,["component"])),q(" "+d(x.exp_folder_name),1)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}))]),r("div",ks,[(We=t(e).expInfo)!=null&&We.exp_id?(u(),k("span",Cs,d((Ye=(Ke=t(e))==null?void 0:Ke.expInfo)==null?void 0:Ye.create_time),1)):(u(),k("span",zs,[n(_,{size:"small",bordered:!1,color:{color:"#f00",textColor:"#fff"}},{default:c(()=>[q(d(t(i)("expInfo.unsumbit")),1)]),_:1})])),r("span",null,[n(_,{type:"warning",size:"small",onClick:N,class:"!cursor-pointer"},{default:c(()=>{var x,h,ae;return[q(d(((ae=(h=(x=t(e))==null?void 0:x.expInfo)==null?void 0:h.exp)==null?void 0:ae.template)||t(i)("expInfo.notpl")),1)]}),_:1})]),(Ze=(Xe=t(e))==null?void 0:Xe.expInfo)!=null&&Ze.source?(u(),k("span",qs,[n(_,{type:"info",size:"small",class:"!cursor-pointer"},{default:c(()=>{var x,h;return[q(d(t(i)("expInfo.source"))+": "+d((h=(x=t(e))==null?void 0:x.expInfo)==null?void 0:h.source),1)]}),_:1})])):R("",!0),(et=t(e).expInfo)!=null&&et.exp_id?(u(),E(S,{key:3,trigger:"hover"},{trigger:c(()=>[n(v,{type:"info",class:"!ml-1",size:"tiny",onClick:U},{icon:c(()=>[n(t(Ct))]),_:1})]),default:c(()=>[q(" "+d(t(i)("expInfo.downloadExp")),1)]),_:1})):R("",!0)]),r("div",Ms,d((at=(tt=t(e))==null?void 0:tt.expInfo)==null?void 0:at.exp_desc),1)])])],64)):R("",!0)]),(st=t(e))!=null&&st.expInfo?(u(),k("div",Es,[r("div",Ss,[(nt=(ot=t(e))==null?void 0:ot.expInfo)!=null&&nt.status?(u(),E(_,{key:0,color:{color:t(bt)[t(e).expInfo.status].color,textColor:"#fff"},size:"small"},{default:c(()=>[q(d(t(i)(t(bt)[t(e).expInfo.status].text)),1)]),_:1},8,["color"])):R("",!0),(it=(lt=t(e))==null?void 0:lt.expInfo)!=null&&it.progress?(u(),k("span",Rs,d((ct=(rt=t(e))==null?void 0:rt.expInfo)==null?void 0:ct.progress),1)):R("",!0),n(we,{value:(dt=(pt=t(e).expInfo)==null?void 0:pt.exp_msg)==null?void 0:dt.length,max:15,class:"cursor-pointer",onClick:de},{default:c(()=>[n(l,{size:22},{default:c(()=>[n(t(Ka))]),_:1})]),_:1},8,["value"])]),r("div",Vs,[n(v,{type:"info",size:"small",class:"flex-1",onClick:ue,disabled:((ft=(_t=(ut=t(e))==null?void 0:ut.expInfo)==null?void 0:_t.exp)==null?void 0:ft.exp_mode)==="batch_circuit"||!t(o).query.exp_id},{icon:c(()=>[n(t(Da))]),default:c(()=>[q(d(t(i)("expInfo.duplicate"))+" ",1)]),_:1},8,["disabled"]),n(v,{type:"info",size:"small",class:"flex-1",disabled:![t(K).SERVICE_QUEUING,t(K).RUNNING,t(K).HOST_DOWNLOADED].includes((mt=t(e).expInfo)==null?void 0:mt.status),onClick:fe},{icon:c(()=>[n(t(Ma))]),default:c(()=>[q(d(t(i)("expInfo.stop"))+" ",1)]),_:1},8,["disabled"])]),r("div",Ls,[n(v,{class:"flex-1",type:"primary",size:"small",loading:t(e).showPlotParamsModal,onClick:xe,disabled:!!((gt=(xt=t(e))==null?void 0:xt.expInfo)!=null&&gt.exp_id)},{icon:c(()=>[n(t(os))]),default:c(()=>[q(d(t(i)("expInfo.run"))+" ",1)]),_:1},8,["loading","disabled"])])])):R("",!0),n(ns,{ref_key:"msgViewRef",ref:w},null,512)]),n(Na,{ref_key:"expsTplRef",ref:z,fid:t(e).expFolderId||"root"},null,8,["fid"]),n(ls,{ref_key:"tempalteDataRef",ref:L,"template-data":(wt=(ht=(vt=t(e))==null?void 0:vt.expInfo)==null?void 0:ht.exp)==null?void 0:wt.template_data},null,8,["template-data"])]}),_:1}),n(W,{show:t(ee),"onUpdate:show":[a[0]||(a[0]=y=>A(ee)?ee.value=y:null),At],size:"huge"},{default:c(()=>[n(J,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:c(()=>{var y,F,$,T,P,H;return[r("div",Fs,[r("div",null,d(t(i)("expInfo.space"))+"： "+d((F=(y=t(e))==null?void 0:y.expInfo)==null?void 0:F.space_name)+" ( "+d((T=($=t(e))==null?void 0:$.expInfo)==null?void 0:T.space_time_str)+" ) ",1)]),n(te,{class:"!my-4"}),t(o).query.space_id?(u(),E(zt,{key:0,ref_key:"paramsLatestRef",ref:ze,"max-height":"65vh","read-only":"",version:(H=(P=t(e))==null?void 0:P.expInfo)==null?void 0:H.space_timestamp,"space-id":+t(o).query.space_id},null,8,["version","space-id"])):R("",!0)]}),_:1})]),_:1},8,["show"]),n(W,{show:t(Z),"onUpdate:show":[a[2]||(a[2]=y=>A(Z)?Z.value=y:null),Pt],size:"huge"},{default:c(()=>[n(J,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:c(()=>{var y,F,$,T;return[r("div",$s,[r("div",null,d(t(i)("expInfo.space"))+"： "+d((F=(y=t(e))==null?void 0:y.expInfo)==null?void 0:F.space_name)+" ( "+d((T=($=t(e))==null?void 0:$.expInfo)==null?void 0:T.space_time_str)+" ) ",1),r("div",Ts,[n(Ie,{style:{width:"310px","padding-right":"20px"},value:t(j),"onUpdate:value":a[1]||(a[1]=P=>A(j)?j.value=P:null),valueModifiers:{trim:!0},onKeyup:ra(Le,["enter"]),placeholder:t(i)("groupDetail.parameterManager.searchPlaceholder")},null,8,["value","placeholder"]),r("div",{class:"absolute -right-4 top-1/2 -translate-1/2 h-full w-8 flex items-center justify-center cursor-pointer",onClick:Le},[n(l,{color:t(C).primaryColor,component:t(ca)},null,8,["color","component"])])])]),n(te,{class:"!my-4"}),t(o).query.space_id?(u(),E(zt,{key:0,ref_key:"paramsLatestRef",ref:ze,"max-height":"65vh","space-id":+t(o).query.space_id},null,8,["space-id"])):R("",!0)]}),_:1})]),_:1},8,["show"]),n(W,{show:t(X),"onUpdate:show":a[4]||(a[4]=y=>A(X)?X.value=y:null),size:"huge",onUpdateShow:Nt},{default:c(()=>[n(J,{style:{"min-height":"82vh",overflow:"auto",width:"1300px","max-width":"95vw","min-width":"500px"}},{default:c(()=>[t(o).query.space_id?(u(),E(Ea,{key:0,search:"","space-id":+t(o).query.space_id,"hide-history-option":"",modelValue:t(j),"onUpdate:modelValue":a[3]||(a[3]=y=>A(j)?j.value=y:null),onRefresh:Ot},null,8,["space-id","modelValue"])):R("",!0)]),_:1})]),_:1},8,["show"])],64)}}}),Ns=da(Ds,[["__scopeId","data-v-d3d584ee"]]),Os={class:"flex mt-5"},Ps={class:"ml-5 flex-1"},vo=D({__name:"ExperimentView",setup(g){const{t:m}=St(),i=Rt(),C=Vt(),I=Ce(),o=V(),M=e=>{C.push({name:e,query:i.query})};return Ft(i,e=>{o.value=e.name},{deep:!0,immediate:!0}),Lt(()=>{const e=$t("t");se(e)||(I.reset(),Y(()=>{Se(e),localStorage.removeItem("t")}))}),(e,b)=>{const z=ua,L=_a,N=Tt("router-view");return u(),k("div",null,[n(Ns),r("div",Os,[n(L,{type:"card",animated:"",placement:"left",class:"!h-full !w-auto",value:t(o),"onUpdate:value":b[0]||(b[0]=w=>A(o)?o.value=w:null),onUpdateValue:M},{default:c(()=>{var w,O,B;return[n(z,{name:"expSettings",tab:p("div",{class:"flex items-center gap-2"},[p("div",{class:"flex items-center"},p(t(Q),{size:20},{default:()=>p(t(Xa))})),p("div",[p("div",{class:"font-bold"},t(m)("expInfo.expSettings"))])])},null,8,["tab"]),n(z,{name:"waveforms",tab:p("div",{class:"flex items-center gap-2"},[p("div",{class:"flex items-center"},p(t(Q),{size:20},{default:()=>p(t(ja))})),p("div",[p("div",{class:"font-bold"},t(m)("expInfo.waveforms"))])])},null,8,["tab"]),n(z,{name:"program",tab:p("div",{class:"flex items-center gap-2"},[p("div",{class:"flex items-center"},p(t(Q),{size:20},{default:()=>p(t(Ja))})),p("div",[p("div",{class:"font-bold"},t(m)("expInfo.program"))])])},null,8,["tab"]),n(z,{name:"finalSetting",disabled:!((w=t(I).expInfo)!=null&&w.exp_id),tab:p("div",{class:"flex items-center gap-2"},[p("div",{class:"flex items-center"},p(t(Q),{size:20},{default:()=>p(t(Qa))})),p("div",[p("div",{class:"font-bold"},t(m)("expInfo.plotter"))])])},null,8,["disabled","tab"]),n(z,{name:"result",disabled:!((O=t(I).expInfo)!=null&&O.exp_id),tab:p("div",{class:"flex items-center gap-2"},[p("div",{class:"flex items-center"},p(t(Q),{size:20},{default:()=>p(t(as))})),p("div",[p("div",{class:"font-bold"},t(m)("expInfo.fitting"))])])},null,8,["disabled","tab"]),n(z,{name:"attachment",disabled:!((B=t(I).expInfo)!=null&&B.exp_id),tab:p("div",{class:"flex items-center gap-2"},[p("div",{class:"flex items-center"},p(t(Q),{size:20},{default:()=>p(t(es))})),p("div",[p("div",{class:"font-bold"},t(m)("expInfo.attachment"))])])},null,8,["disabled","tab"])]}),_:1},8,["value"]),r("div",Ps,[n(N,null,{default:c(({Component:w})=>[(u(),E(fa,null,[(u(),E(ma(w),{key:e.$route.fullPath}))],1024))]),_:1})])])])}}});export{vo as default};
