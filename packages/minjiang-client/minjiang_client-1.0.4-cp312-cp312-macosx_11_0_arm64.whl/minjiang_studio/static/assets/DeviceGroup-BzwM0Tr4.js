import{d as ee,b as oe,c as ae,C as te,r as p,an as ne,aO as se,o as ie,I as L,ar as R,am as re,L as le,e as V,f as $,h as y,i as n,s as h,l as o,O as ue,N as de,t as m,w as r,a9 as _e,af as ce,a7 as pe,ay as me,cW as O,V as C,aq as ge,B as ve,cX as fe,v as ye,au as he,k as be,m as Ge,bX as xe,n as ke,W as ze,cY as we,cZ as Ne,ao as Le,c_ as $e,D as Ce,E as Ie,a2 as qe}from"./index-BHd9xypC.js";import{_ as Ue}from"./PaginationView.vue_vue_type_script_setup_true_lang-BxX_Je6t.js";import{A as Be}from"./Add-CMAgnUAh.js";import{N as Me}from"./Switch-t-7rbxnR.js";import{_ as Pe}from"./DataTable-08tqtwQR.js";import{_ as Re}from"./InputGroupLabel-D5Q01Jk6.js";import"./Pagination-DKvHZiJi.js";import"./Checkbox-DKKtBMeF.js";import"./RadioGroup-rQxCkFUy.js";import"./download-C2161hUv.js";const Ve={class:"flex"},Oe={class:"text-xl mt-[26px] flex items-center gap-1"},Ee={class:"flex justify-between items-center w-full"},Se={class:"flex-1"},Te={class:"text-xl"},je={class:"flex justify-end"},Ae=ee({__name:"DeviceGroup",setup(We){const{t:s}=oe(),E=ae(),k=te(),g=p(!1),I=p(),_=p({description:void 0,device_group_name:void 0}),S={description:{required:!0,message:s("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:s("deviceGroup.groupNameErrMsg")}},q=()=>{g.value=!1,_.value={description:void 0,device_group_name:void 0}},T=()=>{var a;d.value||(d.value=!0,(a=I.value)==null||a.validate(async e=>{if(e){d.value=!1;return}const[i,u]=await we({..._.value,device_group_name:`${U.value}_${_.value.device_group_name}`,organization_id:l.value});d.value=!1,!i&&u&&u.status===0&&v()}))},j=a=>{a||q()},z=p(),b=ne({page:1,per_page:se,total:0}),d=p(!1),l=p(),v=async a=>{d.value=!0,z.value=void 0;const[e,i]=await Ne({...Le(b),org_id:a||l.value});d.value=!1,!e&&i&&i.status===0&&(z.value=i.data.list,b.total=i.data.total),g.value&&q()},A=async(a,e)=>{const[i,u]=await $e({device_id:e,hidden:!a});!i&&(u==null?void 0:u.status)===0&&v()},f=p(),W=async()=>{var i,u;const[a,e]=await Ce();if(!a&&(e==null?void 0:e.status)===0){f.value=(i=e.data)==null?void 0:i.organizations;const G=(u=e.data)==null?void 0:u.organizations;if(k.query.org&&e.data.organizations.some(c=>c.organization_id===+(k.query.org||"")))l.value=+k.query.org,Ie(()=>{v()});else if(G&&G.length>0){const c=G[0].organization_id;c&&(l.value=c,v(c))}}};ie(()=>{W()});const X=[{title:s("deviceGroup.groupId"),key:"device_group_id"},{title:s("deviceGroup.groupName"),key:"device_group_name"},{title:s("deviceGroup.description"),key:"description"},{title:s("deviceGroup.createTime"),key:"create_time"},{title:s("createuser"),key:"user_name"},{title:s("deviceGroup.status"),key:"status",render:a=>{var e;if(a.status)return L(re,{type:((e=R[a.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return s((i=R[a.status])==null?void 0:i.text)}})}},{title:s("deviceGroup.show2desktop"),key:"status",render:a=>{if(a.status)return L("div",{onClick:e=>e.stopPropagation()},L(Me,{value:!a.hidden,onUpdateValue:e=>A(e,a.device_group_id)}))}}],D=({device_group_name:a})=>({class:"cursor-pointer",onClick:()=>{E.push({name:"overview",query:{device_group_name:a}})}}),U=le(()=>{var a,e;return(e=(a=f.value)==null?void 0:a.find(i=>i.organization_id==l.value))==null?void 0:e.organization_name});return(a,e)=>{var M,P;const i=de,u=me,G=ge,c=ve,F=Pe,H=he,w=Ge,K=Re,B=ke,Y=xe,Z=be,J=ye,Q=ze;return $(),V("div",Ve,[y("div",null,[y("div",Oe,[n(i,{component:o(ue)},null,8,["component"]),h(" "+m(o(s)("org.orgList")),1)]),n(G,{placement:"left","bar-width":300,type:"card",value:o(l),"onUpdate:value":[e[0]||(e[0]=t=>C(l)?l.value=t:null),v],class:"pr-5 mt-7"},{default:r(()=>[($(!0),V(_e,null,ce(o(f),t=>($(),pe(u,{key:t.organization_id,name:t.organization_id,disabled:o(d),class:"min-w-[200px]"},{default:r(()=>[y("div",Ee,[h(m(t.organization_name)+" ",1),n(O,{role:t.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),y("div",Se,[n(fe,{title:(P=(M=o(f))==null?void 0:M.find(t=>t.organization_id==o(l)))==null?void 0:P.organization_name},{tag:r(()=>{var t,x;return[n(O,{role:(x=(t=o(f))==null?void 0:t.find(N=>N.organization_id==o(l)))==null?void 0:x.user_role},null,8,["role"])]}),extra:r(()=>[n(c,{type:"primary",onClick:e[1]||(e[1]=t=>g.value=!0)},{icon:r(()=>[n(o(Be))]),default:r(()=>[h(" "+m(o(s)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),n(F,{columns:X,data:o(z),pagination:!1,loading:o(d),"row-props":D},null,8,["data","loading"]),n(Ue,{"page-info":o(b),"onUpdate:pageInfo":e[2]||(e[2]=t=>C(b)?b.value=t:null),onUpdateList:v},null,8,["page-info"]),n(Q,{show:o(g),"onUpdate:show":e[5]||(e[5]=t=>C(g)?g.value=t:null),"on-update:show":j},{default:r(()=>[n(J,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[n(H,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[h(m(o(s)("deviceGroup.tips")),1)]),_:1}),n(Z,{ref_key:"formRef",ref:I,model:o(_),rules:S},{default:r(()=>[n(w,{label:o(s)("deviceGroup.orgName"),path:"orgName"},{default:r(()=>{var t,x;return[y("div",Te,m((x=(t=o(f))==null?void 0:t.find(N=>N.organization_id==o(l)))==null?void 0:x.organization_name),1)]}),_:1},8,["label"]),n(w,{label:o(s)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[n(Y,null,{default:r(()=>[n(K,null,{default:r(()=>[h(m(o(U))+"_ ",1)]),_:1}),n(B,{value:o(_).device_group_name,"onUpdate:value":e[3]||(e[3]=t=>o(_).device_group_name=t),placeholder:o(s)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["label"]),n(w,{label:o(s)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[n(B,{value:o(_).description,"onUpdate:value":e[4]||(e[4]=t=>o(_).description=t),placeholder:o(s)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),y("div",je,[n(c,{type:"primary",loading:o(d),onClick:T},{default:r(()=>[h(m(o(s)("deviceGroup.create")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])])}}}),oo=qe(Ae,[["__scopeId","data-v-5dc093ef"]]);export{oo as default};
