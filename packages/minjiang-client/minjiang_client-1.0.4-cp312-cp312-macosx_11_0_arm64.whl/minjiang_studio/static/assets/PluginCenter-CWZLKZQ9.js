import{bd as ce,bf as ue,bg as je,bb as Ee,d as T,I as j,b0 as Fe,bo as Ne,bp as ke,e7 as qe,L as X,r as C,ad as Ge,ah as We,cp as Ze,bu as Ke,cC as ve,c9 as he,cv as we,cD as xe,G as K,u as B,P as te,e as P,f as m,h as i,b as W,o as ne,a7 as D,W as _e,l as e,V as Z,w as n,i as t,v as le,k as ze,m as Le,n as Se,p as Xe,B as O,t as w,D as Ye,A as Je,a9 as E,a6 as ye,N as J,s as V,au as Qe,aj as ae,e8 as et,aI as pe,E as re,bV as tt,a2 as nt,a as $e,K as Pe,a8 as Q,T as Ve,ag as lt,an as Me,aO as st,a3 as ge,cX as Re,ao as Te,aG as fe,af as ee,ak as ot,am as Y,j as Ue,R as be,aH as me,aD as Ie,F as de,aF as it,b8 as Ce,at,e9 as rt,ap as ct,aq as ut}from"./index-BHd9xypC.js";import{b as dt}from"./index-_045hRnh.js";import{C as _t}from"./CommingSoon-qA5ocNS_.js";import{D as pt}from"./Delete24Regular-EYjDC_C_.js";import{_ as gt}from"./PaginationView.vue_vue_type_script_setup_true_lang-BxX_Je6t.js";import{_ as ft,C as mt,V as vt}from"./Version-BXwusFCE.js";import{_ as ht}from"./DataTable-08tqtwQR.js";import"./index-Due476Fm.js";import{A as wt}from"./Add-CMAgnUAh.js";import"./Image-D3gvlp1C.js";import"./download-C2161hUv.js";import"./Pagination-DKvHZiJi.js";import"./Checkbox-DKKtBMeF.js";import"./RadioGroup-rQxCkFUy.js";const xt=ce("split",`
 display: flex;
 width: 100%;
 height: 100%;
`,[ue("horizontal",`
 flex-direction: row;
 `),ue("vertical",`
 flex-direction: column;
 `),ce("split-pane-1",`
 overflow: hidden;
 `),ce("split-pane-2",`
 overflow: hidden;
 flex: 1;
 `),je("resize-trigger",`
 background-color: var(--n-resize-trigger-color);
 transition: background-color .3s var(--n-bezier);
 `,[ue("hover",`
 background-color: var(--n-resize-trigger-color-hover);
 `),Ee("&:hover",`
 background-color: var(--n-resize-trigger-color-hover);
 `)])]),yt=Object.assign(Object.assign({},ke.props),{direction:{type:String,default:"horizontal"},resizeTriggerSize:{type:Number,default:3},disabled:Boolean,defaultSize:{type:[String,Number],default:.5},"onUpdate:size":[Function,Array],onUpdateSize:[Function,Array],size:[String,Number],min:{type:[String,Number],default:0},max:{type:[String,Number],default:1},pane1Class:String,pane1Style:[Object,String],pane2Class:String,pane2Style:[Object,String],onDragStart:Function,onDragMove:Function,onDragEnd:Function,watchProps:Array}),bt=T({name:"Split",props:yt,slots:Object,setup(l){var v;const{mergedClsPrefixRef:s,inlineThemeDisabled:f}=Ne(l),p=ke("Split","-split",xt,qe,l,s),y=X(()=>{const{common:{cubicBezierEaseInOut:S},self:{resizableTriggerColor:x,resizableTriggerColorHover:h}}=p.value;return{"--n-bezier":S,"--n-resize-trigger-color":x,"--n-resize-trigger-color-hover":h}}),d=C(null),_=C(!1),u=Ge(l,"size"),b=C(l.defaultSize);!((v=l.watchProps)===null||v===void 0)&&v.includes("defaultSize")&&We(()=>b.value=l.defaultSize);const $=S=>{const x=l["onUpdate:size"];l.onUpdateSize&&we(l.onUpdateSize,S),x&&we(x,S),b.value=S},k=Ze(u,b),a=X(()=>{const S=k.value;if(typeof S=="string")return{flex:`0 0 ${S}`};if(typeof S=="number"){const x=S*100;return{flex:`0 0 calc(${x}% - ${l.resizeTriggerSize*x/100}px)`}}}),c=X(()=>l.direction==="horizontal"?{width:`${l.resizeTriggerSize}px`,height:"100%"}:{width:"100%",height:`${l.resizeTriggerSize}px`}),r=X(()=>{const S=l.direction==="horizontal";return{width:S?`${l.resizeTriggerSize}px`:"",height:S?"":`${l.resizeTriggerSize}px`,cursor:l.direction==="horizontal"?"col-resize":"row-resize"}});let g=0;const R=S=>{S.preventDefault(),_.value=!0,l.onDragStart&&l.onDragStart(S);const x="mousemove",h="mouseup",U=I=>{M(I),l.onDragMove&&l.onDragMove(I)},z=()=>{xe(x,document,U),xe(h,document,z),_.value=!1,l.onDragEnd&&l.onDragEnd(S),document.body.style.cursor=""};document.body.style.cursor=r.value.cursor,ve(x,document,U),ve(h,document,z);const o=d.value;if(o){const I=o.getBoundingClientRect();l.direction==="horizontal"?g=S.clientX-I.left:g=I.top-S.clientY}M(S)};function M(S){var x,h;const U=(h=(x=d.value)===null||x===void 0?void 0:x.parentElement)===null||h===void 0?void 0:h.getBoundingClientRect();if(!U)return;const{direction:z}=l,o=U.width-l.resizeTriggerSize,I=U.height-l.resizeTriggerSize,H=z==="horizontal"?o:I,F=z==="horizontal"?S.clientX-U.left-g:S.clientY-U.top+g,{min:N,max:A}=l,se=typeof N=="string"?he(N):N*H,oe=typeof A=="string"?he(A):A*H;let q=F;q=Math.max(q,se),q=Math.min(q,oe,H),typeof k.value=="string"?$(`${q}px`):$(q/H)}const L=f?Ke("split",void 0,y,l):void 0;return{themeClass:L==null?void 0:L.themeClass,onRender:L==null?void 0:L.onRender,cssVars:f?void 0:y,resizeTriggerElRef:d,isDragging:_,mergedClsPrefix:s,resizeTriggerWrapperStyle:r,resizeTriggerStyle:c,handleMouseDown:R,firstPaneStyle:a}},render(){var l,v,s,f,p;return(l=this.onRender)===null||l===void 0||l.call(this),j("div",{class:[`${this.mergedClsPrefix}-split`,`${this.mergedClsPrefix}-split--${this.direction}`,this.themeClass],style:this.cssVars},j("div",{class:[`${this.mergedClsPrefix}-split-pane-1`,this.pane1Class],style:[this.firstPaneStyle,this.pane1Style]},(s=(v=this.$slots)[1])===null||s===void 0?void 0:s.call(v)),!this.disabled&&j("div",{ref:"resizeTriggerElRef",class:`${this.mergedClsPrefix}-split__resize-trigger-wrapper`,style:this.resizeTriggerWrapperStyle,onMousedown:this.handleMouseDown},Fe(this.$slots["resize-trigger"],()=>[j("div",{style:this.resizeTriggerStyle,class:[`${this.mergedClsPrefix}-split__resize-trigger`,this.isDragging&&`${this.mergedClsPrefix}-split__resize-trigger--hover`]})])),j("div",{class:[`${this.mergedClsPrefix}-split-pane-2`,this.pane2Class],style:this.pane2Style},(p=(f=this.$slots)[2])===null||p===void 0?void 0:p.call(f)))}});function Ct(l){return K(B.getPluginList,l)}function kt(){return K(B.getLocalPluginList)}function zt(l){return te(B.createPlugin,l)}function Lt(l){return K(B.getPluginVersions,l)}function St(l){return te(B.packagePlugin,l)}function $t(l){return K(B.installPlugin,l)}function Pt(l){return K(B.unInstallPlugin,l)}function Vt(l){return te(B.globalVisible,l)}function Mt(l){return te(B.updatePlugin,l)}function Rt(l){return K(B.getPluginConfig,l)}const Tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ut=T({name:"Close",render:function(v,s){return m(),P("svg",Tt,s[0]||(s[0]=[i("path",{d:"M289.94 256l95-95A24 24 0 0 0 351 127l-95 95l-95-95a24 24 0 0 0-34 34l95 95l-95 95a24 24 0 1 0 34 34l95-95l95 95a24 24 0 0 0 34-34z",fill:"currentColor"},null,-1)]))}}),It={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Dt=T({name:"Play",render:function(v,s){return m(),P("svg",It,s[0]||(s[0]=[i("path",{d:"M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z",fill:"currentColor"},null,-1)]))}}),At={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Bt=T({name:"Map",render:function(v,s){return m(),P("svg",At,s[0]||(s[0]=[i("path",{d:"M16 24l-6.09-8.6A8.14 8.14 0 0 1 16 2a8.08 8.08 0 0 1 8 8.13a8.2 8.2 0 0 1-1.8 5.13zm0-20a6.07 6.07 0 0 0-6 6.13a6.19 6.19 0 0 0 1.49 4L16 20.52L20.63 14A6.24 6.24 0 0 0 22 10.13A6.07 6.07 0 0 0 16 4z",fill:"currentColor"},null,-1),i("circle",{cx:"16",cy:"9",r:"2",fill:"currentColor"},null,-1),i("path",{d:"M28 12h-2v2h2v14H4V14h2v-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V14a2 2 0 0 0-2-2z",fill:"currentColor"},null,-1)]))}}),Ht={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Ot=T({name:"Package",render:function(v,s){return m(),P("svg",Ht,s[0]||(s[0]=[i("path",{d:"M26 30H6a2 2 0 0 1-2-2V16a2 2 0 0 1 2-2h3v2H6v12h20V16h-3v-2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2z",fill:"currentColor"},null,-1),i("path",{d:"M13 20h6v2h-6z",fill:"currentColor"},null,-1),i("path",{d:"M20.59 8.59L17 12.17V2h-2v10.17l-3.59-3.58L10 10l6 6l6-6l-1.41-1.41z",fill:"currentColor"},null,-1)]))}}),jt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Et=T({name:"SwapOutlined",render:function(v,s){return m(),P("svg",jt,s[0]||(s[0]=[i("path",{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z",fill:"currentColor"},null,-1)]))}}),Ft={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 12 12"},Nt=T({name:"Add12Regular",render:function(v,s){return m(),P("svg",Ft,s[0]||(s[0]=[i("g",{fill:"none"},[i("path",{d:"M6 1.5a.5.5 0 0 0-1 0V5H1.5a.5.5 0 0 0 0 1H5v3.5a.5.5 0 0 0 1 0V6h3.5a.5.5 0 0 0 0-1H6V1.5z",fill:"currentColor"})],-1)]))}}),qt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Gt=T({name:"UninstallApp24Regular",render:function(v,s){return m(),P("svg",qt,s[0]||(s[0]=[i("g",{fill:"none"},[i("path",{d:"M21.695 15.147l.084.072a.75.75 0 0 1 .072.977l-.072.084l-2.22 2.219l2.22 2.22a.75.75 0 0 1 .072.976l-.072.084a.75.75 0 0 1-.977.072l-.084-.072l-2.22-2.22l-2.218 2.22a.75.75 0 0 1-.976.072l-.085-.072a.75.75 0 0 1-.072-.977l.072-.084l2.219-2.22l-2.218-2.218a.75.75 0 0 1-.073-.976l.072-.085a.75.75 0 0 1 .977-.072l.084.072l2.219 2.219l2.22-2.218a.75.75 0 0 1 .976-.073zM18.75 3A2.25 2.25 0 0 1 21 5.25v5.25a2.25 2.25 0 0 1-2.25 2.25h-6v6A2.25 2.25 0 0 1 10.5 21H5.25A2.25 2.25 0 0 1 3 18.75V5.25A2.25 2.25 0 0 1 5.25 3h13.5zm-7.5 9.749H4.5v6.001c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75v-6.001zm7.5-8.249h-6v6.75h6a.75.75 0 0 0 .75-.75V5.25a.75.75 0 0 0-.75-.75zm-7.5 0h-6a.75.75 0 0 0-.75.75v5.999l6.75.001V4.5z",fill:"currentColor"})],-1)]))}}),Wt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Zt=T({name:"InsertDriveFileOutlined",render:function(v,s){return m(),P("svg",Wt,s[0]||(s[0]=[i("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z",fill:"currentColor"},null,-1)]))}}),Kt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},De=T({name:"InstallDesktopFilled",render:function(v,s){return m(),P("svg",Kt,s[0]||(s[0]=[i("path",{d:"M20 17H4V5h8V3H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h4v2h8v-2h4c1.1 0 2-.9 2-2v-3h-2v3z",fill:"currentColor"},null,-1),i("path",{d:"M17 14l5-5l-1.41-1.41L18 10.17V3h-2v7.17l-2.59-2.58L12 9z",fill:"currentColor"},null,-1)]))}}),Xt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Yt=T({name:"UpgradeFilled",render:function(v,s){return m(),P("svg",Xt,s[0]||(s[0]=[i("path",{d:"M16 18v2H8v-2h8zM11 7.99V16h2V7.99h3L12 4L8 7.99h3z",fill:"currentColor"},null,-1)]))}}),Jt={class:"flex justify-end"},Qt={key:0},en={key:1},Ae=T({__name:"CreatePlugin",emits:["success"],setup(l,{expose:v,emit:s}){const f=s,{t:p}=W(),y=C(),d=C(!1),_=C(),u=C({plugin_name:void 0,description:void 0,must_be_installed:!1,auto_upgrade:!1,manager_user_ids:void 0,org_ids:void 0}),b={plugin_name:{required:!0,message:"common.required"},description:{required:!0,message:"common.required"},must_be_installed:{required:!0,message:"common.required"},auto_upgrade:{required:!0,message:"common.required"}},$=C(!1),k=()=>{$.value=!1,u.value={plugin_name:void 0,description:void 0,must_be_installed:!1,auto_upgrade:!1,manager_user_ids:void 0,org_ids:void 0}},a=x=>{x||k()},c=async()=>{const[x,h]=await zt({...u.value,manager_user_ids:[],org_ids:u.value.org_ids||[]});d.value=!1,!x&&h&&h.status===0&&setTimeout(()=>{k(),f("success")},100)},r=async()=>{const[x,h]=await Mt({...u.value,manager_user_ids:[],org_ids:u.value.org_ids||[]});d.value=!1,!x&&h&&h.status===0&&setTimeout(()=>{k(),f("success")},100)},g=()=>{var x;d.value||(d.value=!0,(x=_.value)==null||x.validate(async h=>{if(h){d.value=!1;return}y.value==="update"?r():c()}))},R=C(),M=async()=>{var U,z;const[x,h]=await Ye();!x&&(h==null?void 0:h.status)===0&&(R.value=(z=(U=h==null?void 0:h.data)==null?void 0:U.organizations)==null?void 0:z.map(o=>({...o,label:o.organization_name,value:o.organization_id})))};return ne(()=>{M()}),v({open:()=>$.value=!0,close:k,setValues:(x={})=>{u.value={...u.value,...x}},setType:x=>{y.value=x}}),(x,h)=>{const U=Se,z=Le,o=Xe,I=O,H=ze,F=le,N=_e;return m(),D(N,{show:e($),"onUpdate:show":h[3]||(h[3]=A=>Z($)?$.value=A:null),"on-update:show":a},{default:n(()=>[t(F,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:n(()=>[t(H,{ref_key:"formRef",ref:_,model:e(u),rules:b},{default:n(()=>[t(z,{label:e(p)("pluginCenter.pluginName"),path:"plugin_name"},{default:n(()=>[t(U,{disabled:e(y)==="update",value:e(u).plugin_name,"onUpdate:value":h[0]||(h[0]=A=>e(u).plugin_name=A),placeholder:e(p)("pluginCenter.pluginName")},null,8,["disabled","value","placeholder"])]),_:1},8,["label"]),t(z,{label:e(p)("pluginCenter.description"),path:"description"},{default:n(()=>[t(U,{type:"textarea",value:e(u).description,"onUpdate:value":h[1]||(h[1]=A=>e(u).description=A),placeholder:e(p)("pluginCenter.description")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(z,{label:e(p)("pluginCenter.visibleRange"),path:"org_ids"},{default:n(()=>[t(o,{filterable:"",multiple:"",clearable:"",placeholder:e(p)("pluginCenter.rangeTips"),value:e(u).org_ids,"onUpdate:value":h[2]||(h[2]=A=>e(u).org_ids=A),options:e(R)},null,8,["placeholder","value","options"])]),_:1},8,["label"]),i("div",Jt,[t(I,{type:"primary",loading:e(d),onClick:g},{default:n(()=>[e(y)==="update"?(m(),P("span",Qt,w(e(p)("pluginCenter.update")),1)):(m(),P("span",en,w(e(p)("pluginCenter.create")),1))]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),tn={class:"font-bold flex justify-between mt-1.5 pr-2"},nn={class:"h-full flex flex-col"},ln={class:"flex-1 flex items-center pl-2"},sn={class:"flex-1 py-3 pl-3"},on={class:"whitespace-pre-line"},an={key:1,class:"h-full flex justify-center items-center"},rn={class:"flex justify-end gap-2"},cn=T({__name:"PackageView",emits:["success"],setup(l,{expose:v,emit:s}){const f=s,{t:p}=W(),y=Je(),d=dt("pathops",[]),_=C(),u=C(),b=C(!1),$=C(),k=C({plugin_dir:void 0}),a={plugin_dir:{required:!0,message:"common.required"}},c=C(!1),r=C(!1),g=()=>{r.value=!1,u.value=void 0},R=()=>{c.value=!1,u.value=void 0,k.value={plugin_dir:void 0}},M=()=>{const z=d.value||[];z.unshift(k.value.plugin_dir),d.value=[...new Set(z)]},L=async()=>{if(u.value=void 0,b.value||(b.value=!0,!_.value))return;const[z,o]=await St({plugin_dir:_.value});b.value=!1,!z&&(o==null?void 0:o.status)===1&&(u.value={type:"error",text:o.msg}),!z&&o&&o.status===0&&(u.value={type:"success",text:o==null?void 0:o.data},f("success"))},S=()=>{var z;M(),_.value=(z=k.value)==null?void 0:z.plugin_dir,R()};ne(()=>{Array.isArray(d.value)||(d.value=[])}),v({open:()=>{r.value=!0},close:g});const x=z=>{_.value===z.key&&re(()=>{setTimeout(()=>{_.value=void 0},200)}),d.value=tt(d.value,z.label)},h=()=>{c.value=!0},U=z=>j("div",{className:"flex items-center gap-2"},[j(J,{onClick:()=>x(z),component:Zt}),j(pe,null,{default:()=>z.label}),j(J,{color:"#f00",style:"display: none",onClick:()=>x(z),component:pt})]);return(z,o)=>{const I=O,H=et,F=ae,N=Qe,A=bt,se=le,oe=_e,q=Se,He=Le,Oe=ze;return m(),P(E,null,[t(oe,{show:e(r),"onUpdate:show":o[1]||(o[1]=G=>Z(r)?r.value=G:null),"mask-closable":!1},{default:n(()=>[t(se,{style:{width:"1200px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true","content-class":"!p-4"},{default:n(()=>[t(A,{min:.1,max:.75,"default-size":"200px"},{1:n(()=>[i("div",tn,[V(w(e(p)("pluginCenter.plugin"))+" ",1),t(I,{type:"primary",size:"tiny",onClick:h},{icon:n(()=>[t(e(Nt))]),_:1})]),t(F,{style:{"max-height":"80vh","min-height":"500px"}},{default:n(()=>{var G;return[t(H,{indent:0,"collapsed-width":64,"collapsed-icon-size":22,options:(G=e(d))==null?void 0:G.map(ie=>({label:ie,key:ie})),"render-label":U,value:e(_),"onUpdate:value":o[0]||(o[0]=ie=>Z(_)?_.value=ie:null)},null,8,["options","value"])]}),_:1})]),2:n(()=>[i("div",nn,[i("div",{class:"flex justify-end gap-2 pb-2 border-b",style:ye({borderColor:e(y).dividerColor})},[i("div",ln,w(e(_)),1),t(I,{disabled:!e(_),type:"primary",loading:e(b),onClick:L},{icon:n(()=>[t(e(Dt))]),default:n(()=>[V(" "+w(e(p)("pluginCenter.package")),1)]),_:1},8,["disabled","loading"]),t(I,{type:"primary",onClick:g},{icon:n(()=>[t(e(Ut))]),_:1})],4),i("div",sn,[e(u)?(m(),D(N,{key:0,"show-icon":!1,type:e(u).type,class:"mb-5 max-h-48 overflow-y-auto"},{default:n(()=>[o[4]||(o[4]=i("div",null,"Result:",-1)),i("div",on,w(e(u).text),1)]),_:1},8,["type"])):(m(),P("div",an,[t(_t,{class:"h-full"})]))])])]),"resize-trigger":n(()=>[i("div",{style:ye({height:"100%",backgroundColor:e(y).dividerColor,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"8px"})},[t(e(J),{color:"white",size:16},{default:n(()=>[t(e(Et))]),_:1})],4)]),_:1})]),_:1})]),_:1},8,["show"]),t(oe,{show:e(c),"onUpdate:show":o[3]||(o[3]=G=>Z(c)?c.value=G:null),"mask-closable":!1,"auto-focus":!1},{default:n(()=>[t(se,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true","content-class":"!p-4"},{default:n(()=>[t(Oe,{ref_key:"formRef",ref:$,model:e(k),rules:a},{default:n(()=>[t(N,{class:"w-full mb-5",type:"info"},{default:n(()=>[V(w(e(p)("pluginCenter.packagePathPlaceholder")),1)]),_:1}),t(He,{label:e(p)("pluginCenter.packagePath"),path:"plugin_dir"},{default:n(()=>[t(q,{value:e(k).plugin_dir,"onUpdate:value":o[2]||(o[2]=G=>e(k).plugin_dir=G),clearable:""},null,8,["value"])]),_:1},8,["label"]),i("div",rn,[t(I,{type:"default",onClick:R},{default:n(()=>[V(w(e(p)("common.cancel")),1)]),_:1}),t(I,{type:"primary",loading:e(b),onClick:S},{default:n(()=>[V(w(e(p)("common.OK")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])],64)}}}),un=nt(cn,[["__scopeId","data-v-56486782"]]),dn="data:image/svg+xml,%3csvg%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='24.000000'%20height='24.000000'%20fill='none'%3e%3crect%20id='swap-box-fill'%20width='24.000000'%20height='24.000000'%20x='0.000000'%20y='0.000000'%20fill='rgb(255,255,255)'%20fill-opacity='0'%20/%3e%3cpath%20id='矢量%20100'%20d='M3%203L21%203C21.2652%203%2021.5196%203.10536%2021.7071%203.29289C21.8946%203.48043%2022%203.73478%2022%204L22%2020C22%2020.2652%2021.8946%2020.5196%2021.7071%2020.7071C21.5196%2020.8946%2021.2652%2021%2021%2021L3%2021C2.73478%2021%202.48043%2020.8946%202.29289%2020.7071C2.10536%2020.5196%202%2020.2652%202%2020L2%204C2%203.73478%202.10536%203.48043%202.29289%203.29289C2.48043%203.10536%202.73478%203%203%203L3%203ZM15%207L15%209L11%209L11%2011L15%2011L15%2013L18.5%2010L15%207ZM9%2017L9%2015L13%2015L13%2013L9%2013L9%2011L5.5%2014L9%2017Z'%20fill='rgb(99,226,183)'%20fill-rule='evenodd'%20/%3e%3c/svg%3e",_n="data:image/svg+xml,%3csvg%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='24.000000'%20height='24.000000'%20fill='none'%3e%3crect%20id='file-edit-fill'%20width='24.000000'%20height='24.000000'%20x='0.000000'%20y='0.000000'%20fill='rgb(255,255,255)'%20fill-opacity='0'%20/%3e%3cpath%20id='矢量%2044'%20d='M21%2015.243L21%2021.008C20.9997%2021.2712%2020.895%2021.5235%2020.7088%2021.7095C20.5226%2021.8955%2020.2702%2022%2020.007%2022L3.99302%2022C3.8617%2021.9991%203.73184%2021.9723%203.61087%2021.9212C3.48989%2021.8701%203.38017%2021.7957%203.28796%2021.7022C3.19575%2021.6087%203.12286%2021.4979%203.07346%2021.3762C3.02405%2021.2545%202.9991%2021.1243%203.00002%2020.993L3.00002%209L9.00002%209C9.26524%209%209.51959%208.89464%209.70713%208.70711C9.89467%208.51957%2010%208.26522%2010%208L10%202L20.002%202C20.553%202%2021%202.455%2021%202.992L21%206.757L12.001%2015.757L11.995%2019.995L16.241%2020.001L21%2015.243ZM21.778%208.808L23.192%2010.222L15.414%2018L13.998%2017.998L14%2016.586L21.778%208.808L21.778%208.808ZM3.00002%207L8.00002%202.003L8.00002%207L3.00002%207Z'%20fill='rgb(99,226,183)'%20fill-rule='evenodd'%20/%3e%3c/svg%3e",pn={class:"absolute top-0 right-0 inline-flex items-center gap-1"},gn=["src"],fn=["src"],mn=T({__name:"ActionView",props:{cfg:{},uid:{},id:{},visible:{type:Boolean}},emits:["visible:success","refresh"],setup(l,{emit:v}){const s=$e(),f=Pe(),{t:p}=W(),y=C(),d=v,_=l,u=C(!1),b=async()=>{const[r,g]=await Vt({plugin_id:_.id,visible:!_.visible});!r&&(g==null?void 0:g.status)===0&&(f.success(p("pluginCenter.setupSuccess")),d("visible:success"))},$=C(!1),k=async()=>{const[r,g]=await Rt({plugin_id:_.id});if(!r&&(g==null?void 0:g.status)===0)return g.data.org_list},a=async()=>{const r=await k();$.value=!0,re(()=>{setTimeout(()=>{var g,R,M;(g=y.value)==null||g.open(),(R=y.value)==null||R.setValues({plugin_name:_.cfg.plugin_name,plugin_id:_.cfg.plugin_id,description:_.cfg.description,must_be_installed:_.cfg.must_be_installed,auto_upgrade:_.cfg.auto_upgrade,manager_user_ids:void 0,org_ids:r==null?void 0:r.map(L=>L.organization_id)}),(M=y.value)==null||M.setType("update")},100)})},c=()=>{d("refresh")};return(r,g)=>{var M,L;const R=Ve;return m(),P(E,null,[i("div",pn,[e(u)?(m(),D(R,{key:0,placement:"top-start",trigger:"hover"},{trigger:n(()=>[i("img",{class:"w-5 cursor-pointer",src:e(dn),alt:"",onClick:b},null,8,gn)]),default:n(()=>[V(" "+w(e(p)("pluginCenter.visibleTips")),1)]),_:1})):Q("",!0),((M=e(s).info)==null?void 0:M.user_id)===r.uid||(L=e(s).info)!=null&&L.is_sys_admin?(m(),D(R,{key:1,placement:"top-start",trigger:"hover"},{trigger:n(()=>[i("img",{class:"w-5 cursor-pointer",src:e(_n),alt:"",onClick:a},null,8,fn)]),default:n(()=>[V(" "+w(e(p)("pluginCenter.edit")),1)]),_:1})):Q("",!0)]),e($)?(m(),D(Ae,{key:0,ref_key:"createPluginRef",ref:y,onSuccess:c},null,512)):Q("",!0)],64)}}}),Be=T({__name:"UploadFile",props:{url:{}},emits:["success"],setup(l,{emit:v}){const{t:s}=W(),f=l,p=v,y=Pe(),d=async({file:_,data:u,onFinish:b,onError:$,onProgress:k})=>{const a=new FormData;u&&Object.keys(u).forEach(g=>{a.append(g,u[g])}),a.append("plugin_file",_.file);const[c,r]=await te(f.url,a,{headers:{"Content-Type":"multipart/form-data"}});!c&&(r==null?void 0:r.status)===0?(b(),p("success"),y.success(s("pluginCenter.uploadSuccessfully"))):$()};return(_,u)=>{const b=ft;return m(),D(b,{"custom-request":d,"show-file-list":!1},{default:n(()=>[lt(_.$slots,"default")]),_:3})}}}),vn=T({__name:"VersionList",props:{pluginId:{}},setup(l,{expose:v}){const{t:s}=W(),f=l,p=C(!1),y=[{title:s("pluginCenter.version"),key:"full_version_code"},{title:s("pluginCenter.updateDesc"),key:"update_description"},{title:s("pluginCenter.hooks"),key:"hook",render:a=>a.hook||"-"},{title:s("pluginCenter.createTime"),key:"create_time",minWidth:100,render:a=>a.create_time?new Date(a.create_time).toLocaleString():"-"}],d=Me({page:1,per_page:st,total:0}),_=C(),u=async()=>{if(!f.pluginId||!p.value)return;const[a,c]=await Lt({...Te(d),plugin_id:f.pluginId});!a&&c&&c.status===0&&(_.value=c.data.list,d.total=c.data.total)},b=a=>{a||$()},$=()=>{p.value=!1};ge(()=>f.pluginId,a=>{a&&u()});const k=()=>{d.page=1,re(()=>{u()})};return v({open:()=>p.value=!0,close:$,fetchList:u}),(a,c)=>{const r=O,g=ht,R=le,M=_e;return m(),D(M,{show:e(p),"onUpdate:show":c[1]||(c[1]=L=>Z(p)?p.value=L:null),"on-update:show":b},{default:n(()=>[t(R,{style:{width:"80vw"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true",class:"!pt-0"},{default:n(()=>[t(Re,{title:e(s)("pluginCenter.versions")},{extra:n(()=>[i("div",null,[t(Be,{url:e(B).uploadVersion,data:{plugin_id:a.pluginId},onSuccess:k},{default:n(()=>[t(r,{type:"primary"},{icon:n(()=>[t(e(mt))]),default:n(()=>[V(" "+w(e(s)("pluginCenter.upload")),1)]),_:1})]),_:1},8,["url","data"])])]),_:1},8,["title"]),t(g,{columns:y,data:e(_),pagination:!1,"scroll-x":1e3},null,8,["data"]),t(gt,{"page-info":e(d),"onUpdate:pageInfo":c[0]||(c[0]=L=>Z(d)?d.value=L:null),onUpdateList:u},null,8,["page-info"])]),_:1})]),_:1},8,["show"])}}}),hn={class:"relative"},wn={class:"break-keep text-xl"},xn={class:"inline-block ml-2"},yn={class:"opacity-75 text-xs mt-2"},bn={class:"flex"},Cn={class:"break-keep pr-2"},kn={class:"flex flex-col gap-2 mt-2 min-h-[62px]"},zn={class:"mt-2"},Ln={class:""},Sn={class:"flex justify-around items-center gap-1"},$n=T({__name:"OnlinePlugin",setup(l,{expose:v}){const s=$e(),{t:f}=W(),p=C(),y=C(),d=c=>{var r;y.value=c,(r=p.value)==null||r.open()},_=C({loading:!1,id:void 0}),u=async(c,r,g)=>{var R;if(!((R=_.value)!=null&&R.loading)){if(_.value={loading:!0,id:g},r==="install"){const[M,L]=await $t({plugin_id:c.plugin_id});!M&&(L==null?void 0:L.status)===0&&k()}else if(r==="unInstall"){const[M,L]=await Pt({plugin_name:c.plugin_name});!M&&(L==null?void 0:L.status)===0&&k()}_.value={loading:!1}}},b=Me({page:1,per_page:999999999,total:0}),$=C(),k=async(c={})=>{const[r,g]=await Ct({...c,...Te(b)});!r&&g&&g.status===0&&($.value=g.data.list,b.total=g.data.total)};ne(()=>{k()});const a=()=>{b.page=1,re(k)};return v({refresh:a}),(c,r)=>{const g=J,R=Ve,M=pe,L=Ue,S=le,x=ot,h=me,U=fe,z=ae;return m(),P("div",null,[t(z,{style:{maxHeight:"calc(100vh - 160px)"}},{default:n(()=>[t(U,{cols:"4","x-gap":"20","y-gap":"20",class:"py-1 px-1.5"},{default:n(()=>[(m(!0),P(E,null,ee(e($),o=>(m(),D(h,{key:o.plugin_id},{default:n(()=>{var I,H;return[t(x,{show:((I=e(_))==null?void 0:I.loading)&&((H=e(_))==null?void 0:H.id)==o.plugin_id},{default:n(()=>[t(S,{rounded:"",style:{width:"100%"},"content-class":"!mb-0 !p-2",class:"hover:scale-103 hover:transform-gpu"},{default:n(()=>{var F;return[i("div",hn,[i("div",wn,[V(w(o.plugin_name)+" ",1),t(e(Y),{class:"ml-2",size:"small",type:o.installed?"success":"info",bordered:!1},{default:n(()=>[V(w(o.installed?e(f)("pluginCenter.INSTALLED"):e(f)("pluginCenter.UNINSTALLED")),1)]),_:2},1032,["type"]),o.full_path?(m(),D(R,{key:0,placement:"top-start",trigger:"hover"},{trigger:n(()=>[i("div",xn,[t(e(O),{type:"primary",size:"tiny",class:"relative top-0.5"},{default:n(()=>[t(g,{component:e(Bt)},null,8,["component"])]),_:1})])]),default:n(()=>[i("span",null,w(o.full_path),1)]),_:2},1024)):Q("",!0),t(mn,{id:o.plugin_id,visible:o.is_globally_visible,uid:o.create_uid,cfg:o,"onVisible:success":a,onRefresh:a},null,8,["id","visible","uid","cfg"])]),i("div",yn,[t(M,{"line-clamp":1},{default:n(()=>[V(w(o.description),1)]),_:2},1024)])]),t(L,{class:"!my-3"}),i("div",bn,[i("span",Cn,w(e(f)("pluginCenter.hooks"))+": ",1),t(M,{"line-clamp":1},{default:n(()=>[V(w(o.latest_version_hook),1)]),_:2},1024)]),i("div",kn,[i("div",null,[t(e(Y),{type:"warning",size:"small"},{default:n(()=>[V(w(e(f)("pluginCenter.localVersion"))+": "+w(o.local_version),1)]),_:2},1024),t(e(Y),{type:"warning",size:"small",class:"ml-2"},{default:n(()=>[V(w(e(f)("pluginCenter.latestVersionCode"))+": "+w(o.latest_version_code),1)]),_:2},1024)]),i("div",zn,[(F=e(s).info)!=null&&F.is_sys_admin?(m(),P(E,{key:0},[i("span",Ln,w(e(f)("pluginCenter.visible"))+": ",1),t(e(Y),{type:"error",size:"small"},{default:n(()=>[V(w(o.is_globally_visible?e(f)("pluginCenter.yes"):e(f)("pluginCenter.no")),1)]),_:2},1024)],64)):Q("",!0)])]),t(L,{class:"!my-3"}),i("div",Sn,[t(e(O),{type:"info",size:"small",class:"flex-1 !px-0.5",onClick:be(()=>d(o.plugin_id),["stop"])},{icon:n(()=>[t(e(vt))]),default:n(()=>[V(" "+w(e(f)("pluginCenter.versions")),1)]),_:2},1032,["onClick"]),t(e(O),{type:"info",size:"small",class:"flex-1",disabled:o.installed?!o.uninstall_enable:!1,onClick:be(()=>u(o,o.installed?"unInstall":"install",o.plugin_id),["stop"])},{icon:n(()=>[o.installed?(m(),D(e(Gt),{key:0})):(m(),D(e(De),{key:1}))]),default:n(()=>[V(w(o!=null&&o.installed?e(f)("pluginCenter.unInstall"):e(f)("pluginCenter.install"))+" ",1)]),_:2},1032,["disabled","onClick"]),t(e(O),{type:"info",size:"small",class:"flex-1",onClick:()=>u(o,"install",o.plugin_id),disabled:!o.need_update},{icon:n(()=>[t(e(Yt))]),default:n(()=>[V(w(e(f)("pluginCenter.update"))+" ",1)]),_:2},1032,["onClick","disabled"])])]}),_:2},1024)]),_:2},1032,["show"])]}),_:2},1024))),128))]),_:1})]),_:1}),t(vn,{"plugin-id":e(y),ref_key:"versionModalRef",ref:p},null,8,["plugin-id"])])}}}),Pn={class:"relative"},Vn={class:"break-keep text-xl flex justify-between"},Mn={class:"opacity-75 text-xs mt-2"},Rn={class:"flex"},Tn={class:"break-keep pr-2"},Un={class:"flex mt-2 pb-3"},In={class:"pr-2"},Dn={class:"flex gap-2 flex-wrap"},An=T({__name:"LocalPlugin",setup(l,{expose:v}){const{t:s}=W(),f=C(),p=async()=>{const[y,d]=await kt();!y&&d&&d.status===0&&(f.value=d.data)};return v({refresh:p}),ne(()=>{p()}),(y,d)=>{const _=pe,u=Ue,b=le,$=me,k=fe,a=ae;return m(),P("div",null,[t(a,{style:{maxHeight:"calc(100vh - 160px)"}},{default:n(()=>[t(k,{cols:"4","x-gap":"20","y-gap":"20",class:"py-1 px-1.5"},{default:n(()=>[(m(!0),P(E,null,ee(e(f),(c,r)=>(m(),D($,{key:r},{default:n(()=>[t(b,{rounded:"",style:{width:"100%"},"content-class":"!mb-0 !p-2",class:"hover:scale-103 hover:transform-gpu"},{default:n(()=>[i("div",Pn,[i("div",Vn,[i("div",null,w(c.plugin_name),1)]),i("div",Mn,[t(_,{"line-clamp":1},{default:n(()=>[V(w(c.desc),1)]),_:2},1024)])]),t(u,{class:"!my-3"}),i("div",Rn,[i("span",Tn,w(e(s)("pluginCenter.hooks"))+": ",1),t(_,{"line-clamp":1},{default:n(()=>{var g;return[V(w((g=c.hook)==null?void 0:g.join(", ")),1)]}),_:2},1024)]),i("div",Un,[i("span",In,w(e(s)("pluginCenter.localVersion"))+": ",1),i("div",Dn,[t(e(Y),{type:"warning",size:"small"},{default:n(()=>[V(w(c.version),1)]),_:2},1024)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])}}}),Bn={class:"text-lg font-bold"},Hn=T({__name:"UtilityGroups",setup(l){const v=Ie(),s=C(),f=async()=>{const[y,d]=await rt();!y&&(d==null?void 0:d.status)===0&&(s.value=d.data),v.refreshPluginUtilities&&(v.refreshPluginUtilities=!1)},p=X(()=>de(s.value)||de(s.value.by_group)&&de(s.value.without_group));return ne(()=>{f()}),ge(()=>v.refreshPluginUtilities,y=>{y&&f()}),(y,d)=>{const _=it,u=me,b=fe,$=ae;return m(),P("div",null,[e(p)?(m(),D(_,{key:0,class:"mt-40"})):(m(),D($,{key:1,style:{maxHeight:"calc(100vh - 160px)"}},{default:n(()=>{var k;return[t(b,{cols:4,"x-gap":20},{default:n(()=>{var a,c;return[(m(!0),P(E,null,ee((c=(a=e(s))==null?void 0:a.without_group)==null?void 0:c.map(r=>({...r,is_running:!0})),r=>(m(),D(u,{key:r.server_id},{default:n(()=>[t(Ce,{info:r,onRefresh:f},null,8,["info"])]),_:2},1024))),128))]}),_:1}),(m(!0),P(E,null,ee((k=e(s))==null?void 0:k.by_group,(a,c)=>(m(),P(E,{key:c},[i("div",Bn,[t(Re,{title:c,icon:e(at)},null,8,["title","icon"])]),t(b,{cols:4,"x-gap":20},{default:n(()=>[(m(!0),P(E,null,ee(a==null?void 0:a.map(r=>({...r,is_running:!0})),r=>(m(),D(u,{key:r.server_id},{default:n(()=>[t(Ce,{info:r,onRefresh:f},null,8,["info"])]),_:2},1024))),128))]),_:2},1024)],64))),128))]}),_:1}))])}}}),On={class:"flex justify-between items-center gap-5"},jn={class:"flex justify-end gap-2"},nl=T({__name:"PluginCenter",setup(l){const v=Ie(),{t:s}=W(),f=C(),p=C(),y=C(),d=C(),_=()=>{var a;(a=y.value)==null||a.open()},u=()=>{var a;(a=d.value)==null||a.open()},b=C(),$=C(),k=()=>{setTimeout(()=>{var a,c;(a=f.value)==null||a.refresh(),(c=p.value)==null||c.refresh()},500)};return ge(()=>v.pluginCenterActiveTab,a=>{a&&(b.value=a,v.pluginCenterActiveTab=void 0)},{immediate:!0}),(a,c)=>{const r=J,g=ct,R=ut;return m(),P("div",null,[t(R,{type:"card",animated:"",class:"!h-full !w-auto",value:e(b),"onUpdate:value":c[0]||(c[0]=M=>Z(b)?b.value=M:null),onUpdateValue:e($)},{suffix:n(()=>[i("div",On,[i("div",jn,[t(e(O),{type:"primary",onClick:u},{icon:n(()=>[t(e(Ot))]),default:n(()=>[V(" "+w(e(s)("pluginCenter.package")),1)]),_:1}),t(Be,{url:e(B).installFromLocal},{default:n(()=>[t(e(O),{type:"primary"},{icon:n(()=>[t(e(De))]),default:n(()=>[V(" "+w(e(s)("pluginCenter.installFromLocale")),1)]),_:1})]),_:1},8,["url"]),t(e(O),{type:"primary",onClick:_},{icon:n(()=>[t(r,null,{default:n(()=>[t(e(wt))]),_:1})]),default:n(()=>[V(" "+w(e(s)("pluginCenter.create")),1)]),_:1})])])]),default:n(()=>[t(g,{name:"online",tab:e(s)("pluginCenter.onlinePlugins")},{default:n(()=>[t($n,{ref_key:"onlinePluginRef",ref:p},null,512)]),_:1},8,["tab"]),t(g,{name:"local",tab:e(s)("pluginCenter.localPlugins")},{default:n(()=>[t(An,{ref_key:"localPluginRef",ref:f},null,512)]),_:1},8,["tab"]),t(g,{name:"utility",tab:e(s)("pluginCenter.utility")},{default:n(()=>[t(Hn)]),_:1},8,["tab"])]),_:1},8,["value","onUpdateValue"]),t(Ae,{ref_key:"createPluginRef",ref:y,onSuccess:k},null,512),t(un,{ref_key:"packageViewRef",ref:d},null,512)])}}});export{nl as default};
