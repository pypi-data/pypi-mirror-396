mirror-dedupe (0.2.10-1) noble; urgency=medium

  * Teach mirror-dedupe-scan to discover a concrete rsync_upstream using
    rsync daemon probes and only enable rsync when a working dists/ tree
    is found; wire rsync_upstream into the runtime so that rsync-based
    metadata syncs always use the discovered module path.
  * Add a new rsync_upstream key to repos-available/*.conf, populated by
    mirror-dedupe-scan when rsync discovery succeeds, and document this
    behaviour in config/repos-available/README.md and
    mirror-dedupe-scan(1).
  * Refresh shipped repos-available/*.conf, the example nginx
    mirror.conf and related documentation to match current configs.

 -- Tim Hosking <tim@mungerware.com>  Tue, 09 Dec 2025 14:30:00 +0000

mirror-dedupe (0.2.9-1) noble; urgency=medium

  * Add optional per-mirror storage_filters to repos-available/*.conf,
    allowing specific packages or pool paths to be excluded from download
    and storage without rewriting upstream indices. This is primarily
    intended for non-critical third-party mirrors (e.g. pruning nightly
    builds) and is not enabled by default.
  * Document storage_filters, exclude_packages and exclude_paths in the
    mirror-dedupe(1) manpage, including the implications for faithful
    mirroring.
  * Refresh the example nginx mirror.conf to match the set of Ubuntu
    mirror configs shipped with this release.

 -- Tim Hosking <tim@mungerware.com>  Mon, 08 Dec 2025 22:55:00 +0000

mirror-dedupe (0.2.8-1) noble; urgency=medium

  * Fix systemd service ExecStart to pass --config /etc/mirror-dedupe
    instead of a bare positional argument, so the service starts cleanly.
  * Stop installing config/repos-enabled/.gitkeep into /etc so the package
    no longer ships that placeholder file.

 -- Tim Hosking <tim@mungerware.com>  Sun, 07 Dec 2025 17:55:00 +0000

mirror-dedupe (0.2.7-1) noble; urgency=medium

  * Change mirror-dedupe-scan default distribution behaviour:
    - Stop auto-selecting a "primary" series via Release Version.
    - Use explicit --dist/--releases values exactly (with special "all").
    - When no suites are specified, behave as if --releases all was given.
  * Improve architecture discovery and logging:
    - Prefer curl -4 for fetching /dists/ and Release files.
    - Discover architectures/components across all selected suites.
    - Clean up per-suite logging during [3/4] discovery.
  * Add automatic GPG key verification using gpg with a temporary keyring
    against InRelease or Release/Release.gpg.
  * Make gpg a runtime dependency in debian/control.
  * Add a global architectures mask to mirror-dedupe.conf so all mirrors can
    be constrained to a specific arch set.
  * Refresh shipped repos-available/*.conf for Ubuntu, Debian and major
    third-party repos, and add nodesource-node22.
  * Expand and cross-link documentation:
    - Add full mirror-dedupe-scan reference and examples to
      config/repos-available/README.md.
    - Point the top-level README.md at the scanner docs.
    - Update mirror-dedupe-scan(1) man page for new distribution semantics.

 -- Tim Hosking <tim@mungerware.com>  Sun, 07 Dec 2025 17:10:00 +0000

mirror-dedupe (0.2.6-1) noble; urgency=medium

  * Add mirror-dedupe-scan console script to pyproject so debs install scanner.

 -- Tim Hosking <tim@mungerware.com>  Sun, 07 Dec 2025 16:45:00 +0000

mirror-dedupe (0.2.5-1) noble; urgency=medium

  * Fix Debian packaging so mirror-dedupe-scan console script is installed.

 -- Tim Hosking <tim@mungerware.com>  Sun, 07 Dec 2025 16:15:00 +0000

mirror-dedupe (0.2.4-1) noble; urgency=medium

  * Add ubuntu-cloud UCA mirror (epoxy, flamingo).
  * Update nginx mirror.conf with /ubuntu-cloud and symlinks.
  * Fix systemd unit to use /usr/bin/mirror-dedupe entrypoint.

 -- Tim Hosking <tim@mungerware.com>  Sun, 07 Dec 2025 15:40:00 +0000

mirror-dedupe (0.2.3-1) noble; urgency=medium

  * Fix: Add debhelper override to prevent service auto-start during installation
  * Use --no-start flag in dh_installsystemd to prevent dpkg hangs

 -- Tim Hosking <tim@mungerware.com>  Fri, 08 Nov 2025 21:16:00 +0000

mirror-dedupe (0.2.2-1) noble; urgency=medium

  * Fix: Remove [Install] section from service to prevent auto-start during package installation
  * Prevents dpkg hanging while waiting for long-running mirror sync to complete

 -- Tim Hosking <tim@mungerware.com>  Fri, 08 Nov 2025 20:55:00 +0000

mirror-dedupe (0.2.1-1) noble; urgency=medium

  * Fix: Replace Unicode symbols with ASCII for better terminal compatibility
  * Fix: Improve hardlink savings calculation accuracy

 -- Tim Hosking <tim@mungerware.com>  Tue, 29 Oct 2025 00:47:00 +0000

mirror-dedupe (0.2.0-1) noble; urgency=medium

  * Restructure to repos-available/repos-enabled pattern
  * Add pre-configured repository definitions (ubuntu, grafana, influxdb)
  * Simplify repository management with symlink-based enabling/disabling

 -- Tim Hosking <tim@mungerware.com>  Mon, 28 Oct 2025 23:04:00 +0000

mirror-dedupe (0.1.0-1) noble; urgency=medium

  * Initial release
  * Mirror synchronisation with intelligent deduplication
  * Support for multiple mirrors with global deduplication
  * Configurable via YAML files
  * Systemd timer support

 -- Tim Hosking <tim@mungerware.com>  Mon, 28 Oct 2025 19:33:00 +0000
