{"version":3,"file":"js/module_attachments.29639c9c.bundle.js","mappings":"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","sources":["webpack:///indico/modules/attachments/client/js/legacy.js","webpack:///indico/modules/attachments/client/js/package.js"],"sourcesContent":["// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n/* global ajaxDialog, build_url, confirmPrompt, handleAjaxError, handleFlashes, alertPopup */\n\nimport _ from 'lodash';\n\nimport {$T} from 'indico/utils/i18n';\n\n(function(global) {\n  const HISTORY_API_SUPPORTED = !!history.pushState;\n\n  function toggleFolder(evt) {\n    if ($(evt.target).closest('.actions').length) {\n      // ignore if it comes from inside the action panel\n      return;\n    }\n    $(this).toggleClass('collapsed').next('.sub-tree').find('td > div').slideToggle(150);\n  }\n\n  $(document).ready(() => {\n    $('.attachments > .i-dropdown').parent().dropdown();\n    if (!$('html').data('static-site')) {\n      setupAttachmentPreview();\n    }\n\n    $(document).on('click', '[data-attachment-editor]', function(evt) {\n      evt.preventDefault();\n      const $this = $(this);\n      if (this.disabled || $this.hasClass('disabled')) {\n        return;\n      }\n      const locator = $(this).data('locator');\n      const title = $(this).data('title');\n      const reloadOnChange = $this.data('reload-on-change') !== undefined;\n      openAttachmentManager(locator, title, reloadOnChange, $this);\n    });\n  });\n\n  function setupAttachmentPreview() {\n    const previewDialog = $('.js-preview-dialog');\n    const pageURL = location.href.replace(/#.*$/, '');\n\n    // Previewer not supported on mobile browsers\n    if ($.mobileBrowser) {\n      return;\n    }\n\n    $(window)\n      .on('hashchange', (e, initial) => {\n        if (location.hash.indexOf('#preview:') !== 0) {\n          $('.attachment-preview-dialog').trigger('ajaxDialog:close', [true]);\n        } else {\n          if (initial && HISTORY_API_SUPPORTED) {\n            const hash = location.hash;\n            // start with a clean state, i.e. [..., page, page+preview]\n            history.replaceState({}, document.title, pageURL);\n            history.pushState({}, document.title, location.href + hash);\n          }\n          const id = parseInt(location.hash.split('#preview:')[1], 10);\n          previewAttachment(id);\n        }\n      })\n      .triggerHandler('hashchange', [true]);\n\n    previewDialog.on('click', function(e) {\n      if (e.which !== 1 || e.shiftKey || e.metaKey || e.ctrlKey || e.altKey) {\n        // ignore middle clicks and modifier-clicks - people should be able to open\n        // an attachment in a new tab/window skipping the previewer, even if they use\n        // a weird mouse with less than three buttons.\n        return;\n      }\n      e.preventDefault();\n      location.hash = '#preview:{0}'.format($(this).data('attachmentId'));\n    });\n\n    function clearHash() {\n      if (HISTORY_API_SUPPORTED) {\n        // if we have the history api, we can assume that the previous state is the same page without\n        // a preview hash (since we ensure this in the initial/fake hashchange event on page load)\n        history.back();\n      } else {\n        // old browsers with no pushState support: the # will stay which is a bit ugly,\n        // but let's not break history (we WILL \"spam\" history though, but that's what you\n        // get when using ancient browsers)\n        location.hash = '';\n      }\n    }\n\n    function previewAttachment(id) {\n      const attachment = $('.attachment[data-previewable][data-attachment-id=\"{0}\"]'.format(id));\n      if (!attachment.length) {\n        clearHash();\n        return;\n      }\n      ajaxDialog({\n        url: build_url(attachment.attr('href'), {preview: '1'}),\n        title: attachment.data('title'),\n        dialogClasses: 'attachment-preview-dialog',\n        onClose(data) {\n          $('body').off('keydown.attachmentPreview');\n          $('html, body').removeClass('prevent-scrolling');\n          if (!data) {\n            // get rid of the hash if we closed the dialog manually (i.e. not using the back button,\n            // in which case the hash should already be gone)\n            clearHash();\n          }\n        },\n        onOpen(popup) {\n          const dialog = popup.canvas.closest('.ui-dialog');\n          dialog.prev('.ui-widget-overlay').addClass('attachment-preview-overlay');\n          popup.canvas\n            .find('.attachment-preview-content-wrapper, .js-close-preview')\n            .on('click', () => {\n              popup.canvas.trigger('ajaxDialog:close');\n            });\n          popup.canvas.find('.attachment-download').on('click', function() {\n            const $this = $(this);\n            const href = $this.attr('href');\n            $this.attr('href', build_url(href, {from_preview: '1', download: '1'}));\n            _.defer(() => {\n              $this.attr('href', href);\n            });\n          });\n          popup.canvas\n            .find('.attachment-preview-content, .attachment-preview-top-bar')\n            .on('click', e => {\n              e.stopPropagation();\n            });\n          $('body')\n            .add(dialog)\n            .on('keydown.attachmentPreview', e => {\n              if (e.which === $.ui.keyCode.ESCAPE) {\n                popup.canvas.trigger('ajaxDialog:close');\n              }\n            });\n          $('html, body').addClass('prevent-scrolling');\n          // for some reason the dialog is hidden when its position\n          // gets updated so we explicitly show it.\n          _.defer(() => {\n            dialog.show();\n          });\n        },\n        onLoadError(xhr) {\n          const hash = location.hash;\n          clearHash();\n          if (xhr.status === 404) {\n            alertPopup($T.gettext('This file no longer exists. Please reload the page.'));\n            return false;\n          } else if (xhr.status !== 403) {\n            return;\n          }\n          if (Indico.User && Indico.User.id !== undefined) {\n            alertPopup($T('You are not authorized to access this file.'), $T('Access Denied'));\n          } else {\n            const msg = $T('This file is protected. You will be redirected to the login page.');\n            confirmPrompt(msg, $T('Access Denied')).then(() => {\n              location.href = build_url(Indico.Urls.Login, {next: location.href + hash});\n            });\n          }\n          return false;\n        },\n      });\n    }\n  }\n\n  global.setupAttachmentTreeView = function setupAttachmentTreeView() {\n    $('.attachments-box').on('click', '.tree .expandable', toggleFolder);\n  };\n\n  global.setupAttachmentEditor = function setupAttachmentEditor() {\n    const editor = $('.attachment-editor');\n\n    function flagChanged() {\n      editor.trigger('ajaxDialog:setData', [true]);\n    }\n\n    editor\n      .on('click', '.tree .expandable', toggleFolder)\n      .on('click', '.js-dialog-action', function(e) {\n        e.preventDefault();\n        const $this = $(this);\n        let title = $this.data('title');\n        if (!title && title !== undefined) {\n          // if `data-title` is present without a value, fall back to the title attr\n          title = $this.attr('title') || $this.data('qtip-oldtitle');\n        }\n        ajaxDialog({\n          trigger: this,\n          url: $this.data('href'),\n          title,\n          hidePageHeader: true,\n          onClose(data) {\n            if (data) {\n              $('#attachments-container').html(data.attachment_list);\n              flagChanged();\n            }\n          },\n        });\n      })\n      .on('indico:confirmed', '.js-delete', function(e) {\n        e.preventDefault();\n\n        const $this = $(this);\n        $.ajax({\n          url: $this.data('href'),\n          method: $this.data('method'),\n          complete: IndicoUI.Dialogs.Util.progress(),\n          error: handleAjaxError,\n          success(data) {\n            $('#attachments-container').html(data.attachment_list);\n            handleFlashes(data, true, editor);\n            flagChanged();\n          },\n        });\n      });\n  };\n\n  function openAttachmentManager(itemLocator, title, reloadOnChange, trigger) {\n    reloadOnChange = reloadOnChange === undefined ? true : reloadOnChange;\n    ajaxDialog({\n      trigger,\n      url: build_url(Indico.Urls.AttachmentManager, itemLocator),\n      title: title || $T.gettext('Manage material'),\n      confirmCloseUnsaved: false,\n      hidePageHeader: true,\n      onClose(callbackData, customData) {\n        if (customData && reloadOnChange) {\n          location.reload();\n        } else if (customData && trigger) {\n          trigger.trigger('attachments:updated');\n        }\n      },\n    });\n  }\n\n  global.reloadManagementAttachmentInfoColumn = function reloadManagementAttachmentInfoColumn(\n    itemLocator,\n    column\n  ) {\n    $.ajax({\n      url: build_url(Indico.Urls.ManagementAttachmentInfoColumn, itemLocator),\n      method: 'GET',\n      error: handleAjaxError,\n      success(data) {\n        column.replaceWith(data.html);\n      },\n    });\n  };\n\n  global.messageIfFolderProtected = function messageIfFolderProtected(\n    protectionField,\n    folderField,\n    protectionInfo,\n    selfProtection,\n    inheritedProtection,\n    folderProtection\n  ) {\n    folderField.on('change', function() {\n      const selectedFolder = $(this);\n      if (protectionInfo[selectedFolder.val()] && !protectionField.prop('checked')) {\n        selfProtection.hide();\n        inheritedProtection.hide();\n        folderProtection\n          .find('.folder-name')\n          .html(selectedFolder.children('option:selected').text());\n        folderProtection.show();\n      } else {\n        folderProtection.hide();\n        selfProtection.toggle(protectionField.prop('checked'));\n        inheritedProtection.toggle(!protectionField.prop('checked'));\n      }\n    });\n    _.defer(() => {\n      folderField.triggerHandler('change');\n    });\n  };\n\n  global.setupAttachmentTooltipButtons = function setupAttachmentTooltipButtons() {\n    $('.attachments-tooltip-button').each(function() {\n      const button = $(this);\n      button.qtip({\n        content: {\n          text: button.next('.material_list'),\n        },\n        show: {\n          event: 'click',\n        },\n        hide: {\n          event: 'unfocus',\n        },\n        position: {\n          my: 'top right',\n          at: 'bottom left',\n        },\n        events: {\n          show() {\n            button.addClass('open');\n          },\n          hide() {\n            button.removeClass('open');\n          },\n        },\n        style: {\n          classes: 'material_tip',\n        },\n      });\n    });\n  };\n})(window);\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n/* global handleFlashes:false, handleAjaxError:false */\n\nimport packageStatusURL from 'indico-url:attachments.package_status';\n\nimport {indicoAxios, handleAxiosError} from 'indico/utils/axios';\nimport {$T} from 'indico/utils/i18n';\n\nwindow.setupGeneratePackage = function setupGeneratePackage(eventId) {\n  $('#filter_type input:radio').on('change', function() {\n    $('#form-group-sessions').toggle(this.value === 'sessions');\n    $('#form-group-contributions').toggle(this.value === 'contributions');\n    $('#form-group-dates').toggle(this.value === 'dates');\n  });\n  $('#filter_type input:radio:checked').trigger('change');\n\n  const $form = $('#download-package-form');\n  let closeLoader;\n\n  async function poll(taskId) {\n    let res;\n    try {\n      res = await indicoAxios.get(packageStatusURL({event_id: eventId, task_id: taskId}));\n    } catch (error) {\n      handleAxiosError(error);\n      closeLoader();\n      return;\n    }\n    if (res.data.download_url) {\n      window.location.href = res.data.download_url;\n      closeLoader();\n    } else {\n      poll(taskId);\n    }\n  }\n\n  $form.ajaxForm({\n    error(...args) {\n      closeLoader();\n      handleAjaxError(...args);\n    },\n    beforeSubmit() {\n      closeLoader = IndicoUI.Dialogs.Util.progress($T.gettext('Building package'));\n    },\n    success(data) {\n      if (data.success) {\n        poll(data.task_id);\n      } else {\n        handleFlashes(data, true, $form.find('.flashed-messages'));\n        closeLoader();\n      }\n    },\n  });\n};\n"],"names":["global","HISTORY_API_SUPPORTED","history","pushState","toggleFolder","evt","$","target","closest","length","this","toggleClass","next","find","slideToggle","document","ready","parent","dropdown","data","previewDialog","pageURL","location","href","replace","mobileBrowser","clearHash","back","hash","previewAttachment","id","attachment","format","ajaxDialog","url","build_url","attr","preview","title","dialogClasses","onClose","off","removeClass","onOpen","popup","dialog","canvas","prev","addClass","on","trigger","$this","from_preview","download","_","e","stopPropagation","add","which","ui","keyCode","ESCAPE","show","onLoadError","xhr","status","alertPopup","$T","gettext","Indico","User","undefined","msg","confirmPrompt","then","Urls","Login","window","initial","indexOf","replaceState","parseInt","split","triggerHandler","shiftKey","metaKey","ctrlKey","altKey","preventDefault","setupAttachmentPreview","disabled","hasClass","itemLocator","reloadOnChange","AttachmentManager","confirmCloseUnsaved","hidePageHeader","callbackData","customData","reload","openAttachmentManager","setupAttachmentTreeView","setupAttachmentEditor","editor","flagChanged","html","attachment_list","ajax","method","complete","IndicoUI","Dialogs","Util","progress","error","handleAjaxError","success","handleFlashes","reloadManagementAttachmentInfoColumn","column","ManagementAttachmentInfoColumn","replaceWith","messageIfFolderProtected","protectionField","folderField","protectionInfo","selfProtection","inheritedProtection","folderProtection","selectedFolder","val","prop","hide","children","text","toggle","setupAttachmentTooltipButtons","each","button","qtip","content","event","position","my","at","events","style","classes","packageStatusURL","_buildFlaskURL","bind","endpoint","rules","args","converters","event_id","defaults","trace","isDynamic","setupGeneratePackage","eventId","value","$form","closeLoader","async","poll","taskId","res","indicoAxios","get","task_id","handleAxiosError","download_url","ajaxForm","beforeSubmit"],"sourceRoot":""}