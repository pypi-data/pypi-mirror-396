"""
Pytest suite for puber.norm.norm_name.

Run with:
    pytest
or:
    python -m pytest
"""

import pytest
from puber.norm import norm_name


# --- test data ---
TEST_CASES = {
    # EN
    "Smith John David": "Smith J.D.",
    "Smith,John David": "Smith J.D.",
    "Smith, John David": "Smith J.D.",
    "Smith John": "Smith J.",
    "Smith,John": "Smith J.",
    "Smith, John": "Smith J.",
    "Smith J.D.": "Smith J.D.",
    "Smith,J.D.": "Smith J.D.",
    "Smith, J.D.": "Smith J.D.",
    "Smith J. D.": "Smith J.D.",
    "Smith,J. D.": "Smith J.D.",
    "Smith, J. D.": "Smith J.D.",
    "J.D. Smith": "Smith J.D.",
    "J.D.,Smith": "Smith J.D.",
    "J.D., Smith": "Smith J.D.",
    "J. D. Smith": "Smith J.D.",
    "J. D.,Smith": "Smith J.D.",
    "J. D., Smith": "Smith J.D.",
    "J. Smith": "Smith J.",
    "J.,Smith": "Smith J.",
    "J., Smith": "Smith J.",
    "Smith J D": "Smith J.D.",
    "Smith,J D": "Smith J.D.",
    "Smith, J D": "Smith J.D.",
    "Smith J": "Smith J.",
    "Smith,J": "Smith J.",
    "Smith, J": "Smith J.",
    "J D Smith": "Smith J.D.",
    "J D,Smith": "Smith J.D.",
    "J D, Smith": "Smith J.D.",
    "J Smith": "Smith J.",
    "J,Smith": "Smith J.",
    "J, Smith": "Smith J.",
    # EN-UPPER
    "SMITH JOHN DAVID": "Smith J.D.",
    "SMITH, JOHN DAVID": "Smith J.D.",
    "SMITH JOHN": "Smith J.",
    "SMITH J.D.": "Smith J.D.",
    "SMITH J. D.": "Smith J.D.",
    "J.D. SMITH": "Smith J.D.",
    "J. D. SMITH": "Smith J.D.",
    "J. SMITH": "Smith J.",
    "SMITH J D": "Smith J.D.",
    "SMITH J": "Smith J.",
    "J D SMITH": "Smith J.D.",
    "J SMITH": "Smith J.",
    # EN-LAST-AFTER-COMMA
    "John David, Smith": "Smith J.D.",
    "John David,Smith": "Smith J.D.",
    "Smith, John, David": "Smith J.D.",
    "Smith,John, David": "Smith J.D.",
    "Smith, John,David": "Smith J.D.",
    "Smith,John,David": "Smith J.D.",
    # EN-LAST-AFTER-COMMA UPPER
    "JOHN DAVID, SMITH": "Smith J.D.",
    "JOHN DAVID,SMITH": "Smith J.D.",
    "SMITH, JOHN, DAVID": "Smith J.D.",
    "SMITH,JOHN, DAVID": "Smith J.D.",
    "SMITH, JOHN,DAVID": "Smith J.D.",
    "SMITH,JOHN,DAVID": "Smith J.D.",
    # EN-FIRSTNAME-INIT-FAM
    "John D. Smith": "Smith J.D.",
    "John D.Smith": "Smith J.D.",
    "JOHN D. SMITH": "Smith J.D.",
    "JOHN D.SMITH": "Smith J.D.",
    # RU
    "Иванова Татьяна Михайловна": "Иванова Т.М.",
    "Иванова,Татьяна Михайловна": "Иванова Т.М.",
    "Иванова, Татьяна Михайловна": "Иванова Т.М.",
    "Иванова Татьяна": "Иванова Т.",
    "Иванова,Татьяна": "Иванова Т.",
    "Иванова, Татьяна": "Иванова Т.",
    "Иванова Т.М.": "Иванова Т.М.",
    "Иванова,Т.М.": "Иванова Т.М.",
    "Иванова, Т.М.": "Иванова Т.М.",
    "Иванова Т. М.": "Иванова Т.М.",
    "Иванова,Т. М.": "Иванова Т.М.",
    "Иванова, Т. М.": "Иванова Т.М.",
    "Т.М. Иванова": "Иванова Т.М.",
    "Т.М.,Иванова": "Иванова Т.М.",
    "Т.М., Иванова": "Иванова Т.М.",
    "Т. М. Иванова": "Иванова Т.М.",
    "Т. М.,Иванова": "Иванова Т.М.",
    "Т. М., Иванова": "Иванова Т.М.",
    "Т. Иванова": "Иванова Т.",
    "Т.,Иванова": "Иванова Т.",
    "Т., Иванова": "Иванова Т.",
    "Иванова Т М": "Иванова Т.М.",
    "Иванова,Т М": "Иванова Т.М.",
    "Иванова, Т М": "Иванова Т.М.",
    "Иванова Т": "Иванова Т.",
    "Иванова,Т": "Иванова Т.",
    "Иванова, Т": "Иванова Т.",
    "Т М Иванова": "Иванова Т.М.",
    "Т М,Иванова": "Иванова Т.М.",
    "Т М, Иванова": "Иванова Т.М.",
    "Т Иванова": "Иванова Т.",
    "Т,Иванова": "Иванова Т.",
    "Т, Иванова": "Иванова Т.",
    # RU UPPER
    "ИВАНОВА ТАТЬЯНА МИХАЙЛОВНА": "Иванова Т.М.",
    "ИВАНОВА, ТАТЬЯНА МИХАЙЛОВНА": "Иванова Т.М.",
    "ИВАНОВА ТАТЬЯНА": "Иванова Т.",
    "ИВАНОВА Т.М.": "Иванова Т.М.",
    "ИВАНОВА Т. М.": "Иванова Т.М.",
    "Т.М. ИВАНОВА": "Иванова Т.М.",
    "Т. М. ИВАНОВА": "Иванова Т.М.",
    "Т. ИВАНОВА": "Иванова Т.",
    "ИВАНОВА Т М": "Иванова Т.М.",
    "ИВАНОВА Т": "Иванова Т.",
    "Т М ИВАНОВА": "Иванова Т.М.",
    "Т ИВАНОВА": "Иванова Т.",
    # RU-LAST-AFTER-COMMA
    "Татьяна Михайловна, Иванова": "Иванова Т.М.",
    "Татьяна Михайловна,Иванова": "Иванова Т.М.",
    "Иванова, Татьяна, Михайловна": "Иванова Т.М.",
    "Иванова,Татьяна, Михайловна": "Иванова Т.М.",
    "Иванова, Татьяна,Михайловна": "Иванова Т.М.",
    "Иванова,Татьяна,Михайловна": "Иванова Т.М.",
    # RU-LAST-AFTER-COMMA UPPER
    "ТАТЬЯНА МИХАЙЛОВНА, ИВАНОВА": "Иванова Т.М.",
    "ТАТЬЯНА МИХАЙЛОВНА,ИВАНОВА": "Иванова Т.М.",
    "ИВАНОВА, ТАТЬЯНА, МИХАЙЛОВНА": "Иванова Т.М.",
    "ИВАНОВА,ТАТЬЯНА, МИХАЙЛОВНА": "Иванова Т.М.",
    "ИВАНОВА, ТАТЬЯНА,МИХАЙЛОВНА": "Иванова Т.М.",
    "ИВАНОВА,ТАТЬЯНА,МИХАЙЛОВНА": "Иванова Т.М.",
    # RU UPPER-WS-LOWER
    "ИВАНОВА Татьяна Михайловна": "Иванова Т.М.",
    "ИВАНОВА, Татьяна Михайловна": "Иванова Т.М.",
    "ИВАНОВА Татьяна": "Иванова Т.",
    "Татьяна М. ИВАНОВА": "Иванова Т.М.",
    # RU-FIRSTNAME-INIT-FAM
    "Татьяна М. Иванова": "Иванова Т.М.",
    "Татьяна М.Иванова": "Иванова Т.М.",
    "ТАТЬЯНА М. ИВАНОВА": "Иванова Т.М.",
    "ТАТЬЯНА М.ИВАНОВА": "Иванова Т.М.",
    # RU-WITH-DASH
    "Иванова-Петрова Татьяна Михайловна": "Иванова-Петрова Т.М.",
    "Иванова-Петрова, Татьяна Михайловна": "Иванова-Петрова Т.М.",
    "Иванова-Петрова Татьяна": "Иванова-Петрова Т.",
    "Иванова-Петрова, Татьяна": "Иванова-Петрова Т.",
    "Иванова-Петрова Т.М.": "Иванова-Петрова Т.М.",
    "Иванова-Петрова, Т.М.": "Иванова-Петрова Т.М.",
    "Иванова-Петрова Т. М.": "Иванова-Петрова Т.М.",
    "Иванова-Петрова, Т. М.": "Иванова-Петрова Т.М.",
    # RU-WITH-DASH UPPER
    "ИВАНОВА-ПЕТРОВА ТАТЬЯНА МИХАЙЛОВНА": "Иванова-Петрова Т.М.",
    "ИВАНОВА-ПЕТРОВА, ТАТЬЯНА МИХАЙЛОВНА": "Иванова-Петрова Т.М.",
    "ИВАНОВА-ПЕТРОВА ТАТЬЯНА": "Иванова-Петрова Т.",
    "ИВАНОВА-ПЕТРОВА Т.М.": "Иванова-Петрова Т.М.",
    "ИВАНОВА-ПЕТРОВА Т. М.": "Иванова-Петрова Т.М.",
    "Т М ИВАНОВА-ПЕТРОВА": "Иванова-Петрова Т.М.",
    # RU-WITH-DASH-AFTER-COMMA
    "Иванова-Петрова, Татьяна, Михайловна": "Иванова-Петрова Т.М.",
    "Иванова-Петрова, Татьяна,Михайловна": "Иванова-Петрова Т.М.",
    "Татьяна Михайловна, Иванова-Петрова": "Иванова-Петрова Т.М.",
    "Татьяна Михайловна,Иванова-Петрова": "Иванова-Петрова Т.М.",
    # RU-EXTREMELY-CASES
    "ИВАНОВА татьяна михайловна": "Иванова Т.М.",
    "ИВАНОВА, татьяна михайловна": "Иванова Т.М.",
    "ИВАНОВА татьяна": "Иванова Т.",
    "Иванова татьяна михайловна": "Иванова Т.М.",
    "Иванова, татьяна михайловна": "Иванова Т.М.",
    "Иванова татьяна": "Иванова Т.",
    "иванова татьяна михайловна": "Иванова Т.М.",
    "иванова, татьяна михайловна": "Иванова Т.М.",
    "иванова татьяна": "Иванова Т.",
    "иванова Татьяна": "Иванова Т.",
    # RU-EXTREMELY-CASES-INIT
    "Иванова т.м.": "Иванова Т.М.",
    "Иванова,Т.м.": "Иванова Т.М.",
    "Иванова,т.М.": "Иванова Т.М.",
    "Иванова, Т.м.": "Иванова Т.М.",
    "Иванова Т. м.": "Иванова Т.М.",
    "т.м. Иванова": "Иванова Т.М.",
    "Т.м.,Иванова": "Иванова Т.М.",
    "т.М., Иванова": "Иванова Т.М.",
    "т. м. Иванова": "Иванова Т.М.",
    "т. М. Иванова": "Иванова Т.М.",
    "Т. м.,Иванова": "Иванова Т.М.",
    "т. Иванова": "Иванова Т.",
    "т., Иванова": "Иванова Т.",
    "Иванова т м": "Иванова Т.М.",
    "Иванова Т м": "Иванова Т.М.",
    "Иванова т М": "Иванова Т.М.",
    "Иванова,т м": "Иванова Т.М.",
    "Иванова, т М": "Иванова Т.М.",
    "Иванова т": "Иванова Т.",
    "Иванова,т": "Иванова Т.",
    "Иванова, т": "Иванова Т.",
    "т м Иванова": "Иванова Т.М.",
    "Т м Иванова": "Иванова Т.М.",
    "т М Иванова": "Иванова Т.М.",
    "т м,Иванова": "Иванова Т.М.",
    "т Иванова": "Иванова Т.",
    "т,Иванова": "Иванова Т.",
    "т, Иванова": "Иванова Т.",
    # RU-EXTREMELY-FIRSTNAME-INIT-FAM
    "татьяна М. ИВАНОВА": "Иванова Т.М.",
    "татьяна м. ИВАНОВА": "Иванова Т.М.",
    "татьяна М. Иванова": "Иванова Т.М.",
    "татьяна м. Иванова": "Иванова Т.М.",
    "татьяна М. иванова": "Иванова Т.М.",
    "татьяна м. иванова": "Иванова Т.М.",
    "Татьяна м. Иванова": "Иванова Т.М.",
    "Татьяна М. иванова": "Иванова Т.М.",
}


# --- tests ---
@pytest.mark.parametrize("inp, expected", list(TEST_CASES.items()))
def test_norm_name(inp, expected):
    """Check normalization of Russian/English personal names."""
    out = norm_name(inp)
    assert out == expected, f"{inp!r} -> {out!r} (expected {expected!r})"
