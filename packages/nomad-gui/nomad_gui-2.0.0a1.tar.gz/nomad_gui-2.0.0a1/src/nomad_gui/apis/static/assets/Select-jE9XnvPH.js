import{R as p,r as n,j as e,n as S,a7 as R,a8 as P,a9 as j,ap as D,aa as _,ab as g,B as b}from"./material-react-table-B5vcPysv.js";import{a4 as L,a5 as I,a6 as w,j as y,a7 as E,l as k,A as B,a8 as M,a9 as N,aa as V,O as W,ab as A,P as F,z as T,h as U}from"./index-Ch6wx3XL.js";import{a as z}from"./useLocalState-DdvWN1Wu.js";const $=p.forwardRef(function(a,r){const{navigate:s}=L(),u=n.useCallback(()=>{a.to&&s(a.to)},[s,a.to]);return e.jsx(S,{...a,href:"#",onClick:u,ref:r})});function q({url:o,...a}){const[r,s]=z(o||"/"),u=n.useMemo(()=>{const[c,h]=r.split("?");return{path:c,rawSearch:Object.fromEntries(new URLSearchParams(h||"").entries())}},[r]),d=n.useCallback(c=>{s(c)},[s]),l=n.useMemo(()=>({navigate:d,createLink:(c,h)=>e.jsx($,{ref:h,...c})}),[d]);return e.jsx(I.Provider,{value:l,children:e.jsx(w,{...a,location:u,navigate:d})})}const G={path:"",component:function(){return e.jsxs(b,{sx:{height:"70vh",position:"relative"},children:[e.jsx(V,{}),e.jsx(W,{})]})},errorComponent:function(){const a=A();return e.jsx(b,{sx:{height:"70vh",position:"relative"},children:e.jsx(F,{fullwidth:!0,variant:"dialog",children:e.jsx(T,{error:a})})})},children:[U]};function X({children:o,component:a,initialPath:r,title:s,description:u,selectButtonLabel:d,onSelect:l,selectOptions:c,...h}){const x=a,[i,t]=n.useState(!1),f=n.useCallback(()=>t(!0),[t]),C=n.useCallback(()=>t(!1),[t]),m=n.useCallback(v=>{t(!1),l?.(v)},[t,l]);return e.jsxs(e.Fragment,{children:[e.jsx(x,{...h,title:s,onClick:f,children:o}),e.jsx(H,{open:i,onCancel:C,onSelect:m,selectOptions:c,initialPath:r,title:s,description:u,selectButtonLabel:d})]})}function H({selectOptions:o,initialPath:a,title:r,description:s,selectButtonLabel:u="Select",onSelect:d,onCancel:l,open:c,...h}){const[x,i]=n.useState(void 0),t=n.useCallback(()=>{l?.()},[l]),f=n.useCallback(()=>{y(x!==void 0,"SelectedPath must be defined when select button is clicked."),d?.(x)},[d,x]);return c?e.jsxs(R,{open:!0,onClose:t,fullWidth:!0,maxWidth:"xl",...h,children:[r&&e.jsx(P,{children:r}),s&&e.jsx(j,{children:e.jsx(D,{children:s})}),e.jsx(j,{sx:C=>({padding:0,borderWidth:1,borderStyle:"solid",borderColor:C.palette.divider,borderLeft:"none",borderRight:"none",backgroundColor:C.palette.background.default}),children:e.jsx(J,{selectOptions:o,initialPath:a,onChange:i})}),e.jsxs(_,{children:[e.jsx(g,{onClick:t,title:"Cancel",children:"Cancel"}),e.jsx(g,{onClick:f,disabled:x===void 0,title:"Select",children:u})]})]}):null}function J({selectOptions:o={},initialPath:a,onChange:r}){const[s,u]=n.useState(a),d=E(o),{entity:l}=o,c=n.useCallback(({location:h,fullMatch:x})=>{const i=x[x.length-1];u(h);let t=!1;if(l==="file"){t=i.route.routeId===k.routeId,t&&=i.response?.m_is==="File";const{filePattern:f}=o;if(f){const C=i.path;t&&=C.match(f)!==null}}else if(l==="directory")t=i.route.routeId===k.routeId,t&&=i.response?.m_is==="Directory";else if(l==="section"){t=i.route.routeId===B.routeId,t&&=i.response?.m_def!==void 0;const{sectionDefinition:f}=o;if(f){const C=i.response?.m_def;t&&=C.m_ref===f||C.all_base_sections.some(m=>m.m_ref===f)}}r?.(t?h:void 0)},[u,r,l,o]);return e.jsx(M.Provider,{value:d,children:e.jsx(q,{route:G,loader:N,url:s,onNavigate:c})})}export{X as S};
