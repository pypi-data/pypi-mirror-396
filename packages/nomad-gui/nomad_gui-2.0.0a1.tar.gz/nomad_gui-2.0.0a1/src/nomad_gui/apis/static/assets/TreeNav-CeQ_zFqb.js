import{r as t,j as n,T as ae}from"./material-react-table-B5vcPysv.js";import{s as H,b as re,t as ue}from"./index-Ch6wx3XL.js";import{u as ce}from"./useDataForRoute-CHohu-wJ.js";import{N as ie}from"./NavItem-BloxgtRl.js";import{u as E}from"./useLocalState-DdvWN1Wu.js";function le(){var e=t.useRef(!0);return e.current?(e.current=!1,!0):e.current}function J({path:e,request:u,dataIsSufficient:M=()=>!0,filterChildKeys:Q=()=>!0,getChildProps:x=()=>({}),orderCompareFn:b,depth:a=0,children:U,expanded:g,onToggle:S,defaultExpanded:y,expandable:F=!1,...V}){const w=g!==void 0,A=E(u);A!==u&&A&&console.warn("Request must not change. Might happen on hot update, otherwise: did you forget to memoize it?");const r=t.useMemo(()=>e.split("/"),[e]),B=t.useMemo(()=>r.at(-1)||"no path",[r]),X=t.useMemo(()=>({request:{[e]:u},noImplicitFetch:!0}),[u,e]),I=ce(X),{fetch:h,loading:N}=I,T=I.data&&H(r,I.data).at(-1),P=!!T,{index:p,fullMatch:v,navigate:W}=re(),z=t.useMemo(()=>v.slice(p+1).map(s=>s.path).join("/"),[v,p]),l=t.useMemo(()=>v[p+r.length+1]?.path,[v,p,r]),R=z.substring(0,e.length)===e,f=e===z,k=E(R)!==R&&R,G=E(f)!==f&&f,C=ue(),c=t.useMemo(()=>C&&H(r,C,!1).at(-1),[C,r]),L=c&&M(c,B),j=t.useRef();T&&!N?j.current=T:c&&L&&(j.current=c);const o=typeof F=="function"?F(j.current):F,[Z,K]=t.useState(!1),[q,ee]=t.useState(!!y&&o),d=w?g:q,te=t.useCallback(s=>{S&&s!==g&&S()},[g,S]),i=w?te:ee,se=t.useCallback(()=>W({path:e,search:{}}),[W,e]),D=t.useCallback(()=>{if(o)return i(!0),h()},[i,h,o]),O=t.useCallback(()=>{i(!1),K(!1)},[i]),oe=t.useCallback(()=>{d?O():(D(),K(!0))},[d,D,O]),Y=le();t.useEffect(()=>{if(Y&&y)return D();if(!(!k||!o)&&(i(!0),!L&&(!P||G&&!d)))return h()},[k,L,h,G,d,o,P,i,y,D,Y]);const m=j.current,$=d||k&&o,ne=f||R&&(!$||N);return n.jsx(ie,{expanded:$,selected:ne,highlighted:f,onToggle:oe,onSelect:se,expandable:o,label:B,sx:{"&>.NavItem-button":{paddingLeft:a===0?void 0:(a-1)*2},"&.NavItem-root":{position:"relative"},...a>0&&{"&>.NavItem-content::before":{content:'""',position:"absolute",top:42,bottom:-4,left:16+a*16,borderLeftWidth:1,borderLeftStyle:"solid",borderLeftColor:"divider"}}},...V,children:$&&n.jsxs(n.Fragment,{children:[U,N?n.jsxs(n.Fragment,{children:[n.jsx(ae,{sx:{marginLeft:a*2+4,marginY:1},children:"loading..."}),l&&!Z&&c?.[l]&&n.jsx(J,{path:`${e}/${l}`,expandable:o,request:u,dataIsSufficient:M,getChildProps:x,orderCompareFn:b,...x(c,l,e),depth:a+1},l)]}):m&&Object.keys(m).filter(s=>!s.startsWith("m_")).filter(s=>Q(m,s)).toSorted((s,_)=>b?b(m,s,_):s.localeCompare(_)).map(s=>n.jsx(J,{path:`${e}/${s}`,expandable:o,request:u,dataIsSufficient:M,getChildProps:x,orderCompareFn:b,...x(m,s,e),depth:a+1},s))]})})}export{J as T};
