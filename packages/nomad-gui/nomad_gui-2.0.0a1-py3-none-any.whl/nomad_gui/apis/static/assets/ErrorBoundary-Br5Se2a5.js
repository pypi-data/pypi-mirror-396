import{r as h,j as e,R as S,L as R,ai as _,aj as E,ak as g,a_ as y,al as w,n as v,B as b,k as D}from"./material-react-table-CoLKVKmx.js";import{aa as L,cN as P,cO as B,cP as M,ac as W,cQ as N,bv as C,c8 as O,cd as U,cR as V,cS as I,cT as T,cU as F,cV as $,P as q,at as A,cW as Q,O as z,br as G}from"./index-Bzcp6Isa.js";var k=function(){return k=Object.assign||function(n){for(var r,t=1,l=arguments.length;t<l;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},k.apply(this,arguments)};function ne(s,n,r,t){function l(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function u(c){try{d(t.next(c))}catch(o){i(o)}}function f(c){try{d(t.throw(c))}catch(o){i(o)}}function d(c){c.done?a(c.value):l(c.value).then(u,f)}d((t=t.apply(s,n||[])).next())})}const H=S.forwardRef(function(n,r){const{navigate:t}=M(),l=h.useCallback(()=>{n.to&&t(n.to)},[t,n.to]);return e.jsx(R,{...n,href:"#",onClick:l,ref:r})});function J({url:s,...n}){const[r,t]=L(s||"/"),l=h.useMemo(()=>{const[u,f]=r.split("?");return{path:u,rawSearch:Object.fromEntries(new URLSearchParams(f||"").entries())}},[r]),a=h.useCallback(u=>{t(u)},[t]),i=h.useMemo(()=>({navigate:a,createLink:(u,f)=>e.jsx(H,{ref:f,...u})}),[a]);return e.jsx(P.Provider,{value:i,children:e.jsx(B,{...n,location:l,navigate:a})})}const K={routeId:"selectRoot",path:"",component:function(){return e.jsxs(b,{sx:{height:"70vh",position:"relative"},children:[e.jsx(Q,{}),e.jsx(z,{})]})},errorComponent:function(){const n=$();return e.jsx(b,{sx:{height:"70vh",position:"relative"},children:e.jsx(q,{maxWidth:"unset",variant:"dialog",children:e.jsx(A,{error:n})})})},children:[F]};function re({children:s,component:n,initialPath:r,title:t,description:l,selectButtonLabel:a,onSelect:i,selectOptions:u,...f}){const d=n,[c,o]=h.useState(!1),j=h.useCallback(()=>o(!0),[o]),x=h.useCallback(()=>o(!1),[o]),m=h.useCallback(p=>{o(!1),i?.(p)},[o,i]);return e.jsxs(e.Fragment,{children:[e.jsx(d,{...f,title:t,onClick:j,children:s}),e.jsx(X,{open:c,onCancel:x,onSelect:m,selectOptions:u,initialPath:r,title:t,description:l,selectButtonLabel:a})]})}function X({selectOptions:s,initialPath:n,title:r,description:t,selectButtonLabel:l="Select",onSelect:a,onCancel:i,open:u,...f}){const[d,c]=h.useState(void 0),o=h.useCallback(()=>{i?.()},[i]),j=h.useCallback(()=>{W(d!==void 0,"SelectedPath must be defined when select button is clicked."),a?.(d)},[a,d]);return u?e.jsxs(_,{open:!0,onClose:o,fullWidth:!0,maxWidth:"xl",...f,children:[r&&e.jsx(E,{children:r}),t&&e.jsx(g,{children:e.jsx(y,{children:t})}),e.jsx(g,{sx:x=>({padding:0,borderWidth:1,borderStyle:"solid",borderColor:x.palette.divider,borderLeft:"none",borderRight:"none",backgroundColor:x.palette.background.default}),children:e.jsx(Y,{selectOptions:s,initialPath:n,onChange:c})}),e.jsxs(w,{children:[e.jsx(v,{onClick:o,title:"Cancel",children:"Cancel"}),e.jsx(v,{onClick:j,disabled:d===void 0,title:"Select",children:l})]})]}):null}function Y({selectOptions:s={},initialPath:n,onChange:r}){const[t,l]=h.useState(n),a=N(s),{entity:i}=s,u=h.useCallback(({location:f,fullMatch:d})=>{const c=d[d.length-1];l(f);let o=!1;if(i==="file"){o=C(c.route,O),o&&=c.response?.m_is==="File";const{filePattern:x}=s;if(x){const m=c.path;o&&=m.match(x)!==null}}else if(i==="directory")o=C(c.route,U),o&&=c.response?.m_is==="Directory";else if(i==="section"){o=C(c.route,V),o&&=c.response?.m_def!==void 0;const{sectionDefinition:x}=s;if(x){const m=c.response?.m_def;o&&=m.m_ref===x||m.all_base_sections.some(p=>p.m_ref===x)}}const j=decodeURIComponent(f);r?.(o?j:void 0)},[l,r,i,s]);return e.jsx(I.Provider,{value:a,children:e.jsx(J,{route:K,loader:T,url:t,onNavigate:u})})}function Z({error:s,message:n}){return e.jsxs("div",{children:[n&&e.jsxs("span",{children:[n,": "]}),e.jsx("span",{children:s.message})]})}function oe(s){const{renderError:n=t=>e.jsx(Z,{error:t,message:s.message}),children:r}=s;return e.jsx(G,{fallbackRender:({error:t,resetErrorBoundary:l})=>e.jsx(D,{onClick:()=>l(),sx:{borderColor:a=>a.palette.error.main,padding:1,overflow:"auto"},children:n(t)}),children:r})}export{oe as E,re as S,k as _,ne as a};
