import{r as l,j as e,n as g,ai as y,aj as G,ak as _,a_ as F,ao as D,aw as A,al as I,B as R,bh as T,ag as k,Z as V}from"./material-react-table-CoLKVKmx.js";import{a as E,aD as h,u as b,a4 as N,aE as O,T as c,I as P,aF as M,aG as W,aq as f,b as B,P as K,aA as U}from"./index-Bzcp6Isa.js";import{u as L}from"./groupTypes-cgeA4QqK.js";import"./rehype-prism-plus-Ct2a49xA.js";import"./msw-DptHyBtO.js";import"./plotly.js-dist-min-Bl-VrBG9.js";function q(){const s=E(),{user:a}=h(),{navigate:t}=b(),[o,n]=l.useState(!1),[r,u]=l.useState(""),[m,p]=l.useState(""),j=()=>{u(""),p(""),n(!0)},d=()=>n(!1),C=i=>{u(i.target.value)},w=async()=>{if(!a)return;if(!s)throw new Error("API is not available");const i={group_name:r,members_info:[{user_id:a.profile.sub,role:"owner"}]};try{const x=await s.post("groups",i);if(x){const S=x.group_id;d(),t({path:`/groups/${S}`})}}catch{p("An error occurred while creating the group.")}},v=i=>{i.preventDefault(),w()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"contained",onClick:j,disabled:!a,children:"Create New Group"}),e.jsx(y,{open:o,onClose:d,maxWidth:"xs",fullWidth:!0,children:e.jsxs("form",{onSubmit:v,children:[e.jsx(G,{children:"Create New Group"}),e.jsxs(_,{children:[e.jsx(F,{children:"Enter the name of the new group:"}),e.jsx(D,{sx:{mt:1},label:"Group Name",size:"small",type:"string",value:r,onChange:C,fullWidth:!0,autoFocus:!0}),m&&e.jsx(A,{sx:{mt:1},severity:"error",onClose:()=>p(""),children:m})]}),e.jsxs(I,{children:[e.jsx(g,{onClick:d,children:"Cancel"}),e.jsx(g,{type:"submit",children:"Create"})]})]})})]})}function z(){return e.jsx(R,{children:e.jsx(q,{})})}function Z(s,a){return s.members_info?.find(t=>t.user_id==a)?.role}function $(){const{user:s}=h(),{navigate:a}=b(),t=N(O),o=l.useMemo(()=>Object.keys(t).filter(r=>r!=="m_response").map(r=>t[r]),[t]),n=l.useMemo(()=>[{accessorKey:"group_name",header:"Name",Cell:({cell:r})=>e.jsx(c,{value:r.getValue(),fullWidth:!0}),enableSorting:!0,grow:!0},{accessorKey:"owner.name",header:"Owner",Cell:({cell:r})=>e.jsx(c,{value:r.getValue()}),enableSorting:!1,grow:!0},{header:"Role",accessorFn:r=>{const u=Z(r,s?.profile.sub);return u?L[u].label:"â€”"},Cell:({cell:r})=>e.jsx(c,{value:r.getValue()}),enableSorting:!1,grow:!0},{id:"members",accessorFn:r=>r?.members_info?.length||"0",header:"Members",Cell:({cell:r})=>e.jsx(c,{value:r.getValue()}),enableSorting:!1,center:!0,grow:!0},{accessorKey:"group_id",header:"ID",Cell:({cell:r})=>e.jsx(P,{value:r.getValue(),abbreviated:!0}),enableSorting:!0,grow:!0}],[s?.profile.sub]);return e.jsx(M,{paginationType:"page",entityLabel:"group",getRowId:r=>r.group_id,onRowClick:r=>{a({path:r.group_id})},columns:n,data:o})}function H(){const{user:s}=h(),a=s?.profile.sub??"",[t,o]=W("user_id",a);return e.jsx(f,{children:e.jsx(T,{row:!0,children:e.jsx(k,{control:e.jsx(V,{disabled:!s,checked:!!s&&t===a,onChange:n=>{o(n.target.checked?a:"")}}),label:"Only my groups"})})})}function se(){const{pageVariant:s}=B(),[a,t]=l.useState("");return e.jsxs(K,{variant:s,title:"Groups",subtitle:"View and manage user groups here. Projects can also be shared with groups instead of single users.",children:[e.jsx(H,{}),e.jsx(f,{primaryActions:e.jsx(z,{}),search:e.jsx(U,{placeholder:"Search groups",value:a,onChange:o=>t(o.target.value),onClear:()=>t("")})}),e.jsx($,{})]})}export{se as default};
