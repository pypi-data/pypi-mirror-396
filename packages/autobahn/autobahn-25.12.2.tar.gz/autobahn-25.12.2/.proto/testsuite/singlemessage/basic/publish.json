{
  "description": "Basic PUBLISH message with application payload",
  "wamp_message_type": "PUBLISH",
  "wamp_message_code": 16,
  "feature": "basic.pubsub",
  "spec_reference": "https://wamp-proto.org/wamp_latest_ietf.html#name-publish-2",
  "samples": [
    {
      "description": "PUBLISH with positional args only",
      "serializers": {
        "json": [
          {
            "bytes": "[16, 239714735, {}, \"com.myapp.mytopic1\", [\"Hello, world!\"]]",
            "bytes_hex": "5b31362c203233393731343733352c207b7d2c2022636f6d2e6d796170702e6d79746f70696331222c205b2248656c6c6f2c20776f726c6421225d5d",
            "note": "With spaces after commas"
          },
          {
            "bytes": "[16,239714735,{},\"com.myapp.mytopic1\",[\"Hello, world!\"]]",
            "bytes_hex": "5b31362c3233393731343733352c7b7d2c22636f6d2e6d796170702e6d79746f70696331222c5b2248656c6c6f2c20776f726c6421225d5d",
            "note": "Compact (no spaces) - produced by autobahn-python"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9510ce0e49c1af80b2636f6d2e6d796170702e6d79746f7069633191ad48656c6c6f2c20776f726c6421"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "85101a0e49c1afa072636f6d2e6d796170702e6d79746f70696331816d48656c6c6f2c20776f726c6421"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c0e49c1af7b7d535512636f6d2e6d796170702e6d79746f706963315b53550d48656c6c6f2c20776f726c64215d5d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "0c00000008000c000b0004000800000014000000000000100c00180000000c00080004000c0000002c00000010000000afc1490e000000000000000012000000636f6d2e6d796170702e6d79746f7069633100000f000000816d48656c6c6f2c20776f726c642100",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 239714735,
        "options": {},
        "topic": "com.myapp.mytopic1",
        "args": [
          "Hello, world!"
        ],
        "kwargs": null
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 239714735\nassert msg.topic == 'com.myapp.mytopic1'\nassert msg.args == ['Hello, world!']\nassert msg.kwargs is None or msg.kwargs == {}\n\n# Check that options are empty/default (all None)\nassert msg.acknowledge is None\nassert msg.exclude_me is None\nassert msg.retain is None\n"
        ],
        "autobahn-js": [
          "// Test framework provides 'msg' with deserialized message\nassert(msg.type === 16);\nassert(msg.request === 239714735);\nassert(Object.keys(msg.options).length === 0);\nassert(msg.topic === 'com.myapp.mytopic1');\nassert(msg.args.length === 1);\nassert(msg.args[0] === 'Hello, world!');\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\nmsg = Publish(\n    request=239714735,\n    topic='com.myapp.mytopic1',\n    args=['Hello, world!']\n)\n"
      }
    },
    {
      "description": "PUBLISH with transparent payload (encrypted E2E)",
      "serializers": {
        "json": [
          {
            "bytes": "[16,123456789,{\"enc_algo\":\"cryptobox\",\"enc_serializer\":\"msgpack\"},\"com.myapp.encrypted\",\"\\u0000gqVjb2xvcqZvcmFuZ2Wlc2l6ZXOTFwAqBw==\"]",
            "bytes_hex": "5b31362c3132333435363738392c7b22656e635f616c676f223a2263727970746f626f78222c22656e635f73657269616c697a6572223a226d73677061636b227d2c22636f6d2e6d796170702e656e63727970746564222c225c75303030306771566a6232787663715a76636d46755a32576c63326c365a584f544677417142773d3d225d",
            "note": "Transparent payload with encryption metadata"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9510ce075bcd1582a8656e635f616c676fa963727970746f626f78ae656e635f73657269616c697a6572a76d73677061636bb3636f6d2e6d796170702e656e63727970746564c41982a5636f6c6f72a66f72616e6765a573697a65739317002a07"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "85101a075bcd15a268656e635f616c676f6963727970746f626f786e656e635f73657269616c697a6572676d73677061636b73636f6d2e6d796170702e656e63727970746564581982a5636f6c6f72a66f72616e6765a573697a65739317002a07"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c075bcd157b5508656e635f616c676f53550963727970746f626f78550e656e635f73657269616c697a65725355076d73677061636b7d535513636f6d2e6d796170702e656e637279707465645b245523551982a5636f6c6f72a66f72616e6765a573697a65739317002a075d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "100000000000000008000c000b000400080000001c0000000000001014001800000010000c00000000000800070006001400000000000201280000000c00000015cd5b070000000013000000636f6d2e6d796170702e656e63727970746564001900000082a5636f6c6f72a66f72616e6765a573697a65739317002a07000000",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 123456789,
        "options": {
          "enc_algo": "cryptobox",
          "enc_serializer": "msgpack"
        },
        "topic": "com.myapp.encrypted",
        "args": null,
        "kwargs": null,
        "payload": "82a5636f6c6f72a66f72616e6765a573697a65739317002a07"
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 123456789\nassert msg.topic == 'com.myapp.encrypted'\n\n# Transparent payload mode: args/kwargs are None, payload is bytes or memoryview\nassert msg.args is None\nassert msg.kwargs is None\nassert msg.payload is not None\nassert isinstance(msg.payload, (bytes, memoryview))\nassert msg.payload.hex() == '82a5636f6c6f72a66f72616e6765a573697a65739317002a07'\n\n# E2E encryption metadata in options\nassert msg.enc_algo == 'cryptobox'\nassert msg.enc_serializer == 'msgpack'\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\n# Simulated encrypted payload (opaque bytes)\npayload_bytes = bytes.fromhex('82a5636f6c6f72a66f72616e6765a573697a65739317002a07')\n\nmsg = Publish(\n    request=123456789,\n    topic='com.myapp.encrypted',\n    payload=payload_bytes,\n    enc_algo='cryptobox',\n    enc_serializer='msgpack'\n)\n"
      }
    },
    {
      "description": "PUBLISH with forward_for (router-to-router link)",
      "serializers": {
        "json": [
          {
            "bytes": "[16,987654321,{\"forward_for\":[{\"session\":3456789012,\"authid\":\"client1\",\"authrole\":\"frontend\"}]},\"com.myapp.topic2\",[42,\"test\"]]",
            "bytes_hex": "5b31362c3938373635343332312c7b22666f72776172645f666f72223a5b7b2273657373696f6e223a333435363738393031322c22617574686964223a22636c69656e7431222c2261757468726f6c65223a2266726f6e74656e64227d5d7d2c22636f6d2e6d796170702e746f70696332222c5b34322c2274657374225d5d",
            "note": "Compact - Router-to-Router with forward_for"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9510ce3ade68b181ab666f72776172645f666f729183a773657373696f6ecece0a6a14a6617574686964a7636c69656e7431a861757468726f6c65a866726f6e74656e64b0636f6d2e6d796170702e746f70696332922aa474657374"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "85101a3ade68b1a16b666f72776172645f666f7281a36773657373696f6e1ace0a6a146661757468696467636c69656e74316861757468726f6c656866726f6e74656e6470636f6d2e6d796170702e746f7069633282182a6474657374"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c3ade68b17b550b666f72776172645f666f725b7b550773657373696f6e4c00000000ce0a6a145506617574686964535507636c69656e7431550861757468726f6c6553550866726f6e74656e647d5d7d535510636f6d2e6d796170702e746f706963325b552a535504746573745d5d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "100000000000000008000a0009000400080000003400000000102e001800000010000c000800000000000000000000000000000000000000000000000000000000000000000004002e000000140000006c00000050000000b168de3a00000000010000001000000000000a0014000c00080004000a000000100000001c000000146a0ace000000000800000066726f6e74656e640000000007000000636c69656e74310010000000636f6d2e6d796170702e746f70696332000000000800000082182a6474657374",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 987654321,
        "options": {
          "forward_for": [
            {
              "session": 3456789012,
              "authid": "client1",
              "authrole": "frontend"
            }
          ]
        },
        "topic": "com.myapp.topic2",
        "args": [
          42,
          "test"
        ],
        "kwargs": null
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 987654321\nassert msg.topic == 'com.myapp.topic2'\nassert msg.args == [42, 'test']\nassert msg.kwargs is None or msg.kwargs == {}\n\n# Check forward_for (router-to-router link)\nassert msg.forward_for is not None\nassert isinstance(msg.forward_for, list)\nassert len(msg.forward_for) == 1\n\nff = msg.forward_for[0]\nassert isinstance(ff, dict)\nassert ff['session'] == 3456789012\nassert ff['authid'] == 'client1'\nassert ff['authrole'] == 'frontend'\n\n# Normal payload mode (not E2EE)\nassert msg.payload is None\nassert msg.enc_algo is None\nassert msg.enc_serializer is None\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\nmsg = Publish(\n    request=987654321,\n    topic='com.myapp.topic2',\n    args=[42, 'test'],\n    forward_for=[\n        {\n            'session': 3456789012,\n            'authid': 'client1',\n            'authrole': 'frontend'\n        }\n    ]\n)\n"
      }
    },
    {
      "description": "PUBLISH with both forward_for and E2EE (advanced R-Link + encryption)",
      "serializers": {
        "json": [
          {
            "bytes": "[16,555666777,{\"enc_algo\":\"cryptobox\",\"enc_serializer\":\"cbor\",\"forward_for\":[{\"session\":8901234567,\"authid\":\"router1\",\"authrole\":\"router\"}]},\"com.myapp.secure\",\"\\u0000oWZub3RpY2Vxcm91dGVyMSBmb3J3YXJkZWQ=\"]",
            "bytes_hex": "5b31362c3535353636363737372c7b22656e635f616c676f223a2263727970746f626f78222c22656e635f73657269616c697a6572223a2263626f72222c22666f72776172645f666f72223a5b7b2273657373696f6e223a383930313233343536372c22617574686964223a22726f7574657231222c2261757468726f6c65223a22726f75746572227d5d7d2c22636f6d2e6d796170702e736563757265222c225c75303030306f575a756233527059325678636d3931644756794d53426d62334a3359584a6b5a57513d225d",
            "note": "Router-forwarded with E2EE payload"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9510ce211ecd5983a8656e635f616c676fa963727970746f626f78ae656e635f73657269616c697a6572a463626f72ab666f72776172645f666f729183a773657373696f6ecf00000002128e0f87a6617574686964a7726f7574657231a861757468726f6c65a6726f75746572b0636f6d2e6d796170702e736563757265c41aa1666e6f7469636571726f757465723120666f72776172646564"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "85101a211ecd59a368656e635f616c676f6963727970746f626f786e656e635f73657269616c697a65726463626f726b666f72776172645f666f7281a36773657373696f6e1b00000002128e0f876661757468696467726f75746572316861757468726f6c6566726f7574657270636f6d2e6d796170702e736563757265581aa1666e6f7469636571726f757465723120666f72776172646564"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c211ecd597b5508656e635f616c676f53550963727970746f626f78550e656e635f73657269616c697a657253550463626f72550b666f72776172645f666f725b7b550773657373696f6e4c00000002128e0f875506617574686964535507726f7574657231550861757468726f6c65535506726f757465727d5d7d535510636f6d2e6d796170702e7365637572655b245523551aa1666e6f7469636571726f757465723120666f727761726465645d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "0c00000008000a0009000400080000003400000000102e001c00000014001000000000000c000b000a0000000000000000000000000000000000000000000000000004002e0000001800000000000301680000004c00000059cd1e2100000000010000001000000000000a0014000c00080004000a0000001000000018000000870f8e120200000006000000726f75746572000007000000726f75746572310010000000636f6d2e6d796170702e736563757265000000001a000000a1666e6f7469636571726f757465723120666f727761726465640000",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 555666777,
        "options": {
          "enc_algo": "cryptobox",
          "enc_serializer": "cbor",
          "forward_for": [
            {
              "session": 8901234567,
              "authid": "router1",
              "authrole": "router"
            }
          ]
        },
        "topic": "com.myapp.secure",
        "args": null,
        "kwargs": null,
        "payload": "a1666e6f7469636571726f757465723120666f72776172646564"
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 555666777\nassert msg.topic == 'com.myapp.secure'\n\n# Transparent payload mode (E2EE) - payload can be bytes or memoryview\nassert msg.args is None\nassert msg.kwargs is None\nassert msg.payload is not None\nassert isinstance(msg.payload, (bytes, memoryview))\nassert msg.payload.hex() == 'a1666e6f7469636571726f757465723120666f72776172646564'\n\n# E2EE metadata\nassert msg.enc_algo == 'cryptobox'\nassert msg.enc_serializer == 'cbor'\n\n# Router-to-router forwarding\nassert msg.forward_for is not None\nassert isinstance(msg.forward_for, list)\nassert len(msg.forward_for) == 1\n\nff = msg.forward_for[0]\nassert isinstance(ff, dict)\nassert ff['session'] == 8901234567\nassert ff['authid'] == 'router1'\nassert ff['authrole'] == 'router'\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\n# Simulated encrypted payload forwarded from another router\npayload_bytes = bytes.fromhex('a1666e6f7469636571726f757465723120666f72776172646564')\n\nmsg = Publish(\n    request=555666777,\n    topic='com.myapp.secure',\n    payload=payload_bytes,\n    enc_algo='cryptobox',\n    enc_serializer='cbor',\n    forward_for=[\n        {\n            'session': 8901234567,\n            'authid': 'router1',\n            'authrole': 'router'\n        }\n    ]\n)\n"
      }
    },
    {
      "description": "PUBLISH with no payload (signal only)",
      "serializers": {
        "json": [
          {
            "bytes": "[16,987654321,{},\"com.myapp.signal\"]",
            "bytes_hex": "5b31362c3938373635343332312c7b7d2c22636f6d2e6d796170702e7369676e616c225d",
            "note": "Minimal PUBLISH - just a signal on topic, no application payload"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9410ce3ade68b180b0636f6d2e6d796170702e7369676e616c"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "84101a3ade68b1a070636f6d2e6d796170702e7369676e616c"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c3ade68b17b7d535510636f6d2e6d796170702e7369676e616c5d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "0c00000008000a0009000400080000001000000000100a0010000000080004000a0000000c000000b168de3a0000000010000000636f6d2e6d796170702e7369676e616c00000000",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 987654321,
        "options": {},
        "topic": "com.myapp.signal",
        "args": null,
        "kwargs": null,
        "payload": null
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 987654321\nassert msg.topic == 'com.myapp.signal'\n\n# No payload at all - pure signal on topic\nassert msg.args is None\nassert msg.kwargs is None\nassert msg.payload is None\n\n# No additional options\nassert msg.acknowledge is None\nassert msg.exclude_me is None\nassert msg.forward_for is None\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\nmsg = Publish(\n    request=987654321,\n    topic='com.myapp.signal',\n    args=None,\n    kwargs=None\n)\n"
      }
    },
    {
      "description": "PUBLISH with both args and kwargs",
      "serializers": {
        "json": [
          {
            "bytes": "[16,111222333,{},\"com.myapp.data\",[\"Alice\",30],{\"role\":\"admin\",\"active\":true}]",
            "bytes_hex": "5b31362c3131313232323333332c7b7d2c22636f6d2e6d796170702e64617461222c5b22416c696365222c33305d2c7b22726f6c65223a2261646d696e222c22616374697665223a747275657d5d",
            "note": "Complete payload with both positional and keyword arguments"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9610ce06a11e3d80ae636f6d2e6d796170702e6461746192a5416c6963651e82a4726f6c65a561646d696ea6616374697665c3"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "86101a06a11e3da06e636f6d2e6d796170702e646174618265416c696365181ea264726f6c656561646d696e66616374697665f5"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c06a11e3d7b7d53550e636f6d2e6d796170702e646174615b535505416c696365551e5d7b5504726f6c6553550561646d696e5506616374697665547d5d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "100000000000000008000a0009000400080000001400000000100e001c00000010000c00080004000e0000002c00000040000000100000003d1ea10600000000000000000e000000636f6d2e6d796170702e64617461000014000000a264726f6c656561646d696e66616374697665f5090000008265416c696365181e000000",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 111222333,
        "options": {},
        "topic": "com.myapp.data",
        "args": [
          "Alice",
          30
        ],
        "kwargs": {
          "role": "admin",
          "active": true
        },
        "payload": null
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 111222333\nassert msg.topic == 'com.myapp.data'\n\n# Both positional and keyword arguments present\nassert msg.args == ['Alice', 30]\nassert msg.kwargs == {'role': 'admin', 'active': True}\nassert msg.payload is None\n\n# No additional options\nassert msg.acknowledge is None\nassert msg.forward_for is None\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\nmsg = Publish(\n    request=111222333,\n    topic='com.myapp.data',\n    args=['Alice', 30],\n    kwargs={'role': 'admin', 'active': True}\n)\n"
      }
    },
    {
      "description": "PUBLISH with args, kwargs, and acknowledge option",
      "serializers": {
        "json": [
          {
            "bytes": "[16,444555666,{\"acknowledge\":true},\"com.myapp.important\",[100,\"critical\"],{\"priority\":\"high\",\"count\":5}]",
            "bytes_hex": "5b31362c3434343535353636362c7b2261636b6e6f776c65646765223a747275657d2c22636f6d2e6d796170702e696d706f7274616e74222c5b3130302c22637269746963616c225d2c7b227072696f72697479223a2268696768222c22636f756e74223a357d5d",
            "note": "Args + kwargs with acknowledge option (requests PUBLISHED confirmation)"
          }
        ],
        "msgpack": [
          {
            "bytes_hex": "9610ce1a7f619281ab61636b6e6f776c65646765c3b3636f6d2e6d796170702e696d706f7274616e749264a8637269746963616c82a87072696f72697479a468696768a5636f756e7405"
          }
        ],
        "cbor": [
          {
            "bytes_hex": "86101a1a7f6192a16b61636b6e6f776c65646765f573636f6d2e6d796170702e696d706f7274616e7482186468637269746963616ca2687072696f72697479646869676865636f756e7405"
          }
        ],
        "ubjson": [
          {
            "bytes_hex": "5b55106c1a7f61927b550b61636b6e6f776c65646765547d535513636f6d2e6d796170702e696d706f7274616e745b5564535508637269746963616c5d7b55087072696f72697479535504686967685505636f756e7455057d5d"
          }
        ],
        "flatbuffers": [
          {
            "bytes_hex": "100000000000000008000a0009000400080000002000000000101a0020000000140010000c0008000000000000000000000007001a0000000000000130000000480000001000000092617f1a000000000000000013000000636f6d2e6d796170702e696d706f7274616e740016000000a2687072696f72697479646869676865636f756e740500000c00000082186468637269746963616c",
            "note": "Generated by autobahn-python FlatBuffers serializer"
          }
        ]
      },
      "expected_attributes": {
        "message_type": 16,
        "request_id": 444555666,
        "options": {
          "acknowledge": true
        },
        "topic": "com.myapp.important",
        "args": [
          100,
          "critical"
        ],
        "kwargs": {
          "priority": "high",
          "count": 5
        },
        "payload": null
      },
      "validation": {
        "autobahn-python": [
          "from autobahn.wamp.message import Publish\n\n# Test framework provides 'msg' with deserialized message\nassert isinstance(msg, Publish)\nassert msg.request == 444555666\nassert msg.topic == 'com.myapp.important'\n\n# Both args and kwargs present\nassert msg.args == [100, 'critical']\nassert msg.kwargs == {'priority': 'high', 'count': 5}\nassert msg.payload is None\n\n# Acknowledge option set to True\nassert msg.acknowledge == True\n\n# No router forwarding\nassert msg.forward_for is None\n"
        ]
      },
      "construction": {
        "autobahn-python": "from autobahn.wamp.message import Publish\n\nmsg = Publish(\n    request=444555666,\n    topic='com.myapp.important',\n    args=[100, 'critical'],\n    kwargs={'priority': 'high', 'count': 5},\n    acknowledge=True\n)\n"
      }
    },
    {
      "description": "PUBLISH.Options.acknowledge with value true (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "acknowledge": true
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.acknowledge with value false (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "acknowledge": false
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.acknowledge with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "acknowledge": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "acknowledge"
      }
    },
    {
      "description": "PUBLISH.Options.acknowledge with invalid type int",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "acknowledge": 1
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "acknowledge"
      }
    },
    {
      "description": "PUBLISH.Options.exclude_me with value true (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_me": true
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude_me with value false (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_me": false
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude_me with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_me": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "exclude_me"
      }
    },
    {
      "description": "PUBLISH.Options.exclude empty list (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude": []
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude with session IDs (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude": [
            123,
            456,
            789
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "exclude"
      }
    },
    {
      "description": "PUBLISH.Options.exclude with invalid item type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude": [
            "hello"
          ]
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "exclude"
      }
    },
    {
      "description": "PUBLISH.Options.exclude_authid empty list (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_authid": []
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude_authid with authids (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_authid": [
            "alice",
            "bob"
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude_authid with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_authid": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "exclude_authid"
      }
    },
    {
      "description": "PUBLISH.Options.exclude_authid with invalid item type int",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_authid": [
            123
          ]
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "exclude_authid"
      }
    },
    {
      "description": "PUBLISH.Options.exclude_authrole with roles (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_authrole": [
            "manager",
            "staff"
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.exclude_authrole with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "exclude_authrole": "manager"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "exclude_authrole"
      }
    },
    {
      "description": "PUBLISH.Options.eligible empty list (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible": []
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.eligible with session IDs (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible": [
            123,
            456
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.eligible with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "eligible"
      }
    },
    {
      "description": "PUBLISH.Options.eligible_authid with authids (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible_authid": [
            "alice"
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.eligible_authid with invalid type int",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible_authid": 123
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "eligible_authid"
      }
    },
    {
      "description": "PUBLISH.Options.eligible_authrole with roles (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible_authrole": [
            "manager"
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.eligible_authrole with invalid item type int",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "eligible_authrole": [
            123
          ]
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "eligible_authrole"
      }
    },
    {
      "description": "PUBLISH.Options.retain with value true (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "retain": true
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.retain with value false (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "retain": false
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.retain with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "retain": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "retain"
      }
    },
    {
      "description": "PUBLISH.Options.transaction_hash with value (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "transaction_hash": "abc123"
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.transaction_hash with invalid type int",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "transaction_hash": 123
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "transaction_hash"
      }
    },
    {
      "description": "PUBLISH.Options.forward_for empty list (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "forward_for": []
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.forward_for with router info (valid)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "forward_for": [
            {
              "session": 123,
              "authid": "router1",
              "authrole": "router"
            }
          ]
        },
        "com.example.topic"
      ]
    },
    {
      "description": "PUBLISH.Options.forward_for with invalid type string",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "forward_for": "hello"
        },
        "com.example.topic"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "forward_for"
      }
    },
    {
      "description": "PUBLISH.Options.enc_algo cryptobox (valid with payload)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "enc_algo": "cryptobox"
        },
        "com.example.topic",
        "a1666e6f74696365"
      ]
    },
    {
      "description": "PUBLISH.Options.enc_algo with invalid value",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "enc_algo": "invalid"
        },
        "com.example.topic",
        "a1666e6f74696365"
      ],
      "expected_error": {
        "type": "protocol_violation",
        "contains": "enc_algo"
      }
    },
    {
      "description": "PUBLISH.Options.enc_serializer cbor (valid with payload)",
      "test_category": "options_validation",
      "wmsg": [
        16,
        123,
        {
          "enc_algo": "cryptobox",
          "enc_serializer": "cbor"
        },
        "com.example.topic",
        "a1666e6f74696365"
      ]
    }
  ],
  "notes": [
    "Sample 1-7: Serialization samples with roundtrip tests",
    "Sample 8+: Options validation samples (wmsg-level, language-agnostic)",
    "",
    "Sample 1: Basic PUBLISH with args only (normal payload mode)",
    "Sample 2: PUBLISH with transparent payload mode (E2E encryption)",
    "Sample 3: PUBLISH with forward_for (router-to-router link, normal payload)",
    "Sample 4: PUBLISH with both forward_for and E2EE (most advanced deployment)",
    "Sample 5: PUBLISH with no payload (signal only - Variant 1)",
    "Sample 6: PUBLISH with args + kwargs (both present - Variant 3)",
    "Sample 7: PUBLISH with args + kwargs and acknowledge option",
    "",
    "ATTRIBUTE NAMING: Autobahn Implementation vs WAMP Spec 14.1 (Draft)",
    "\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510",
    "\u2502 Autobahn:          \u2502 WAMP Spec 14.1:    \u2502",
    "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524",
    "\u2502 enc_algo           \u2502 ppt_scheme         \u2502",
    "\u2502 enc_serializer     \u2502 ppt_serializer     \u2502",
    "\u2502 enc_key            \u2502 ppt_keyid          \u2502",
    "\u2502 (N/A)              \u2502 ppt_cipher         \u2502",
    "\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518",
    "NOTE: WAMP spec section 14.1 (Payload Transparency) text not yet finalized.",
    "      Test vectors use Autobahn implementation attribute names above.",
    "      See: https://github.com/wamp-proto/wamp-proto/blob/master/WIP_E2EE_AND_RLINKS.md",
    "",
    "Valid enc_algo values: 'null', 'cryptobox', 'mqtt', 'xbr'",
    "Valid enc_serializer values: 'null', 'json', 'msgpack', 'cbor', 'ubjson', 'opaque', 'flatbuffers'",
    "ppt_cipher is hardcoded for 'cryptobox': xsalsa20poly1305 or aes256gcm",
    "",
    "Normal mode: Application payload in args/kwargs (router deserializes)",
    "Transparent mode: Application payload as opaque bytes (router does NOT deserialize)",
    "Transparent mode enables E2E encryption: router cannot read encrypted payload",
    "enc_algo and enc_serializer in Options indicate encryption/serialization used",
    "Payload bytes must be preserved exactly through router (byte-for-byte)",
    "",
    "forward_for: Router-to-router link forwarding chain",
    "  - List of dicts tracking message forwarding across multiple routers",
    "  - Each dict has: session (int), authid (str), authrole (str)",
    "  - Enables distributed WAMP router fabrics (R-Links)",
    "  - Can be combined with E2EE for encrypted multi-router deployments",
    "",
    "Serializers list contains valid byte representations (at least one must match)",
    "Validation blocks are executable code (at least one must pass)",
    "Construction creates a message instance for serialization tests"
  ]
}
